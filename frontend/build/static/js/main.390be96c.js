/*! For license information please see main.390be96c.js.LICENSE.txt */
(()=>{"use strict";var e={579:(e,t,n)=>{e.exports=n(2799)},945:(e,t,n)=>{n.d(t,{DK:()=>v,F6:()=>x,L6:()=>h,N6:()=>p,TK:()=>u,VE:()=>c,cw:()=>m,ec:()=>f,g9:()=>o,hG:()=>g,hc:()=>b,kg:()=>i,lo:()=>a,loginUser:()=>l,o3:()=>s,qx:()=>d});const r="http://localhost:5000/api",a=async e=>{const t=await fetch(r+"/users",{headers:{Authorization:"Bearer "+e}});if(!t.ok)throw new Error("Erreur lors du chargement des utilisateurs");const n=await t.json();return n.data||n},s=async()=>{try{const e=await fetch(r+"/users/conseillers");if(!e.ok)throw new Error("Erreur lors du chargement des conseill\xe8res");const t=await e.json();return t.data||t}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des conseill\xe8res:",e),e}},i=async(e,t)=>{try{console.log("\ud83d\ude80 === D\xc9BUT createUser ==="),console.log("\ud83d\udcdd Payload re\xe7u:",e),console.log("\ud83d\udd11 Token re\xe7u:",t?"".concat(t.substring(0,20),"..."):"AUCUN TOKEN");const a={nom:e.nom,prenom:e.prenom,email:e.email,telephone:e.telephone||"",mot_de_passe:e.motDePasse||"temp123",role:"administrateur"===e.role?"admin":e.role,permissions:e.permissions||{}};console.log("\ud83d\udcca Donn\xe9es transform\xe9es:",a),console.log("\ud83c\udf10 URL cible:",r+"/users"),console.log("\ud83d\udd27 Utilisation de fetch");const s=await fetch(r+"/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(a)});if(console.log("\ud83d\udce1 R\xe9ponse fetch:",{status:s.status,statusText:s.statusText,ok:s.ok,headers:Object.fromEntries(s.headers.entries())}),!s.ok){let e=null,t="Erreur ".concat(s.status," - ").concat(s.statusText);try{e=await s.json(),t=e.message||t,console.error("\u274c Erreur du serveur:",e)}catch(n){console.error("\u274c Impossible de parser l'erreur:",n)}throw new Error(t)}const i=await s.json();return console.log("\u2705 R\xe9sultat final:",i),i}catch(a){throw console.error("\u274c === ERREUR GLOBALE createUser ==="),console.error("Type:",typeof a),console.error("Instance of Error:",a instanceof Error),console.error("Message:",a.message),console.error("Stack:",a.stack),console.error("Objet complet:",a),a}},o=async(e,t,n)=>{const a=await fetch(r+"/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({actif:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Erreur lors de la mise \xe0 jour du statut")}return a.json()},l=async(e,t)=>{const n=await fetch(r+"/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,mot_de_passe:t})});if(!n.ok){const e=await n.json();throw new Error(e.message||"Erreur lors de la connexion")}return n.json()},c=async e=>{const t=await fetch(r+"/users/permissions",{headers:{Authorization:"Bearer "+e}});if(!t.ok)throw new Error("Erreur lors du chargement des permissions");const n=await t.json();return n.data||n},u=async(e,t,n)=>{try{console.log("\ud83d\udd04 [API] Mise \xe0 jour utilisateur:",{id:e,userData:t});const a=await fetch(r+"/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify(t)}),s=await a.json();if(!a.ok)throw new Error(s.message||"Erreur ".concat(a.status,": ").concat(a.statusText));return console.log("\u2705 [API] Utilisateur mis \xe0 jour avec succ\xe8s:",s),s}catch(a){throw console.error("\u274c [API] Erreur mise \xe0 jour utilisateur:",a),new Error(a.message||"Erreur lors de la mise \xe0 jour de l'utilisateur")}},d=async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("Token d'authentification manquant");console.log("\ud83d\udd04 [API] R\xe9cup\xe9ration de mon profil...");const t=await fetch(r+"/users/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Erreur ".concat(t.status,": ").concat(t.statusText));return console.log("\u2705 [API] Mon profil r\xe9cup\xe9r\xe9 avec succ\xe8s:",n),n}catch(e){throw console.error("\u274c [API] Erreur r\xe9cup\xe9ration profil:",e),new Error(e.message||"Erreur lors de la r\xe9cup\xe9ration du profil")}},h=async(e,t)=>{try{console.log("\ud83d\udd04 [API] Mise \xe0 jour de mon profil:",e);const n=await fetch(r+"/users/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(e)}),a=await n.json();if(!n.ok)throw new Error(a.message||"Erreur ".concat(n.status,": ").concat(n.statusText));return console.log("\u2705 [API] Mon profil mis \xe0 jour avec succ\xe8s:",a),a}catch(n){throw console.error("\u274c [API] Erreur mise \xe0 jour profil:",n),new Error(n.message||"Erreur lors de la mise \xe0 jour du profil")}},f=async(e,t,n)=>{try{console.log("\ud83d\udd04 [API] Changement de mot de passe...");const a=await fetch(r+"/users/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({currentPassword:e,newPassword:t})}),s=await a.json();if(!a.ok)throw new Error(s.message||"Erreur ".concat(a.status,": ").concat(a.statusText));return console.log("\u2705 [API] Mot de passe chang\xe9 avec succ\xe8s"),s}catch(a){throw console.error("\u274c [API] Erreur changement mot de passe:",a),new Error(a.message||"Erreur lors du changement de mot de passe")}},p=async(e,t,n)=>{const a=await fetch(r+"/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify({permissions:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Erreur lors de la mise \xe0 jour des permissions")}return a.json()},m=async(e,t)=>{const n=await fetch(r+"/users/".concat(e,"/password-reset"),{method:"POST",headers:{Authorization:"Bearer "+t}});if(!n.ok)throw new Error("Erreur reset MDP");return n.json()},g=async(e,t)=>{const n=await fetch(r+"/users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer "+t}});if(!n.ok){const e=await n.json();throw new Error(e.message||"Erreur lors de la suppression de l'utilisateur")}return n.json()},v=async(e,t)=>{try{console.log("\ud83d\udd04 [API] Upload photo de profil...");const n=new FormData;n.append("photo",e);const a=await fetch(r+"/users/upload-photo",{method:"POST",headers:{Authorization:"Bearer "+t},body:n}),s=await a.json();if(!a.ok)throw new Error(s.message||"Erreur ".concat(a.status,": ").concat(a.statusText));return console.log("\u2705 [API] Photo t\xe9l\xe9charg\xe9e avec succ\xe8s:",s),s}catch(n){throw console.error("\u274c [API] Erreur upload photo:",n),new Error(n.message||"Erreur lors du t\xe9l\xe9chargement de la photo")}},b=async e=>{try{console.log("\ud83d\udd04 [API] Suppression photo de profil...");const t=await fetch(r+"/users/delete-photo",{method:"DELETE",headers:{Authorization:"Bearer "+e}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Erreur ".concat(t.status,": ").concat(t.statusText));return console.log("\u2705 [API] Photo supprim\xe9e avec succ\xe8s"),n}catch(t){throw console.error("\u274c [API] Erreur suppression photo:",t),new Error(t.message||"Erreur lors de la suppression de la photo")}},x=async(e,t,n)=>{try{console.log("\ud83d\udd04 [API] Upload photo pour utilisateur:",e);const a=new FormData;a.append("photo",t);const s=await fetch(r+"/users/".concat(e,"/upload-photo"),{method:"POST",headers:{Authorization:"Bearer "+n},body:a}),i=await s.json();if(!s.ok)throw new Error(i.message||"Erreur ".concat(s.status,": ").concat(s.statusText));return console.log("\u2705 [API] Photo utilisateur t\xe9l\xe9charg\xe9e avec succ\xe8s:",i),i}catch(a){throw console.error("\u274c [API] Erreur upload photo utilisateur:",a),new Error(a.message||"Erreur lors du t\xe9l\xe9chargement de la photo")}}},2284:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})},2799:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=a,t.jsxs=a},3175:(e,t)=>{const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,a=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,o=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function c(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function u(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},4288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function b(){}function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var y=x.prototype=new b;y.constructor=x,m(y,v.prototype),y.isPureReactComponent=!0;var w=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function S(e,t,r,a,s,i){return r=i.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:i}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(){}function T(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return T((u=e._init)(e._payload),t,a,s,i)}}if(u)return i=i(e),u=""===s?"."+E(e,0):s,w(i)?(a="",null!=u&&(a=u.replace(k,"$&/")+"/"),T(i,t,a,"",(function(e){return e}))):null!=i&&(C(i)&&(l=i,c=a+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(k,"$&/")+"/")+u,i=S(l.type,c,void 0,0,0,l.props)),t.push(i)),1;u=0;var d,p=""===s?".":s+":";if(w(e))for(var m=0;m<e.length;m++)u+=T(s=e[m],t,a,o=p+E(s,m),i);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=T(s=s.value,t,a,o=p+E(s,m++),i);else if("object"===o){if("function"===typeof e.then)return T(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(A,A):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function P(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function R(){}t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=i,t.PureComponent=x,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return j.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(a=""+t.key),t)!N.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];r.children=i}return S(e.type,a,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,a={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)N.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var i=arguments.length-2;if(1===i)a.children=n;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(r in i=e.defaultProps)void 0===a[r]&&(a[r]=i[r]);return S(e,s,void 0,0,0,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=j.T,n={};j.T=n;try{var r=e(),a=j.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(R,L)}catch(s){L(s)}finally{j.T=t}},t.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},t.use=function(e){return j.H.use(e)},t.useActionState=function(e,t,n){return j.H.useActionState(e,t,n)},t.useCallback=function(e,t){return j.H.useCallback(e,t)},t.useContext=function(e){return j.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return j.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=j.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return j.H.useId()},t.useImperativeHandle=function(e,t,n){return j.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return j.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return j.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return j.H.useMemo(e,t)},t.useOptimistic=function(e,t){return j.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return j.H.useReducer(e,t,n)},t.useRef=function(e){return j.H.useRef(e)},t.useState=function(e){return j.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return j.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return j.H.useTransition()},t.version="19.1.0"},4391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(Qm){console.error(Qm)}}(),e.exports=n(7004)},4980:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(2284);function a(e){var t=function(e,t){if("object"!=(0,r.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=(0,r.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,r.A)(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},5043:(e,t,n)=>{e.exports=n(4288)},5896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<s(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,i=a>>>1;r<i;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<a&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v=!1,b="function"===typeof setTimeout?setTimeout:null,x="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function j(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,S||(S=!0,N());else{var t=r(u);null!==t&&L(j,t.startTime-e)}}var N,S=!1,C=-1,k=5,E=-1;function A(){return!!v||!(t.unstable_now()-E<k)}function T(){if(v=!1,S){var e=t.unstable_now();E=e;var n=!0;try{e:{m=!1,g&&(g=!1,x(C),C=-1),p=!0;var s=f;try{t:{for(w(e),h=r(c);null!==h&&!(h.expirationTime>e&&A());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),n=!0;break t}h===r(c)&&a(c),w(e)}else a(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&L(j,l.startTime-e),n=!1}}break e}finally{h=null,f=s,p=!1}n=void 0}}finally{n?N():S=!1}}}if("function"===typeof y)N=function(){y(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,_=P.port2;P.port1.onmessage=T,N=function(){_.postMessage(null)}}else N=function(){b(T,0)};function L(e,n){C=b((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(x(C),C=-1):g=!0,L(j,s-i))):(e.sortIndex=o,n(c,e),m||p||(m=!0,S||(S=!0,N()))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},6672:(e,t,n)=>{var r=n(5043);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=n,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:s}):"script"===n&&i.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},7004:(e,t,n)=>{var r=n(8853),a=n(5043),s=n(7950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(i(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),w=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope");var E=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var T=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=T&&e[T]||e["@@iterator"])?e:null}var _=Symbol.for("react.client.reference");function L(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===_?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case N:return"Suspense";case S:return"SuspenseList";case E:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case w:return(e.displayName||"Context")+".Provider";case y:return(e._context.displayName||"Context")+".Consumer";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:L(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return L(e(t))}catch(Mm){}}return null}var R=Array.isArray,D=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},F=[],M=-1;function B(e){return{current:e}}function z(e){0>M||(e.current=F[M],F[M]=null,M--)}function U(e,t){M++,F[M]=e.current,e.current=t}var q=B(null),V=B(null),W=B(null),H=B(null);function G(e,t){switch(U(W,t),U(V,e),U(q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ad(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=sd(t=ad(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(q),U(q,e)}function Y(){z(q),z(V),z(W)}function $(e){null!==e.memoizedState&&U(H,e);var t=q.current,n=sd(t,e.type);t!==n&&(U(V,e),U(q,n))}function K(e){V.current===e&&(z(q),z(V)),H.current===e&&(z(H),$d._currentValue=O)}var J=Object.prototype.hasOwnProperty,X=r.unstable_scheduleCallback,Q=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ae=r.unstable_UserBlockingPriority,se=r.unstable_NormalPriority,ie=r.unstable_LowPriority,oe=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(Qm){}}var fe=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(pe(e)/me|0)|0},pe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function be(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function xe(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~s)?a=be(r):0!==(i&=o)?a=be(i):n||0!==(n=o&~e)&&(a=be(n)):0!==(o=r&~s)?a=be(o):0!==i?a=be(i):n||0!==(n=r&~e)&&(a=be(n)),0===a?0:0!==t&&t!==a&&0===(t&s)&&((s=a&-a)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:a}function ye(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function je(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Ne(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function Se(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ce(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ke(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-fe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ee(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fe(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Ae(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Te(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Pe(){var e=I.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var _e=Math.random().toString(36).slice(2),Le="__reactFiber$"+_e,Re="__reactProps$"+_e,De="__reactContainer$"+_e,Ie="__reactEvents$"+_e,Oe="__reactListeners$"+_e,Fe="__reactHandles$"+_e,Me="__reactResources$"+_e,Be="__reactMarker$"+_e;function ze(e){delete e[Le],delete e[Re],delete e[Ie],delete e[Oe],delete e[Fe]}function Ue(e){var t=e[Le];if(t)return t;for(var n=e.parentNode;n;){if(t=n[De]||n[Le]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=xd(e);null!==e;){if(n=e[Le])return n;e=xd(e)}return t}n=(e=n).parentNode}return null}function qe(e){if(e=e[Le]||e[De]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ve(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function We(e){var t=e[Me];return t||(t=e[Me]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function He(e){e[Be]=!0}var Ge=new Set,Ye={};function $e(e,t){Ke(e,t),Ke(e+"Capture",t)}function Ke(e,t){for(Ye[e]=t,e=0;e<t.length;e++)Ge.add(t[e])}var Je,Xe,Qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(a=t,J.call(et,a)||!J.call(Ze,a)&&(Qe.test(a)?et[a]=!0:(Ze[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function at(e){if(void 0===Je)try{throw Error()}catch(Mm){var t=Mm.stack.trim().match(/\n( *(at )?)/);Je=t&&t[1]||"",Xe=-1<Mm.stack.indexOf("\n    at")?" (<anonymous>)":-1<Mm.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Je+e+Xe}var st=!1;function it(e,t){if(!e||st)return"";st=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(Mm){var r=Mm}Reflect.construct(e,[],n)}else{try{n.call()}catch(a){r=a}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(i){if(i&&r&&"string"===typeof i.stack)return[i.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{st=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?at(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return at(e.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return it(e.type,!1);case 11:return it(e.type.render,!1);case 1:return it(e.type,!0);case 31:return at("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(Mm){return"\nError generating stack: "+Mm.message+"\n"+Mm.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function gt(e,t,n,r,a,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?bt(e,i,ct(t)):null!=n?bt(e,i,ct(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=s&&(e.defaultChecked=!!s),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,n,r,a,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i)}function bt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function xt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function yt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(i(92));if(R(r)){if(1<r.length)throw Error(i(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function jt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Nt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function St(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Nt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&St(e,a,r)}else for(var s in t)t.hasOwnProperty(s)&&St(e,s,t[s])}function kt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Et=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tt(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Pt=null;function _t(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,Rt=null;function Dt(e){var t=qe(e);if(t&&(e=t.stateNode)){var n=e[Re]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[Re]||null;if(!a)throw Error(i(90));gt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":yt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&xt(e,!!n.multiple,t,!1)}}}var It=!1;function Ot(e,t,n){if(It)return e(t,n);It=!0;try{return e(t)}finally{if(It=!1,(null!==Lt||null!==Rt)&&(Uc(),Lt&&(t=Lt,e=Rt,Rt=Lt=null,Dt(t),e)))for(t=0;t<e.length;t++)Dt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Re]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Mt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Bt=!1;if(Mt)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch(Rh){Bt=!1}var Ut=null,qt=null,Vt=null;function Wt(){if(Vt)return Vt;var e,t,n=qt,r=n.length,a="value"in Ut?Ut.value:Ut.textContent,s=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[s-t];t++);return Vt=a.slice(e,1<t?1-t:void 0)}function Ht(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Gt(){return!0}function Yt(){return!1}function $t(e){function t(t,n,r,a,s){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Gt:Yt,this.isPropagationStopped=Yt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var Kt,Jt,Xt,Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=$t(Qt),en=h({},Qt,{view:0,detail:0}),tn=$t(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Kt=e.screenX-Xt.screenX,Jt=e.screenY-Xt.screenY):Jt=Kt=0,Xt=e),Kt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),rn=$t(nn),an=$t(h({},nn,{dataTransfer:0})),sn=$t(h({},en,{relatedTarget:0})),on=$t(h({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=$t(h({},Qt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=$t(h({},Qt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function pn(){return fn}var mn=$t(h({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ht(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Ht(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ht(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=$t(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=$t(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),bn=$t(h({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0})),xn=$t(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),yn=$t(h({},Qt,{newState:0,oldState:0})),wn=[9,13,27,32],jn=Mt&&"CompositionEvent"in window,Nn=null;Mt&&"documentMode"in document&&(Nn=document.documentMode);var Sn=Mt&&"TextEvent"in window&&!Nn,Cn=Mt&&(!jn||Nn&&8<Nn&&11>=Nn),kn=String.fromCharCode(32),En=!1;function An(e,t){switch(e){case"keyup":return-1!==wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1;var _n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!_n[e.type]:"textarea"===t}function Rn(e,t,n,r){Lt?Rt?Rt.push(r):Rt=[r]:Lt=r,0<(t=Wu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Dn=null,In=null;function On(e){Ou(e,0)}function Fn(e){if(ht(Ve(e)))return e}function Mn(e,t){if("change"===e)return t}var Bn=!1;if(Mt){var zn;if(Mt){var Un="oninput"in document;if(!Un){var qn=document.createElement("div");qn.setAttribute("oninput","return;"),Un="function"===typeof qn.oninput}zn=Un}else zn=!1;Bn=zn&&(!document.documentMode||9<document.documentMode)}function Vn(){Dn&&(Dn.detachEvent("onpropertychange",Wn),In=Dn=null)}function Wn(e){if("value"===e.propertyName&&Fn(In)){var t=[];Rn(t,In,e,_t(e)),Ot(On,t)}}function Hn(e,t,n){"focusin"===e?(Vn(),In=n,(Dn=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Vn()}function Gn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(In)}function Yn(e,t){if("click"===e)return Fn(t)}function $n(e,t){if("input"===e||"change"===e)return Fn(t)}var Kn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Jn(e,t){if(Kn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!J.call(t,a)||!Kn(e[a],t[a]))return!1}return!0}function Xn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qn(e,t){var n,r=Xn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xn(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(Qm){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Mt&&"documentMode"in document&&11>=document.documentMode,rr=null,ar=null,sr=null,ir=!1;function or(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ir||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Jn(sr,r)||(sr=r,0<(r=Wu(ar,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},dr={};function hr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in dr)return ur[e]=n[t];return e}Mt&&(dr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=hr("animationend"),pr=hr("animationiteration"),mr=hr("animationstart"),gr=hr("transitionrun"),vr=hr("transitionstart"),br=hr("transitioncancel"),xr=hr("transitionend"),yr=new Map,wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(e,t){yr.set(e,t),$e(t,[e])}wr.push("scrollEnd");var Nr=new WeakMap;function Sr(e,t){if("object"===typeof e&&null!==e){var n=Nr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Nr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Cr=[],kr=0,Er=0;function Ar(){for(var e=kr,t=Er=kr=0;t<e;){var n=Cr[t];Cr[t++]=null;var r=Cr[t];Cr[t++]=null;var a=Cr[t];Cr[t++]=null;var s=Cr[t];if(Cr[t++]=null,null!==r&&null!==a){var i=r.pending;null===i?a.next=a:(a.next=i.next,i.next=a),r.pending=a}0!==s&&Lr(n,a,s)}}function Tr(e,t,n,r){Cr[kr++]=e,Cr[kr++]=t,Cr[kr++]=n,Cr[kr++]=r,Er|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Tr(e,t,n,r),Rr(e)}function _r(e,t){return Tr(e,null,null,t),Rr(e)}function Lr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(a=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,a&&null!==t&&(a=31-fe(n),null===(r=(e=s.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),s):null}function Rr(e){if(50<Lc)throw Lc=0,Rc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Dr={};function Ir(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(e,t,n,r){return new Ir(e,t,n,r)}function Fr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mr(e,t){var n=e.alternate;return null===n?((n=Or(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Br(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zr(e,t,n,r,a,s){var o=0;if(r=e,"function"===typeof e)Fr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,q.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case E:return(e=Or(31,n,t,a)).elementType=E,e.lanes=s,e;case g:return Ur(n.children,a,s,t);case v:o=8,a|=24;break;case b:return(e=Or(12,n,t,2|a)).elementType=b,e.lanes=s,e;case N:return(e=Or(13,n,t,a)).elementType=N,e.lanes=s,e;case S:return(e=Or(19,n,t,a)).elementType=S,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:case w:o=10;break e;case y:o=9;break e;case j:o=11;break e;case C:o=14;break e;case k:o=16,r=null;break e}o=29,n=Error(i(130,null===e?"null":typeof e,"")),r=null}return(t=Or(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Ur(e,t,n,r){return(e=Or(7,e,r,t)).lanes=n,e}function qr(e,t,n){return(e=Or(6,e,null,t)).lanes=n,e}function Vr(e,t,n){return(t=Or(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wr=[],Hr=0,Gr=null,Yr=0,$r=[],Kr=0,Jr=null,Xr=1,Qr="";function Zr(e,t){Wr[Hr++]=Yr,Wr[Hr++]=Gr,Gr=e,Yr=t}function ea(e,t,n){$r[Kr++]=Xr,$r[Kr++]=Qr,$r[Kr++]=Jr,Jr=e;var r=Xr;e=Qr;var a=32-fe(r)-1;r&=~(1<<a),n+=1;var s=32-fe(t)+a;if(30<s){var i=a-a%5;s=(r&(1<<i)-1).toString(32),r>>=i,a-=i,Xr=1<<32-fe(t)+a|n<<a|r,Qr=s+e}else Xr=1<<s|n<<a|r,Qr=e}function ta(e){null!==e.return&&(Zr(e,1),ea(e,1,0))}function na(e){for(;e===Gr;)Gr=Wr[--Hr],Wr[Hr]=null,Yr=Wr[--Hr],Wr[Hr]=null;for(;e===Jr;)Jr=$r[--Kr],$r[Kr]=null,Qr=$r[--Kr],$r[Kr]=null,Xr=$r[--Kr],$r[Kr]=null}var ra=null,aa=null,sa=!1,ia=null,oa=!1,la=Error(i(519));function ca(e){throw ma(Sr(Error(i(418,"")),e)),la}function ua(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Le]=e,t[Re]=r,n){case"dialog":Fu("cancel",t),Fu("close",t);break;case"iframe":case"object":case"embed":Fu("load",t);break;case"video":case"audio":for(n=0;n<Du.length;n++)Fu(Du[n],t);break;case"source":Fu("error",t);break;case"img":case"image":case"link":Fu("error",t),Fu("load",t);break;case"details":Fu("toggle",t);break;case"input":Fu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":Fu("invalid",t);break;case"textarea":Fu("invalid",t),wt(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Ju(t.textContent,n)?(null!=r.popover&&(Fu("beforetoggle",t),Fu("toggle",t)),null!=r.onScroll&&Fu("scroll",t),null!=r.onScrollEnd&&Fu("scrollend",t),null!=r.onClick&&(t.onclick=Xu),t=!0):t=!1,t||ca(e)}function da(e){for(ra=e.return;ra;)switch(ra.tag){case 5:case 13:return void(oa=!1);case 27:case 3:return void(oa=!0);default:ra=ra.return}}function ha(e){if(e!==ra)return!1;if(!sa)return da(e),sa=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||id(e.type,e.memoizedProps)),t=!t),t&&aa&&ca(e),da(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){aa=vd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}aa=null}}else 27===n?(n=aa,fd(e.type)?(e=bd,bd=null,aa=e):aa=n):aa=ra?vd(e.stateNode.nextSibling):null;return!0}function fa(){aa=ra=null,sa=!1}function pa(){var e=ia;return null!==e&&(null===xc?xc=e:xc.push.apply(xc,e),ia=null),e}function ma(e){null===ia?ia=[e]:ia.push(e)}var ga=B(null),va=null,ba=null;function xa(e,t,n){U(ga,t._currentValue),t._currentValue=n}function ya(e){e._currentValue=ga.current,z(ga)}function wa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ja(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var s=a.dependencies;if(null!==s){var o=a.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),wa(s.return,n,e),r||(o=null);break e}s=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),wa(o,n,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Na(e,t,n,r){e=null;for(var a=t,s=!1;null!==a;){if(!s)if(0!==(524288&a.flags))s=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=a.type;Kn(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===H.current){if(null===(o=a.alternate))throw Error(i(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push($d):e=[$d])}a=a.return}null!==e&&ja(t,e,n,r),t.flags|=262144}function Sa(e){for(e=e.firstContext;null!==e;){if(!Kn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ca(e){va=e,ba=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ka(e){return Aa(va,e)}function Ea(e,t){return null===va&&Ca(e),Aa(e,t)}function Aa(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ba){if(null===e)throw Error(i(308));ba=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ba=ba.next=t;return n}var Ta="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Pa=r.unstable_scheduleCallback,_a=r.unstable_NormalPriority,La={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ra(){return{controller:new Ta,data:new Map,refCount:0}}function Da(e){e.refCount--,0===e.refCount&&Pa(_a,(function(){e.controller.abort()}))}var Ia=null,Oa=0,Fa=0,Ma=null;function Ba(){if(0===--Oa&&null!==Ia){null!==Ma&&(Ma.status="fulfilled");var e=Ia;Ia=null,Fa=0,Ma=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var za=D.S;D.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ia){var n=Ia=[];Oa=0,Fa=Tu(),Ma={status:"pending",value:void 0,then:function(e){n.push(e)}}}Oa++,t.then(Ba,Ba)}(0,t),null!==za&&za(e,t)};var Ua=B(null);function qa(){var e=Ua.current;return null!==e?e:rc.pooledCache}function Va(e,t){U(Ua,null===t?Ua.current:t.pool)}function Wa(){var e=qa();return null===e?null:{parent:La._currentValue,pool:e}}var Ha=Error(i(460)),Ga=Error(i(474)),Ya=Error(i(542)),$a={then:function(){}};function Ka(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Ja(){}function Xa(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Ja,Ja),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ja,Ja);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e}throw Qa=t,Ha}}var Qa=null;function Za(){if(null===Qa)throw Error(i(459));var e=Qa;return Qa=null,e}function es(e){if(e===Ha||e===Ya)throw Error(i(483))}var ts=!1;function ns(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function as(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ss(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Rr(e),Lr(e,null,n),t}return Tr(e,r,t,n),Rr(e)}function is(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ee(e,n)}}function os(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?a=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?a=s=t:s=s.next=t}else a=s=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ls=!1;function cs(){if(ls){if(null!==Ma)throw Ma}}function us(e,t,n,r){ls=!1;var a=e.updateQueue;ts=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=a.baseState;for(i=0,u=c=l=null,o=s;;){var f=-536870913&o.lane,p=f!==o.lane;if(p?(sc&f)===f:(r&f)===f){0!==f&&f===Fa&&(ls=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;f=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(v,d,f);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=g.payload)?m.call(v,d,f):m)||void 0===f)break e;d=h({},d,f);break e;case 2:ts=!0}}null!==(f=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[f]:p.push(f))}else p={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,i|=f;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===s&&(a.shared.lanes=0),fc|=i,e.lanes=i,e.memoizedState=d}}function ds(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function hs(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ds(n[e],t)}var fs=B(null),ps=B(0);function ms(e,t){U(ps,e=dc),U(fs,t),dc=e|t.baseLanes}function gs(){U(ps,dc),U(fs,fs.current)}function vs(){dc=ps.current,z(fs),z(ps)}var bs=0,xs=null,ys=null,ws=null,js=!1,Ns=!1,Ss=!1,Cs=0,ks=0,Es=null,As=0;function Ts(){throw Error(i(321))}function Ps(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kn(e[n],t[n]))return!1;return!0}function _s(e,t,n,r,a,s){return bs=s,xs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?Hi:Gi,Ss=!1,s=n(r,a),Ss=!1,Ns&&(s=Rs(t,n,r,a)),Ls(e),s}function Ls(e){D.H=Wi;var t=null!==ys&&null!==ys.next;if(bs=0,ws=ys=xs=null,js=!1,ks=0,Es=null,t)throw Error(i(300));null===e||Eo||null!==(e=e.dependencies)&&Sa(e)&&(Eo=!0)}function Rs(e,t,n,r){xs=e;var a=0;do{if(Ns&&(Es=null),ks=0,Ns=!1,25<=a)throw Error(i(301));if(a+=1,ws=ys=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}D.H=Yi,s=t(n,r)}while(Ns);return s}function Ds(){var e=D.H,t=e.useState()[0];return t="function"===typeof t.then?zs(t):t,e=e.useState()[0],(null!==ys?ys.memoizedState:null)!==e&&(xs.flags|=1024),t}function Is(){var e=0!==Cs;return Cs=0,e}function Os(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fs(e){if(js){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}js=!1}bs=0,ws=ys=xs=null,Ns=!1,ks=Cs=0,Es=null}function Ms(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ws?xs.memoizedState=ws=e:ws=ws.next=e,ws}function Bs(){if(null===ys){var e=xs.alternate;e=null!==e?e.memoizedState:null}else e=ys.next;var t=null===ws?xs.memoizedState:ws.next;if(null!==t)ws=t,ys=e;else{if(null===e){if(null===xs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(ys=e).memoizedState,baseState:ys.baseState,baseQueue:ys.baseQueue,queue:ys.queue,next:null},null===ws?xs.memoizedState=ws=e:ws=ws.next=e}return ws}function zs(e){var t=ks;return ks+=1,null===Es&&(Es=[]),e=Xa(Es,e,t),t=xs,null===(null===ws?t.memoizedState:ws.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?Hi:Gi),e}function Us(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return zs(e);if(e.$$typeof===w)return ka(e)}throw Error(i(438,String(e)))}function qs(e){var t=null,n=xs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=xs.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},xs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function Vs(e,t){return"function"===typeof t?t(e):t}function Ws(e){return Hs(Bs(),ys,e)}function Hs(e,t,n){var r=e.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=n;var a=e.baseQueue,s=r.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}t.baseQueue=a=s,r.pending=null}if(s=e.baseState,null===a)e.memoizedState=s;else{var l=o=null,c=null,u=t=a.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(sc&h)===h:(bs&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Fa&&(d=!0);else{if((bs&f)===f){u=u.next,f===Fa&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,xs.lanes|=f,fc|=f}h=u.action,Ss&&n(s,h),s=u.hasEagerState?u.eagerState:n(s,h)}else f={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,xs.lanes|=h,fc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!Kn(s,e.memoizedState)&&(Eo=!0,d&&null!==(n=Ma)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Gs(e){var t=Bs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);Kn(s,t.memoizedState)||(Eo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ys(e,t,n){var r=xs,a=Bs(),s=sa;if(s){if(void 0===n)throw Error(i(407));n=n()}else n=t();var o=!Kn((ys||a).memoizedState,n);if(o&&(a.memoizedState=n,Eo=!0),a=a.queue,gi(2048,8,Js.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||null!==ws&&1&ws.memoizedState.tag){if(r.flags|=2048,fi(9,{destroy:void 0,resource:void 0},Ks.bind(null,r,a,n,t),null),null===rc)throw Error(i(349));s||0!==(124&bs)||$s(r,t,n)}return n}function $s(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=xs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},xs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ks(e,t,n,r){t.value=n,t.getSnapshot=r,Xs(t)&&Qs(e)}function Js(e,t,n){return n((function(){Xs(t)&&Qs(e)}))}function Xs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kn(e,n)}catch(r){return!0}}function Qs(e){var t=_r(e,2);null!==t&&Oc(t,e,2)}function Zs(e){var t=Ms();if("function"===typeof e){var n=e;if(e=n(),Ss){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:e},t}function ei(e,t,n,r){return e.baseState=n,Hs(e,ys,"function"===typeof r?r:Vs)}function ti(e,t,n,r,a){if(Ui(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==D.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,ni(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ni(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var s=D.T,i={};D.T=i;try{var o=n(a,r),l=D.S;null!==l&&l(i,o),ri(e,t,o)}catch(c){si(e,t,c)}finally{D.T=s}}else try{ri(e,t,s=n(a,r))}catch(u){si(e,t,u)}}function ri(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){ai(e,t,n)}),(function(n){return si(e,t,n)})):ai(e,t,n)}function ai(e,t,n){t.status="fulfilled",t.value=n,ii(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ni(e,n)))}function si(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,ii(t),t=t.next}while(t!==r)}e.action=null}function ii(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function oi(e,t){return t}function li(e,t){if(sa){var n=rc.formState;if(null!==n){e:{var r=xs;if(sa){if(aa){t:{for(var a=aa,s=oa;8!==a.nodeType;){if(!s){a=null;break t}if(null===(a=vd(a.nextSibling))){a=null;break t}}a="F!"===(s=a.data)||"F"===s?a:null}if(a){aa=vd(a.nextSibling),r="F!"===a.data;break e}}ca(r)}r=!1}r&&(t=n[0])}}return(n=Ms()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:t},n.queue=r,n=Mi.bind(null,xs,r),r.dispatch=n,r=Zs(!1),s=zi.bind(null,xs,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=Ms()).queue=a,n=ti.bind(null,xs,a,s,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function ci(e){return ui(Bs(),ys,e)}function ui(e,t,n){if(t=Hs(e,t,oi)[0],e=Ws(Vs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=zs(t)}catch(Mm){if(Mm===Ha)throw Ya;throw Mm}else r=t;var a=(t=Bs()).queue,s=a.dispatch;return n!==t.memoizedState&&(xs.flags|=2048,fi(9,{destroy:void 0,resource:void 0},di.bind(null,a,n),null)),[r,s,e]}function di(e,t){e.action=t}function hi(e){var t=Bs(),n=ys;if(null!==n)return ui(t,n,e);Bs(),t=t.memoizedState;var r=(n=Bs()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function fi(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=xs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},xs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function pi(){return Bs().memoizedState}function mi(e,t,n,r){var a=Ms();r=void 0===r?null:r,xs.flags|=e,a.memoizedState=fi(1|t,{destroy:void 0,resource:void 0},n,r)}function gi(e,t,n,r){var a=Bs();r=void 0===r?null:r;var s=a.memoizedState.inst;null!==ys&&null!==r&&Ps(r,ys.memoizedState.deps)?a.memoizedState=fi(t,s,n,r):(xs.flags|=e,a.memoizedState=fi(1|t,s,n,r))}function vi(e,t){mi(8390656,8,e,t)}function bi(e,t){gi(2048,8,e,t)}function xi(e,t){return gi(4,2,e,t)}function yi(e,t){return gi(4,4,e,t)}function wi(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function ji(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gi(4,4,wi.bind(null,t,e),n)}function Ni(){}function Si(e,t){var n=Bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Ps(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ci(e,t){var n=Bs();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Ps(t,r[1]))return r[0];if(r=e(),Ss){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r}function ki(e,t,n){return void 0===n||0!==(1073741824&bs)?e.memoizedState=t:(e.memoizedState=n,e=Ic(),xs.lanes|=e,fc|=e,n)}function Ei(e,t,n,r){return Kn(n,t)?n:null!==fs.current?(e=ki(e,n,r),Kn(e,t)||(Eo=!0),e):0===(42&bs)?(Eo=!0,e.memoizedState=n):(e=Ic(),xs.lanes|=e,fc|=e,t)}function Ai(e,t,n,r,a){var s=I.p;I.p=0!==s&&8>s?s:8;var i=D.T,o={};D.T=o,zi(e,!1,t,n);try{var l=a(),c=D.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(l,r);Bi(e,t,u,Dc())}else Bi(e,t,r,Dc())}catch(d){Bi(e,t,{then:function(){},status:"rejected",reason:d},Dc())}finally{I.p=s,D.T=i}}function Ti(){}function Pi(e,t,n,r){if(5!==e.tag)throw Error(i(476));var a=_i(e).queue;Ai(e,a,t,O,null===n?Ti:function(){return Li(e),n(r)})}function _i(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:O},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Li(e){Bi(e,_i(e).next.queue,{},Dc())}function Ri(){return ka($d)}function Di(){return Bs().memoizedState}function Ii(){return Bs().memoizedState}function Oi(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Dc(),r=ss(t,e=as(n),n);return null!==r&&(Oc(r,t,n),is(r,t,n)),t={cache:Ra()},void(e.payload=t)}t=t.return}}function Fi(e,t,n){var r=Dc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Ui(e)?qi(t,n):null!==(n=Pr(e,t,n,r))&&(Oc(n,e,r),Vi(n,t,r))}function Mi(e,t,n){Bi(e,t,n,Dc())}function Bi(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ui(e))qi(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,n);if(a.hasEagerState=!0,a.eagerState=o,Kn(o,i))return Tr(e,t,a,0),null===rc&&Ar(),!1}catch(l){}if(null!==(n=Pr(e,t,a,r)))return Oc(n,e,r),Vi(n,t,r),!0}return!1}function zi(e,t,n,r){if(r={lane:2,revertLane:Tu(),action:r,hasEagerState:!1,eagerState:null,next:null},Ui(e)){if(t)throw Error(i(479))}else null!==(t=Pr(e,n,r,2))&&Oc(t,e,2)}function Ui(e){var t=e.alternate;return e===xs||null!==t&&t===xs}function qi(e,t){Ns=js=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Vi(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ee(e,n)}}var Wi={readContext:ka,use:Us,useCallback:Ts,useContext:Ts,useEffect:Ts,useImperativeHandle:Ts,useLayoutEffect:Ts,useInsertionEffect:Ts,useMemo:Ts,useReducer:Ts,useRef:Ts,useState:Ts,useDebugValue:Ts,useDeferredValue:Ts,useTransition:Ts,useSyncExternalStore:Ts,useId:Ts,useHostTransitionStatus:Ts,useFormState:Ts,useActionState:Ts,useOptimistic:Ts,useMemoCache:Ts,useCacheRefresh:Ts},Hi={readContext:ka,use:Us,useCallback:function(e,t){return Ms().memoizedState=[e,void 0===t?null:t],e},useContext:ka,useEffect:vi,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,mi(4194308,4,wi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return mi(4194308,4,e,t)},useInsertionEffect:function(e,t){mi(4,2,e,t)},useMemo:function(e,t){var n=Ms();t=void 0===t?null:t;var r=e();if(Ss){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Ms();if(void 0!==n){var a=n(t);if(Ss){he(!0);try{n(t)}finally{he(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=Fi.bind(null,xs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ms().memoizedState=e},useState:function(e){var t=(e=Zs(e)).queue,n=Mi.bind(null,xs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ni,useDeferredValue:function(e,t){return ki(Ms(),e,t)},useTransition:function(){var e=Zs(!1);return e=Ai.bind(null,xs,e.queue,!0,!1),Ms().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=xs,a=Ms();if(sa){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===rc)throw Error(i(349));0!==(124&sc)||$s(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,vi(Js.bind(null,r,s,e),[e]),r.flags|=2048,fi(9,{destroy:void 0,resource:void 0},Ks.bind(null,r,s,n,t),null),n},useId:function(){var e=Ms(),t=rc.identifierPrefix;if(sa){var n=Qr;t="\xab"+t+"R"+(n=(Xr&~(1<<32-fe(Xr)-1)).toString(32)+n),0<(n=Cs++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=As++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ri,useFormState:li,useActionState:li,useOptimistic:function(e){var t=Ms();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=zi.bind(null,xs,!0,n),n.dispatch=t,[e,t]},useMemoCache:qs,useCacheRefresh:function(){return Ms().memoizedState=Oi.bind(null,xs)}},Gi={readContext:ka,use:Us,useCallback:Si,useContext:ka,useEffect:bi,useImperativeHandle:ji,useInsertionEffect:xi,useLayoutEffect:yi,useMemo:Ci,useReducer:Ws,useRef:pi,useState:function(){return Ws(Vs)},useDebugValue:Ni,useDeferredValue:function(e,t){return Ei(Bs(),ys.memoizedState,e,t)},useTransition:function(){var e=Ws(Vs)[0],t=Bs().memoizedState;return["boolean"===typeof e?e:zs(e),t]},useSyncExternalStore:Ys,useId:Di,useHostTransitionStatus:Ri,useFormState:ci,useActionState:ci,useOptimistic:function(e,t){return ei(Bs(),0,e,t)},useMemoCache:qs,useCacheRefresh:Ii},Yi={readContext:ka,use:Us,useCallback:Si,useContext:ka,useEffect:bi,useImperativeHandle:ji,useInsertionEffect:xi,useLayoutEffect:yi,useMemo:Ci,useReducer:Gs,useRef:pi,useState:function(){return Gs(Vs)},useDebugValue:Ni,useDeferredValue:function(e,t){var n=Bs();return null===ys?ki(n,e,t):Ei(n,ys.memoizedState,e,t)},useTransition:function(){var e=Gs(Vs)[0],t=Bs().memoizedState;return["boolean"===typeof e?e:zs(e),t]},useSyncExternalStore:Ys,useId:Di,useHostTransitionStatus:Ri,useFormState:hi,useActionState:hi,useOptimistic:function(e,t){var n=Bs();return null!==ys?ei(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:qs,useCacheRefresh:Ii},$i=null,Ki=0;function Ji(e){var t=Ki;return Ki+=1,null===$i&&($i=[]),Xa($i,e,t)}function Xi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Qi(e,t){if(t.$$typeof===f)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zi(e){return(0,e._init)(e._payload)}function eo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Mr(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=qr(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===g?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===k&&Zi(s)===t.type)?(Xi(t=a(t,n.props),n),t.return=e,t):(Xi(t=zr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vr(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Ur(n,e.mode,r,s)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=qr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Xi(n=zr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Vr(t,e.mode,n)).return=e,t;case k:return h(e,t=(0,t._init)(t._payload),n)}if(R(t)||P(t))return(t=Ur(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,Ji(t),n);if(t.$$typeof===w)return h(e,Ea(e,t),n);Qi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===a?c(e,t,n,r):null;case m:return n.key===a?u(e,t,n,r):null;case k:return f(e,t,n=(a=n._init)(n._payload),r)}if(R(n)||P(n))return null!==a?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,Ji(n),r);if(n.$$typeof===w)return f(e,t,Ea(e,n),r);Qi(e,n)}return null}function v(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return v(e,t,n,r=(0,r._init)(r._payload),a)}if(R(r)||P(r))return d(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return v(e,t,n,Ji(r),a);if(r.$$typeof===w)return v(e,t,n,Ea(t,r),a);Qi(t,r)}return null}function b(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var x=u.key;null!==c;){if(c.key===x){if((x=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=a(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===x||"object"===typeof x&&null!==x&&x.$$typeof===k&&Zi(x)===c.type){n(l,c.sibling),Xi(d=a(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=Ur(u.props.children,l.mode,d,u.key)).return=l,l=d):(Xi(d=zr(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return o(l);case m:e:{for(x=u.key;null!==c;){if(c.key===x){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=a(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Vr(u,l.mode,d)).return=l,l=d}return o(l);case k:return b(l,c,u=(x=u._init)(u._payload),d)}if(R(u))return function(a,i,o,l){for(var c=null,u=null,d=i,p=i=0,m=null;null!==d&&p<o.length;p++){d.index>p?(m=d,d=null):m=d.sibling;var g=f(a,d,o[p],l);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(a,d),i=s(g,i,p),null===u?c=g:u.sibling=g,u=g,d=m}if(p===o.length)return n(a,d),sa&&Zr(a,p),c;if(null===d){for(;p<o.length;p++)null!==(d=h(a,o[p],l))&&(i=s(d,i,p),null===u?c=d:u.sibling=d,u=d);return sa&&Zr(a,p),c}for(d=r(d);p<o.length;p++)null!==(m=v(d,a,p,o[p],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?p:m.key),i=s(m,i,p),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(a,e)})),sa&&Zr(a,p),c}(l,c,u,d);if(P(u)){if("function"!==typeof(x=P(u)))throw Error(i(150));return function(a,o,l,c){if(null==l)throw Error(i(151));for(var u=null,d=null,p=o,m=o=0,g=null,b=l.next();null!==p&&!b.done;m++,b=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var x=f(a,p,b.value,c);if(null===x){null===p&&(p=g);break}e&&p&&null===x.alternate&&t(a,p),o=s(x,o,m),null===d?u=x:d.sibling=x,d=x,p=g}if(b.done)return n(a,p),sa&&Zr(a,m),u;if(null===p){for(;!b.done;m++,b=l.next())null!==(b=h(a,b.value,c))&&(o=s(b,o,m),null===d?u=b:d.sibling=b,d=b);return sa&&Zr(a,m),u}for(p=r(p);!b.done;m++,b=l.next())null!==(b=v(p,a,m,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?m:b.key),o=s(b,o,m),null===d?u=b:d.sibling=b,d=b);return e&&p.forEach((function(e){return t(a,e)})),sa&&Zr(a,m),u}(l,c,u=x.call(u),d)}if("function"===typeof u.then)return b(l,c,Ji(u),d);if(u.$$typeof===w)return b(l,c,Ea(l,u),d);Qi(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=a(c,u)).return=l,l=d):(n(l,c),(d=qr(u,l.mode,d)).return=l,l=d),o(l)):n(l,c)}return function(e,t,n,r){try{Ki=0;var a=b(e,t,n,r);return $i=null,a}catch(Mm){if(Mm===Ha||Mm===Ya)throw Mm;var s=Or(29,Mm,null,e.mode);return s.lanes=r,s.return=e,s}}}var to=eo(!0),no=eo(!1),ro=B(null),ao=null;function so(e){var t=e.alternate;U(co,1&co.current),U(ro,e),null===ao&&(null===t||null!==fs.current||null!==t.memoizedState)&&(ao=e)}function io(e){if(22===e.tag){if(U(co,co.current),U(ro,e),null===ao){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ao=e)}}else oo()}function oo(){U(co,co.current),U(ro,ro.current)}function lo(e){z(ro),ao===e&&(ao=null),z(co)}var co=B(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gd(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ho(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fo={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Dc(),a=as(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ss(e,a,r))&&(Oc(t,e,r),is(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Dc(),a=as(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=ss(e,a,r))&&(Oc(t,e,r),is(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Dc(),r=as(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ss(e,r,n))&&(Oc(t,e,n),is(t,e,n))}};function po(e,t,n,r,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Jn(n,r)||!Jn(a,s))}function mo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fo.enqueueReplaceState(t,t.state,null)}function go(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=h({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var vo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function bo(e){vo(e)}function xo(e){console.error(e)}function yo(e){vo(e)}function wo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function jo(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function No(e,t,n){return(n=as(n)).tag=3,n.payload={element:null},n.callback=function(){wo(e,t)},n}function So(e){return(e=as(e)).tag=3,e}function Co(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var s=r.value;e.payload=function(){return a(s)},e.callback=function(){jo(t,n,r)}}var i=n.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){jo(t,n,r),"function"!==typeof a&&(null===Sc?Sc=new Set([this]):Sc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var ko=Error(i(461)),Eo=!1;function Ao(e,t,n,r){t.child=null===e?no(t,null,n,r):to(t,e.child,n,r)}function To(e,t,n,r,a){n=n.render;var s=t.ref;if("ref"in r){var i={};for(var o in r)"ref"!==o&&(i[o]=r[o])}else i=r;return Ca(t),r=_s(e,t,n,i,s,a),o=Is(),null===e||Eo?(sa&&o&&ta(t),t.flags|=1,Ao(e,t,r,a),t.child):(Os(e,t,a),Ko(e,t,a))}function Po(e,t,n,r,a){if(null===e){var s=n.type;return"function"!==typeof s||Fr(s)||void 0!==s.defaultProps||null!==n.compare?((e=zr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,_o(e,t,s,r,a))}if(s=e.child,!Jo(e,a)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(i,r)&&e.ref===t.ref)return Ko(e,t,a)}return t.flags|=1,(e=Mr(s,r)).ref=t.ref,e.return=t,t.child=e}function _o(e,t,n,r,a){if(null!==e){var s=e.memoizedProps;if(Jn(s,r)&&e.ref===t.ref){if(Eo=!1,t.pendingProps=r=s,!Jo(e,a))return t.lanes=e.lanes,Ko(e,t,a);0!==(131072&e.flags)&&(Eo=!0)}}return Io(e,t,n,r,a)}function Lo(e,t,n){var r=t.pendingProps,a=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==s?s.baseLanes|n:n,null!==e){for(a=t.child=e.child,s=0;null!==a;)s=s|a.lanes|a.childLanes,a=a.sibling;t.childLanes=s&~r}else t.childLanes=0,t.child=null;return Ro(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Ro(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Va(0,null!==s?s.cachePool:null),null!==s?ms(t,s):gs(),io(t)}else null!==s?(Va(0,s.cachePool),ms(t,s),oo(),t.memoizedState=null):(null!==e&&Va(0,null),gs(),oo());return Ao(e,t,a,n),t.child}function Ro(e,t,n,r){var a=qa();return a=null===a?null:{parent:La._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Va(0,null),gs(),io(t),null!==e&&Na(e,t,r,!0),null}function Do(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(i(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Io(e,t,n,r,a){return Ca(t),n=_s(e,t,n,r,void 0,a),r=Is(),null===e||Eo?(sa&&r&&ta(t),t.flags|=1,Ao(e,t,n,a),t.child):(Os(e,t,a),Ko(e,t,a))}function Oo(e,t,n,r,a,s){return Ca(t),t.updateQueue=null,n=Rs(t,r,n,a),Ls(e),r=Is(),null===e||Eo?(sa&&r&&ta(t),t.flags|=1,Ao(e,t,n,s),t.child):(Os(e,t,s),Ko(e,t,s))}function Fo(e,t,n,r,a){if(Ca(t),null===t.stateNode){var s=Dr,i=n.contextType;"object"===typeof i&&null!==i&&(s=ka(i)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=fo,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},ns(t),i=n.contextType,s.context="object"===typeof i&&null!==i?ka(i):Dr,s.state=t.memoizedState,"function"===typeof(i=n.getDerivedStateFromProps)&&(ho(t,n,i,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&fo.enqueueReplaceState(s,s.state,null),us(t,r,s,a),cs(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=go(n,o);s.props=l;var c=s.context,u=n.contextType;i=Dr,"object"===typeof u&&null!==u&&(i=ka(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&mo(t,s,r,i),ts=!1;var h=t.memoizedState;s.state=h,us(t,r,s,a),cs(),c=t.memoizedState,o||h!==c||ts?("function"===typeof d&&(ho(t,n,d,r),c=t.memoizedState),(l=ts||po(t,n,l,r,h,c,i))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=i,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,rs(e,t),u=go(n,i=t.memoizedProps),s.props=u,d=t.pendingProps,h=s.context,c=n.contextType,l=Dr,"object"===typeof c&&null!==c&&(l=ka(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==d||h!==l)&&mo(t,s,r,l),ts=!1,h=t.memoizedState,s.state=h,us(t,r,s,a),cs();var f=t.memoizedState;i!==d||h!==f||ts||null!==e&&null!==e.dependencies&&Sa(e.dependencies)?("function"===typeof o&&(ho(t,n,o,r),f=t.memoizedState),(u=ts||po(t,n,u,r,h,f,l)||null!==e&&null!==e.dependencies&&Sa(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,Do(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=to(t,e.child,null,a),t.child=to(t,null,n,a)):Ao(e,t,n,a),t.memoizedState=s.state,e=t.child):e=Ko(e,t,a),e}function Mo(e,t,n,r){return fa(),t.flags|=256,Ao(e,t,n,r),t.child}var Bo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zo(e){return{baseLanes:e,cachePool:Wa()}}function Uo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function qo(e,t,n){var r,a=t.pendingProps,s=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&co.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(sa){if(s?so(t):oo(),sa){var l,c=aa;if(l=c){e:{for(l=c,c=oa;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Jr?{id:Xr,overflow:Qr}:null,retryLane:536870912,hydrationErrors:null},(l=Or(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ra=t,aa=null,l=!0):l=!1}l||ca(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gd(c)?t.lanes=32:t.lanes=536870912,null;lo(t)}return c=a.children,a=a.fallback,s?(oo(),c=Wo({mode:"hidden",children:c},s=t.mode),a=Ur(a,s,n,null),c.return=t,a.return=t,c.sibling=a,t.child=c,(s=t.child).memoizedState=zo(n),s.childLanes=Uo(e,r,n),t.memoizedState=Bo,a):(so(t),Vo(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(so(t),t.flags&=-257,t=Ho(e,t,n)):null!==t.memoizedState?(oo(),t.child=e.child,t.flags|=128,t=null):(oo(),s=a.fallback,c=t.mode,a=Wo({mode:"visible",children:a.children},c),(s=Ur(s,c,n,null)).flags|=2,a.return=t,s.return=t,a.sibling=s,t.child=a,to(t,e.child,null,n),(a=t.child).memoizedState=zo(n),a.childLanes=Uo(e,r,n),t.memoizedState=Bo,t=s);else if(so(t),gd(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(a=Error(i(419))).stack="",a.digest=r,ma({value:a,source:null,stack:null}),t=Ho(e,t,n)}else if(Eo||Na(e,t,n,!1),r=0!==(n&e.childLanes),Eo||r){if(null!==(r=rc)&&(0!==(a=0!==((a=0!==(42&(a=n&-n))?1:Ae(a))&(r.suspendedLanes|n))?0:a)&&a!==l.retryLane))throw l.retryLane=a,_r(e,a),Oc(r,e,a),ko;"$?"===c.data||Yc(),t=Ho(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,aa=vd(c.nextSibling),ra=t,sa=!0,ia=null,oa=!1,null!==e&&($r[Kr++]=Xr,$r[Kr++]=Qr,$r[Kr++]=Jr,Xr=e.id,Qr=e.overflow,Jr=t),(t=Vo(t,a.children)).flags|=4096);return t}return s?(oo(),s=a.fallback,c=t.mode,u=(l=e.child).sibling,(a=Mr(l,{mode:"hidden",children:a.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?s=Mr(u,s):(s=Ur(s,c,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,null===(c=e.child.memoizedState)?c=zo(n):(null!==(l=c.cachePool)?(u=La._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Wa(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=Uo(e,r,n),t.memoizedState=Bo,a):(so(t),e=(n=e.child).sibling,(n=Mr(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Vo(e,t){return(t=Wo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wo(e,t){return(e=Or(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Ho(e,t,n){return to(t,e.child,null,n),(e=Vo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Go(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),wa(e.return,t,n)}function Yo(e,t,n,r,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function $o(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;if(Ao(e,t,r.children,n),0!==(2&(r=co.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Go(e,n,t);else if(19===e.tag)Go(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(U(co,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Yo(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Yo(t,!0,n,null,s);break;case"together":Yo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ko(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),fc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Na(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Mr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Jo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Sa(e))}function Xo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Eo=!0;else{if(!Jo(e,n)&&0===(128&t.flags))return Eo=!1,function(e,t,n){switch(t.tag){case 3:G(t,t.stateNode.containerInfo),xa(0,La,e.memoizedState.cache),fa();break;case 27:case 5:$(t);break;case 4:G(t,t.stateNode.containerInfo);break;case 10:xa(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(so(t),t.flags|=128,null):0!==(n&t.child.childLanes)?qo(e,t,n):(so(t),null!==(e=Ko(e,t,n))?e.sibling:null);so(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Na(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return $o(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),U(co,co.current),r)break;return null;case 22:case 23:return t.lanes=0,Lo(e,t,n);case 24:xa(0,La,e.memoizedState.cache)}return Ko(e,t,n)}(e,t,n);Eo=0!==(131072&e.flags)}else Eo=!1,sa&&0!==(1048576&t.flags)&&ea(t,Yr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,a=r._init;if(r=a(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((a=r.$$typeof)===j){t.tag=11,t=To(null,t,r,e,n);break e}if(a===C){t.tag=14,t=Po(null,t,r,e,n);break e}}throw t=L(r)||r,Error(i(306,t,""))}Fr(r)?(e=go(r,e),t.tag=1,t=Fo(null,t,r,e,n)):(t.tag=0,t=Io(null,t,r,e,n))}return t;case 0:return Io(e,t,t.type,t.pendingProps,n);case 1:return Fo(e,t,r=t.type,a=go(r,t.pendingProps),n);case 3:e:{if(G(t,t.stateNode.containerInfo),null===e)throw Error(i(387));r=t.pendingProps;var s=t.memoizedState;a=s.element,rs(e,t),us(t,r,null,n);var o=t.memoizedState;if(r=o.cache,xa(0,La,r),r!==s.cache&&ja(t,[La],n,!0),cs(),r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Mo(e,t,r,n);break e}if(r!==a){ma(a=Sr(Error(i(424)),t)),t=Mo(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(aa=vd(e.firstChild),ra=t,sa=!0,ia=null,oa=!0,n=no(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===a){t=Ko(e,t,n);break e}Ao(e,t,r,n)}t=t.child}return t;case 26:return Do(e,t),null===e?(n=Ad(t.type,null,t.pendingProps,null))?t.memoizedState=n:sa||(n=t.type,e=t.pendingProps,(r=rd(W.current).createElement(n))[Le]=t,r[Re]=e,ed(r,n,e),He(r),t.stateNode=r):t.memoizedState=Ad(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&sa&&(r=t.stateNode=yd(t.type,t.pendingProps,W.current),ra=t,oa=!0,a=aa,fd(t.type)?(bd=a,aa=vd(r.firstChild)):aa=a),Ao(e,t,t.pendingProps.children,n),Do(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&sa&&((a=r=aa)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Be])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===s)return e}if(null===(e=vd(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,oa))?(t.stateNode=r,ra=t,aa=vd(r.firstChild),oa=!1,a=!0):a=!1),a||ca(t)),$(t),a=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,r=s.children,id(a,s)?r=null:null!==o&&id(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=_s(e,t,Ds,null,null,n),$d._currentValue=a),Do(e,t),Ao(e,t,r,n),t.child;case 6:return null===e&&sa&&((e=n=aa)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vd(e.nextSibling)))return null}return e}(n,t.pendingProps,oa))?(t.stateNode=n,ra=t,aa=null,e=!0):e=!1),e||ca(t)),null;case 13:return qo(e,t,n);case 4:return G(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=to(t,null,r,n):Ao(e,t,r,n),t.child;case 11:return To(e,t,t.type,t.pendingProps,n);case 7:return Ao(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ao(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,xa(0,t.type,r.value),Ao(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,Ca(t),r=r(a=ka(a)),t.flags|=1,Ao(e,t,r,n),t.child;case 14:return Po(e,t,t.type,t.pendingProps,n);case 15:return _o(e,t,t.type,t.pendingProps,n);case 19:return $o(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=Wo(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Mr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Lo(e,t,n);case 24:return Ca(t),r=ka(La),null===e?(null===(a=qa())&&(a=rc,s=Ra(),a.pooledCache=s,s.refCount++,null!==s&&(a.pooledCacheLanes|=n),a=s),t.memoizedState={parent:r,cache:a},ns(t),xa(0,La,a)):(0!==(e.lanes&n)&&(rs(e,t),us(t,null,null,n),cs()),a=e.memoizedState,s=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),xa(0,La,r)):(r=s.cache,xa(0,La,r),r!==a.cache&&ja(t,[La],n,!0))),Ao(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Qo(e){e.flags|=4}function Zo(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Ud(t)){if(null!==(t=ro.current)&&((4194048&sc)===sc?null!==ao:(62914560&sc)!==sc&&0===(536870912&sc)||t!==ao))throw Qa=$a,Ga;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ne():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),ya(La),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?Qo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pa())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Qo(t),null!==n?(nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Qo(t),nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Qo(t),nl(t),t.flags&=-16777217),null;case 27:K(t),n=W.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Qo(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return nl(t),null}e=q.current,ha(t)?ua(t):(e=yd(a,r,n),t.stateNode=e,Qo(t))}return nl(t),null;case 5:if(K(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Qo(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return nl(t),null}if(e=q.current,ha(t))ua(t);else{switch(a=rd(W.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?a.createElement(n,{is:r.is}):a.createElement(n)}}e[Le]=t,e[Re]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(ed(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Qo(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Qo(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(e=W.current,ha(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=ra))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[Le]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Ju(e.nodeValue,n)))||ca(t)}else(e=rd(e).createTextNode(r))[Le]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[Le]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),a=!1}else a=pa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(lo(t),t):(lo(t),null)}if(lo(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool);var s=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==a&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return Y(),null===e&&zu(t.stateNode.containerInfo),nl(t),null;case 10:return ya(t.type),nl(t),null;case 19:if(z(co),null===(a=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(s=a.rendering))if(r)tl(a,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=uo(e))){for(t.flags|=128,tl(a,!1),e=s.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Br(n,e),n=n.sibling;return U(co,1&co.current|2),t.child}e=e.sibling}null!==a.tail&&te()>jc&&(t.flags|=128,r=!0,tl(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!s.alternate&&!sa)return nl(t),null}else 2*te()-a.renderingStartTime>jc&&536870912!==n&&(t.flags|=128,r=!0,tl(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=a.last)?e.sibling=s:t.child=s,a.last=s)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=te(),t.sibling=null,e=co.current,U(co,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return lo(t),vs(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&z(Ua),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ya(La),nl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function al(e,t){switch(na(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ya(La),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return K(t),null;case 13:if(lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return z(co),null;case 4:return Y(),null;case 10:return ya(t.type),null;case 22:case 23:return lo(t),vs(),null!==e&&z(Ua),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return ya(La),null;default:return null}}function sl(e,t){switch(na(t),t.tag){case 3:ya(La),Y();break;case 26:case 27:case 5:K(t);break;case 4:Y();break;case 13:lo(t);break;case 19:z(co);break;case 10:ya(t.type);break;case 22:case 23:lo(t),vs(),null!==e&&z(Ua);break;case 24:ya(La)}}function il(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var s=n.create,i=n.inst;r=s(),i.destroy=r}n=n.next}while(n!==a)}}catch(o){uu(t,t.return,o)}}function ol(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var s=a.next;r=s;do{if((r.tag&e)===e){var i=r.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,a=t;var l=n,c=o;try{c()}catch(u){uu(a,l,u)}}}r=r.next}while(r!==s)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{hs(t,n)}catch(r){uu(e,e.return,r)}}}function cl(e,t,n){n.props=go(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){uu(e,t,r)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(a){uu(e,t,a)}}function dl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){uu(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){uu(e,t,s)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){uu(e,e.return,a)}}function fl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,o=null,l=null,c=null,u=null,d=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(p)||Qu(e,t,p,null,r,h)}}for(var f in r){var p=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=p||null!=h))switch(f){case"type":s=p;break;case"name":a=p;break;case"checked":u=p;break;case"defaultChecked":d=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(i(137,t));break;default:p!==h&&Qu(e,t,f,p,r,h)}}return void gt(e,o,l,c,u,d,s,a);case"select":for(s in p=o=l=f=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||Qu(e,t,s,null,r,c)}for(a in r)if(s=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=s||null!=c))switch(a){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&Qu(e,t,a,s,r,c)}return t=l,n=o,r=p,void(null!=f?xt(e,!!n,f,!1):!!r!==!!n&&(null!=t?xt(e,!!n,t,!0):xt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(a=n[l],n.hasOwnProperty(l)&&null!=a&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Qu(e,t,l,null,r,a)}for(o in r)if(a=r[o],s=n[o],r.hasOwnProperty(o)&&(null!=a||null!=s))switch(o){case"value":f=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(i(91));break;default:a!==s&&Qu(e,t,o,a,r,s)}return void yt(e,f,p);case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Qu(e,t,m,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Qu(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g)&&Qu(e,t,g,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(i(137,t));break;default:Qu(e,t,u,f,r,p)}return;default:if(kt(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&Zu(e,t,v,void 0,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||void 0===f&&void 0===p||Zu(e,t,d,f,r,p);return}}for(var b in n)f=n[b],n.hasOwnProperty(b)&&null!=f&&!r.hasOwnProperty(b)&&Qu(e,t,b,null,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||null==f&&null==p||Qu(e,t,h,f,r,p)}(r,e.type,n,t),r[Re]=t}catch(a){uu(e,e.return,a)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fd(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xu));else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);ed(t,r,n),t[Le]=e,t[Re]=n}catch(s){uu(e,e.return,s)}}var xl=!1,yl=!1,wl=!1,jl="function"===typeof WeakSet?WeakSet:Set,Nl=null;function Sl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(e,n),4&r&&il(5,n);break;case 1:if(Fl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){uu(n,n.return,i)}else{var a=go(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){uu(n,n.return,o)}}64&r&&ll(n),512&r&&ul(n,n.return);break;case 3:if(Fl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{hs(e,t)}catch(i){uu(n,n.return,i)}}break;case 27:null===t&&4&r&&bl(n);case 26:case 5:Fl(e,n),null===t&&4&r&&hl(n),512&r&&ul(n,n.return);break;case 12:Fl(e,n);break;case 13:Fl(e,n),4&r&&Pl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=pu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||xl)){t=null!==t&&null!==t.memoizedState||yl,a=xl;var s=yl;xl=r,(yl=t)&&!s?Bl(e,n,0!==(8772&n.subtreeFlags)):Fl(e,n),xl=a,yl=s}break;case 30:break;default:Fl(e,n)}}function Cl(e){var t=e.alternate;null!==t&&(e.alternate=null,Cl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ze(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var kl=null,El=!1;function Al(e,t,n){for(n=n.child;null!==n;)Tl(e,t,n),n=n.sibling}function Tl(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(Qm){}switch(n.tag){case 26:yl||dl(n,t),Al(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:yl||dl(n,t);var r=kl,a=El;fd(n.type)&&(kl=n.stateNode,El=!1),Al(e,t,n),wd(n.stateNode),kl=r,El=a;break;case 5:yl||dl(n,t);case 6:if(r=kl,a=El,kl=null,Al(e,t,n),El=a,null!==(kl=r))if(El)try{(9===kl.nodeType?kl.body:"HTML"===kl.nodeName?kl.ownerDocument.body:kl).removeChild(n.stateNode)}catch(s){uu(n,t,s)}else try{kl.removeChild(n.stateNode)}catch(s){uu(n,t,s)}break;case 18:null!==kl&&(El?(pd(9===(e=kl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Eh(e)):pd(kl,n.stateNode));break;case 4:r=kl,a=El,kl=n.stateNode.containerInfo,El=!0,Al(e,t,n),kl=r,El=a;break;case 0:case 11:case 14:case 15:yl||ol(2,n,t),yl||ol(4,n,t),Al(e,t,n);break;case 1:yl||(dl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&cl(n,t,r)),Al(e,t,n);break;case 21:Al(e,t,n);break;case 22:yl=(r=yl)||null!==n.memoizedState,Al(e,t,n),yl=r;break;default:Al(e,t,n)}}function Pl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Eh(e)}catch(n){uu(t,t.return,n)}}function _l(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new jl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new jl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach((function(t){var r=mu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function Ll(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(fd(l.type)){kl=l.stateNode,El=!1;break e}break;case 5:kl=l.stateNode,El=!1;break e;case 3:case 4:kl=l.stateNode.containerInfo,El=!0;break e}l=l.return}if(null===kl)throw Error(i(160));Tl(s,o,a),kl=null,El=!1,null!==(s=a.alternate)&&(s.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Dl(t,e),t=t.sibling}var Rl=null;function Dl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ll(t,e),Il(e),4&r&&(ol(3,e,e.return),il(3,e),ol(5,e,e.return));break;case 1:Ll(t,e),Il(e),512&r&&(yl||null===n||dl(n,n.return)),64&r&&xl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=Rl;if(Ll(t,e),Il(e),512&r&&(yl||null===n||dl(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(s=a.getElementsByTagName("title")[0])||s[Be]||s[Le]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=a.createElement(r),a.head.insertBefore(s,a.querySelector("head > title"))),ed(s,r,n),s[Le]=e,He(s),r=s;break e;case"link":var o=Bd("link","href",a).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}ed(s=a.createElement(r),r,n),a.head.appendChild(s);break;case"meta":if(o=Bd("meta","content",a).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}ed(s=a.createElement(r),r,n),a.head.appendChild(s);break;default:throw Error(i(468,r))}s[Le]=e,He(s),r=s}e.stateNode=r}else zd(a,e.type,e.stateNode);else e.stateNode=Dd(a,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?zd(a,e.type,e.stateNode):Dd(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&fl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ll(t,e),Il(e),512&r&&(yl||null===n||dl(n,n.return)),null!==n&&4&r&&fl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ll(t,e),Il(e),512&r&&(yl||null===n||dl(n,n.return)),32&e.flags){a=e.stateNode;try{jt(a,"")}catch(p){uu(e,e.return,p)}}4&r&&null!=e.stateNode&&fl(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(wl=!0);break;case 6:if(Ll(t,e),Il(e),4&r){if(null===e.stateNode)throw Error(i(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){uu(e,e.return,p)}}break;case 3:if(Md=null,a=Rl,Rl=Sd(t.containerInfo),Ll(t,e),Rl=a,Il(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Eh(t.containerInfo)}catch(p){uu(e,e.return,p)}wl&&(wl=!1,Ol(e));break;case 4:r=Rl,Rl=Sd(e.stateNode.containerInfo),Ll(t,e),Il(e),Rl=r;break;case 12:default:Ll(t,e),Il(e);break;case 13:Ll(t,e),Il(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(wc=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,_l(e,r)));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=xl,d=yl;if(xl=u||a,yl=d||c,Ll(t,e),yl=d,xl=u,Il(e),8192&r)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||xl||yl||Ml(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,a)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){uu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(p){uu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,_l(e,n))));break;case 19:Ll(t,e),Il(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,_l(e,r)));case 30:case 21:}}function Il(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(pl(r)){n=r;break}r=r.return}if(null==n)throw Error(i(160));switch(n.tag){case 27:var a=n.stateNode;vl(e,ml(e),a);break;case 5:var s=n.stateNode;32&n.flags&&(jt(s,""),n.flags&=-33),vl(e,ml(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;gl(e,ml(e),o);break;default:throw Error(i(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ol(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ol(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Sl(e,t.alternate,t),t=t.sibling}function Ml(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ol(4,t,t.return),Ml(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Ml(t);break;case 27:wd(t.stateNode);case 26:case 5:dl(t,t.return),Ml(t);break;case 22:null===t.memoizedState&&Ml(t);break;default:Ml(t)}e=e.sibling}}function Bl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:Bl(a,s,n),il(4,s);break;case 1:if(Bl(a,s,n),"function"===typeof(a=(r=s).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){uu(r,r.return,c)}if(null!==(a=(r=s).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)ds(l[a],o)}catch(c){uu(r,r.return,c)}}n&&64&i&&ll(s),ul(s,s.return);break;case 27:bl(s);case 26:case 5:Bl(a,s,n),n&&null===r&&4&i&&hl(s),ul(s,s.return);break;case 12:Bl(a,s,n);break;case 13:Bl(a,s,n),n&&4&i&&Pl(a,s);break;case 22:null===s.memoizedState&&Bl(a,s,n),ul(s,s.return);break;case 30:break;default:Bl(a,s,n)}t=t.sibling}}function zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Da(n))}function Ul(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e))}function ql(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Vl(e,t,n,r),t=t.sibling}function Vl(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:ql(e,t,n,r),2048&a&&il(9,t);break;case 1:case 13:default:ql(e,t,n,r);break;case 3:ql(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e)));break;case 12:if(2048&a){ql(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else ql(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?ql(e,t,n,r):Hl(e,t):2&s._visibility?ql(e,t,n,r):(s._visibility|=2,Wl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&a&&zl(i,t);break;case 24:ql(e,t,n,r),2048&a&&Ul(t.alternate,t)}}function Wl(e,t,n,r,a){for(a=a&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,i=t,o=n,l=r,c=i.flags;switch(i.tag){case 0:case 11:case 15:Wl(s,i,o,l,a),il(8,i);break;case 23:break;case 22:var u=i.stateNode;null!==i.memoizedState?2&u._visibility?Wl(s,i,o,l,a):Hl(s,i):(u._visibility|=2,Wl(s,i,o,l,a)),a&&2048&c&&zl(i.alternate,i);break;case 24:Wl(s,i,o,l,a),a&&2048&c&&Ul(i.alternate,i);break;default:Wl(s,i,o,l,a)}t=t.sibling}}function Hl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:Hl(n,r),2048&a&&zl(r.alternate,r);break;case 24:Hl(n,r),2048&a&&Ul(r.alternate,r);break;default:Hl(n,r)}t=t.sibling}}var Gl=8192;function Yl(e){if(e.subtreeFlags&Gl)for(e=e.child;null!==e;)$l(e),e=e.sibling}function $l(e){switch(e.tag){case 26:Yl(e),e.flags&Gl&&null!==e.memoizedState&&function(e,t,n){if(null===qd)throw Error(i(475));var r=qd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var a=Td(n.href),s=e.querySelector(Pd(a));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Wd.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=s,void He(s);s=e.ownerDocument||e,n=_d(n),(a=jd.get(a))&&Od(n,a),He(s=s.createElement("link"));var o=s;o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),ed(s,"link",n),t.instance=s}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Wd.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Rl,e.memoizedState,e.memoizedProps);break;case 5:default:Yl(e);break;case 3:case 4:var t=Rl;Rl=Sd(e.stateNode.containerInfo),Yl(e),Rl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Gl,Gl=16777216,Yl(e),Gl=t):Yl(e))}}function Kl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Nl=r,Zl(r,e)}Kl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Xl(e),e=e.sibling}function Xl(e){switch(e.tag){case 0:case 11:case 15:Jl(e),2048&e.flags&&ol(9,e,e.return);break;case 3:case 12:default:Jl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Ql(e)):Jl(e)}}function Ql(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Nl=r,Zl(r,e)}Kl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ol(8,t,t.return),Ql(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Ql(t));break;default:Ql(t)}e=e.sibling}}function Zl(e,t){for(;null!==Nl;){var n=Nl;switch(n.tag){case 0:case 11:case 15:ol(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Da(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Nl=r;else e:for(n=e;null!==Nl;){var a=(r=Nl).sibling,s=r.return;if(Cl(r),r===n){Nl=null;break e}if(null!==a){a.return=s,Nl=a;break e}Nl=s}}}var ec={getCacheForType:function(e){var t=ka(La),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,rc=null,ac=null,sc=0,ic=0,oc=null,lc=!1,cc=!1,uc=!1,dc=0,hc=0,fc=0,pc=0,mc=0,gc=0,vc=0,bc=null,xc=null,yc=!1,wc=0,jc=1/0,Nc=null,Sc=null,Cc=0,kc=null,Ec=null,Ac=0,Tc=0,Pc=null,_c=null,Lc=0,Rc=null;function Dc(){if(0!==(2&nc)&&0!==sc)return sc&-sc;if(null!==D.T){return 0!==Fa?Fa:Tu()}return Pe()}function Ic(){0===gc&&(gc=0===(536870912&sc)||sa?je():536870912);var e=ro.current;return null!==e&&(e.flags|=32),gc}function Oc(e,t,n){(e!==rc||2!==ic&&9!==ic)&&null===e.cancelPendingCommit||(Vc(e,0),zc(e,sc,gc,!1)),Ce(e,n),0!==(2&nc)&&e===rc||(e===rc&&(0===(2&nc)&&(pc|=n),4===hc&&zc(e,sc,gc,!1)),ju(e))}function Fc(e,t,n){if(0!==(6&nc))throw Error(i(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||ye(e,t),a=r?function(e,t){var n=nc;nc|=2;var r=Hc(),a=Gc();rc!==e||sc!==t?(Nc=null,jc=te()+500,Vc(e,t)):cc=ye(e,t);e:for(;;)try{if(0!==ic&&null!==ac){t=ac;var s=oc;t:switch(ic){case 1:ic=0,oc=null,Zc(e,t,s,1);break;case 2:case 9:if(Ka(s)){ic=0,oc=null,Qc(t);break}t=function(){2!==ic&&9!==ic||rc!==e||(ic=7),ju(e)},s.then(t,t);break e;case 3:ic=7;break e;case 4:ic=5;break e;case 7:Ka(s)?(ic=0,oc=null,Qc(t)):(ic=0,oc=null,Zc(e,t,s,7));break;case 5:var o=null;switch(ac.tag){case 26:o=ac.memoizedState;case 5:case 27:var l=ac;if(!o||Ud(o)){ic=0,oc=null;var c=l.sibling;if(null!==c)ac=c;else{var u=l.return;null!==u?(ac=u,eu(u)):ac=null}break t}}ic=0,oc=null,Zc(e,t,s,5);break;case 6:ic=0,oc=null,Zc(e,t,s,6);break;case 8:qc(),hc=6;break e;default:throw Error(i(462))}}Jc();break}catch(d){Wc(e,d)}return ba=va=null,D.H=r,D.A=a,nc=n,null!==ac?0:(rc=null,sc=0,Ar(),hc)}(e,t):$c(e,t,!0),s=r;;){if(0===a){cc&&!r&&zc(e,t,0,!1);break}if(n=e.current.alternate,!s||Bc(n)){if(2===a){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Vc(l,o).flags|=256),2!==(o=$c(l,o,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=s,pc|=s,a=4;break e}s=xc,xc=a,null!==s&&(null===xc?xc=s:xc.push.apply(xc,s))}a=o}if(s=!1,2!==a)continue}}if(1===a){Vc(e,0),zc(e,t,0,!0);break}e:{switch(r=e,s=a){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:zc(r,t,gc,!lc);break e;case 2:xc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(a=wc+300-te())){if(zc(r,t,gc,!lc),0!==xe(r,0,!0))break e;r.timeoutHandle=ld(Mc.bind(null,r,n,xc,Nc,yc,t,gc,pc,vc,lc,s,2,-0,0),a)}else Mc(r,n,xc,Nc,yc,t,gc,pc,vc,lc,s,0,-0,0)}break}a=$c(e,t,!1),s=!1}ju(e)}function Mc(e,t,n,r,a,s,o,l,c,u,d,h,f,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(qd={stylesheets:null,count:0,unsuspend:Vd},$l(t),null!==(h=function(){if(null===qd)throw Error(i(475));var e=qd;return e.stylesheets&&0===e.count&&Gd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Gd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nu.bind(null,e,t,s,n,r,a,o,l,c,d,1,f,p)),void zc(e,s,o,!u);nu(e,t,s,n,r,a,o,l,c)}function Bc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!Kn(s(),a))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zc(e,t,n,r){t&=~mc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var s=31-fe(a),i=1<<s;r[s]=-1,a&=~i}0!==n&&ke(e,n,t)}function Uc(){return 0!==(6&nc)||(Nu(0,!1),!1)}function qc(){if(null!==ac){if(0===ic)var e=ac.return;else ba=va=null,Fs(e=ac),$i=null,Ki=0,e=ac;for(;null!==e;)sl(e.alternate,e),e=e.return;ac=null}}function Vc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),qc(),rc=e,ac=n=Mr(e.current,null),sc=t,ic=0,oc=null,lc=!1,cc=ye(e,t),uc=!1,vc=gc=mc=pc=fc=hc=0,xc=bc=null,yc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-fe(r),s=1<<a;t|=e[a],r&=~s}return dc=t,Ar(),n}function Wc(e,t){xs=null,D.H=Wi,t===Ha||t===Ya?(t=Za(),ic=3):t===Ga?(t=Za(),ic=4):ic=t===ko?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,oc=t,null===ac&&(hc=1,wo(e,Sr(t,e.current)))}function Hc(){var e=D.H;return D.H=Wi,null===e?Wi:e}function Gc(){var e=D.A;return D.A=ec,e}function Yc(){hc=4,lc||(4194048&sc)!==sc&&null!==ro.current||(cc=!0),0===(134217727&fc)&&0===(134217727&pc)||null===rc||zc(rc,sc,gc,!1)}function $c(e,t,n){var r=nc;nc|=2;var a=Hc(),s=Gc();rc===e&&sc===t||(Nc=null,Vc(e,t)),t=!1;var i=hc;e:for(;;)try{if(0!==ic&&null!==ac){var o=ac,l=oc;switch(ic){case 8:qc(),i=6;break e;case 3:case 2:case 9:case 6:null===ro.current&&(t=!0);var c=ic;if(ic=0,oc=null,Zc(e,o,l,c),n&&cc){i=0;break e}break;default:c=ic,ic=0,oc=null,Zc(e,o,l,c)}}Kc(),i=hc;break}catch(u){Wc(e,u)}return t&&e.shellSuspendCounter++,ba=va=null,nc=r,D.H=a,D.A=s,null===ac&&(rc=null,sc=0,Ar()),i}function Kc(){for(;null!==ac;)Xc(ac)}function Jc(){for(;null!==ac&&!Z();)Xc(ac)}function Xc(e){var t=Xo(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):ac=t}function Qc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Oo(n,t,t.pendingProps,t.type,void 0,sc);break;case 11:t=Oo(n,t,t.pendingProps,t.type.render,t.ref,sc);break;case 5:Fs(t);default:sl(n,t),t=Xo(n,t=ac=Br(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ac=t}function Zc(e,t,n,r){ba=va=null,Fs(t),$i=null,Ki=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Na(t,n,a,!0),null!==(n=ro.current)){switch(n.tag){case 13:return null===ao?Yc():null===n.alternate&&0===hc&&(hc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===$a?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),du(e,r,a)),!1;case 22:return n.flags|=65536,r===$a?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),du(e,r,a)),!1}throw Error(i(435,n.tag))}return du(e,r,a),Yc(),!1}if(sa)return null!==(t=ro.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==la&&ma(Sr(e=Error(i(422),{cause:r}),n))):(r!==la&&ma(Sr(t=Error(i(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=Sr(r,n),os(e,a=No(e.stateNode,r,a)),4!==hc&&(hc=2)),!1;var s=Error(i(520),{cause:r});if(s=Sr(s,n),null===bc?bc=[s]:bc.push(s),4!==hc&&(hc=2),null===t)return!0;r=Sr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,os(n,e=No(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Sc||!Sc.has(s))))return n.flags|=65536,a&=-a,n.lanes|=a,Co(a=So(a),e,n,r),os(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,sc))return hc=1,wo(e,Sr(n,e.current)),void(ac=null)}catch(s){if(null!==a)throw ac=a,s;return hc=1,wo(e,Sr(n,e.current)),void(ac=null)}32768&t.flags?(sa||1===r?e=!0:cc||0!==(536870912&sc)?e=!1:(lc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ro.current)&&13===r.tag&&(r.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=rl(t.alternate,t,dc);if(null!==n)return void(ac=n);if(null!==(t=t.sibling))return void(ac=t);ac=t=e}while(null!==t);0===hc&&(hc=5)}function tu(e,t){do{var n=al(e.alternate,e);if(null!==n)return n.flags&=32767,void(ac=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ac=e);ac=e=n}while(null!==e);hc=6,ac=null}function nu(e,t,n,r,a,s,o,l,c){e.cancelPendingCommit=null;do{ou()}while(0!==Cc);if(0!==(6&nc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,a,s){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var u=31-fe(n),d=1<<u;o[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&ke(e,r,0),0!==s&&0===a&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,n,s|=Er,o,l,c),e===rc&&(ac=rc=null,sc=0),Ec=t,kc=e,Ac=n,Tc=s,Pc=a,_c=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,X(se,(function(){return lu(),null}))):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=D.T,D.T=null,a=I.p,I.p=2,o=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,td=nh,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===a&&(l=o),f===s&&++d===r&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},nh=!1,Nl=t;null!==Nl;)if(e=(t=Nl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,Nl=e;else for(;null!==Nl;){switch(s=(t=Nl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,a=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var m=go(n.type,a,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){uu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))md(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":md(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Nl=e;break}Nl=t.return}}(e,t)}finally{nc=o,I.p=a,D.T=r}}Cc=1,ru(),au(),su()}}function ru(){if(1===Cc){Cc=0;var e=kc,t=Ec,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=D.T,D.T=null;var r=I.p;I.p=2;var a=nc;nc|=4;try{Dl(t,e);var s=nd,i=er(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&Zn(o.ownerDocument.documentElement,o)){if(null!==l&&tr(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var d=o.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),p=o.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!f.extend&&m>g&&(i=g,g=m,m=i);var v=Qn(o,m),b=Qn(o,g);if(v&&b&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==b.node||f.focusOffset!==b.offset)){var x=d.createRange();x.setStart(v.node,v.offset),f.removeAllRanges(),m>g?(f.addRange(x),f.extend(b.node,b.offset)):(x.setEnd(b.node,b.offset),f.addRange(x))}}}}for(d=[],f=o;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var y=d[o];y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}nh=!!td,nd=td=null}finally{nc=a,I.p=r,D.T=n}}e.current=t,Cc=2}}function au(){if(2===Cc){Cc=0;var e=kc,t=Ec,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=D.T,D.T=null;var r=I.p;I.p=2;var a=nc;nc|=4;try{Sl(e,t.alternate,t)}finally{nc=a,I.p=r,D.T=n}}Cc=3}}function su(){if(4===Cc||3===Cc){Cc=0,ee();var e=kc,t=Ec,n=Ac,r=_c;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Cc=5:(Cc=0,Ec=kc=null,iu(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Sc=null),Te(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(Qm){}if(null!==r){t=D.T,a=I.p,I.p=2,D.T=null;try{for(var s=e.onRecoverableError,i=0;i<r.length;i++){var o=r[i];s(o.value,{componentStack:o.stack})}}finally{D.T=t,I.p=a}}0!==(3&Ac)&&ou(),ju(e),a=e.pendingLanes,0!==(4194090&n)&&0!==(42&a)?e===Rc?Lc++:(Lc=0,Rc=e):Lc=0,Nu(0,!1)}}function iu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Da(t)))}function ou(e){return ru(),au(),su(),lu()}function lu(){if(5!==Cc)return!1;var e=kc,t=Tc;Tc=0;var n=Te(Ac),r=D.T,a=I.p;try{I.p=32>n?32:n,D.T=null,n=Pc,Pc=null;var s=kc,o=Ac;if(Cc=0,Ec=kc=null,Ac=0,0!==(6&nc))throw Error(i(331));var l=nc;if(nc|=4,Xl(s.current),Vl(s,s.current,o,n),nc=l,Nu(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,s)}catch(Qm){}return!0}finally{I.p=a,D.T=r,iu(e,t)}}function cu(e,t,n){t=Sr(n,t),null!==(e=ss(e,t=No(e.stateNode,t,2),2))&&(Ce(e,2),ju(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Sc||!Sc.has(r))){e=Sr(n,e),null!==(r=ss(t,n=So(2),2))&&(Co(n,r,t,e),Ce(r,2),ju(r));break}}t=t.return}}function du(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(uc=!0,a.add(n),e=hu.bind(null,e,t,n),t.then(e,e))}function hu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(sc&n)===n&&(4===hc||3===hc&&(62914560&sc)===sc&&300>te()-wc?0===(2&nc)&&Vc(e,0):mc|=n,vc===sc&&(vc=0)),ju(e)}function fu(e,t){0===t&&(t=Ne()),null!==(e=_r(e,t))&&(Ce(e,t),ju(e))}function pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),fu(e,n)}function mu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==r&&r.delete(t),fu(e,n)}var gu=null,vu=null,bu=!1,xu=!1,yu=!1,wu=0;function ju(e){e!==vu&&null===e.next&&(null===vu?gu=vu=e:vu=vu.next=e),xu=!0,bu||(bu=!0,dd((function(){0!==(6&nc)?X(re,Su):Cu()})))}function Nu(e,t){if(!yu&&xu){yu=!0;do{for(var n=!1,r=gu;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var s=0;else{var i=r.suspendedLanes,o=r.pingedLanes;s=(1<<31-fe(42|e)+1)-1,s=201326741&(s&=a&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,Au(r,s))}else s=sc,0===(3&(s=xe(r,r===rc?s:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||ye(r,s)||(n=!0,Au(r,s));r=r.next}}while(n);yu=!1}}function Su(){Cu()}function Cu(){xu=bu=!1;var e=0;0!==wu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==od&&(od=e,!0);return od=null,!1}()&&(e=wu),wu=0);for(var t=te(),n=null,r=gu;null!==r;){var a=r.next,s=ku(r,t);0===s?(r.next=null,null===n?gu=a:n.next=a,null===a&&(vu=n)):(n=r,(0!==e||0!==(3&s))&&(xu=!0)),r=a}Nu(e,!1)}function ku(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-fe(s),o=1<<i,l=a[i];-1===l?0!==(o&n)&&0===(o&r)||(a[i]=we(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(n=sc,n=xe(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===ic||9===ic)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&Q(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||ye(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&Q(r),Te(n)){case 2:case 8:n=ae;break;case 32:default:n=se;break;case 268435456:n=oe}return r=Eu.bind(null,e),n=X(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&Q(r),e.callbackPriority=2,e.callbackNode=null,2}function Eu(e,t){if(0!==Cc&&5!==Cc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ou()&&e.callbackNode!==n)return null;var r=sc;return 0===(r=xe(e,e===rc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,r,t),ku(e,te()),null!=e.callbackNode&&e.callbackNode===n?Eu.bind(null,e):null)}function Au(e,t){if(ou())return null;Fc(e,t,!0)}function Tu(){return 0===wu&&(wu=je()),wu}function Pu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Tt(""+e)}function _u(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Lu=0;Lu<wr.length;Lu++){var Ru=wr[Lu];jr(Ru.toLowerCase(),"on"+(Ru[0].toUpperCase()+Ru.slice(1)))}jr(fr,"onAnimationEnd"),jr(pr,"onAnimationIteration"),jr(mr,"onAnimationStart"),jr("dblclick","onDoubleClick"),jr("focusin","onFocus"),jr("focusout","onBlur"),jr(gr,"onTransitionRun"),jr(vr,"onTransitionStart"),jr(br,"onTransitionCancel"),jr(xr,"onTransitionEnd"),Ke("onMouseEnter",["mouseout","mouseover"]),Ke("onMouseLeave",["mouseout","mouseover"]),Ke("onPointerEnter",["pointerout","pointerover"]),Ke("onPointerLeave",["pointerout","pointerover"]),$e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$e("onBeforeInput",["compositionend","keypress","textInput","paste"]),$e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Iu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Du));function Ou(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(u){vo(u)}a.currentTarget=null,s=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(u){vo(u)}a.currentTarget=null,s=l}}}}function Fu(e,t){var n=t[Ie];void 0===n&&(n=t[Ie]=new Set);var r=e+"__bubble";n.has(r)||(Uu(t,e,2,!1),n.add(r))}function Mu(e,t,n){var r=0;t&&(r|=4),Uu(n,e,r,t)}var Bu="_reactListening"+Math.random().toString(36).slice(2);function zu(e){if(!e[Bu]){e[Bu]=!0,Ge.forEach((function(t){"selectionchange"!==t&&(Iu.has(t)||Mu(t,!1,e),Mu(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bu]||(t[Bu]=!0,Mu("selectionchange",!1,t))}}function Uu(e,t,n,r){switch(ch(t)){case 2:var a=rh;break;case 8:a=ah;break;default:a=sh}n=a.bind(null,t,n,e),a=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function qu(e,t,n,r,a){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===a)break;if(4===i)for(i=r.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===a)return;i=i.return}for(;null!==o;){if(null===(i=Ue(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){r=s=i;continue e}o=o.parentNode}}r=r.return}Ot((function(){var r=s,a=_t(n),i=[];e:{var o=yr.get(e);if(void 0!==o){var c=Zt,u=e;switch(e){case"keypress":if(0===Ht(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case fr:case pr:case mr:c=on;break;case xr:c=bn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=xn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=yn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===f||null!=(g=Ft(m,f))&&d.push(Vu(m,g,p)),h)break;m=m.return}0<d.length&&(o=new c(o,u,null,n,a),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Pt||!(u=n.relatedTarget||n.fromElement)||!Ue(u)&&!u[De])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Ue(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=rn,g="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=gn,g="onPointerLeave",f="onPointerEnter",m="pointer"),h=null==c?o:Ve(c),p=null==u?o:Ve(u),(o=new d(g,m+"leave",c,n,a)).target=h,o.relatedTarget=p,g=null,Ue(a)===r&&((d=new d(f,m+"enter",u,n,a)).target=p,d.relatedTarget=h,g=d),h=g,c&&u)e:{for(f=u,m=0,p=d=c;p;p=Hu(p))m++;for(p=0,g=f;g;g=Hu(g))p++;for(;0<m-p;)d=Hu(d),m--;for(;0<p-m;)f=Hu(f),p--;for(;m--;){if(d===f||null!==f&&d===f.alternate)break e;d=Hu(d),f=Hu(f)}d=null}else d=null;null!==c&&Gu(i,o,c,d,!1),null!==u&&null!==h&&Gu(i,h,u,d,!0)}if("select"===(c=(o=r?Ve(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=Mn;else if(Ln(o))if(Bn)v=$n;else{v=Gn;var b=Hn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&kt(r.elementType)&&(v=Mn):v=Yn;switch(v&&(v=v(e,r))?Rn(i,v,n,a):(b&&b(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&bt(o,"number",o.value)),b=r?Ve(r):window,e){case"focusin":(Ln(b)||"true"===b.contentEditable)&&(rr=b,ar=r,sr=null);break;case"focusout":sr=ar=rr=null;break;case"mousedown":ir=!0;break;case"contextmenu":case"mouseup":case"dragend":ir=!1,or(i,n,a);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":or(i,n,a)}var x;if(jn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Pn?An(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Cn&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Pn&&(x=Wt()):(qt="value"in(Ut=a)?Ut.value:Ut.textContent,Pn=!0)),0<(b=Wu(r,y)).length&&(y=new cn(y,e,null,n,a),i.push({event:y,listeners:b}),x?y.data=x:null!==(x=Tn(n))&&(y.data=x))),(x=Sn?function(e,t){switch(e){case"compositionend":return Tn(t);case"keypress":return 32!==t.which?null:(En=!0,kn);case"textInput":return(e=t.data)===kn&&En?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!jn&&An(e,t)?(e=Wt(),Vt=qt=Ut=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(y=Wu(r,"onBeforeInput")).length&&(b=new cn("onBeforeInput","beforeinput",null,n,a),i.push({event:b,listeners:y}),b.data=x)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var s=Pu((a[Re]||null).action),i=r.submitter;i&&null!==(t=(t=i[Re]||null)?Pu(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new Zt("action","action",null,r,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==wu){var e=i?_u(a,i):new FormData(a);Pi(n,{pending:!0,data:e,method:a.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?_u(a,i):new FormData(a),Pi(n,{pending:!0,data:e,method:a.method,action:s},s,e))},currentTarget:a}]})}}(i,e,r,n,a)}Ou(i,t)}))}function Vu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===s||(null!=(a=Ft(e,n))&&r.unshift(Vu(e,a,s)),null!=(a=Ft(e,t))&&r.push(Vu(e,a,s))),3===e.tag)return r;e=e.return}return[]}function Hu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Gu(e,t,n,r,a){for(var s=t._reactName,i=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Ft(n,s))&&i.unshift(Vu(n,c,l)):a||null!=(c=Ft(n,s))&&i.push(Vu(n,c,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Yu=/\r\n?/g,$u=/\u0000|\uFFFD/g;function Ku(e){return("string"===typeof e?e:""+e).replace(Yu,"\n").replace($u,"")}function Ju(e,t){return t=Ku(t),Ku(e)===t}function Xu(){}function Qu(e,t,n,r,a,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||jt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&jt(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":Ct(e,r,s);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Tt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Qu(e,t,"name",a.name,a,null),Qu(e,t,"formEncType",a.formEncType,a,null),Qu(e,t,"formMethod",a.formMethod,a,null),Qu(e,t,"formTarget",a.formTarget,a,null)):(Qu(e,t,"encType",a.encType,a,null),Qu(e,t,"method",a.method,a,null),Qu(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Tt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Xu);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Tt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Fu("beforetoggle",e),Fu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Et.get(n)||n,r)}}function Zu(e,t,n,r,a,s){switch(n){case"style":Ct(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=n}}break;case"children":"string"===typeof r?jt(e,r):("number"===typeof r||"bigint"===typeof r)&&jt(e,""+r);break;case"onScroll":null!=r&&Fu("scroll",e);break;case"onScrollEnd":null!=r&&Fu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Xu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ye.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(s=null!=(s=e[Re]||null)?s[n]:null)&&e.removeEventListener(t,s,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fu("error",e),Fu("load",e);var r,a=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":a=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Qu(e,t,r,o,n,null)}}return s&&Qu(e,t,"srcSet",n.srcSet,n,null),void(a&&Qu(e,t,"src",n.src,n,null));case"input":Fu("invalid",e);var l=r=o=s=null,c=null,u=null;for(a in n)if(n.hasOwnProperty(a)){var d=n[a];if(null!=d)switch(a){case"name":s=d;break;case"type":o=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(i(137,t));break;default:Qu(e,t,a,d,n,null)}}return vt(e,r,l,c,u,o,s,!1),void dt(e);case"select":for(s in Fu("invalid",e),a=o=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:Qu(e,t,s,l,n,null)}return t=r,n=o,e.multiple=!!a,void(null!=t?xt(e,!!a,t,!1):null!=n&&xt(e,!!a,n,!0));case"textarea":for(o in Fu("invalid",e),r=s=a=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":a=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:Qu(e,t,o,l,n,null)}return wt(e,a,s,r),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else Qu(e,t,c,a,n,null);return;case"dialog":Fu("beforetoggle",e),Fu("toggle",e),Fu("cancel",e),Fu("close",e);break;case"iframe":case"object":Fu("load",e);break;case"video":case"audio":for(a=0;a<Du.length;a++)Fu(Du[a],e);break;case"image":Fu("error",e),Fu("load",e);break;case"details":Fu("toggle",e);break;case"embed":case"source":case"link":Fu("error",e),Fu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(a=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Qu(e,t,u,a,n,null)}return;default:if(kt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(a=n[d])&&Zu(e,t,d,a,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(a=n[l])&&Qu(e,t,l,a,n,null))}var td=null,nd=null;function rd(e){return 9===e.nodeType?e:e.ownerDocument}function ad(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function id(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var od=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout((function(){throw e}))}function fd(e){return"head"===e}function pd(e,t){var n=t,r=0,a=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0<r&&8>r){n=r;var i=e.ownerDocument;if(1&n&&wd(i.documentElement),2&n&&wd(i.body),4&n)for(wd(n=i.head),i=n.firstChild;i;){var o=i.nextSibling,l=i.nodeName;i[Be]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=o}}if(0===a)return e.removeChild(s),void Eh(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:r=n.charCodeAt(0)-48;else r=0;n=s}while(n);Eh(t)}function md(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":md(n),ze(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gd(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bd=null;function xd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function yd(e,t,n){switch(t=rd(n),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function wd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);ze(e)}var jd=new Map,Nd=new Set;function Sd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Cd=I.d;I.d={f:function(){var e=Cd.f(),t=Uc();return e||t},r:function(e){var t=qe(e);null!==t&&5===t.tag&&"form"===t.type?Li(t):Cd.r(e)},D:function(e){Cd.D(e),Ed("dns-prefetch",e,null)},C:function(e,t){Cd.C(e,t),Ed("preconnect",e,t)},L:function(e,t,n){Cd.L(e,t,n);var r=kd;if(r&&e&&t){var a='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+mt(n.imageSizes)+'"]')):a+='[href="'+mt(e)+'"]';var s=a;switch(t){case"style":s=Td(e);break;case"script":s=Ld(e)}jd.has(s)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),jd.set(s,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Pd(s))||"script"===t&&r.querySelector(Rd(s))||(ed(t=r.createElement("link"),"link",e),He(t),r.head.appendChild(t)))}},m:function(e,t){Cd.m(e,t);var n=kd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',s=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Ld(e)}if(!jd.has(s)&&(e=h({rel:"modulepreload",href:e},t),jd.set(s,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Rd(s)))return}ed(r=n.createElement("link"),"link",e),He(r),n.head.appendChild(r)}}},X:function(e,t){Cd.X(e,t);var n=kd;if(n&&e){var r=We(n).hoistableScripts,a=Ld(e),s=r.get(a);s||((s=n.querySelector(Rd(a)))||(e=h({src:e,async:!0},t),(t=jd.get(a))&&Fd(e,t),He(s=n.createElement("script")),ed(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(a,s))}},S:function(e,t,n){Cd.S(e,t,n);var r=kd;if(r&&e){var a=We(r).hoistableStyles,s=Td(e);t=t||"default";var i=a.get(s);if(!i){var o={loading:0,preload:null};if(i=r.querySelector(Pd(s)))o.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=jd.get(s))&&Od(e,n);var l=i=r.createElement("link");He(l),ed(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){o.loading|=1})),l.addEventListener("error",(function(){o.loading|=2})),o.loading|=4,Id(i,t,r)}i={type:"stylesheet",instance:i,count:1,state:o},a.set(s,i)}}},M:function(e,t){Cd.M(e,t);var n=kd;if(n&&e){var r=We(n).hoistableScripts,a=Ld(e),s=r.get(a);s||((s=n.querySelector(Rd(a)))||(e=h({src:e,async:!0,type:"module"},t),(t=jd.get(a))&&Fd(e,t),He(s=n.createElement("script")),ed(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(a,s))}}};var kd="undefined"===typeof document?null:document;function Ed(e,t,n){var r=kd;if(r&&"string"===typeof t&&t){var a=mt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),Nd.has(a)||(Nd.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(ed(t=r.createElement("link"),"link",e),He(t),r.head.appendChild(t)))}}function Ad(e,t,n,r){var a,s,o,l,c=(c=W.current)?Sd(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Td(n.href),(r=(n=We(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Td(n.href);var u=We(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Pd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),jd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},jd.set(e,n),u||(a=c,s=e,o=n,l=d.state,a.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=a.createElement("link"),l.preload=s,s.addEventListener("load",(function(){return l.loading|=1})),s.addEventListener("error",(function(){return l.loading|=2})),ed(s,"link",o),He(s),a.head.appendChild(s))))),t&&null===r)throw Error(i(528,""));return d}if(t&&null!==r)throw Error(i(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Ld(n),(r=(n=We(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Td(e){return'href="'+mt(e)+'"'}function Pd(e){return'link[rel="stylesheet"]['+e+"]"}function _d(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Ld(e){return'[src="'+mt(e)+'"]'}function Rd(e){return"script[async]"+e}function Dd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,He(r),r;var a=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return He(r=(e.ownerDocument||e).createElement("style")),ed(r,"style",a),Id(r,n.precedence,e),t.instance=r;case"stylesheet":a=Td(n.href);var s=e.querySelector(Pd(a));if(s)return t.state.loading|=4,t.instance=s,He(s),s;r=_d(n),(a=jd.get(a))&&Od(r,a),He(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),ed(s,"link",r),t.state.loading|=4,Id(s,n.precedence,e),t.instance=s;case"script":return s=Ld(n.src),(a=e.querySelector(Rd(s)))?(t.instance=a,He(a),a):(r=n,(a=jd.get(s))&&Fd(r=h({},n),a),He(a=(e=e.ownerDocument||e).createElement("script")),ed(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Id(r,n.precedence,e));return t.instance}function Id(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,s=a,i=0;i<r.length;i++){var o=r[i];if(o.dataset.precedence===t)s=o;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Od(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Md=null;function Bd(e,t,n){if(null===Md){var r=new Map,a=Md=new Map;a.set(n,r)}else(r=(a=Md).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var s=n[a];if(!(s[Be]||s[Le]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=r.get(i);o?o.push(s):r.set(i,[s])}}return r}function zd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Ud(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var qd=null;function Vd(){}function Wd(){if(this.count--,0===this.count)if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Hd=null;function Gd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Hd=new Map,t.forEach(Yd,e),Hd=null,Wd.call(e))}function Yd(e,t){if(!(4&t.state.loading)){var n=Hd.get(e);if(n)var r=n.get(null);else{n=new Map,Hd.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var i=a[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),r=i)}r&&n.set(null,r)}i=(a=t.instance).getAttribute("data-precedence"),(s=n.get(i)||r)===r&&n.set(null,a),n.set(i,a),this.count++,r=Wd.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),s?s.parentNode.insertBefore(a,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var $d={$$typeof:w,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function Kd(e,t,n,r,a,s,i,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Se(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Se(0),this.hiddenUpdates=Se(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Jd(e,t,n,r,a,s,i,o,l,c,u,d){return e=new Kd(e,t,n,i,o,l,c,d),t=1,!0===s&&(t|=24),s=Or(3,null,null,t),e.current=s,s.stateNode=e,(t=Ra()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},ns(s),e}function Xd(e){return e?e=Dr:Dr}function Qd(e,t,n,r,a,s){a=Xd(a),null===r.context?r.context=a:r.pendingContext=a,(r=as(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=ss(e,r,t))&&(Oc(n,0,t),is(n,e,t))}function Zd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Zd(e,t),(e=e.alternate)&&Zd(e,t)}function th(e){if(13===e.tag){var t=_r(e,67108864);null!==t&&Oc(t,0,67108864),eh(e,67108864)}}var nh=!0;function rh(e,t,n,r){var a=D.T;D.T=null;var s=I.p;try{I.p=2,sh(e,t,n,r)}finally{I.p=s,D.T=a}}function ah(e,t,n,r){var a=D.T;D.T=null;var s=I.p;try{I.p=8,sh(e,t,n,r)}finally{I.p=s,D.T=a}}function sh(e,t,n,r){if(nh){var a=ih(r);if(null===a)qu(e,t,r,oh,n),bh(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return dh=xh(dh,e,t,n,r,a),!0;case"dragenter":return hh=xh(hh,e,t,n,r,a),!0;case"mouseover":return fh=xh(fh,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return ph.set(s,xh(ph.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,mh.set(s,xh(mh.get(s)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(bh(e,r),4&t&&-1<vh.indexOf(e)){for(;null!==a;){var s=qe(a);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=be(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-fe(i);o.entanglements[1]|=l,i&=~l}ju(s),0===(6&nc)&&(jc=te()+500,Nu(0,!1))}}break;case 13:null!==(o=_r(s,2))&&Oc(o,0,2),Uc(),eh(s,2)}if(null===(s=ih(r))&&qu(e,t,r,oh,n),s===a)break;a=s}null!==a&&r.stopPropagation()}else qu(e,t,r,null,n)}}function ih(e){return lh(e=_t(e))}var oh=null;function lh(e){if(oh=null,null!==(e=Ue(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return oh=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ae:return 8;case se:case ie:return 32;case oe:return 268435456;default:return 32}default:return 32}}var uh=!1,dh=null,hh=null,fh=null,ph=new Map,mh=new Map,gh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bh(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":fh=null;break;case"pointerover":case"pointerout":ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(t.pointerId)}}function xh(e,t,n,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=qe(t))&&th(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function yh(e){var t=Ue(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=I.p;try{return I.p=e,t()}finally{I.p=n}}(e.priority,(function(){if(13===n.tag){var e=Dc();e=Ae(e);var t=_r(n,e);null!==t&&Oc(t,0,e),eh(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function wh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=ih(e.nativeEvent);if(null!==n)return null!==(t=qe(n))&&th(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Pt=r,n.target.dispatchEvent(r),Pt=null,t.shift()}return!0}function jh(e,t,n){wh(e)&&n.delete(t)}function Nh(){uh=!1,null!==dh&&wh(dh)&&(dh=null),null!==hh&&wh(hh)&&(hh=null),null!==fh&&wh(fh)&&(fh=null),ph.forEach(jh),mh.forEach(jh)}function Sh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Nh)))}var Ch=null;function kh(e){Ch!==e&&(Ch=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){Ch===e&&(Ch=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===lh(r||n))continue;break}var s=qe(n);null!==s&&(e.splice(t,3),t-=3,Pi(s,{pending:!0,data:a,method:n.method,action:r},r,a))}})))}function Eh(e){function t(t){return Sh(t,e)}null!==dh&&Sh(dh,e),null!==hh&&Sh(hh,e),null!==fh&&Sh(fh,e),ph.forEach(t),mh.forEach(t);for(var n=0;n<gh.length;n++){var r=gh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<gh.length&&null===(n=gh[0]).blockedOn;)yh(n),null===n.blockedOn&&gh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],s=n[r+1],i=a[Re]||null;if("function"===typeof s)i||kh(n);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(a=s,i=s[Re]||null)o=i.formAction;else if(null!==lh(a))continue}else o=i.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),kh(n)}}}function Ah(e){this._internalRoot=e}function Th(e){this._internalRoot=e}Th.prototype.render=Ah.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Qd(t.current,Dc(),e,t,null,null)},Th.prototype.unmount=Ah.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Qd(e.current,2,null,e,null,null),Uc(),t[De]=null}},Th.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gh.length&&0!==t&&t<gh[n].priority;n++);gh.splice(n,0,e),0===n&&yh(e)}};var Ph=a.version;if("19.1.0"!==Ph)throw Error(i(527,Ph,"19.1.0"));I.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return u(a),e;if(s===r)return u(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var _h={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Lh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lh.isDisabled&&Lh.supportsFiber)try{ue=Lh.inject(_h),de=Lh}catch(Qm){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var n=!1,r="",a=bo,s=xo,l=yo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Jd(e,1,!1,null,0,n,r,a,s,l,0,null),e[De]=t.current,zu(e),new Ah(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(i(299));var r=!1,a="",s=bo,l=xo,c=yo,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Jd(e,1,!0,t,0,r,a,s,l,c,0,u)).context=Xd(null),n=t.current,(a=as(r=Ae(r=Dc()))).callback=null,ss(n,a,r),n=r,t.current.lanes=n,Ce(t,n),ju(t),e[De]=t.current,zu(e),new Th(t)},t.version="19.1.0"},7950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(Qm){console.error(Qm)}}(),e.exports=n(6672)},8853:(e,t,n)=>{e.exports=n(5896)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(s,i),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{239:"dfdb0d71",453:"d855a71b",455:"b06868b9",977:"2caed02d"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="frontend:";n.l=(r,a,s,i)=>{if(e[r])e[r].push(a);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[a];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var s=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=s);var i=n.p+n.u(t),o=new Error;n.l(i,(r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,a[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,s,i=r[0],o=r[1],l=r[2],c=0;if(i.some((t=>0!==e[t]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)l(n)}for(t&&t(r);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkfrontend=self.webpackChunkfrontend||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r={};n.r(r),n.d(r,{hasBrowserEnv:()=>An,hasStandardBrowserEnv:()=>Pn,hasStandardBrowserWebWorkerEnv:()=>_n,navigator:()=>Tn,origin:()=>Ln});var a={};n.r(a),n.d(a,{Decoder:()=>am,Encoder:()=>nm,PacketType:()=>tm,protocol:()=>em});var s=n(5043),i=n(4391);function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=n(4980);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,l.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(3175);const d=["sri"],h=["page"],f=["page","matches"],p=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],g=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function b(){return C((function(e,t){let{pathname:n,search:r,hash:a}=e.location;return j("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:N(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function x(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function y(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function w(e,t){return{usr:e.state,key:e.key,idx:t}}function j(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return u(u({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?S(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function N(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function S(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function C(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:s=!1}=r,i=a.history,o="POP",l=null,c=d();function d(){return(i.state||{idx:null}).idx}function h(){o="POP";let e=d(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function f(e){return k(e)}null==c&&(c=0,i.replaceState(u(u({},i.state),{},{idx:c}),""));let p={get action(){return o},get location(){return e(a,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(v,h),l=e,()=>{a.removeEventListener(v,h),l=null}},createHref:e=>t(a,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let r=j(p.location,e,t);n&&n(r,e),c=d()+1;let u=w(r,c),h=p.createHref(r);try{i.pushState(u,"",h)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;a.location.assign(h)}s&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o="REPLACE";let r=j(p.location,e,t);n&&n(r,e),c=d();let a=w(r,c),u=p.createHref(r);i.replaceState(a,"",u),s&&l&&l({action:o,location:p.location,delta:0})},go:e=>i.go(e)};return p}function k(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),x(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:N(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function E(e,t){return A(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function A(e,t,n,r){let a=V(("string"===typeof t?S(t):t).pathname||"/",n);if(null==a)return null;let s=T(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=q(a);i=B(s[o],e,r)}return i}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=(e,a,s)=>{let i={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(x(i.relativePath.startsWith(r),'Absolute route path "'.concat(i.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),i.relativePath=i.relativePath.slice(r.length));let o=K([r,i.relativePath]),l=n.concat(i);e.children&&e.children.length>0&&(x(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(o,'".')),T(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:M(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of P(e.path))a(e,t,r);else a(e,t)})),t}function P(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return a?[s,""]:[s];let i=P(r.join("/")),o=[];return o.push(...i.map((e=>""===e?s:[s,e].join("/")))),a&&o.push(...i),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var _=/^:[\w-]+$/,L=3,R=2,D=1,I=10,O=-2,F=e=>"*"===e;function M(e,t){let n=e.split("/"),r=n.length;return n.some(F)&&(r+=O),t&&(r+=R),n.filter((e=>!F(e))).reduce(((e,t)=>e+(_.test(t)?L:""===t?D:I)),r)}function B(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,a={},s="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),i.push({params:a,pathname:K([s,u.pathname]),pathnameBase:J(K([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=K([s,u.pathnameBase]))}return i}function z(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=U(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:s,pathnameBase:i,pattern:e}}function U(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];y("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function q(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return y(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function W(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function H(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function G(e){let t=H(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function Y(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=S(e):(r=u({},e),x(!r.pathname||!r.pathname.includes("?"),W("?","pathname","search",r)),x(!r.pathname||!r.pathname.includes("#"),W("#","pathname","hash",r)),x(!r.search||!r.search.includes("#"),W("#","search","hash",r)));let s,i=""===e||""===r.pathname,o=i?"/":r.pathname;if(null==o)s=n;else{let e=t.length-1;if(!a&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:a=""}="string"===typeof e?S(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:X(r),hash:Q(a)}}(r,s),c=o&&"/"!==o&&o.endsWith("/"),d=(i||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}var K=e=>e.join("/").replace(/\/\/+/g,"/"),J=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),X=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var ee=["POST","PUT","PATCH","DELETE"],te=(new Set(ee),["GET",...ee]);new Set(te),Symbol("ResetLoaderData");var ne=s.createContext(null);ne.displayName="DataRouter";var re=s.createContext(null);re.displayName="DataRouterState";var ae=s.createContext({isTransitioning:!1});ae.displayName="ViewTransition";var se=s.createContext(new Map);se.displayName="Fetchers";var ie=s.createContext(null);ie.displayName="Await";var oe=s.createContext(null);oe.displayName="Navigation";var le=s.createContext(null);le.displayName="Location";var ce=s.createContext({outlet:null,matches:[],isDataRoute:!1});ce.displayName="Route";var ue=s.createContext(null);ue.displayName="RouteError";function de(){return null!=s.useContext(le)}function he(){return x(de(),"useLocation() may be used only in the context of a <Router> component."),s.useContext(le).location}var fe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pe(e){s.useContext(oe).static||s.useLayoutEffect(e)}function me(){let{isDataRoute:e}=s.useContext(ce);return e?function(){let{router:e}=Ce("useNavigate"),t=Ee("useNavigate"),n=s.useRef(!1);pe((()=>{n.current=!0}));let r=s.useCallback((async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(n.current,fe),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,u({fromRouteId:t},a)))}),[e,t]);return r}():function(){x(de(),"useNavigate() may be used only in the context of a <Router> component.");let e=s.useContext(ne),{basename:t,navigator:n}=s.useContext(oe),{matches:r}=s.useContext(ce),{pathname:a}=he(),i=JSON.stringify(G(r)),o=s.useRef(!1);pe((()=>{o.current=!0}));let l=s.useCallback((function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(y(o.current,fe),!o.current)return;if("number"===typeof r)return void n.go(r);let l=Y(r,JSON.parse(i),a,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:K([t,l.pathname])),(s.replace?n.replace:n.push)(l,s.state,s)}),[t,n,i,a,e]);return l}()}s.createContext(null);function ge(){let{matches:e}=s.useContext(ce),t=e[e.length-1];return t?t.params:{}}function ve(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=s.useContext(ce),{pathname:r}=he(),a=JSON.stringify(G(n));return s.useMemo((()=>Y(e,JSON.parse(a),r,"path"===t)),[e,a,r,t])}function be(e,t,n,r){x(de(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=s.useContext(oe),{matches:o}=s.useContext(ce),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",f=l&&l.route;{let e=f&&f.path||"";Pe(d,!f||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let p,m=he();if(t){var g;let e="string"===typeof t?S(t):t;x("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),p=e}else p=m;let v=p.pathname||"/",b=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=!i&&n&&n.matches&&n.matches.length>0?n.matches:E(e,{pathname:b});y(f||null!=w,'No routes matched location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" ')),y(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,'Matched leaf route at location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let j=Ne(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:K([h,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:K([h,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,n,r);return t&&j?s.createElement(le.Provider,{value:{location:u({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},j):j}function xe(){let e=Ae(),t=Z(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=s.createElement(s.Fragment,null,s.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),s.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",s.createElement("code",{style:i},"ErrorBoundary")," or"," ",s.createElement("code",{style:i},"errorElement")," prop on your route.")),s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),n?s.createElement("pre",{style:a},n):null,o)}var ye=s.createElement(xe,null),we=class extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(ce.Provider,{value:this.props.routeContext},s.createElement(ue.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function je(e){let{routeContext:t,match:n,children:r}=e,a=s.useContext(ne);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),s.createElement(ce.Provider,{value:t},r)}function Ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let r=e,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let e=r.findIndex((e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id])));x(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),r=r.slice(0,Math.min(r.length,e+1))}let i=!1,o=-1;if(n)for(let s=0;s<r.length;s++){let e=r[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=s),e.route.id){let{loaderData:t,errors:a}=n,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||s){i=!0,r=o>=0?r.slice(0,o+1):[r[0]];break}}}return r.reduceRight(((e,l,c)=>{let u,d=!1,h=null,f=null;n&&(u=a&&l.route.id?a[l.route.id]:void 0,h=l.route.errorElement||ye,i&&(o<0&&0===c?(Pe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):o===c&&(d=!0,f=l.route.hydrateFallbackElement||null)));let p=t.concat(r.slice(0,c+1)),m=()=>{let t;return t=u?h:d?f:l.route.Component?s.createElement(l.route.Component,null):l.route.element?l.route.element:e,s.createElement(je,{match:l,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?s.createElement(we,{location:n.location,revalidation:n.revalidation,component:h,error:u,children:m(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):m()}),null)}function Se(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ce(e){let t=s.useContext(ne);return x(t,Se(e)),t}function ke(e){let t=s.useContext(re);return x(t,Se(e)),t}function Ee(e){let t=function(e){let t=s.useContext(ce);return x(t,Se(e)),t}(e),n=t.matches[t.matches.length-1];return x(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Ae(){var e;let t=s.useContext(ue),n=ke("useRouteError"),r=Ee("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var Te={};function Pe(e,t,n){t||Te[e]||(Te[e]=!0,y(!1,n))}s.memo((function(e){let{routes:t,future:n,state:r}=e;return be(t,void 0,r,n)}));function _e(e){let{to:t,replace:n,state:r,relative:a}=e;x(de(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=s.useContext(oe);y(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=s.useContext(ce),{pathname:l}=he(),c=me(),u=Y(t,G(o),l,"path"===a),d=JSON.stringify(u);return s.useEffect((()=>{c(JSON.parse(d),{replace:n,state:r,relative:a})}),[c,d,a,n,r]),null}function Le(e){x(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Re(e){let{basename:t="/",children:n=null,location:r,navigationType:a="POP",navigator:i,static:o=!1}=e;x(!de(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=s.useMemo((()=>({basename:l,navigator:i,static:o,future:{}})),[l,i,o]);"string"===typeof r&&(r=S(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=r,m=s.useMemo((()=>{let e=V(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:f,key:p},navigationType:a}}),[l,u,d,h,f,p,a]);return y(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:s.createElement(oe.Provider,{value:c},s.createElement(le.Provider,{children:n,value:m}))}function De(e){let{children:t,location:n}=e;return be(Ie(t),n)}s.Component;function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return s.Children.forEach(e,((e,r)=>{if(!s.isValidElement(e))return;let a=[...t,r];if(e.type===s.Fragment)return void n.push.apply(n,Ie(e.props.children,a));x(e.type===Le,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),x(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Ie(e.props.children,a)),n.push(i)})),n}var Oe="get",Fe="application/x-www-form-urlencoded";function Me(e){return null!=e&&"string"===typeof e.tagName}var Be=null;var ze=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ue(e){return null==e||ze.has(e)?e:(y(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Fe,'"')),null)}function qe(e,t){let n,r,a,s,i;if(Me(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");r=i?V(i,t):null,n=e.getAttribute("method")||Oe,a=Ue(e.getAttribute("enctype"))||Fe,s=new FormData(e)}else if(function(e){return Me(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Me(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(r=o?V(o,t):null,n=e.getAttribute("formmethod")||i.getAttribute("method")||Oe,a=Ue(e.getAttribute("formenctype"))||Ue(i.getAttribute("enctype"))||Fe,s=new FormData(i,e),!function(){if(null===Be)try{new FormData(document.createElement("form"),0),Be=!1}catch(e){Be=!0}return Be}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,r)}}else{if(Me(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Oe,r=null,a=Fe,i=e}var o;return s&&"text/plain"===a&&(i=s,s=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:s,body:i}}function Ve(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function We(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function He(e){return null!=e&&"string"===typeof e.page}function Ge(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ye(e,t,n,r,a,s){let i=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter(((e,t)=>i(e,t)||o(e,t))):"data"===s?t.filter(((t,s)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0})):[]}function $e(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a})).flat(1),[...new Set(r)];var r}function Ke(e,t){let n=new Set,r=new Set(t);return e.reduce(((e,a)=>{if(t&&!He(a)&&"script"===a.as&&a.href&&r.has(a.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(s)||(n.add(s),e.push({key:s,link:a})),e}),[])}function Je(e){return{__html:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;Symbol("SingleFetchRedirect");var Xe=new Set([100,101,204,205]);function Qe(e,t){let n="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.data":t&&"/"===V(n.pathname,t)?n.pathname="".concat(t.replace(/\/$/,""),"/_root.data"):n.pathname="".concat(n.pathname.replace(/\/$/,""),".data"),n}s.Component;function Ze(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,a=s.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Z(t))return s.createElement(et,{title:"Unhandled Thrown Response!"},s.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),a);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return s.createElement(et,{title:"Application Error!",isOutsideRemixApp:n},s.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),s.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),a)}function et(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:a,children:i}=e,{routeModules:o}=st();return null!==(t=o.root)&&void 0!==t&&t.Layout&&!a?i:s.createElement("html",{lang:"en"},s.createElement("head",null,s.createElement("meta",{charSet:"utf-8"}),s.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),s.createElement("title",null,n)),s.createElement("body",null,s.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},i,r?s.createElement(ht,null):null)))}function tt(e,t){return"lazy"===e.mode&&!0===t}function nt(){let e=s.useContext(ne);return Ve(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function rt(){let e=s.useContext(re);return Ve(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var at=s.createContext(void 0);function st(){let e=s.useContext(at);return Ve(e,"You must render this element inside a <HydratedRouter> element"),e}function it(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ot(e,t,n){if(n&&!dt)return[e[0]];if(t){let n=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,n+1)}return e}function lt(e){let{page:t}=e,n=o(e,h),{router:r}=nt(),a=s.useMemo((()=>E(r.routes,t,r.basename)),[r.routes,t,r.basename]);return a?s.createElement(ut,u({page:t,matches:a},n)):null}function ct(e){let{manifest:t,routeModules:n}=st(),[r,a]=s.useState([]);return s.useEffect((()=>{let r=!1;return async function(e,t,n){return Ke((await Promise.all(e.map((async e=>{let r=t.routes[e.route.id];if(r){let e=await We(r,n);return e.links?e.links():[]}return[]})))).flat(1).filter(Ge).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?u(u({},e),{},{rel:"prefetch",as:"style"}):u(u({},e),{},{rel:"prefetch"}))))}(e,t,n).then((e=>{r||a(e)})),()=>{r=!0}}),[e,t,n]),r}function ut(e){let{page:t,matches:n}=e,r=o(e,f),a=he(),{manifest:i,routeModules:l}=st(),{basename:c}=nt(),{loaderData:d,matches:h}=rt(),p=s.useMemo((()=>Ye(t,n,h,i,a,"data")),[t,n,h,i,a]),m=s.useMemo((()=>Ye(t,n,h,i,a,"assets")),[t,n,h,i,a]),g=s.useMemo((()=>{if(t===a.pathname+a.search+a.hash)return[];let e=new Set,r=!1;if(n.forEach((t=>{var n;let a=i.routes[t.route.id];a&&a.hasLoader&&(!p.some((e=>e.route.id===t.route.id))&&t.route.id in d&&null!==(n=l[t.route.id])&&void 0!==n&&n.shouldRevalidate||a.hasClientLoader?r=!0:e.add(t.route.id))})),0===e.size)return[];let s=Qe(t,c);return r&&e.size>0&&s.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[s.pathname+s.search]}),[c,d,a,i,p,n,t,l]),v=s.useMemo((()=>$e(m,i)),[m,i]),b=ct(m);return s.createElement(s.Fragment,null,g.map((e=>s.createElement("link",u({key:e,rel:"prefetch",as:"fetch",href:e},r)))),v.map((e=>s.createElement("link",u({key:e,rel:"modulepreload",href:e},r)))),b.map((e=>{let{key:t,link:n}=e;return s.createElement("link",u({key:t},n))})))}at.displayName="FrameworkContext";var dt=!1;function ht(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:a,routeDiscovery:i,ssr:l}=st(),{router:c,static:h,staticContext:f}=nt(),{matches:p}=rt(),m=tt(i,l);a&&(a.didRenderScripts=!0);let g=ot(p,null,r);s.useEffect((()=>{dt=!0}),[]);let v=s.useMemo((()=>{var r;let a=f?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",i=h?"".concat(null!==(r=t.hmr)&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(m?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(g.map(((e,n)=>{let r="route".concat(n),a=t.routes[e.route.id];Ve(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:i,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=a,u=[...s?[{module:s,varName:"".concat(r,"_clientAction")}]:[],...i?[{module:i,varName:"".concat(r,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map((e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";'))).join("\n"),"const ".concat(r," = {").concat(u.map((e=>"...".concat(e.varName))).join(","),"};")].join("\n")})).join("\n"),"\n  ").concat(m?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=o(e,d),a=new Set(t.state.matches.map((e=>e.route.id))),s=t.state.location.pathname.split("/").filter(Boolean),i=["/"];for(s.pop();s.length>0;)i.push("/".concat(s.join("/"))),s.pop();i.forEach((e=>{let n=E(t.routes,e,t.basename);n&&n.forEach((e=>a.add(e.route.id)))}));let l=[...a].reduce(((e,t)=>Object.assign(e,{[t]:r.routes[t]})),{});return u(u({},r),{},{routes:l,sri:!!n||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(g.map(((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t))).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return s.createElement(s.Fragment,null,s.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Je(a),type:void 0})),s.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Je(i),type:"module",async:!0})))}),[]),b=dt?[]:(x=t.entry.imports.concat($e(g,t,{includeHydrateFallback:!0})),[...new Set(x)]);var x;let y="object"===typeof t.sri?t.sri:{};return dt?null:s.createElement(s.Fragment,null,"object"===typeof t.sri?s.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:y})}}):null,m?null:s.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:y[t.url],suppressHydrationWarning:!0}),s.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:y[t.entry.module],suppressHydrationWarning:!0}),b.map((t=>s.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:y[t],suppressHydrationWarning:!0}))),v)}function ft(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var pt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{pt&&(window.__reactRouterVersion="7.6.0")}catch(cw){}function mt(e){let{basename:t,children:n,window:r}=e,a=s.useRef();null==a.current&&(a.current=b({window:r,v5Compat:!0}));let i=a.current,[o,l]=s.useState({action:i.action,location:i.location}),c=s.useCallback((e=>{s.startTransition((()=>l(e)))}),[l]);return s.useLayoutEffect((()=>i.listen(c)),[i,c]),s.createElement(Re,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:i})}var gt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vt=s.forwardRef((function(e,t){let n,{onClick:r,discover:a="render",prefetch:i="none",relative:l,reloadDocument:c,replace:d,state:h,target:f,to:m,preventScrollReset:g,viewTransition:v}=e,b=o(e,p),{basename:w}=s.useContext(oe),j="string"===typeof m&&gt.test(m),S=!1;if("string"===typeof m&&j&&(n=m,pt))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=V(t.pathname,w);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:S=!0}catch(cw){y(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let C=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(de(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=s.useContext(oe),{hash:a,pathname:i,search:o}=ve(e,{relative:t}),l=i;return"/"!==n&&(l="/"===i?n:K([n,i])),r.createHref({pathname:l,search:o,hash:a})}(m,{relative:l}),[k,E,A]=function(e,t){let n=s.useContext(at),[r,a]=s.useState(!1),[i,o]=s.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,f=s.useRef(null);s.useEffect((()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{o(e.isIntersecting)}))}),{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}}),[e]),s.useEffect((()=>{if(r){let e=setTimeout((()=>{o(!0)}),100);return()=>{clearTimeout(e)}}}),[r]);let p=()=>{a(!0)},m=()=>{a(!1),o(!1)};return n?"intent"!==e?[i,f,{}]:[i,f,{onFocus:it(l,p),onBlur:it(c,m),onMouseEnter:it(u,p),onMouseLeave:it(d,m),onTouchStart:it(h,p)}]:[!1,f,{}]}(i,b),T=function(e){let{target:t,replace:n,state:r,preventScrollReset:a,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=me(),c=he(),u=ve(e,{relative:i});return s.useCallback((s=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(s,t)){s.preventDefault();let t=void 0!==n?n:N(c)===N(u);l(e,{replace:t,state:r,preventScrollReset:a,relative:i,viewTransition:o})}}),[c,l,u,n,r,t,e,a,i,o])}(m,{replace:d,state:h,target:f,preventScrollReset:g,relative:l,viewTransition:v});let P=s.createElement("a",u(u(u({},b),A),{},{href:n||C,onClick:S||c?r:function(e){r&&r(e),e.defaultPrevented||T(e)},ref:ft(t,E),target:f,"data-discover":j||"render"!==a?void 0:"true"}));return k&&!j?s.createElement(s.Fragment,null,P,s.createElement(lt,{page:C})):P}));vt.displayName="Link",s.forwardRef((function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:i=!1,style:l,to:c,viewTransition:d,children:h}=e,f=o(e,m),p=ve(c,{relative:f.relative}),g=he(),v=s.useContext(re),{navigator:b,basename:y}=s.useContext(oe),w=null!=v&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=s.useContext(ae);x(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=yt("useViewTransitionState"),a=ve(e,{relative:t.relative});if(!n.isTransitioning)return!1;let i=V(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=V(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=z(a.pathname,o)||null!=z(a.pathname,i)}(p)&&!0===d,j=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,N=g.pathname,S=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(N=N.toLowerCase(),S=S?S.toLowerCase():null,j=j.toLowerCase()),S&&y&&(S=V(S,y)||S);const C="/"!==j&&j.endsWith("/")?j.length-1:j.length;let k,E=N===j||!i&&N.startsWith(j)&&"/"===N.charAt(C),A=null!=S&&(S===j||!i&&S.startsWith(j)&&"/"===S.charAt(j.length)),T={isActive:E,isPending:A,isTransitioning:w},P=E?n:void 0;k="function"===typeof a?a(T):[a,E?"active":null,A?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let _="function"===typeof l?l(T):l;return s.createElement(vt,u(u({},f),{},{"aria-current":P,className:k,ref:t,style:_,to:c,viewTransition:d}),"function"===typeof h?h(T):h)})).displayName="NavLink";var bt=s.forwardRef(((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:a,reloadDocument:i,replace:l,state:c,method:d=Oe,action:h,onSubmit:f,relative:p,preventScrollReset:m,viewTransition:v}=e,b=o(e,g),y=Nt(),w=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=s.useContext(oe),r=s.useContext(ce);x(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i=u({},ve(e||".",{relative:t})),o=he();if(null==e){i.search=o.search;let e=new URLSearchParams(i.search),t=e.getAll("index"),n=t.some((e=>""===e));if(n){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();i.search=n?"?".concat(n):""}}e&&"."!==e||!a.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(i.pathname="/"===i.pathname?n:K([n,i.pathname]));return N(i)}(h,{relative:p}),j="get"===d.toLowerCase()?"get":"post",S="string"===typeof h&&gt.test(h);return s.createElement("form",u(u({ref:t,method:j,action:w,onSubmit:i?f:e=>{if(f&&f(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;y(t||e.currentTarget,{fetcherKey:r,method:n,navigate:a,replace:l,state:c,relative:p,preventScrollReset:m,viewTransition:v})}},b),{},{"data-discover":S||"render"!==n?void 0:"true"}))}));function xt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function yt(e){let t=s.useContext(ne);return x(t,xt(e)),t}bt.displayName="Form";var wt=0,jt=()=>"__".concat(String(++wt),"__");function Nt(){let{router:e}=yt("useSubmit"),{basename:t}=s.useContext(oe),n=Ee("useRouteId");return s.useCallback((async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:i,encType:o,formData:l,body:c}=qe(r,t);if(!1===a.navigate){let t=a.fetcherKey||jt();await e.fetch(t,n,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})}),[e,t,n])}function St(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ct}=Object.prototype,{getPrototypeOf:kt}=Object,{iterator:Et,toStringTag:At}=Symbol,Tt=(e=>t=>{const n=Ct.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Pt=e=>(e=e.toLowerCase(),t=>Tt(t)===e),_t=e=>t=>typeof t===e,{isArray:Lt}=Array,Rt=_t("undefined");const Dt=Pt("ArrayBuffer");const It=_t("string"),Ot=_t("function"),Ft=_t("number"),Mt=e=>null!==e&&"object"===typeof e,Bt=e=>{if("object"!==Tt(e))return!1;const t=kt(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(At in e)&&!(Et in e)},zt=Pt("Date"),Ut=Pt("File"),qt=Pt("Blob"),Vt=Pt("FileList"),Wt=Pt("URLSearchParams"),[Ht,Gt,Yt,$t]=["ReadableStream","Request","Response","Headers"].map(Pt);function Kt(e,t){let n,r,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Lt(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=a?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let i;for(n=0;n<s;n++)i=r[n],t.call(null,e[i],i,e)}}function Jt(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,a=n.length;for(;a-- >0;)if(r=n[a],t===r.toLowerCase())return r;return null}const Xt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Qt=e=>!Rt(e)&&e!==Xt;const Zt=(en="undefined"!==typeof Uint8Array&&kt(Uint8Array),e=>en&&e instanceof en);var en;const tn=Pt("HTMLFormElement"),nn=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),rn=Pt("RegExp"),an=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Kt(n,((n,a)=>{let s;!1!==(s=t(n,a,e))&&(r[a]=s||n)})),Object.defineProperties(e,r)};const sn=Pt("AsyncFunction"),on=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),r=[],Xt.addEventListener("message",(e=>{let{source:t,data:a}=e;t===Xt&&a===n&&r.length&&r.shift()()}),!1),e=>{r.push(e),Xt.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,Ot(Xt.postMessage)),ln="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Xt):"undefined"!==typeof process&&process.nextTick||on,cn={isArray:Lt,isArrayBuffer:Dt,isBuffer:function(e){return null!==e&&!Rt(e)&&null!==e.constructor&&!Rt(e.constructor)&&Ot(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||Ot(e.append)&&("formdata"===(t=Tt(e))||"object"===t&&Ot(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Dt(e.buffer),t},isString:It,isNumber:Ft,isBoolean:e=>!0===e||!1===e,isObject:Mt,isPlainObject:Bt,isReadableStream:Ht,isRequest:Gt,isResponse:Yt,isHeaders:$t,isUndefined:Rt,isDate:zt,isFile:Ut,isBlob:qt,isRegExp:rn,isFunction:Ot,isStream:e=>Mt(e)&&Ot(e.pipe),isURLSearchParams:Wt,isTypedArray:Zt,isFileList:Vt,forEach:Kt,merge:function e(){const{caseless:t}=Qt(this)&&this||{},n={},r=(r,a)=>{const s=t&&Jt(n,a)||a;Bt(n[s])&&Bt(r)?n[s]=e(n[s],r):Bt(r)?n[s]=e({},r):Lt(r)?n[s]=r.slice():n[s]=r};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&Kt(arguments[a],r);return n},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Kt(t,((t,r)=>{n&&Ot(t)?e[r]=St(t,n):e[r]=t}),{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let a,s,i;const o={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],r&&!r(i,e,t)||o[i]||(t[i]=e[i],o[i]=!0);e=!1!==n&&kt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Tt,kindOfTest:Pt,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(Lt(e))return e;let t=e.length;if(!Ft(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Et]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:tn,hasOwnProperty:nn,hasOwnProp:nn,reduceDescriptors:an,freezeMethods:e=>{an(e,((t,n)=>{if(Ot(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Ot(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return Lt(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Jt,global:Xt,isContextDefined:Qt,isSpecCompliantForm:function(e){return!!(e&&Ot(e.append)&&"FormData"===e[At]&&e[Et])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Mt(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const a=Lt(e)?[]:{};return Kt(e,((e,t)=>{const s=n(e,r+1);!Rt(s)&&(a[t]=s)})),t[r]=void 0,a}}return e};return n(e,0)},isAsyncFn:sn,isThenable:e=>e&&(Mt(e)||Ot(e))&&Ot(e.then)&&Ot(e.catch),setImmediate:on,asap:ln,isIterable:e=>null!=e&&Ot(e[Et])};function un(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}cn.inherits(un,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:cn.toJSONObject(this.config),code:this.code,status:this.status}}});const dn=un.prototype,hn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{hn[e]={value:e}})),Object.defineProperties(un,hn),Object.defineProperty(dn,"isAxiosError",{value:!0}),un.from=(e,t,n,r,a,s)=>{const i=Object.create(dn);return cn.toFlatObject(e,i,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),un.call(i,e.message,t,n,r,a),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const fn=un;function pn(e){return cn.isPlainObject(e)||cn.isArray(e)}function mn(e){return cn.endsWith(e,"[]")?e.slice(0,-2):e}function gn(e,t,n){return e?e.concat(t).map((function(e,t){return e=mn(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const vn=cn.toFlatObject(cn,{},null,(function(e){return/^is[A-Z]/.test(e)}));const bn=function(e,t,n){if(!cn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=cn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!cn.isUndefined(t[e])}))).metaTokens,a=n.visitor||c,s=n.dots,i=n.indexes,o=(n.Blob||"undefined"!==typeof Blob&&Blob)&&cn.isSpecCompliantForm(t);if(!cn.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(cn.isDate(e))return e.toISOString();if(!o&&cn.isBlob(e))throw new fn("Blob is not supported. Use a Buffer instead.");return cn.isArrayBuffer(e)||cn.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,a){let o=e;if(e&&!a&&"object"===typeof e)if(cn.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(cn.isArray(e)&&function(e){return cn.isArray(e)&&!e.some(pn)}(e)||(cn.isFileList(e)||cn.endsWith(n,"[]"))&&(o=cn.toArray(e)))return n=mn(n),o.forEach((function(e,r){!cn.isUndefined(e)&&null!==e&&t.append(!0===i?gn([n],r,s):null===i?n:n+"[]",l(e))})),!1;return!!pn(e)||(t.append(gn(a,n,s),l(e)),!1)}const u=[],d=Object.assign(vn,{defaultVisitor:c,convertValue:l,isVisitable:pn});if(!cn.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!cn.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),cn.forEach(n,(function(n,s){!0===(!(cn.isUndefined(n)||null===n)&&a.call(t,n,cn.isString(s)?s.trim():s,r,d))&&e(n,r?r.concat(s):[s])})),u.pop()}}(e),t};function xn(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function yn(e,t){this._pairs=[],e&&bn(e,this,t)}const wn=yn.prototype;wn.append=function(e,t){this._pairs.push([e,t])},wn.toString=function(e){const t=e?function(t){return e.call(this,t,xn)}:xn;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const jn=yn;function Nn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Sn(e,t,n){if(!t)return e;const r=n&&n.encode||Nn;cn.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let s;if(s=a?a(t,n):cn.isURLSearchParams(t)?t.toString():new jn(t,n).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const Cn=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){cn.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},kn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},En={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:jn,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},An="undefined"!==typeof window&&"undefined"!==typeof document,Tn="object"===typeof navigator&&navigator||void 0,Pn=An&&(!Tn||["ReactNative","NativeScript","NS"].indexOf(Tn.product)<0),_n="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Ln=An&&window.location.href||"http://localhost",Rn=u(u({},r),En);const Dn=function(e){function t(e,n,r,a){let s=e[a++];if("__proto__"===s)return!0;const i=Number.isFinite(+s),o=a>=e.length;if(s=!s&&cn.isArray(r)?r.length:s,o)return cn.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!i;r[s]&&cn.isObject(r[s])||(r[s]=[]);return t(e,n,r[s],a)&&cn.isArray(r[s])&&(r[s]=function(e){const t={},n=Object.keys(e);let r;const a=n.length;let s;for(r=0;r<a;r++)s=n[r],t[s]=e[s];return t}(r[s])),!i}if(cn.isFormData(e)&&cn.isFunction(e.entries)){const n={};return cn.forEachEntry(e,((e,r)=>{t(function(e){return cn.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const In={transitional:kn,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,a=cn.isObject(e);a&&cn.isHTMLForm(e)&&(e=new FormData(e));if(cn.isFormData(e))return r?JSON.stringify(Dn(e)):e;if(cn.isArrayBuffer(e)||cn.isBuffer(e)||cn.isStream(e)||cn.isFile(e)||cn.isBlob(e)||cn.isReadableStream(e))return e;if(cn.isArrayBufferView(e))return e.buffer;if(cn.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return bn(e,new Rn.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return Rn.isNode&&cn.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=cn.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return bn(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),function(e,t,n){if(cn.isString(e))try{return(t||JSON.parse)(e),cn.trim(e)}catch(cw){if("SyntaxError"!==cw.name)throw cw}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||In.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(cn.isResponse(e)||cn.isReadableStream(e))return e;if(e&&cn.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(cw){if(n){if("SyntaxError"===cw.name)throw fn.from(cw,fn.ERR_BAD_RESPONSE,this,null,this.response);throw cw}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rn.classes.FormData,Blob:Rn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};cn.forEach(["delete","get","head","post","put","patch"],(e=>{In.headers[e]={}}));const On=In,Fn=cn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Mn=Symbol("internals");function Bn(e){return e&&String(e).trim().toLowerCase()}function zn(e){return!1===e||null==e?e:cn.isArray(e)?e.map(zn):String(e)}function Un(e,t,n,r,a){return cn.isFunction(r)?r.call(this,t,n):(a&&(t=n),cn.isString(t)?cn.isString(r)?-1!==t.indexOf(r):cn.isRegExp(r)?r.test(t):void 0:void 0)}class qn{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function a(e,t,n){const a=Bn(t);if(!a)throw new Error("header name must be a non-empty string");const s=cn.findKey(r,a);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||t]=zn(e))}const s=(e,t)=>cn.forEach(e,((e,n)=>a(e,n,t)));if(cn.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(cn.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,r,a;return e&&e.split("\n").forEach((function(e){a=e.indexOf(":"),n=e.substring(0,a).trim().toLowerCase(),r=e.substring(a+1).trim(),!n||t[n]&&Fn[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t);else if(cn.isObject(e)&&cn.isIterable(e)){let n,r,a={};for(const t of e){if(!cn.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[r=t[0]]=(n=a[r])?cn.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(a,t)}else null!=e&&a(t,e,n);return this}get(e,t){if(e=Bn(e)){const n=cn.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(cn.isFunction(t))return t.call(this,e,n);if(cn.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Bn(e)){const n=cn.findKey(this,e);return!(!n||void 0===this[n]||t&&!Un(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function a(e){if(e=Bn(e)){const a=cn.findKey(n,e);!a||t&&!Un(0,n[a],a,t)||(delete n[a],r=!0)}}return cn.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const a=t[n];e&&!Un(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}normalize(e){const t=this,n={};return cn.forEach(this,((r,a)=>{const s=cn.findKey(n,a);if(s)return t[s]=zn(r),void delete t[a];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(a):String(a).trim();i!==a&&delete t[a],t[i]=zn(r),n[i]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return cn.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&cn.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,n]=e;return t+": "+n})).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[Mn]=this[Mn]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Bn(e);t[r]||(!function(e,t){const n=cn.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,a){return this[r].call(this,t,e,n,a)},configurable:!0})}))}(n,e),t[r]=!0)}return cn.isArray(e)?e.forEach(r):r(e),this}}qn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),cn.reduceDescriptors(qn.prototype,((e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}})),cn.freezeMethods(qn);const Vn=qn;function Wn(e,t){const n=this||On,r=t||n,a=Vn.from(r.headers);let s=r.data;return cn.forEach(e,(function(e){s=e.call(n,s,a.normalize(),t?t.status:void 0)})),a.normalize(),s}function Hn(e){return!(!e||!e.__CANCEL__)}function Gn(e,t,n){fn.call(this,null==e?"canceled":e,fn.ERR_CANCELED,t,n),this.name="CanceledError"}cn.inherits(Gn,fn,{__CANCEL__:!0});const Yn=Gn;function $n(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new fn("Request failed with status code "+n.status,[fn.ERR_BAD_REQUEST,fn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Kn=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a,s=0,i=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),c=r[i];a||(a=l),n[s]=o,r[s]=l;let u=i,d=0;for(;u!==s;)d+=n[u++],u%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),l-a<t)return;const h=c&&l-c;return h?Math.round(1e3*d/h):void 0}};const Jn=function(e,t){let n,r,a=0,s=1e3/t;const i=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=s,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-a;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t>=s?i(l,e):(n=l,r||(r=setTimeout((()=>{r=null,i(n)}),s-t)))},()=>n&&i(n)]},Xn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const a=Kn(50,250);return Jn((n=>{const s=n.loaded,i=n.lengthComputable?n.total:void 0,o=s-r,l=a(o);r=s;e({loaded:s,total:i,progress:i?s/i:void 0,bytes:o,rate:l||void 0,estimated:l&&i&&s<=i?(i-s)/l:void 0,event:n,lengthComputable:null!=i,[t?"download":"upload"]:!0})}),n)},Qn=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Zn=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cn.asap((()=>e(...n)))},er=Rn.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Rn.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Rn.origin),Rn.navigator&&/(msie|trident)/i.test(Rn.navigator.userAgent)):()=>!0,tr=Rn.hasStandardBrowserEnv?{write(e,t,n,r,a,s){const i=[e+"="+encodeURIComponent(t)];cn.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),cn.isString(r)&&i.push("path="+r),cn.isString(a)&&i.push("domain="+a),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function nr(e,t,n){let r=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const rr=e=>e instanceof Vn?u({},e):e;function ar(e,t){t=t||{};const n={};function r(e,t,n,r){return cn.isPlainObject(e)&&cn.isPlainObject(t)?cn.merge.call({caseless:r},e,t):cn.isPlainObject(t)?cn.merge({},t):cn.isArray(t)?t.slice():t}function a(e,t,n,a){return cn.isUndefined(t)?cn.isUndefined(e)?void 0:r(void 0,e,0,a):r(e,t,0,a)}function s(e,t){if(!cn.isUndefined(t))return r(void 0,t)}function i(e,t){return cn.isUndefined(t)?cn.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function o(n,a,s){return s in t?r(n,a):s in e?r(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(e,t,n)=>a(rr(e),rr(t),0,!0)};return cn.forEach(Object.keys(Object.assign({},e,t)),(function(r){const s=l[r]||a,i=s(e[r],t[r],r);cn.isUndefined(i)&&s!==o||(n[r]=i)})),n}const sr=e=>{const t=ar({},e);let n,{data:r,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:l}=t;if(t.headers=o=Vn.from(o),t.url=Sn(nr(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),cn.isFormData(r))if(Rn.hasStandardBrowserEnv||Rn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(n=o.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(Rn.hasStandardBrowserEnv&&(a&&cn.isFunction(a)&&(a=a(t)),a||!1!==a&&er(t.url))){const e=s&&i&&tr.read(i);e&&o.set(s,e)}return t},ir="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const r=sr(e);let a=r.data;const s=Vn.from(r.headers).normalize();let i,o,l,c,u,{responseType:d,onUploadProgress:h,onDownloadProgress:f}=r;function p(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(i),r.signal&&r.signal.removeEventListener("abort",i)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=Vn.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());$n((function(e){t(e),p()}),(function(e){n(e),p()}),{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new fn("Request aborted",fn.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new fn("Network Error",fn.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||kn;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new fn(t,a.clarifyTimeoutError?fn.ETIMEDOUT:fn.ECONNABORTED,e,m)),m=null},void 0===a&&s.setContentType(null),"setRequestHeader"in m&&cn.forEach(s.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),cn.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),d&&"json"!==d&&(m.responseType=r.responseType),f&&([l,u]=Xn(f,!0),m.addEventListener("progress",l)),h&&m.upload&&([o,c]=Xn(h),m.upload.addEventListener("progress",o),m.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(i=t=>{m&&(n(!t||t.type?new Yn(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(i),r.signal&&(r.signal.aborted?i():r.signal.addEventListener("abort",i)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);v&&-1===Rn.protocols.indexOf(v)?n(new fn("Unsupported protocol "+v+":",fn.ERR_BAD_REQUEST,e)):m.send(a||null)}))},or=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const a=function(e){if(!n){n=!0,i();const t=e instanceof Error?e:this.reason;r.abort(t instanceof fn?t:new Yn(t instanceof Error?t.message:t))}};let s=t&&setTimeout((()=>{s=null,a(new fn("timeout ".concat(t," of ms exceeded"),fn.ETIMEDOUT))}),t);const i=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)})),e=null)};e.forEach((e=>e.addEventListener("abort",a)));const{signal:o}=r;return o.unsubscribe=()=>cn.asap(i),o}};function lr(e,t){this.v=e,this.k=t}function cr(e){return function(){return new ur(e.apply(this,arguments))}}function ur(e){var t,n;function r(t,n){try{var s=e[t](n),i=s.value,o=i instanceof lr;Promise.resolve(o?i.v:i).then((function(n){if(o){var l="return"===t?"return":"next";if(!i.k||n.done)return r(l,n);n=e[l](n).value}a(s.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise((function(s,i){var o={key:e,arg:a,resolve:s,reject:i,next:null};n?n=n.next=o:(t=n=o,r(e,a))}))},"function"!=typeof e.return&&(this.return=void 0)}function dr(e){return new lr(e,0)}function hr(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise((function(n){n(e[t](r))})),{done:!1,value:new lr(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function fr(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new pr(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function pr(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return pr=function(e){this.s=e,this.n=e.next},pr.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new pr(e)}ur.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},ur.prototype.next=function(e){return this._invoke("next",e)},ur.prototype.throw=function(e){return this._invoke("throw",e)},ur.prototype.return=function(e){return this._invoke("return",e)};const mr=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,a=0;for(;a<n;)r=a+t,yield e.slice(a,r),a=r},gr=function(){var e=cr((function*(e,t){var n,r=!1,a=!1;try{for(var s,i=fr(vr(e));r=!(s=yield dr(i.next())).done;r=!1){const e=s.value;yield*hr(fr(mr(e,t)))}}catch(Qm){a=!0,n=Qm}finally{try{r&&null!=i.return&&(yield dr(i.return()))}finally{if(a)throw n}}}));return function(t,n){return e.apply(this,arguments)}}(),vr=function(){var e=cr((function*(e){if(e[Symbol.asyncIterator])return void(yield*hr(fr(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield dr(t.read());if(e)break;yield n}}finally{yield dr(t.cancel())}}));return function(t){return e.apply(this,arguments)}}(),br=(e,t,n,r)=>{const a=gr(e,t);let s,i=0,o=e=>{s||(s=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await a.next();if(t)return o(),void e.close();let s=r.byteLength;if(n){let e=i+=s;n(e)}e.enqueue(new Uint8Array(r))}catch(Qm){throw o(Qm),Qm}},cancel:e=>(o(e),a.return())},{highWaterMark:2})},xr="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,yr=xr&&"function"===typeof ReadableStream,wr=xr&&("function"===typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),jr=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(cw){return!1}},Nr=yr&&jr((()=>{let e=!1;const t=new Request(Rn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Sr=yr&&jr((()=>cn.isReadableStream(new Response("").body))),Cr={stream:Sr&&(e=>e.body)};var kr;xr&&(kr=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!Cr[e]&&(Cr[e]=cn.isFunction(kr[e])?t=>t[e]():(t,n)=>{throw new fn("Response type '".concat(e,"' is not supported"),fn.ERR_NOT_SUPPORT,n)})})));const Er=async(e,t)=>{const n=cn.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(cn.isBlob(e))return e.size;if(cn.isSpecCompliantForm(e)){const t=new Request(Rn.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return cn.isArrayBufferView(e)||cn.isArrayBuffer(e)?e.byteLength:(cn.isURLSearchParams(e)&&(e+=""),cn.isString(e)?(await wr(e)).byteLength:void 0)})(t):n},Ar=xr&&(async e=>{let{url:t,method:n,data:r,signal:a,cancelToken:s,timeout:i,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:d,withCredentials:h="same-origin",fetchOptions:f}=sr(e);c=c?(c+"").toLowerCase():"text";let p,m=or([a,s&&s.toAbortSignal()],i);const g=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(l&&Nr&&"get"!==n&&"head"!==n&&0!==(v=await Er(d,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(cn.isFormData(r)&&(e=n.headers.get("content-type"))&&d.setContentType(e),n.body){const[e,t]=Qn(v,Xn(Zn(l)));r=br(n.body,65536,e,t)}}cn.isString(h)||(h=h?"include":"omit");const a="credentials"in Request.prototype;p=new Request(t,u(u({},f),{},{signal:m,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:a?h:void 0}));let s=await fetch(p);const i=Sr&&("stream"===c||"response"===c);if(Sr&&(o||i&&g)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=s[t]}));const t=cn.toFiniteNumber(s.headers.get("content-length")),[n,r]=o&&Qn(t,Xn(Zn(o),!0))||[];s=new Response(br(s.body,65536,n,(()=>{r&&r(),g&&g()})),e)}c=c||"text";let b=await Cr[cn.findKey(Cr,c)||"text"](s,e);return!i&&g&&g(),await new Promise(((t,n)=>{$n(t,n,{data:b,headers:Vn.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:p})}))}catch(Qm){if(g&&g(),Qm&&"TypeError"===Qm.name&&/Load failed|fetch/i.test(Qm.message))throw Object.assign(new fn("Network Error",fn.ERR_NETWORK,e,p),{cause:Qm.cause||Qm});throw fn.from(Qm,Qm&&Qm.code,e,p)}}),Tr={http:null,xhr:ir,fetch:Ar};cn.forEach(Tr,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(cw){}Object.defineProperty(e,"adapterName",{value:t})}}));const Pr=e=>"- ".concat(e),_r=e=>cn.isFunction(e)||null===e||!1===e,Lr=e=>{e=cn.isArray(e)?e:[e];const{length:t}=e;let n,r;const a={};for(let s=0;s<t;s++){let t;if(n=e[s],r=n,!_r(n)&&(r=Tr[(t=String(n)).toLowerCase()],void 0===r))throw new fn("Unknown adapter '".concat(t,"'"));if(r)break;a[t||"#"+s]=r}if(!r){const e=Object.entries(a).map((e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=t?e.length>1?"since :\n"+e.map(Pr).join("\n"):" "+Pr(e[0]):"as no adapter specified";throw new fn("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function Rr(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Yn(null,e)}function Dr(e){Rr(e),e.headers=Vn.from(e.headers),e.data=Wn.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Lr(e.adapter||On.adapter)(e).then((function(t){return Rr(e),t.data=Wn.call(e,e.transformResponse,t),t.headers=Vn.from(t.headers),t}),(function(t){return Hn(t)||(Rr(e),t&&t.response&&(t.response.data=Wn.call(e,e.transformResponse,t.response),t.response.headers=Vn.from(t.response.headers))),Promise.reject(t)}))}const Ir="1.9.0",Or={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Or[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Fr={};Or.transitional=function(e,t,n){function r(e,t){return"[Axios v1.9.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,a,s)=>{if(!1===e)throw new fn(r(a," has been removed"+(t?" in "+t:"")),fn.ERR_DEPRECATED);return t&&!Fr[a]&&(Fr[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,s)}},Or.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const Mr={assertOptions:function(e,t,n){if("object"!==typeof e)throw new fn("options must be an object",fn.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const s=r[a],i=t[s];if(i){const t=e[s],n=void 0===t||i(t,s,e);if(!0!==n)throw new fn("option "+s+" must be "+n,fn.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new fn("Unknown option "+s,fn.ERR_BAD_OPTION)}},validators:Or},Br=Mr.validators;class zr{constructor(e){this.defaults=e||{},this.interceptors={request:new Cn,response:new Cn}}async request(e,t){try{return await this._request(e,t)}catch(Qm){if(Qm instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{Qm.stack?n&&!String(Qm.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(Qm.stack+="\n"+n):Qm.stack=n}catch(cw){}}throw Qm}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=ar(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:a}=t;void 0!==n&&Mr.assertOptions(n,{silentJSONParsing:Br.transitional(Br.boolean),forcedJSONParsing:Br.transitional(Br.boolean),clarifyTimeoutError:Br.transitional(Br.boolean)},!1),null!=r&&(cn.isFunction(r)?t.paramsSerializer={serialize:r}:Mr.assertOptions(r,{encode:Br.function,serialize:Br.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Mr.assertOptions(t,{baseUrl:Br.spelling("baseURL"),withXsrfToken:Br.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=a&&cn.merge(a.common,a[t.method]);a&&cn.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete a[e]})),t.headers=Vn.concat(s,a);const i=[];let o=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let u,d=0;if(!o){const e=[Dr.bind(this),void 0];for(e.unshift.apply(e,i),e.push.apply(e,l),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=i.length;let h=t;for(d=0;d<u;){const e=i[d++],t=i[d++];try{h=e(h)}catch(f){t.call(this,f);break}}try{c=Dr.call(this,h)}catch(f){return Promise.reject(f)}for(d=0,u=l.length;d<u;)c=c.then(l[d++],l[d++]);return c}getUri(e){return Sn(nr((e=ar(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}cn.forEach(["delete","get","head","options"],(function(e){zr.prototype[e]=function(t,n){return this.request(ar(n||{},{method:e,url:t,data:(n||{}).data}))}})),cn.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,a){return this.request(ar(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}zr.prototype[e]=t(),zr.prototype[e+"Form"]=t(!0)}));const Ur=zr;class qr{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,a){n.reason||(n.reason=new Yn(e,r,a),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new qr((function(t){e=t}));return{token:t,cancel:e}}}const Vr=qr;const Wr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wr).forEach((e=>{let[t,n]=e;Wr[n]=t}));const Hr=Wr;const Gr=function e(t){const n=new Ur(t),r=St(Ur.prototype.request,n);return cn.extend(r,Ur.prototype,n,{allOwnKeys:!0}),cn.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(ar(t,n))},r}(On);Gr.Axios=Ur,Gr.CanceledError=Yn,Gr.CancelToken=Vr,Gr.isCancel=Hn,Gr.VERSION=Ir,Gr.toFormData=bn,Gr.AxiosError=fn,Gr.Cancel=Gr.CanceledError,Gr.all=function(e){return Promise.all(e)},Gr.spread=function(e){return function(t){return e.apply(null,t)}},Gr.isAxiosError=function(e){return cn.isObject(e)&&!0===e.isAxiosError},Gr.mergeConfig=ar,Gr.AxiosHeaders=Vn,Gr.formToJSON=e=>Dn(cn.isHTMLForm(e)?new FormData(e):e),Gr.getAdapter=Lr,Gr.HttpStatusCode=Hr,Gr.default=Gr;const Yr=Gr;var $r=n(579);const Kr=function(e){let{onLogin:t}=e;const[n,r]=(0,s.useState)(!0),[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,u]=(0,s.useState)(!1),[d,h]=(0,s.useState)("");return(0,$r.jsxs)("div",{className:"auth-container",children:[(0,$r.jsxs)("div",{className:"auth-card",children:[(0,$r.jsx)("div",{className:"auth-logo",children:(0,$r.jsx)("span",{className:"auth-logo-icon",children:"\ud83c\udf41"})}),(0,$r.jsx)("h1",{children:"Gestion d'Immigration et d'\xc9tudes au Canada"}),(0,$r.jsxs)("div",{className:"auth-tabs",children:[(0,$r.jsx)("button",{className:"auth-tab ".concat(n?"active":""),onClick:()=>r(!0),children:"Connexion"}),(0,$r.jsx)("button",{className:"auth-tab ".concat(n?"":"active"),onClick:()=>r(!1),children:"Aide"})]}),n?(0,$r.jsxs)("form",{className:"auth-form",onSubmit:async e=>{e.preventDefault(),u(!0),h("");const n=await t(a,o);u(!1),n||h("Identifiants invalides")},children:[d&&(0,$r.jsx)("div",{className:"auth-error",children:d}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{htmlFor:"email",children:"Email"}),(0,$r.jsx)("input",{type:"email",id:"email",value:a,onChange:e=>i(e.target.value),required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),(0,$r.jsx)("input",{type:"password",id:"password",value:o,onChange:e=>l(e.target.value),required:!0})]}),(0,$r.jsx)("div",{className:"form-group",children:(0,$r.jsx)("button",{type:"submit",className:"auth-button",disabled:c,children:c?"Connexion en cours...":"Se connecter"})}),(0,$r.jsx)("div",{className:"auth-footer",children:(0,$r.jsx)("a",{href:"#forgot-password",children:"Mot de passe oubli\xe9?"})})]}):(0,$r.jsxs)("div",{className:"auth-help",children:[(0,$r.jsx)("p",{children:"Pour obtenir de l'aide concernant votre compte, veuillez contacter l'administrateur syst\xe8me."}),(0,$r.jsx)("p",{children:"Email: admin@immigration-canada.com"}),(0,$r.jsx)("p",{children:"T\xe9l\xe9phone: +1 (123) 456-7890"}),(0,$r.jsx)("p",{children:"Utilisez les identifiants suivants pour tester l'application :"}),(0,$r.jsxs)("ul",{children:[(0,$r.jsx)("li",{children:"Administrateur: admin@example.com / password"}),(0,$r.jsx)("li",{children:"Directeur: directeur@example.com / password"}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Marie T."})," (conseill\xe8re): marie@example.com / password"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Sophie M."})," (conseill\xe8re): sophie@example.com / password"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Julie L."})," (conseill\xe8re): julie@example.com / password"]}),(0,$r.jsx)("li",{children:"Comptable: comptable@example.com / password"}),(0,$r.jsx)("li",{children:"Secr\xe9taire: secretaire@example.com / password"})]})]})]}),(0,$r.jsxs)("div",{className:"auth-profiles",children:[(0,$r.jsx)("h3",{children:"Profils disponibles"}),(0,$r.jsxs)("div",{className:"profile-list",children:[(0,$r.jsxs)("div",{className:"profile-item",children:[(0,$r.jsx)("div",{className:"profile-icon admin",children:"A"}),(0,$r.jsxs)("div",{className:"profile-info",children:[(0,$r.jsx)("h4",{children:"Administrateur"}),(0,$r.jsx)("p",{children:"Acc\xe8s complet au syst\xe8me"})]})]}),(0,$r.jsxs)("div",{className:"profile-item",children:[(0,$r.jsx)("div",{className:"profile-icon director",children:"D"}),(0,$r.jsxs)("div",{className:"profile-info",children:[(0,$r.jsx)("h4",{children:"Directeur"}),(0,$r.jsx)("p",{children:"Gestion et supervision"})]})]}),(0,$r.jsxs)("div",{className:"profile-item",children:[(0,$r.jsx)("div",{className:"profile-icon counselor",children:"C"}),(0,$r.jsxs)("div",{className:"profile-info",children:[(0,$r.jsx)("h4",{children:"Conseill\xe8re"}),(0,$r.jsx)("p",{children:"Gestion des clients"})]})]}),(0,$r.jsxs)("div",{className:"profile-item",children:[(0,$r.jsx)("div",{className:"profile-icon accountant",children:"F"}),(0,$r.jsxs)("div",{className:"profile-info",children:[(0,$r.jsx)("h4",{children:"Comptable"}),(0,$r.jsx)("p",{children:"Gestion financi\xe8re"})]})]}),(0,$r.jsxs)("div",{className:"profile-item",children:[(0,$r.jsx)("div",{className:"profile-icon secretary",children:"S"}),(0,$r.jsxs)("div",{className:"profile-info",children:[(0,$r.jsx)("h4",{children:"Secr\xe9taire"}),(0,$r.jsx)("p",{children:"Gestion des leads et RDV"})]})]})]})]})]})},Jr=e=>{let{isVisible:t,onContinue:n,onLogout:r,warningTime:a=60}=e;const[i,o]=(0,s.useState)(a);return(0,s.useEffect)((()=>{if(!t)return void o(a);const e=setInterval((()=>{o((e=>e<=1?(r(),0):e-1))}),1e3);return()=>clearInterval(e)}),[t,a,r]),t?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("div",{className:"auto-logout-overlay"}),(0,$r.jsxs)("div",{className:"auto-logout-warning",children:[(0,$r.jsx)("h3",{children:"\u23f0 Session sur le point d'expirer"}),(0,$r.jsxs)("p",{children:["Votre session va expirer dans"," ",(0,$r.jsx)("span",{className:"auto-logout-countdown",children:i})," secondes en raison d'inactivit\xe9."]}),(0,$r.jsx)("p",{children:"Souhaitez-vous continuer votre session ?"}),(0,$r.jsx)("div",{className:"countdown-progress",children:(0,$r.jsx)("div",{className:"countdown-progress-bar",style:{width:"".concat(i/a*100,"%")}})}),(0,$r.jsxs)("div",{className:"buttons",children:[(0,$r.jsx)("button",{className:"btn-continue",onClick:n,children:"\u2705 Continuer la session"}),(0,$r.jsx)("button",{className:"btn-logout",onClick:r,children:"\ud83d\udd10 Se d\xe9connecter"})]})]})]}):null};const Xr=function(e){let{items:t}=e;return(0,$r.jsx)("nav",{className:"breadcrumb","aria-label":"fil d'ariane",children:(0,$r.jsx)("ol",{children:t.map(((e,n)=>(0,$r.jsx)("li",{className:n===t.length-1?"active":"",children:n===t.length-1?(0,$r.jsx)("span",{children:e.label}):(0,$r.jsxs)("a",{href:"#",onClick:t=>{t.preventDefault(),e.onClick&&e.onClick()},children:[0===n&&(0,$r.jsx)("i",{className:"fas fa-home"}),0!==n&&e.label]})},n)))})})};const Qr=function(e){let{onClose:t,userRole:n="conseillere"}=e;const[r,a]=(0,s.useState)("process");return(0,$r.jsxs)("div",{className:"lead-process-help",children:[(0,$r.jsxs)("div",{className:"lead-process-help-header",children:[(0,$r.jsx)("h2",{children:"Processus de Gestion des Leads"}),(0,$r.jsxs)("div",{className:"help-tabs",children:[(0,$r.jsx)("button",{className:"process"===r?"active":"",onClick:()=>a("process"),children:"Processus"}),(0,$r.jsx)("button",{className:"permissions"===r?"active":"",onClick:()=>a("permissions"),children:"Permissions"})]}),(0,$r.jsx)("button",{className:"close-btn",onClick:t,children:(0,$r.jsx)("i",{className:"fas fa-times"})})]}),(0,$r.jsx)("div",{className:"lead-process-help-content",children:"process"===r?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("p",{className:"lead-intro",children:"Le processus de gestion des leads suit plusieurs \xe9tapes d\xe9taill\xe9es ci-dessous. Suivez ce guide pour assurer un traitement efficace et coh\xe9rent de tous les leads."}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"1"}),(0,$r.jsx)("h3",{children:"Cr\xe9ation du lead"})]}),(0,$r.jsxs)("div",{className:"step-content",children:[(0,$r.jsx)("p",{children:"Un nouveau lead peut \xeatre cr\xe9\xe9 de trois fa\xe7ons diff\xe9rentes :"}),(0,$r.jsxs)("ul",{children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Via le formulaire du site web"})," (automatique)"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Manuellement"})," par une conseill\xe8re ou la secr\xe9taire (ajout individuel)"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Par import d'un fichier Excel"})," par le directeur (ajout en masse)"]})]})]})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"2"}),(0,$r.jsx)("h3",{children:"Attribution du lead"})]}),(0,$r.jsxs)("div",{className:"step-content",children:[(0,$r.jsx)("p",{children:'Lorsqu\'un nouveau lead est cr\xe9\xe9, il appara\xeet avec le statut "Nouveau".'}),(0,$r.jsxs)("ul",{children:[(0,$r.jsx)("li",{children:"L'administrateur re\xe7oit une notification et peut assigner ce lead \xe0 une conseill\xe8re sp\xe9cifique."}),(0,$r.jsx)("li",{children:"L'administrateur peut assigner les leads individuellement ou par lot (10, 20 leads \xe0 la fois)."}),(0,$r.jsx)("li",{children:"Le directeur peut \xe9galement dispatcher les leads par nombre aux conseill\xe8res et \xe0 la secr\xe9taire."}),(0,$r.jsx)("li",{children:"La conseill\xe8re et la secr\xe9taire re\xe7oivent alors une notification l'informant des nouveaux leads qui leur ont \xe9t\xe9 attribu\xe9s."})]})]})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"3"}),(0,$r.jsx)("h3",{children:"Premier contact"})]}),(0,$r.jsxs)("div",{className:"step-content",children:[(0,$r.jsx)("p",{children:"La conseill\xe8re doit contacter le lead par t\xe9l\xe9phone. Selon le r\xe9sultat de cet appel, elle met \xe0 jour le statut :"}),(0,$r.jsxs)("ul",{children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:'"Contact\xe9"'})," si la personne a r\xe9pondu"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:'"\xc0 recontacter"'})," si elle n'a pas r\xe9pondu ou s'il demande de le rappeler ult\xe9rieurement"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:'"Pas int\xe9ress\xe9"'})," si le lead ne souhaite pas donner suite"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:'"Rendez-vous pris"'})," si le lead souhaite prendre rendez-vous"]})]})]})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"4"}),(0,$r.jsx)("h3",{children:"Prise de rendez-vous"})]}),(0,$r.jsx)("div",{className:"step-content",children:(0,$r.jsx)("p",{children:'Si le lead souhaite prendre rendez-vous, la conseill\xe8re change le statut en "Rendez-vous pris" et cr\xe9e automatiquement un \xe9v\xe9nement dans le calendrier des rendez-vous. Le syst\xe8me enregistre la date, l\'heure et le type de rendez-vous (consultation initiale).'})})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"5"}),(0,$r.jsx)("h3",{children:"Rappel avant rendez-vous"})]}),(0,$r.jsx)("div",{className:"step-content",children:(0,$r.jsx)("p",{children:"La veille du rendez-vous, la conseill\xe8re re\xe7oit une notification lui rappelant d'envoyer un SMS de confirmation au lead avec l'adresse et l'heure du rendez-vous."})})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"6"}),(0,$r.jsx)("h3",{children:"Consultation"})]}),(0,$r.jsxs)("div",{className:"step-content",children:[(0,$r.jsx)("p",{children:"Lorsque le lead se pr\xe9sente pour sa consultation :"}),(0,$r.jsxs)("ul",{children:[(0,$r.jsxs)("li",{children:["La secr\xe9taire ou la conseill\xe8re change le statut en ",(0,$r.jsx)("strong",{children:'"Consultation effectu\xe9e"'})," (affich\xe9 en vert) si le lead est pr\xe9sent."]}),(0,$r.jsxs)("li",{children:["Si le lead ne se pr\xe9sente pas, le statut devient ",(0,$r.jsx)("strong",{children:'"Consultation manqu\xe9e"'})," (affich\xe9 en rouge)."]})]})]})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"7"}),(0,$r.jsx)("h3",{children:"\xc9valuation post-consultation"})]}),(0,$r.jsx)("div",{className:"step-content",children:(0,$r.jsx)("p",{children:'Apr\xe8s la consultation, la conseill\xe8re \xe9value l\'admissibilit\xe9 du lead aux diff\xe9rentes proc\xe9dures d\'immigration et met \xe0 jour son statut en "Qualifi\xe9" ou "Non qualifi\xe9". Elle peut \xe9galement ajouter des notes d\xe9taill\xe9es sur les proc\xe9dures recommand\xe9es.'})})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"8"}),(0,$r.jsx)("h3",{children:"Conversion en client"})]}),(0,$r.jsx)("div",{className:"step-content",children:(0,$r.jsx)("p",{children:'Si le lead d\xe9cide de devenir client en payant la premi\xe8re partie des frais, son statut change en "Client" et il est automatiquement ajout\xe9 \xe0 la liste des clients tout en restant visible dans l\'historique des leads.'})})]}),(0,$r.jsxs)("div",{className:"process-step",children:[(0,$r.jsxs)("div",{className:"step-header",children:[(0,$r.jsx)("div",{className:"step-number",children:"9"}),(0,$r.jsx)("h3",{children:"Dispatch apr\xe8s consultation"})]}),(0,$r.jsx)("div",{className:"step-content",children:(0,$r.jsx)("p",{children:"Lorsqu'un lead vient sur place pour une consultation g\xe9r\xe9e par la secr\xe9taire, celle-ci doit obligatoirement le dispatcher \xe0 une conseill\xe8re apr\xe8s la consultation, car la secr\xe9taire ne doit pas avoir de clients."})})]})]}):(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("p",{className:"lead-intro",children:"Les permissions et droits d'acc\xe8s sont d\xe9finis selon le r\xf4le de chaque utilisateur. Consultez cette section pour comprendre les actions disponibles selon votre r\xf4le."}),(0,$r.jsxs)("div",{className:"permissions-section",children:[(0,$r.jsx)("h3",{className:"role-title",children:"Administrateur"}),(0,$r.jsxs)("ul",{className:"permissions-list",children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Acc\xe8s \xe0 tous les leads"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Filtrage par conseill\xe8re"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," R\xe9assignation des leads entre conseill\xe8res"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Modification de tous les champs"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Import de fichiers Excel"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Dispatch des leads aux conseill\xe8res et \xe0 la secr\xe9taire"]})]})]}),(0,$r.jsxs)("div",{className:"permissions-section",children:[(0,$r.jsx)("h3",{className:"role-title",children:"Directeur"}),(0,$r.jsxs)("ul",{className:"permissions-list",children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Acc\xe8s \xe0 tous les leads"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Filtrage par conseill\xe8re"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Modification de tous les champs"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Import de fichiers Excel"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Dispatch des leads aux conseill\xe8res et \xe0 la secr\xe9taire"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-times"})," R\xe9assignation des leads (r\xe9serv\xe9 \xe0 l'administrateur)"]})]})]}),(0,$r.jsxs)("div",{className:"permissions-section",children:[(0,$r.jsx)("h3",{className:"role-title",children:"Secr\xe9taire"}),(0,$r.jsxs)("ul",{className:"permissions-list",children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Acc\xe8s \xe0 tous les leads"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Modification du statut lors de l'arriv\xe9e pour consultation"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Ajout manuel de leads un par un"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Dispatch obligatoire des leads \xe0 une conseill\xe8re pour consultation"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-times"})," Modification des champs autres que statut et notes"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-times"})," Import de fichiers Excel"]})]})]}),(0,$r.jsxs)("div",{className:"permissions-section",children:[(0,$r.jsx)("h3",{className:"role-title",children:"Conseill\xe8re"}),(0,$r.jsxs)("ul",{className:"permissions-list",children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Acc\xe8s uniquement \xe0 ses propres leads"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Modification du statut et des notes"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-check"})," Ajout manuel de leads un par un"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-times"})," R\xe9assignation des leads"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-times"})," Import de fichiers Excel"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("i",{className:"fas fa-times"})," Acc\xe8s aux leads des autres conseill\xe8res"]})]})]})]})})]})},Zr=async()=>{try{console.log("\ud83d\udd04 Chargement des conseillers depuis l'API...");const e=await Yr.get("".concat("http://localhost:5000/api","/users/conseillers"));if(e.data.success)return console.log("\u2705 Conseillers r\xe9cup\xe9r\xe9s:",e.data.data),{success:!0,data:e.data.data};throw new Error(e.data.message||"Erreur lors de la r\xe9cup\xe9ration des conseillers")}catch(e){return console.error("\u274c Erreur lors de la r\xe9cup\xe9ration des conseillers:",e),{success:!1,error:e.message,data:[{id:1,nomComplet:"wafaa chaouby"},{id:2,nomComplet:"hame amni"},{id:3,nomComplet:"sanaa sami"}]}}},ea=e=>{const t=[{value:"",label:"Aucune conseill\xe8re assign\xe9e"}];return e.forEach((e=>{t.push({value:e.nomComplet,label:e.nomComplet})})),t},ta=e=>e.map((e=>e.nomComplet)),na="http://localhost:5000/api",ra=()=>{const e=localStorage.getItem("token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t},aa=async()=>{try{const e=await fetch("".concat(na,"/leads"),{headers:ra()});if(!e.ok)throw new Error("Erreur lors de la r\xe9cup\xe9ration des leads");return await e.json()}catch(e){throw console.error("Erreur API getAllLeads:",e),e}},sa=async(e,t,n)=>{try{const r=await fetch("".concat(na,"/leads/").concat(e,"/convert-to-client"),{method:"POST",headers:ra(),body:JSON.stringify({utilisateur:t,notes:n})});if(!r.ok){const e=await r.json();throw new Error(e.message||"Erreur lors de la conversion")}return await r.json()}catch(r){throw console.error("Erreur API convertLeadToClient:",r),r}},ia=e=>{let{onLeadCreated:t}=e;const[n,r]=(0,s.useState)({nom:"",prenom:"",email:"",telephone:"",source:"",interet:"",conseillere:"",notes:""}),[a,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)([{value:"",label:"Aucune conseill\xe8re assign\xe9e"}]),[h,f]=(0,s.useState)(!0);(0,s.useEffect)((()=>{(async()=>{try{f(!0);const e=await Zr();if(e.success&&e.data){const t=ea(e.data);d(t)}else{const t=ea(e.data);d(t)}}catch(e){console.error("Erreur lors du chargement des conseillers:",e),d([{value:"",label:"Aucune conseill\xe8re assign\xe9e"},{value:"wafaa chaouby",label:"wafaa chaouby"},{value:"hame amni",label:"hame amni"},{value:"sanaa sami",label:"sanaa sami"}])}finally{f(!1)}})()}),[]),(0,s.useEffect)((()=>{if(!h&&c.length>1&&!n.conseillere){const e=localStorage.getItem("userName");if(console.log("\ud83d\udc64 Utilisateur connect\xe9 r\xe9cup\xe9r\xe9 (CreateLeadForm):",e),console.log("\ud83d\udccb Options de conseillers disponibles:",c),e){const t=c.find((t=>t.value&&(t.value.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.value.toLowerCase()))));t?(console.log("\u2705 Pr\xe9remplissage du champ conseill\xe8re (CreateLeadForm) avec:",t.value),r((e=>u(u({},e),{},{conseillere:t.value})))):console.log("\u26a0\ufe0f Utilisateur connect\xe9 non trouv\xe9 dans les options de conseillers:",{userName:e,conseillerOptions:c.map((e=>e.value)),recherchePartielle:c.filter((t=>t.value&&(t.value.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.value.toLowerCase()))))})}else console.log("\u26a0\ufe0f Aucun utilisateur connect\xe9 trouv\xe9 dans localStorage (CreateLeadForm)")}}),[h,c,n.conseillere]);const p=e=>{const{name:t,value:n}=e.target;r((e=>u(u({},e),{},{[t]:n})))};return(0,$r.jsxs)("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,$r.jsx)("h2",{style:{color:"#2c3e50",marginBottom:"20px"},children:"Cr\xe9er un nouveau lead"}),o&&(0,$r.jsx)("div",{style:{padding:"10px",marginBottom:"15px",borderRadius:"4px",backgroundColor:o.includes("succ\xe8s")?"#d4edda":"#f8d7da",color:o.includes("succ\xe8s")?"#155724":"#721c24",border:"1px solid ".concat(o.includes("succ\xe8s")?"#c3e6cb":"#f5c6cb")},children:o}),(0,$r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.nom&&n.prenom&&n.email&&n.telephone&&n.source&&n.interet){i(!0),l("");try{const e=await(async e=>{try{const t=await fetch("".concat(na,"/leads"),{method:"POST",headers:ra(),body:JSON.stringify(e)});if(!t.ok){const e=await t.json();if(401===t.status){const t=e.message||"";if(t.includes("Token expir\xe9")||t.includes("Token expired"))throw new Error("Votre session a expir\xe9. Veuillez vous reconnecter.");throw new Error("Erreur d'authentification. Veuillez vous reconnecter.")}throw new Error(e.message||"Erreur lors de la cr\xe9ation du lead")}return await t.json()}catch(t){throw console.error("Erreur API createLead:",t),t}})(n);e.success&&(l("Lead cr\xe9\xe9 avec succ\xe8s !"),(()=>{const e=localStorage.getItem("userName");let t="";if(e&&c.length>1){const n=c.find((t=>t.value&&(t.value.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.value.toLowerCase()))));n&&(t=n.value)}r({nom:"",prenom:"",email:"",telephone:"",source:"",interet:"",conseillere:t,notes:""}),console.log("\ud83d\udd04 Formulaire r\xe9initialis\xe9 (CreateLeadForm) avec conseill\xe8re pr\xe9remplie:",t)})(),t&&t())}catch(a){console.error("Erreur:",a),l(a.message||"Erreur lors de la cr\xe9ation du lead")}finally{i(!1)}}else l("Veuillez remplir tous les champs requis")},children:[(0,$r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Nom ",(0,$r.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,$r.jsx)("input",{type:"text",name:"nom",value:n.nom,onChange:p,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0})]}),(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Pr\xe9nom ",(0,$r.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,$r.jsx)("input",{type:"text",name:"prenom",value:n.prenom,onChange:p,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0})]})]}),(0,$r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Email ",(0,$r.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,$r.jsx)("input",{type:"email",name:"email",value:n.email,onChange:p,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0})]}),(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["T\xe9l\xe9phone ",(0,$r.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,$r.jsx)("input",{type:"tel",name:"telephone",value:n.telephone,onChange:p,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0})]})]}),(0,$r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"15px"},children:[(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Source ",(0,$r.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,$r.jsx)("select",{name:"source",value:n.source,onChange:p,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0,children:[{value:"",label:"S\xe9lectionner une source"},{value:"Site web",label:"Site web"},{value:"LinkedIn",label:"LinkedIn"},{value:"Facebook",label:"Facebook"},{value:"R\xe9f\xe9rence",label:"R\xe9f\xe9rence"},{value:"Autre",label:"Autre"}].map((e=>(0,$r.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Int\xe9r\xeat ",(0,$r.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,$r.jsx)("select",{name:"interet",value:n.interet,onChange:p,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0,children:[{value:"",label:"S\xe9lectionner un int\xe9r\xeat"},{value:"Permis d'\xe9tudes",label:"Permis d'\xe9tudes"},{value:"Permis de travail",label:"Permis de travail"},{value:"R\xe9sidence permanente",label:"R\xe9sidence permanente"},{value:"Visa visiteur",label:"Visa visiteur"},{value:"Citoyennet\xe9",label:"Citoyennet\xe9"},{value:"Autre",label:"Autre"}].map((e=>(0,$r.jsx)("option",{value:e.value,children:e.label},e.value)))})]})]}),(0,$r.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,$r.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Conseill\xe8re ",h&&(0,$r.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:"(Chargement...)"})]}),(0,$r.jsx)("select",{name:"conseillere",value:n.conseillere,onChange:p,disabled:h,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:h?"#f5f5f5":"white",cursor:h?"wait":"pointer"},children:c.map((e=>(0,$r.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,$r.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Notes"}),(0,$r.jsx)("textarea",{name:"notes",value:n.notes,onChange:p,rows:3,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",resize:"vertical"},placeholder:"Notes additionnelles..."})]}),(0,$r.jsx)("button",{type:"submit",disabled:a,style:{backgroundColor:a?"#95a5a6":"#3498db",color:"white",padding:"10px 20px",border:"none",borderRadius:"4px",cursor:a?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold"},children:a?"Cr\xe9ation...":"Cr\xe9er le lead"})]})]})},oa=e=>{let{lead:t,isOpen:n,onClose:r,onConvert:a,currentUser:i="Administrateur"}=e;const[o,l]=(0,s.useState)(i),[c,u]=(0,s.useState)(""),[d,h]=(0,s.useState)(!1),f=async e=>{if(e.preventDefault(),o.trim()){h(!0);try{await a(t.id,o.trim(),c.trim()||void 0),r(),u("")}catch(n){console.error("Erreur lors de la conversion:",n),alert("Erreur lors de la conversion du lead")}finally{h(!1)}}else alert("Veuillez saisir le nom de l'utilisateur")};return n?(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content convert-lead-modal",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"\ud83d\udd04 Convertir le lead en client"}),(0,$r.jsx)("button",{className:"close-button",onClick:r,children:"\xd7"})]}),(0,$r.jsxs)("div",{className:"modal-body",children:[(0,$r.jsxs)("div",{className:"lead-info",children:[(0,$r.jsx)("h4",{children:"Informations du lead"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("strong",{children:"Nom:"})," ",t.nom," ",t.prenom]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("strong",{children:"Email:"})," ",t.email]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("strong",{children:"T\xe9l\xe9phone:"})," ",t.telephone]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("strong",{children:"Int\xe9r\xeat:"})," ",t.interet]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("strong",{children:"Source:"})," ",t.source]}),t.conseillere&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("strong",{children:"Conseill\xe8re:"})," ",t.conseillere]})]})]}),(0,$r.jsxs)("form",{onSubmit:f,className:"conversion-form",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{htmlFor:"utilisateur",children:(0,$r.jsx)("strong",{children:"Utilisateur effectuant la conversion *"})}),(0,$r.jsxs)("select",{id:"utilisateur",value:o,onChange:e=>l(e.target.value),required:!0,className:"form-control",children:[(0,$r.jsx)("option",{value:"Administrateur",children:"Administrateur"}),(0,$r.jsx)("option",{value:"Marie Tremblay",children:"Marie Tremblay"}),(0,$r.jsx)("option",{value:"Sophie Martin",children:"Sophie Martin"}),(0,$r.jsx)("option",{value:"Julie Lefebvre",children:"Julie Lefebvre"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{htmlFor:"notes",children:(0,$r.jsx)("strong",{children:"Notes de conversion (optionnel)"})}),(0,$r.jsx)("textarea",{id:"notes",value:c,onChange:e=>u(e.target.value),placeholder:"Ajoutez des notes sur cette conversion...",className:"form-control",rows:3})]}),(0,$r.jsx)("div",{className:"conversion-info",children:(0,$r.jsxs)("div",{className:"info-box",children:[(0,$r.jsx)("h5",{children:"\ud83c\udfaf Actions qui seront effectu\xe9es :"}),(0,$r.jsxs)("ul",{children:[(0,$r.jsx)("li",{children:"\u2705 Cr\xe9ation d'un nouveau client avec les donn\xe9es du lead"}),(0,$r.jsx)("li",{children:"\ud83d\udd22 G\xe9n\xe9ration automatique d'un num\xe9ro de dossier (CL-2025-XXX)"}),(0,$r.jsx)("li",{children:'\ud83d\udcdd Mise \xe0 jour du statut du lead vers "Client"'}),(0,$r.jsx)("li",{children:"\ud83d\udccb Enregistrement de l'action dans le journal"})]})]})})]})]}),(0,$r.jsxs)("div",{className:"modal-footer",children:[(0,$r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:d,children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:f,disabled:d,children:d?"\ud83d\udd04 Conversion...":"\ud83d\udd04 Convertir en client"})]})]})}):null},la=e=>{let{refreshTrigger:t}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[o,l]=(0,s.useState)(""),[c,u]=(0,s.useState)(null),[d,h]=(0,s.useState)(!1),[f,p]=(0,s.useState)(null),[m,g]=(0,s.useState)("table"),[v,b]=(0,s.useState)("date_creation"),[x,y]=(0,s.useState)("desc"),w=async()=>{try{i(!0);const e=localStorage.getItem("token"),t={};e&&(t.Authorization="Bearer ".concat(e));const n=await Yr.get("http://localhost:5000/api/leads",{headers:t});n.data.success?(r(n.data.data.leads),l("")):l("Erreur lors du chargement des leads")}catch(o){console.error("Erreur:",o),l("Impossible de charger les leads. V\xe9rifiez que le serveur backend fonctionne.")}finally{i(!1)}},j=e=>{u(e),h(!0),p(null)},N=e=>{p(f===e?null:e)},S=e=>{v===e?y("asc"===x?"desc":"asc"):(b(e),y("asc"))},C=e=>v!==e?"\u2195\ufe0f":"asc"===x?"\u2191":"\u2193";if((0,s.useEffect)((()=>{const e=()=>{p(null)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)}),[]),(0,s.useEffect)((()=>{w()}),[t]),a)return(0,$r.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,$r.jsx)("div",{style:{fontSize:"18px",color:"#666"},children:"Chargement des leads..."})});if(o)return(0,$r.jsxs)("div",{style:{padding:"20px",backgroundColor:"#f8d7da",color:"#721c24",border:"1px solid #f5c6cb",borderRadius:"4px",margin:"20px 0"},children:[(0,$r.jsx)("strong",{children:"Erreur:"})," ",o,(0,$r.jsx)("br",{}),(0,$r.jsx)("button",{onClick:w,style:{marginTop:"10px",padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"R\xe9essayer"})]});const k=(()=>{const e=[...n].sort(((e,t)=>{let n,r;switch(v){case"nom":n="".concat(e.prenom," ").concat(e.nom).toLowerCase(),r="".concat(t.prenom," ").concat(t.nom).toLowerCase();break;case"conseillere":n=(e.conseillere||"").toLowerCase(),r=(t.conseillere||"").toLowerCase();break;case"date_creation":n=new Date(e.date_creation).getTime(),r=new Date(t.date_creation).getTime();break;case"source":n=e.source.toLowerCase(),r=t.source.toLowerCase();break;case"statut":n=e.statut.toLowerCase(),r=t.statut.toLowerCase();break;case"interet":n=e.interet.toLowerCase(),r=t.interet.toLowerCase();break;default:return 0}return n<r?"asc"===x?-1:1:n>r?"asc"===x?1:-1:0}));return e})();return(0,$r.jsxs)("div",{style:{padding:"20px"},children:[(0,$r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,$r.jsxs)("h2",{style:{color:"#2c3e50",margin:0},children:["Liste des leads (",n.length,")"]}),(0,$r.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,$r.jsxs)("div",{style:{display:"flex",backgroundColor:"#f8f9fa",borderRadius:"6px",padding:"4px"},children:[(0,$r.jsx)("button",{onClick:()=>g("table"),style:{padding:"6px 12px",border:"none",backgroundColor:"table"===m?"#007bff":"transparent",color:"table"===m?"white":"#6c757d",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"\ud83d\udcca Tableau"}),(0,$r.jsx)("button",{onClick:()=>g("grid"),style:{padding:"6px 12px",border:"none",backgroundColor:"grid"===m?"#007bff":"transparent",color:"grid"===m?"white":"#6c757d",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"\ud83d\udd32 Grille"})]}),(0,$r.jsx)("button",{onClick:w,style:{padding:"8px 16px",backgroundColor:"#17a2b8",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"\ud83d\udd04 Actualiser"})]})]}),0===n.length?(0,$r.jsxs)("div",{style:{textAlign:"center",padding:"40px",backgroundColor:"#f8f9fa",borderRadius:"8px",color:"#6c757d"},children:[(0,$r.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\udccb"}),(0,$r.jsx)("h3",{children:"Aucun lead trouv\xe9"}),(0,$r.jsx)("p",{children:"Cr\xe9ez votre premier lead en utilisant le formulaire ci-dessus."})]}):"table"===m?(0,$r.jsx)("div",{style:{backgroundColor:"white",border:"1px solid #e9ecef",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:(0,$r.jsx)("div",{style:{overflowX:"auto"},children:(0,$r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,$r.jsxs)("th",{onClick:()=>S("nom"),style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"bold",color:"#495057",position:"sticky",top:0,backgroundColor:"#f8f9fa",zIndex:10},children:["Nom complet ",C("nom")]}),(0,$r.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:"Contact"}),(0,$r.jsxs)("th",{onClick:()=>S("source"),style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:["Source ",C("source")]}),(0,$r.jsxs)("th",{onClick:()=>S("interet"),style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:["Int\xe9r\xeat ",C("interet")]}),(0,$r.jsxs)("th",{onClick:()=>S("conseillere"),style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:["Conseill\xe8re ",C("conseillere")]}),(0,$r.jsxs)("th",{onClick:()=>S("statut"),style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:["Statut ",C("statut")]}),(0,$r.jsxs)("th",{onClick:()=>S("date_creation"),style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6",cursor:"pointer",userSelect:"none",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:["Date cr\xe9ation ",C("date_creation")]}),(0,$r.jsx)("th",{style:{padding:"12px",textAlign:"center",borderBottom:"2px solid #dee2e6",fontSize:"14px",fontWeight:"bold",color:"#495057"},children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:k.map(((e,t)=>(0,$r.jsxs)("tr",{style:{backgroundColor:t%2===0?"#ffffff":"#f8f9fa",transition:"background-color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#e3f2fd"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=t%2===0?"#ffffff":"#f8f9fa"},children:[(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef"},children:(0,$r.jsxs)("div",{style:{fontWeight:"bold",color:"#2c3e50"},children:[e.prenom," ",e.nom]})}),(0,$r.jsxs)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef"},children:[(0,$r.jsxs)("div",{style:{fontSize:"13px",marginBottom:"4px"},children:["\ud83d\udce7 ",(0,$r.jsx)("a",{href:"mailto:".concat(e.email),style:{color:"#007bff",textDecoration:"none"},children:e.email})]}),(0,$r.jsxs)("div",{style:{fontSize:"13px"},children:["\ud83d\udcde ",(0,$r.jsx)("a",{href:"tel:".concat(e.telephone),style:{color:"#28a745",textDecoration:"none"},children:e.telephone})]})]}),(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef"},children:(0,$r.jsx)("span",{style:{backgroundColor:"#e9ecef",color:"#495057",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:e.source})}),(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef"},children:e.interet}),(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef"},children:e.conseillere||"-"}),(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef"},children:(0,$r.jsx)("span",{style:{backgroundColor:"Nouveau"===e.statut?"#28a745":"Client"===e.statut?"#007bff":"#6c757d",color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:e.statut})}),(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef",fontSize:"13px"},children:new Date(e.date_creation).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"})}),(0,$r.jsx)("td",{style:{padding:"12px",borderBottom:"1px solid #e9ecef",textAlign:"center"},children:(0,$r.jsxs)("div",{style:{position:"relative"},children:[(0,$r.jsx)("button",{onClick:t=>{t.stopPropagation(),N(e.id)},style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",color:"#6c757d",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa",e.currentTarget.style.color="#495057"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#6c757d"},children:"\u22ee"}),f===e.id&&(0,$r.jsxs)("div",{style:{position:"absolute",top:"100%",right:"0",backgroundColor:"white",border:"1px solid #e9ecef",borderRadius:"4px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",zIndex:1e3,minWidth:"180px"},children:["Client"!==e.statut&&(0,$r.jsx)("button",{onClick:t=>{t.stopPropagation(),j(e)},style:{width:"100%",padding:"10px 15px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#495057",display:"flex",alignItems:"center",gap:"8px",transition:"background-color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:"\ud83d\udd04 Convertir en client"}),(0,$r.jsx)("button",{onClick:e=>{e.stopPropagation(),alert("Fonctionnalit\xe9 d'\xe9dition \xe0 venir"),p(null)},style:{width:"100%",padding:"10px 15px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#495057",display:"flex",alignItems:"center",gap:"8px",transition:"background-color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:"\u270f\ufe0f Modifier"})]})]})})]},e.id)))})]})})}):(0,$r.jsx)("div",{style:{display:"grid",gap:"15px",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))"},children:k.map((e=>(0,$r.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #e9ecef",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"transform 0.2s, box-shadow 0.2s",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)"},children:[(0,$r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"15px"},children:[(0,$r.jsxs)("h3",{style:{margin:0,color:"#2c3e50",fontSize:"18px"},children:[e.prenom," ",e.nom]}),(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,$r.jsx)("span",{style:{backgroundColor:"Nouveau"===e.statut?"#28a745":"Client"===e.statut?"#007bff":"#6c757d",color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:e.statut}),(0,$r.jsxs)("div",{style:{position:"relative"},children:[(0,$r.jsx)("button",{onClick:t=>{t.stopPropagation(),N(e.id)},style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",color:"#6c757d",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa",e.currentTarget.style.color="#495057"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#6c757d"},children:"\u22ee"}),f===e.id&&(0,$r.jsxs)("div",{style:{position:"absolute",top:"100%",right:"0",backgroundColor:"white",border:"1px solid #e9ecef",borderRadius:"4px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",zIndex:1e3,minWidth:"180px"},children:["Client"!==e.statut&&(0,$r.jsx)("button",{onClick:t=>{t.stopPropagation(),j(e)},style:{width:"100%",padding:"10px 15px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#495057",display:"flex",alignItems:"center",gap:"8px",transition:"background-color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:"\ud83d\udd04 Convertir en client"}),(0,$r.jsx)("button",{onClick:e=>{e.stopPropagation(),alert("Fonctionnalit\xe9 d'\xe9dition \xe0 venir"),p(null)},style:{width:"100%",padding:"10px 15px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#495057",display:"flex",alignItems:"center",gap:"8px",transition:"background-color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f8f9fa"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:"\u270f\ufe0f Modifier"})]})]})]})]}),(0,$r.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,$r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83d\udce7 Email:"}),(0,$r.jsx)("span",{style:{marginLeft:"8px",color:"#007bff"},children:(0,$r.jsx)("a",{href:"mailto:".concat(e.email),style:{color:"#007bff",textDecoration:"none"},children:e.email})})]}),(0,$r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83d\udcde T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{style:{marginLeft:"8px"},children:(0,$r.jsx)("a",{href:"tel:".concat(e.telephone),style:{color:"#28a745",textDecoration:"none"},children:e.telephone})})]}),(0,$r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83d\udcca Source:"}),(0,$r.jsx)("span",{style:{marginLeft:"8px"},children:e.source})]}),(0,$r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83c\udfaf Int\xe9r\xeat:"}),(0,$r.jsx)("span",{style:{marginLeft:"8px"},children:e.interet})]}),e.conseillere&&(0,$r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83d\udc69\u200d\ud83d\udcbc Conseill\xe8re:"}),(0,$r.jsx)("span",{style:{marginLeft:"8px"},children:e.conseillere})]}),(0,$r.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83d\udcc5 Date de cr\xe9ation:"}),(0,$r.jsx)("span",{style:{marginLeft:"8px"},children:new Date(e.date_creation).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.notes&&(0,$r.jsxs)("div",{style:{marginTop:"15px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #e9ecef"},children:[(0,$r.jsx)("strong",{style:{color:"#495057"},children:"\ud83d\udcdd Notes:"}),(0,$r.jsx)("p",{style:{margin:"5px 0 0 0",fontSize:"14px",lineHeight:"1.4"},children:e.notes})]})]},e.id)))}),c&&(0,$r.jsx)(oa,{lead:c,isOpen:d,onClose:()=>{u(null),h(!1)},onConvert:async(e,t,n)=>{try{const r=await sa(e,t,n);r.success&&(await w(),alert("\u2705 Lead converti avec succ\xe8s!\n\nNum\xe9ro de dossier: ".concat(r.data.numeroDossier,"\nClient cr\xe9\xe9: ").concat(r.data.client.nom," ").concat(r.data.client.prenom)))}catch(o){throw console.error("Erreur lors de la conversion:",o),alert("\u274c Erreur lors de la conversion: ".concat(o.message)),o}},currentUser:"Administrateur"})]})};var ca={version:"0.18.5"},ua=1200,da=1252,ha=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fa={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pa=function(e){-1!=ha.indexOf(e)&&(da=fa[0]=e)};var ma=function(e){ua=e,pa(e)};function ga(){ma(1200),pa(1252)}function va(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function ba(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var xa,ya=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?ba(e.slice(2)):65279==t?e.slice(1):e},wa=function(e){return String.fromCharCode(e)},ja=function(e){return String.fromCharCode(e)};var Na="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Sa(e){for(var t="",n=0,r=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(n=e.charCodeAt(c++))>>2,i=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=Na.charAt(s)+Na.charAt(i)+Na.charAt(o)+Na.charAt(l);return t}function Ca(e){var t="",n=0,r=0,a=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=Na.indexOf(e.charAt(l++))<<2|(s=Na.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&s)<<4|(i=Na.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(r)),a=(3&i)<<6|(o=Na.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var ka=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Ea=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(cw){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Aa(e){return ka?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Ta(e){return ka?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Pa=function(e){return ka?Ea(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function _a(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function La(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return La(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var Ra=ka?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Ea(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var Da=/\u0000/g,Ia=/[\u0001-\u0006]/g;function Oa(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Fa(e,t){var n=""+e;return n.length>=t?n:Gs("0",t-n.length)+n}function Ma(e,t){var n=""+e;return n.length>=t?n:Gs(" ",t-n.length)+n}function Ba(e,t){var n=""+e;return n.length>=t?n:n+Gs(" ",t-n.length)}var za=Math.pow(2,32);function Ua(e,t){return e>za||e<-za?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Gs("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Gs("0",t-n.length)+n}(Math.round(e),t)}function qa(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Va=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Wa=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Ha={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Ga={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ya={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $a(e,t,n){for(var r=e<0?-1:1,a=e*r,s=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(a);c<t&&(o=(d=Math.floor(a))*i+s,u=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!n)return[0,r*o,u];var h=Math.floor(r*o/u);return[h,r*o-h*u,u]}function Ka(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),s=0,i=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)i=n?[1317,10,29]:[1900,2,29],s=3;else if(0===r)i=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Ja=new Date(1899,11,31,0,0,0),Xa=Ja.getTime(),Qa=new Date(1900,2,1,0,0,0);function Za(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Qa&&(n+=864e5),(n-(Xa+6e4*(e.getTimezoneOffset()-Ja.getTimezoneOffset())))/864e5}function es(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ts(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=es(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=es(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),es(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function ns(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):ts(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Ns(14,Za(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function rs(e,t,n,r){var a,s="",i=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return Wa[n.m-1][1];case 5:return Wa[n.m-1][0];default:return Wa[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return Va[n.q][0];default:return Va[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(i=Math.round(o*(n.S+n.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Fa(i,2+r),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Fa(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Fa(a,c):""}function as(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var ss=/%/g;function is(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+is(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(n=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(i-n.length+s):n+="E+"+(i-s);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var os=/# (\?+)( ?)\/( ?)(\d+)/;var ls=/^#*0*\.([0#]+)/,cs=/\).*[0#]/,us=/\(###\) ###\\?-####/;function ds(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function hs(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function fs(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function ps(e,t,n){if(40===e.charCodeAt(0)&&!t.match(cs)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ps("n",r,n):"("+ps("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return vs(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(ss,""),a=t.length-r.length;return vs(e,r,n*Math.pow(10,2*a))+Gs("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return is(t,n);if(36===t.charCodeAt(0))return"$"+ps(e,t.substr(" "==t.charAt(1)?2:1),n);var a,s,i,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Ua(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Ua(n,0))&&(a=""),a.length>t.length?a:ds(t.substr(0,t.length-a.length))+a;if(s=t.match(os))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),s=Math.floor(a/r),i=a-s*r,o=r;return n+(0===s?"":""+s)+" "+(0===i?Gs(" ",e[1].length+1+e[4].length):Ma(i,e[1].length)+e[2]+"/"+e[3]+Fa(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+Ua(l,t.length-t.indexOf("0"));if(s=t.match(ls))return a=hs(n,s[1].length).replace(/^([^\.]+)$/,"$1."+ds(s[1])).replace(/\.$/,"."+ds(s[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Gs("0",ds(s[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+hs(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+as(Ua(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ps(e,t,-n):as(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,s[1].length)))+"."+Fa(fs(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ps(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Oa(ps(e,t.replace(/[\\-]/g,""),n)),i=0,Oa(Oa(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""})));if(t.match(us))return"("+(a=ps(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=$a(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=vs("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=Ba(o[2],i)).length<s[4].length&&(u=ds(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=$a(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Ma(o[1],i)+s[2]+"/"+s[3]+Ba(o[2],i):Gs(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ua(n,0),t.length<=a.length?a:ds(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return ds(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=fs(n,s[1].length),n<0?"-"+ps(e,t,-n):as(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Fa(0,3-e.length):"")+e}))+"."+Fa(i,s[1].length);switch(t){case"###,##0.00":return ps(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=as(Ua(l,0));return"0"!==f?c+f:"";case"###,###.00":return ps(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return ps(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ms(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+ms(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(n=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(i-n.length+s):n+="E+"+(i-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function gs(e,t,n){if(40===e.charCodeAt(0)&&!t.match(cs)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?gs("n",r,n):"("+gs("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return vs(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(ss,""),a=t.length-r.length;return vs(e,r,n*Math.pow(10,2*a))+Gs("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return ms(t,n);if(36===t.charCodeAt(0))return"$"+gs(e,t.substr(" "==t.charAt(1)?2:1),n);var a,s,i,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Fa(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:ds(t.substr(0,t.length-a.length))+a;if(s=t.match(os))return function(e,t,n){return n+(0===t?"":""+t)+Gs(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Fa(l,t.length-t.indexOf("0"));if(s=t.match(ls))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+ds(s[1])).replace(/\.$/,"."+ds(s[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Gs("0",ds(s[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+as(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+gs(e,t,-n):as(""+n)+"."+Gs("0",s[1].length);if(s=t.match(/^#,#*,#0/))return gs(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Oa(gs(e,t.replace(/[\\-]/g,""),n)),i=0,Oa(Oa(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""})));if(t.match(us))return"("+(a=gs(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=$a(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=vs("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=Ba(o[2],i)).length<s[4].length&&(u=ds(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=$a(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Ma(o[1],i)+s[2]+"/"+s[3]+Ba(o[2],i):Gs(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:ds(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return ds(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+gs(e,t,-n):as(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Fa(0,3-e.length):"")+e}))+"."+Fa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=as(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return gs(e,t.slice(0,t.lastIndexOf(".")),n)+ds(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function vs(e,t,n){return(0|n)===n?gs(e,t,n):ps(e,t,n)}var bs=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xs(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":qa(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(bs))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var ys=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ws(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function js(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var s=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,s];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var i=n[0].match(ys),o=n[1].match(ys);return ws(t,i)?[r,n[0]]:ws(t,o)?[r,n[1]]:[r,n[null!=i&&null!=o?2:1]]}return[r,s]}function Ns(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Ha)[e])&&(r=n.table&&n.table[Ga[e]]||Ha[Ga[e]]),null==r&&(r=Ya[e]||"General")}if(qa(r,0))return ns(t,n);t instanceof Date&&(t=Za(t,n.date1904));var a=js(r,t);if(qa(a[1]))return ns(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,s,i,o=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!qa(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Ka(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Ka(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),o[o.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var m={t:u,v:u};if(null==a&&(a=Ka(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?"P":"A"),m.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,h="h"):(m.t="t",++c),null==a&&"T"===m.t)return"";o[o.length]=m,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(bs)){if(null==a&&null==(a=Ka(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",xs(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,b=0;for(c=o.length-1,d="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,d="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=o[c].t;break;case"m":"s"===d&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var x,y="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=rs(o[c].t.charCodeAt(0),o[c].v,a,b),o[c].t="t";break;case"n":case"?":for(x=c+1;null!=o[x]&&("?"===(u=o[x].t)||"D"===u||(" "===u||"t"===u)&&null!=o[x+1]&&("?"===o[x+1].t||"t"===o[x+1].t&&"/"===o[x+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[x].v||" "===o[x].v&&null!=o[x+1]&&"?"==o[x+1].t));)o[c].v+=o[x].v,o[x]={v:"",t:";"},++x;y+=o[c].v,c=x-1;break;case"G":o[c].t="t",o[c].v=ns(t,n)}var w,j,N="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,j=vs("n",y,w)):(j=vs("n",y,w=t<0&&r>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(j=j.substr(1),o[0].v="-"+o[0].v)),x=j.length-1;var S=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){S=c;break}var C=o.length;if(S===o.length&&-1===j.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(x>=o[c].v.length-1?(x-=o[c].v.length,o[c].v=j.substr(x+1,o[c].v.length)):x<0?o[c].v="":(o[c].v=j.substr(0,x+1),x=-1),o[c].t="t",C=c);x>=0&&C<o.length&&(o[C].v=j.substr(0,x+1)+o[C].v)}else if(S!==o.length&&-1===j.indexOf("E")){for(x=j.indexOf(".")-1,c=S;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===S?o[c].v.indexOf(".")-1:o[c].v.length-1,N=o[c].v.substr(s+1);s>=0;--s)x>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(N=j.charAt(x--)+N);o[c].v=N,o[c].t="t",C=c}for(x>=0&&C<o.length&&(o[C].v=j.substr(0,x+1)+o[C].v),x=j.indexOf(".")+1,c=S;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===S)){for(s=o[c].v.indexOf(".")>-1&&c===S?o[c].v.indexOf(".")+1:0,N=o[c].v.substr(0,s);s<o[c].v.length;++s)x<j.length&&(N+=j.charAt(x++));o[c].v=N,o[c].t="t",C=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=vs(o[c].t,o[c].v,w),o[c].t="t");var k="";for(c=0;c!==o.length;++c)null!=o[c]&&(k+=o[c].v);return k}(a[1],t,n,a[0])}function Ss(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Ha[n]){if(Ha[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Ha[t]=e,t}function Cs(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Ha=e}var ks={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Es=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var As=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var s=[];for(r=1;16!=r;++r)s[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return s}(t),r=n[0],a=n[1],s=n[2],i=n[3],o=n[4],l=n[5],c=n[6],u=n[7],d=n[8],h=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,a=0,s=e.length;a<s;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var b=-1^n,x=e.length-15,y=0;y<x;)b=v[e[y++]^255&b]^g[e[y++]^b>>8&255]^m[e[y++]^b>>16&255]^p[e[y++]^b>>>24]^f[e[y++]]^h[e[y++]]^d[e[y++]]^u[e[y++]]^c[e[y++]]^l[e[y++]]^o[e[y++]]^i[e[y++]]^s[e[y++]]^a[e[y++]]^r[e[y++]]^t[e[y++]];for(x+=15;y<x;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,n){for(var r=-1^n,a=0,s=e.length,i=0,o=0;a<s;)(i=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^i)]:i<2048?r=(r=r>>>8^t[255&(r^(192|i>>6&31))])>>>8^t[255&(r^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|i>>8&7))])>>>8^t[255&(r^(128|i>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|i>>12&15))])>>>8^t[255&(r^(128|i>>6&63))])>>>8^t[255&(r^(128|63&i))];return~r},e}(),Ts=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function s(e){So(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};if(21589===r)1&(n=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&n&&(i.atime=e.read_shift(4)),4&n&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[r]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=j(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(ka&&Buffer.isBuffer(e)?e.toString("binary"):j(e)).split("\r\n"),a=0,s="";for(a=0;a<r.length;++a)if(s=r[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),n||(n=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),s.slice(0,n.length)!=n););var i=(r[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,f=0;for(a=0;a<r.length;++a){var p=r[a];p!==o&&p!==o+"--"||(f++&&ce(u,r.slice(d,a),n),d=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,s,i,o,f=512,p=[],m=e.slice(0,512);So(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(n=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&So(m=e.slice(0,f),28);var x=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,n);var y=m.read_shift(4,"i");if(3===n&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);m.l+=4,s=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),i=m.read_shift(4,"i"),r=m.read_shift(4,"i"),o=m.read_shift(4,"i"),a=m.read_shift(4,"i");for(var w=-1,N=0;N<109&&!((w=m.read_shift(4,"i"))<0);++N)p[N]=w;var S=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);c(o,a,S,f,p);var C=function(e,t,n,r){var a=e.length,s=[],i=[],o=[],l=[],c=r-1,u=0,d=0,h=0,f=0;for(u=0;u<a;++u)if(o=[],(h=u+t)>=a&&(h-=a),!i[h]){l=[];var p=[];for(d=h;d>=0;){p[d]=!0,i[d]=!0,o[o.length]=d,l.push(e[d]);var m=n[Math.floor(4*d/r)];if(r<4+(f=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[m])break;if(p[d=go(e[m],f)])break}s[h]={nodes:o,data:Wi([l])}}return s}(S,s,p,f);C[s].name="!Directory",r>0&&i!==v&&(C[i].name="!MiniFAT"),C[p[0]].name="!FAT",C.fat_addrs=p,C.ssz=f;var k=[],E=[],A=[];!function(e,t,n,r,a,s,i,o){for(var c,h=0,f=r.length?2:0,p=t[e].data,m=0,g=0;m<p.length;m+=128){var b=p.slice(m,m+128);So(b,64),g=b.read_shift(2),c=Gi(b,0,g-f),r.push(c);var x={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(x.ct=d(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(x.mt=d(b,b.l-8)),x.start=b.read_shift(4,"i"),x.size=b.read_shift(4,"i"),x.size<0&&x.start<0&&(x.size=x.type=0,x.start=v,x.name=""),5===x.type?(h=x.start,a>0&&h!==v&&(t[h].name="!StreamData")):x.size>=4096?(x.storage="fat",void 0===t[x.start]&&(t[x.start]=u(n,x.start,t.fat_addrs,t.ssz)),t[x.start].name=x.name,x.content=t[x.start].data.slice(0,x.size)):(x.storage="minifat",x.size<0?x.size=0:h!==v&&x.start!==v&&t[h]&&(x.content=l(x,t[h].data,(t[o]||{}).data))),x.content&&So(x.content,0),s[c]=x,i.push(x)}}(s,C,S,k,r,{},E,i),function(e,t,n){for(var r=0,a=0,s=0,i=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,s=e[r].R,i=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==s&&c[s]!==s&&(c[r]=c[s])),-1!==i&&(c[i]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==s&&r!=c[r]&&(c[s]=c[r],u.lastIndexOf(s)<o&&u.push(s));for(r=1;r<l;++r)c[r]===r&&(-1!==s&&c[s]!==s?c[r]=c[s]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(E,A,k),k.shift();var T={FileIndex:E,FullPaths:A};return t&&t.raw&&(T.raw={header:x,sectors:S}),T}function l(e,t,n){for(var r=e.start,a=e.size,s=[],i=r;n&&a>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),a-=g,i=go(n,4*i);return 0===s.length?ko(0):Ra(s).slice(0,e.size)}function c(e,t,n,r,a){var s=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=n[e],o=(r>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=go(i,4*l))!==v;++l)a.push(s);c(go(i,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var s=[],i=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,i.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=go(e[u],c)}return{nodes:s,data:Wi([i])}}function d(e,t){return new Date(1e3*(mo(e,t+4)/1e7*Math.pow(2,32)+mo(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(Ts.find(e,"/"+t))return;var n=ko(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(i=0;i<e.FullPaths.length;++i)u[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&d.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<d.length;++i){var f=n(d[i][0]);(s=u[f])||(d.push([f,{name:r(f).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),u[f]=!0)}for(d.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,s=0,i=Math.min(n.length,r.length);a<i;++a){if(s=n[a].length-r[a].length)return s;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],i=0;i<d.length;++i)e.FullPaths[i]=d[i][0],e.FileIndex[i]=d[i][1];for(i=0;i<d.length;++i){var p=e.FileIndex[i],m=e.FullPaths[i];if(p.name=r(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||y,0===i)p.C=d.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(c=i+1;c<d.length&&n(e.FullPaths[c])!=m;++c);for(p.C=c>=d.length?-1:c,c=i+1;c<d.length&&n(e.FullPaths[c])!=n(m);++c);p.R=c>=d.length?-1:c,p.type=1}else n(e.FullPaths[i+1]||"")==n(m)&&(p.R=i+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,u=ka&&Buffer.isBuffer(c)?c.toString("binary"):j(c),d=0,h=Math.min(1024,u.length),f=0,p=0;p<=h;++p)(f=u.charCodeAt(p))>=32&&f<128&&++d;var m=d>=4*h/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+ie(o,i)),a.push(""),a.push(m?le(u):oe(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],s=[],i=ko(1),o=n.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,f=e.FullPaths[0],p=f,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(f.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=p){var b=d,x=ko(p.length);for(u=0;u<p.length;++u)x.write_shift(1,127&p.charCodeAt(u));x=x.slice(0,x.l),g[h]=As.buf(m.content,0);var y=m.content;8==o&&(y=N(y)),(i=ko(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),m.mt?a(i,m.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[h]),i.write_shift(4,8&l?0:y.length),i.write_shift(4,8&l?0:m.content.length),i.write_shift(2,x.length),i.write_shift(2,0),d+=i.length,r.push(i),d+=x.length,r.push(x),d+=y.length,r.push(y),8&l&&((i=ko(12)).write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,m.content.length),d+=i.l,r.push(i)),(i=ko(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,m.content.length),i.write_shift(2,x.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),v+=i.l,s.push(i),v+=x.length,s.push(x),++h}return i=ko(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,v),i.write_shift(4,d),i.write_shift(2,0),Ra([Ra(r),Ra(s),i])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:n+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+i+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,o,i,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),s=ko(r[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,x[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,r[2]),s.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),s.write_shift(4,r[3]),s.write_shift(-4,r[1]?r[0]-1:v),s.write_shift(4,r[1]),i=0;i<109;++i)s.write_shift(-4,i<r[2]?r[1]+i:-1);if(r[1])for(o=0;o<r[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<r[2]?r[1]+i:-1);s.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,v))};for(o=i=0,o+=r[1];i<o;++i)s.write_shift(-4,w.DIFSECT);for(o+=r[2];i<o;++i)s.write_shift(-4,w.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,l(u+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<r[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){d=e.FileIndex[i],0===i&&(d.start=d.size?d.start-1:v);var p=0===i&&n.root||d.name;if(u=2*(p.length+1),s.write_shift(64,p,"utf16le"),s.write_shift(2,u),s.write_shift(1,d.type),s.write_shift(1,d.color),s.write_shift(-4,d.L),s.write_shift(-4,d.R),s.write_shift(-4,d.C),d.clsid)s.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,d.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,d.start),s.write_shift(4,d.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>=4096)if(s.l=d.start+1<<9,ka&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>0&&d.size<4096)if(ka&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(ka)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var m,g=64,v=-2,b="d0cf11e0a1b11ae1",x=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function j(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function N(e){return m?m.deflateRawSync(e):$(e)}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function E(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!==typeof Uint8Array,T=A?new Uint8Array(256):[],P=0;P<256;++P)T[P]=E(P);function _(e,t){var n=T[255&e];return t<=8?n>>>8-t:(n=n<<8|T[e>>8&255],t<=16?n>>>16-t:(n=n<<8|T[e>>16&255])>>>24-t)}function L(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function R(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function I(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function O(e,t,n){var r=7&t,a=t>>>3,s=(1<<n)-1,i=e[a]>>>r;return n<8-r?i&s:(i|=e[a+1]<<8-r,n<16-r?i&s:(i|=e[a+2]<<16-r,n<24-r?i&s:(i|=e[a+3]<<24-r)&s))}function F(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function M(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function z(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function U(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(ka){var s=Ta(r);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(A){var i=new Uint8Array(r);if(i.set)i.set(e);else for(;a<n;++a)i[a]=e[a];return i}return e.length=r,e}function q(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function V(e,t,n){var r=1,a=0,s=0,i=0,o=0,l=e.length,c=A?new Uint16Array(32):q(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<n;++s)e[s]=0;l=e.length;var u=A?new Uint16Array(l):q(l);for(s=0;s<l;++s)c[a=e[s]]++,r<a&&(r=a),u[s]=0;for(c[0]=0,s=1;s<=r;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(u[s]=c[o+16]++);var d=0;for(s=0;s<l;++s)if(0!=(d=e[s]))for(o=_(u[s],r)>>r-d,i=(1<<r+4-d)-1;i>=0;--i)t[o|i<<d]=15&d|s<<4;return r}var W=A?new Uint16Array(512):q(512),H=A?new Uint16Array(32):q(32);if(!A){for(var G=0;G<512;++G)W[G]=0;for(G=0;G<32;++G)H[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);V(e,H,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);V(n,W,288)}();var Y=function(){for(var e=A?new Uint8Array(32768):[],t=0,n=0;t<k.length-1;++t)for(;n<k[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=A?new Uint8Array(259):[];for(t=0,n=0;t<C.length-1;++t)for(;n<C[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,s=0,i=A?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=F(n,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[s++];a=8*n.l}else{a=F(n,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],u=-1,d=0;if((u=i[l=32767&(l<<5^c)])&&((u|=-32768&s)>s&&(u-=32768),u<s))for(;t[u+d]==t[s+d]&&d<250;)++d;if(d>2){(c=r[d])<=22?a=B(n,a,T[c+1]>>1)-1:(B(n,a,3),B(n,a+=5,T[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(z(n,a,d-C[c]),a+=h),c=e[s-u],a=B(n,a,T[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(z(n,a,s-u-k[c]),a+=f);for(var p=0;p<d;++p)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=d-1}else c<=143?c+=48:a=M(n,a,1),a=B(n,a,T[c]),i[l]=32767&s,++s}a=B(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function $(e){var t=ko(50+Math.floor(1.1*e.length)),n=Y(e,t);return t.slice(0,n)}var K=A?new Uint16Array(32768):q(32768),J=A?new Uint16Array(32768):q(32768),X=A?new Uint16Array(128):q(128),Q=1,Z=1;function ee(e,t){var n=D(e,t)+257,r=D(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var s=0,i=A?new Uint8Array(19):q(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):q(8),u=A?new Uint8Array(8):q(8),d=i.length,h=0;h<a;++h)i[S[h]]=s=R(e,t),l<s&&(l=s),c[s]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)u[h]=f=f+c[h-1]<<1;for(h=0;h<d;++h)0!=(f=i[h])&&(o[h]=u[f]++);var p=0;for(h=0;h<d;++h)if(0!=(p=i[h])){f=T[o[h]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)X[f|m<<p]=7&p|h<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(f=X[I(e,t)]),f>>>=3){case 16:for(s=3+L(e,t),t+=2,f=g[g.length-1];s-- >0;)g.push(f);break;case 17:for(s=3+R(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+I(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var v=g.slice(0,n),b=g.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)b[h]=0;return Q=V(v,K,286),Z=V(b,J,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Aa(t),2];for(var n=0,r=0,a=Ta(t||1<<18),s=0,i=a.length>>>0,o=0,l=0;0==(1&r);)if(r=R(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=Q,l=Z);;){!t&&i<s+32767&&(i=(a=U(a,s+32767)).length);var c=O(e,n,o),u=r>>>1==1?W[c]:K[c];if(n+=15&u,0===((u>>>=4)>>>8&255))a[s++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=s+C[u];d>0&&(h+=O(e,n,d),n+=d),c=O(e,n,l),n+=15&(u=r>>>1==1?H[c]:J[c]);var f=(u>>>=4)<4?0:u-2>>1,p=k[u];for(f>0&&(p+=O(e,n,f),n+=f),!t&&i<h&&(i=(a=U(a,h+100)).length);s<h;)a[s]=a[s-p],++s}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,m>0)for(!t&&i<s+m&&(i=(a=U(a,s+m)).length);m-- >0;)a[s++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,s),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;So(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var i=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<i;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),m=s(n.slice(n.l+u,n.l+u+d));n.l+=u+d+f;var g=n.l;n.l=p+4,ae(n,l,c,r,m),n.l=g}return r}function ae(e,t,n,r,a){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,s=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(s-1),r.setDate(a);var i=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(i<<1),r}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",p=0;p<d;++p)f+=String.fromCharCode(e[e.l++]);if(h){var g=s(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var n=new(0,m.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(b,"Bad compressed size: "+t+" != "+c),u!=n&&ne(b,"Bad uncompressed size: "+n+" != "+u),ue(r,f,v,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&se[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&se[r[1]]?se[r[1]]:"application/octet-stream"}function oe(e){for(var t=Sa(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var s=r[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":r=Pa(Ca(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Pa(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});i&&(u.ctype=i)}function ue(e,t,n,a){var s=a&&a.unsafe;s||h(e);var i=!s&&Ts.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:r(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||Ts.utils.cfb_gc(e)}return i.content=n,i.size=n?n.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?n.indexOf(s):r.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Ia);for(s=s.replace(Da,""),o&&(s=s.replace(Ia,"!")),i=0;i<n.length;++i){if((o?n[i].replace(Ia,"!"):n[i]).replace(Da,"")==s)return e.FileIndex[i];if((o?r[i].replace(Ia,"!"):r[i]).replace(Da,"")==s)return e.FileIndex[i]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||ka&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return i(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(Pa(Ca(t)),n);case"binary":return o(Pa(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return i(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:j(r);case"base64":return Sa("string"==typeof r?r:j(r));case"buffer":if(ka)return Buffer.isBuffer(r)?r:Ea(r);case"array":return"string"==typeof r?Pa(r):r}return r},t.writeFile=function(t,n,r){i();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var n=Ts.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var a=Ts.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=r(n),e.FullPaths[s]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:bo,CheckField:No,prep_blob:So,bconcat:Ra,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(cw){console.error("cannot use native zlib: "+(cw.message||cw))}},_deflateRaw:$,_inflateRaw:te,consts:w},t}();let Ps;function _s(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Ls(e){for(var t=[],n=_s(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var Rs=new Date(1899,11,30,0,0,0);function Ds(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(Rs.getTime()+6e4*(e.getTimezoneOffset()-Rs.getTimezoneOffset())))/864e5}var Is=new Date,Os=Rs.getTime()+6e4*(Is.getTimezoneOffset()-Rs.getTimezoneOffset()),Fs=Is.getTimezoneOffset();function Ms(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Os),t.getTimezoneOffset()!==Fs&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Fs)),t}function Bs(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(n=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(a[s],10)}return t}var zs=new Date("2017-02-19T19:06:09.000Z"),Us=isNaN(zs.getFullYear())?new Date("2/19/17"):zs,qs=2017==Us.getFullYear();function Vs(e,t){var n=new Date(e);if(qs)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==Us.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function Ws(e,t){if(ka&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Ti(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Ti(ba(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Ti(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Ti(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(cw){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Hs(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Hs(e[n]));return t}function Gs(e,t){for(var n="";n.length<t;)n+=e;return n}function Ys(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var $s=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ks(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==$s.indexOf(i))return n}else if(i.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||s>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var Js=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var a=t.split(n),s=[a[0]],i=1;i<a.length;++i)s.push(r),s.push(a[i]);return s}}();function Xs(e){return e?e.content&&e.type?Ws(e.content,!0):e.data?ya(e.data):e.asNodeBuffer&&ka?ya(e.asNodeBuffer().toString("binary")):e.asBinary?ya(e.asBinary()):e._data&&e._data.getContent?ya(Ws(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Qs(e){if(!e)return null;if(e.data)return va(e.data);if(e.asNodeBuffer&&ka)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?va(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Zs(e,t){for(var n=e.FullPaths||_s(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var i=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==i||a==i)return e.files?e.files[n[s]]:e.FileIndex[s]}return null}function ei(e,t){var n=Zs(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function ti(e,t,n){if(!n)return function(e){return e&&".bin"===e.name.slice(-4)?Qs(e):Xs(e)}(ei(e,t));if(!t)return null;try{return ti(e,t)}catch(cw){return null}}function ni(e,t,n){if(!n)return Xs(ei(e,t));if(!t)return null;try{return ni(e,t)}catch(cw){return null}}function ri(e,t,n){if(!n)return Qs(ei(e,t));if(!t)return null;try{return ri(e,t)}catch(cw){return null}}function ai(e){for(var t=e.FullPaths||_s(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function si(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=ka?Ea(n):function(e){for(var t=[],n=0,r=e.length+250,a=Aa(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[n++]=i;else if(i<2048)a[n++]=192|i>>6&31,a[n++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[n++]=240|i>>8&7,a[n++]=128|i>>2&63,a[n++]=128|o>>6&15|(3&i)<<4,a[n++]=128|63&o}else a[n++]=224|i>>12&15,a[n++]=128|i>>6&63,a[n++]=128|63&i;n>r&&(t.push(a.slice(0,n)),n=0,a=Aa(65535),r=65530)}return t.push(a.slice(0,n)),Ra(t)}(n),Ts.utils.cfb_add(e,t,r);Ts.utils.cfb_add(e,t,n)}else e.file(t,n)}function ii(e,t){switch(t.type){case"base64":return Ts.read(e,{type:"base64"});case"binary":return Ts.read(e,{type:"binary"});case"buffer":case"array":return Ts.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function oi(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var a=r.shift();".."===a?n.pop():"."!==a&&n.push(a)}return n.join("/")}var li='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ci=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ui=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,di=li.match(ui)?ui:/<[^>]*>/g,hi=/<\w*:/,fi=/<(\/?)\w+:/;function pi(e,t,n){for(var r={},a=0,s=0;a!==e.length&&(32!==(s=e.charCodeAt(a))&&10!==s&&13!==s);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var i=e.match(ci),o=0,l="",c=0,u="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&61!==d.charCodeAt(s);++s);for(u=d.slice(0,s).trim();32==d.charCodeAt(s+1);)++s;for(h=34==(a=d.charCodeAt(s+1))||39==a?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,n||(r[u.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[f]&&"ext"==u.slice(o-3,o))continue;r[f]=l,n||(r[f.toLowerCase()]=l)}}return r}function mi(e){return e.replace(fi,"<$1")}var gi={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vi=Ls(gi),bi=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var a=r+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,(function(e,t){return gi[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var i=a.indexOf("]]>");return n(a.slice(0,s))+a.slice(s+9,i)+n(a.slice(i+3))}}(),xi=/[&<>'"]/g;var yi=/[\u0000-\u001f]/g;function wi(e){return(e+"").replace(xi,(function(e){return vi[e]})).replace(/\n/g,"<br/>").replace(yi,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var ji=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function Ni(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Si(e){for(var t="",n=0,r=0,a=0,s=0,i=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(i=(31&r)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&s):(o=((7&r)<<18|(63&a)<<12|(63&s)<<6|63&(i=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Ci(e){var t,n,r,a=Aa(2*e.length),s=1,i=0,o=0;for(n=0;n<e.length;n+=s)s=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),s=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),s=3):(s=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function ki(e){return Ea(e,"binary").toString("utf8")}var Ei="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Ai=ka&&(ki(Ei)==Si(Ei)&&ki||Ci(Ei)==Si(Ei)&&Ci)||Si,Ti=ka?function(e){return Ea(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Pi=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),_i=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),Li=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Ri=/<\/?(?:vt:)?variant>/g,Di=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ii(e,t){var n=pi(e),r=e.match(Li(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach((function(e){var t=e.replace(Ri,"").match(Di);t&&a.push({v:Ai(t[2]),t:t[1]})})),a}var Oi=/(^\s|\s$|\n)/;function Fi(e){return _s(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Mi(e,t,n){return"<"+e+(null!=n?Fi(n):"")+(null!=t?(t.match(Oi)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Bi(e){if(ka&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Ai(_a(La(e)));throw new Error("Bad input format: expected Buffer or string")}var zi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Ui="http://schemas.openxmlformats.org/package/2006/content-types",qi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Vi=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Wi=ka?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Ea(e)}))):Vi(e)}:Vi,Hi=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(fo(e,a)));return r.join("").replace(Da,"")},Gi=ka?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Da,""):Hi(e,t,n)}:Hi,Yi=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},$i=ka?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Yi(e,t,n)}:Yi,Ki=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(ho(e,a)));return r.join("")},Ji=ka?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Ki(e,t,n)}:Ki,Xi=function(e,t){var n=mo(e,t);return n>0?Ji(e,t+4,t+4+n-1):""},Qi=Xi,Zi=function(e,t){var n=mo(e,t);return n>0?Ji(e,t+4,t+4+n-1):""},eo=Zi,to=function(e,t){var n=2*mo(e,t);return n>0?Ji(e,t+4,t+4+n-1):""},no=to,ro=function(e,t){var n=mo(e,t);return n>0?Gi(e,t+4,t+4+n):""},ao=ro,so=function(e,t){var n=mo(e,t);return n>0?Ji(e,t+4,t+4+n):""},io=so,oo=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},lo=oo,co=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function uo(){Gi=function(e,t,n){return xa.utils.decode(1200,e.slice(t,n)).replace(Da,"")},Ji=function(e,t,n){return xa.utils.decode(65001,e.slice(t,n))},Qi=function(e,t){var n=mo(e,t);return n>0?xa.utils.decode(da,e.slice(t+4,t+4+n-1)):""},eo=function(e,t){var n=mo(e,t);return n>0?xa.utils.decode(ua,e.slice(t+4,t+4+n-1)):""},no=function(e,t){var n=2*mo(e,t);return n>0?xa.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},ao=function(e,t){var n=mo(e,t);return n>0?xa.utils.decode(1200,e.slice(t+4,t+4+n)):""},io=function(e,t){var n=mo(e,t);return n>0?xa.utils.decode(65001,e.slice(t+4,t+4+n)):""}}ka&&(Qi=function(e,t){if(!Buffer.isBuffer(e))return Xi(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},eo=function(e,t){if(!Buffer.isBuffer(e))return Zi(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},no=function(e,t){if(!Buffer.isBuffer(e))return to(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},ao=function(e,t){if(!Buffer.isBuffer(e))return ro(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},io=function(e,t){if(!Buffer.isBuffer(e))return so(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},lo=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):oo(e,t)},co=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof xa&&uo();var ho=function(e,t){return e[t]},fo=function(e,t){return 256*e[t+1]+e[t]},po=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},mo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},go=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},vo=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function bo(e,t){var n,r,a,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,ka&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(fo(this,o)),o+=2;e*=2;break;case"utf8":l=Ji(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Gi(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof xa)return bo.call(this,e,"dbcs");l=xa.utils.decode(ua,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Qi(this,this.l),e=4+mo(this,this.l);break;case"lpstr-cp":l=eo(this,this.l),e=4+mo(this,this.l);break;case"lpwstr":l=no(this,this.l),e=4+2*mo(this,this.l);break;case"lpp4":e=4+mo(this,this.l),l=ao(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+mo(this,this.l),l=io(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=ho(this,this.l+e++));)c.push(wa(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=fo(this,this.l+e));)c.push(wa(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=ho(this,o),this.l=o+1,s=bo.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(wa(fo(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof xa){l=xa.utils.decode(ua,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=ho(this,o),this.l=o+1,s=bo.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(wa(ho(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=ho(this,this.l),this.l++,n;case 2:return n=("i"===t?po:fo)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?go:vo)(this,this.l),this.l+=4,n):(r=mo(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?lo(this,this.l):lo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=$i(this,this.l,e)}}return this.l+=e,l}var xo=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},yo=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},wo=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function jo(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)wo(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof xa&&874==da)for(a=0;a!=t.length;++a){var s=xa.utils.encode(da,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,xo(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=r?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[n+o]=255&s;e[n+6]=(15&a)<<4|15&s,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,yo(this,t,this.l)}}return this.l+=r,this}function No(e,t){var n=$i(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function So(e,t){e.l=t,e.read_shift=bo,e.chk=No,e.write_shift=jo}function Co(e,t){e.l+=t}function ko(e){var t=Aa(e);return So(t,0),t}function Eo(e,t,n){if(e){var r,a,s;So(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=Ih[o]||Ih[65535];for(s=127&(r=e.read_shift(1)),a=1;a<4&&128&r;++a)s+=(127&(r=e.read_shift(1)))<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,n);if(e.l=l,t(u,c,o))return}}}function Ao(){var e=[],t=ka?256:2048,n=function(e){var t=ko(e);return So(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},s=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(r=e).l&&(r.l=r.length),s(t)},end:function(){return a(),Ra(e)},_bufs:e}}function To(e,t,n){var r=Hs(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Po(e,t,n){var r=Hs(e);return r.s=To(r.s,t.s,n),r.e=To(r.e,t.s,n),r}function _o(e,t){if(e.cRel&&e.c<0)for(e=Hs(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Hs(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Mo(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function Lo(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?_o(e.s,t.biff)+":"+_o(e.e,t.biff):(e.s.rRel?"":"$")+Do(e.s.r)+":"+(e.e.rRel?"":"$")+Do(e.e.r):(e.s.cRel?"":"$")+Oo(e.s.c)+":"+(e.e.cRel?"":"$")+Oo(e.e.c)}function Ro(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Do(e){return""+(e+1)}function Io(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Oo(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Fo(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function Mo(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Bo(e){var t=e.indexOf(":");return-1==t?{s:Fo(e),e:Fo(e)}:{s:Fo(e.slice(0,t)),e:Fo(e.slice(t+1))}}function zo(e,t){return"undefined"===typeof t||"number"===typeof t?zo(e.s,e.e):("string"!==typeof e&&(e=Mo(e)),"string"!==typeof t&&(t=Mo(t)),e==t?e:e+":"+t)}function Uo(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,s=e.length;for(n=0;r<s&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<s&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=s&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function qo(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Ns(e.z,n?Ds(t):t)}catch(cw){}try{return e.w=Ns((e.XF||{}).numFmtId||(n?14:0),n?Ds(t):t)}catch(cw){return""+t}}function Vo(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?gl[e.v]||e.v:qo(e,void 0==t?e.v:t))}function Wo(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function Ho(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var s=e||(a?[]:{}),i=0,o=0;if(s&&null!=r.origin){if("number"==typeof r.origin)i=r.origin;else{var l="string"==typeof r.origin?Fo(r.origin):r.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Uo(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==i&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},p=i+d,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||Ha[14],r.cellDates?(f.t="d",f.w=Ns(f.z,Ds(f.v))):(f.t="n",f.v=Ds(f.v),f.w=Ns(f.z,f.v))):f.t="s";else f=t[d][h];if(a)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(f.z=s[p][m].z),s[p][m]=f;else{var g=Mo({c:m,r:p});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=zo(c)),s}function Go(e,t){return Ho(null,e,t)}function Yo(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function $o(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ko(e,t){var n=e.l,r=e.read_shift(1),a=Yo(e),s=[],i={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push($o(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=n+t,i}var Jo=Ko;function Xo(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Qo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Zo=Yo;function el(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var tl=Yo,nl=el;function rl(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?lo([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):go(t,0)>>2;return n?a/100:a}function al(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var sl=al;function il(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ol(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var ll=80,cl=[ll,81],ul={1:{n:"CodePage",t:2},2:{n:"Category",t:ll},3:{n:"PresentationFormat",t:ll},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:ll},15:{n:"Company",t:ll},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:ll},27:{n:"ContentStatus",t:ll},28:{n:"Language",t:ll},29:{n:"Version",t:ll},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},dl={1:{n:"CodePage",t:2},2:{n:"Title",t:ll},3:{n:"Subject",t:ll},4:{n:"Author",t:ll},5:{n:"Keywords",t:ll},6:{n:"Comments",t:ll},7:{n:"Template",t:ll},8:{n:"LastAuthor",t:ll},9:{n:"RevNumber",t:ll},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:ll},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},hl={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fl=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pl(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var ml=Hs(pl([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),gl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vl={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},bl={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var xl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function yl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function wl(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(di)||[]).forEach((function(e){var a=pi(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var i="External"===a.TargetMode?a.Target:oi(a.Target,t);n[i]=s,r[a.Id]=s}})),n["!id"]=r,n}var jl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Nl=function(){for(var e=new Array(jl.length),t=0;t<jl.length;++t){var n=jl[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function Sl(e){var t={};e=Ai(e);for(var n=0;n<jl.length;++n){var r=jl[n],a=e.match(Nl[n]);null!=a&&a.length>0&&(t[r[1]]=bi(a[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=Vs(t[r[1]]))}return t}var Cl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function kl(e,t,n,r){var a=[];if("string"==typeof e)a=Ii(e,r);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map((function(e){return{v:e}})));var i="string"==typeof t?Ii(t,r).map((function(e){return e.v})):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=l,n.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=i.slice(o,o+l)}o+=l}}var El=/<[^>]+>[^<]*/g;var Al,Tl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Pl(e,t,n){Al||(Al=Ls(Tl)),e[t=Al[t]||t]=n}function _l(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Ll(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function Rl(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function Dl(e,t,n){return 31===t?Rl(e):Ll(e,0,n)}function Il(e,t,n){return Dl(e,t,!1===n?0:4)}function Ol(e){var t=e.l,n=Bl(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,Bl(e,3)]}function Fl(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var s=e.read_shift(4),i=e.read_shift(4);r[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(Da,"").replace(Ia,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Ml(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function Bl(e,t,n){var r,a=e.read_shift(2),s=n||{};if(e.l+=2,12!==t&&a!==t&&-1===cl.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return r=e.read_shift(2,"i"),s.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return Ll(e,0,4).replace(Da,"");case 31:return Rl(e);case 64:return _l(e);case 65:return Ml(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Il(e,a,!s.raw).replace(Da,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Dl(e,t,0)}(e,a).replace(Da,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(Ol(e));return n}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(Da,""),e.l-a&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(Da,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function zl(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),d=e.read_shift(4);s[i]=[u,d+n]}s.sort((function(e,t){return e[1]-t[1]}));var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var f=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],f=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(f=!1,e.l=s[i][1]),f)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(h[p.n]=Bl(e,p.t,{raw:!0}),"version"===p.p&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(65535&h[p.n])).slice(-4)),"CodePage"==p.n)switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ma(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(1===s[i][0]){if(o=h.CodePage=Bl(e,2),ma(o),-1!==l){var m=e.l;e.l=s[l][1],c=Fl(e,o),e.l=m}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=Fl(e,o)}else{var g,v=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=Ml(e);break;case 30:case 31:e.l+=4,g=Il(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Vl(e,4);break;case 64:e.l+=4,g=Vs(_l(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=g}}return e.l=n+r,h}function Ul(e,t,n){var r=e.content;if(!r)return{};So(r,0);var a,s,i,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),u=r.read_shift(16);if(u!==Ts.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=r.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),o=r.read_shift(4),1===a&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===a&&(i=r.read_shift(16),l=r.read_shift(4));var d,h=zl(r,t),f={SystemIdentifier:c};for(var p in h)f[p]=h[p];if(f.FMTID=s,1===a)return f;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{d=zl(r,null)}catch(cw){}for(p in d)f[p]=d[p];return f.FMTID=[s,i],f}function ql(e,t){return e.read_shift(t),null}function Vl(e,t){return 1===e.read_shift(t)}function Wl(e){return e.read_shift(2,"u")}function Hl(e,t){return function(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}(e,t,Wl)}function Gl(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",s=ua;(n&&n.biff>=8&&(ua=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var i=r?e.read_shift(r,a):"";return ua=s,i}function Yl(e){var t=ua;ua=1200;var n,r=e.read_shift(2),a=e.read_shift(1),s=4&a,i=8&a,o=1+(1&a),l=0,c={};i&&(l=e.read_shift(2)),s&&(n=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,u);return i&&(e.l+=4*l),s&&(e.l+=n),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),ua=t,c}function $l(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Kl(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):$l(e,r,n)}function Jl(e,t,n){if(n.biff>5)return Kl(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Xl(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Da,"");return r&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(a>>1,"utf16le").replace(Da,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function Ql(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Da,""):""}function Zl(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function ec(e,t){var n=Zl(e);return n[3]=0,n}function tc(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function nc(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function rc(e){return[e.read_shift(2),rl(e)]}function ac(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function sc(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var ic=sc;function oc(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function lc(e){e.l+=2,e.l+=e.read_shift(2)}var cc={0:lc,4:lc,5:lc,6:lc,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:lc,9:lc,10:lc,11:lc,12:lc,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:lc,15:lc,16:lc,17:lc,18:lc,19:lc,20:lc,21:oc};function uc(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function dc(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var a=e.read_shift(2);return n&&2==n.biff&&(r=1-(a>>15),a&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},a]}var hc=Jl;function fc(e,t,n){var r=e.l+t,a=8!=n.biff&&n.biff?2:4,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:s,c:o},e:{r:i,c:l}}}function pc(e,t,n){var r=tc(e);2!=n.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=a,r.t=!0===a||!1===a?"b":"e",r}var mc=function(e,t,n){return 0===t?"":Jl(e,0,n)};function gc(e,t,n){var r,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=Gl(e,0,n),s=e.read_shift(2);if(s!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,a}(e,t-2,n)),s.body=r||e.read_shift(t-2),"string"===typeof r&&(s.Name=r),s}var vc=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function bc(e,t,n){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(n&&2==n.biff?1:2),l=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),l=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var c=$l(e,i,n);32&a&&(c=vc[c.charCodeAt(0)]);var u=r-e.l;n&&2==n.biff&&--u;var d=r!=e.l&&0!==o&&u>0?function(e,t,n,r){var a,s=e.l+t,i=id(e,r,n);s!==e.l&&(a=sd(e,s-e.l,i,n));return[i,a]}(e,u,n,o):[];return{chKey:s,Name:c,itab:l,rgce:d}}function xc(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Gl(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,s=e.read_shift(n.biff>8?4:2);0!==s--;)r.push(nc(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function yc(e,t,n){var r=ic(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,hd(e,t,n)]}var wc={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function jc(e,t,n){if(!n.cellStyles)return Co(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),s=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var Nc=tc,Sc=Hl,Cc=Kl;var kc=[2,3,48,49,131,139,140,245],Ec=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ls({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=Go(function(t,n){var r=[],a=Aa(1);switch(n.type){case"base64":a=Pa(Ca(t));break;case"binary":a=Pa(t);break;case"buffer":case"array":a=t}So(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,u=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(u=a.read_shift(2));var d=a.read_shift(2),h=n.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],p={},m=Math.min(a.length,2==s?521:u-10-(o?264:0)),g=l?32:11;a.l<m&&13!=a[a.l];)switch((p={}).name=xa.utils.decode(h,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,p.type=String.fromCharCode(a.read_shift(1)),2==s||l||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==s&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=s&&(a.l+=l?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,b=0;for(r[0]=[],b=0;b!=f.length;++b)r[0][b]=f[b].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],b=0,b=0;b!=f.length;++b){var x=a.slice(a.l,a.l+f[b].len);a.l+=f[b].len,So(x,0);var y=xa.utils.decode(h,x);switch(f[b].type){case"C":y.trim().length&&(r[v][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?r[v][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):r[v][b]=y;break;case"F":r[v][b]=parseFloat(y.trim());break;case"+":case"I":r[v][b]=l?2147483648^x.read_shift(-4,"i"):x.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":r[v][b]=!0;break;case"N":case"F":r[v][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));r[v][b]="##MEMO##"+(l?parseInt(y.trim(),10):x.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(r[v][b]=+y||0);break;case"@":r[v][b]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":r[v][b]=new Date(864e5*(x.read_shift(4)-2440588)+x.read_shift(4));break;case"Y":r[v][b]=x.read_shift(4,"i")/1e4+x.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][b]=-x.read_shift(-8,"f");break;case"B":if(o&&8==f[b].len){r[v][b]=x.read_shift(8,"f");break}case"G":case"P":x.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else a.l+=d;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return a["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Wo(n(e,t),t)}catch(cw){if(t&&t.WTF)throw cw}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&ma(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var s=Ao(),i=Pf(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,f=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++h;else if(null!=o[u]){if(++h,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(d=0;d<1024;++d)if(-1==o.indexOf(o[u]+"_"+d)){o[u]+="_"+d;break}}var p=Uo(e["!ref"]),m=[],g=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var b="",x="",y=0,w=[];for(d=0;d<l.length;++d)null!=l[d][u]&&w.push(l[d][u]);if(0!=w.length&&null!=o[u]){for(d=0;d<w.length;++d){switch(typeof w[d]){case"number":x="B";break;case"string":default:x="C";break;case"boolean":x="L";break;case"object":x=w[d]instanceof Date?"D":"C"}y=Math.max(y,String(w[d]).length),b=b&&b!=x?"C":x}y>250&&(y=250),"C"==(x=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>y&&(y=c[u].DBF.len),"B"==b&&"N"==x&&(b="N",v[u]=c[u].DBF.dec,y=c[u].DBF.len),g[u]="C"==b||"N"==x?y:r[b]||0,f+=g[u],m[u]=b}else m[u]="?"}var j=s.next(32);for(j.write_shift(4,318902576),j.write_shift(4,l.length),j.write_shift(2,296+32*h),j.write_shift(2,f),u=0;u<4;++u)j.write_shift(4,0);for(j.write_shift(4,(+t[da]||3)<<8),u=0,d=0;u<o.length;++u)if(null!=o[u]){var N=s.next(32),S=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,S,"sbcs"),N.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),N.write_shift(4,d),N.write_shift(1,g[u]||r[m[u]]||0),N.write_shift(1,v[u]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),d+=g[u]||r[m[u]]||0}var C=s.next(264);for(C.write_shift(4,13),u=0;u<65;++u)C.write_shift(4,0);for(u=0;u<l.length;++u){var k=s.next(f);for(k.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(m[d]){case"L":k.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":k.write_shift(8,l[u][d]||0,"f");break;case"N":var E="0";for("number"==typeof l[u][d]&&(E=l[u][d].toFixed(v[d]||0)),h=0;h<g[d]-E.length;++h)k.write_shift(1,32);k.write_shift(1,E,"sbcs");break;case"D":l[u][d]?(k.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),k.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),k.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):k.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[u][d]?l[u][d]:"").slice(0,g[d]);for(k.write_shift(1,A,"sbcs"),h=0;h<g[d]-A.length;++h)k.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Ac=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+_s(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?ja(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:ja(r)};function a(e,a){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,d=[],h=[],f=null,p={},m=[],g=[],v=[],b=0;for(+a.codepage>=0&&ma(+a.codepage);c!==i.length;++c){b=0;var x,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),w=y.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),j=w[0];if(y.length>0)switch(j){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var N=!1,S=!1,C=!1,k=!1,E=-1,A=-1;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[u].slice(1))-1,S=!0;break;case"Y":for(o=parseInt(w[u].slice(1))-1,S||(l=0),s=d.length;s<=o;++s)d[s]=[];break;case"K":'"'===(x=w[u].slice(1)).charAt(0)?x=x.slice(1,x.length-1):"TRUE"===x?x=!0:"FALSE"===x?x=!1:isNaN(Ys(x))?isNaN(Ks(x).getDate())||(x=Vs(x)):(x=Ys(x),null!==f&&xs(f)&&(x=Ms(x))),"undefined"!==typeof xa&&"string"==typeof x&&"string"!=(a||{}).type&&(a||{}).codepage&&(x=xa.utils.decode(a.codepage,x)),N=!0;break;case"E":k=!0;var T=Du(w[u].slice(1),{r:o,c:l});d[o][l]=[d[o][l],T];break;case"S":C=!0,d[o][l]=[d[o][l],"S5S"];break;case"R":E=parseInt(w[u].slice(1))-1;break;case"C":A=parseInt(w[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}if(N&&(d[o][l]&&2==d[o][l].length?d[o][l][0]=x:d[o][l]=x,f=null),C){if(k)throw new Error("SYLK shared formula cannot have own formula");var P=E>-1&&d[E][A];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");d[o][l][1]=Fu(P[1],{r:o-E,c:l-A})}break;case"F":var _=0;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"X":l=parseInt(w[u].slice(1))-1,++_;break;case"Y":for(o=parseInt(w[u].slice(1))-1,s=d.length;s<=o;++s)d[s]=[];break;case"M":b=parseInt(w[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[u].slice(1))];break;case"W":for(v=w[u].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)b=parseInt(v[2],10),g[s-1]=0===b?{hidden:!0}:{wch:b},uu(g[s-1]);break;case"C":g[l=parseInt(w[u].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(w[u].slice(1))-1]||(m[o]={}),b>0?(m[o].hpt=b,m[o].hpx=fu(b)):0===b&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}_<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),[d,p]}function s(e,t){var n=function(e,t){switch(t.type){case"base64":return a(Ca(e),t);case"binary":return a(e,t);case"buffer":return a(ka&&Buffer.isBuffer(e)?e.toString("binary"):_a(e),t);case"array":return a(Ws(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],s=n[1],i=Go(r,t);return _s(s).forEach((function(e){i[e]=s[e]})),i}function i(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Ou(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Wo(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],s=[],o=Uo(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=su(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=iu(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*hu(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var h=Mo({r:u,c:d});(n=l?(e[u]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&s.push(i(n,0,u,d))}return a.join(c)+c+s.join(c)+c+"E"+c}}}(),Tc=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,s=0,i=[];s!==n.length;++s)if("BOT"!==n[s].trim()){if(!(r<0)){for(var o=n[s].trim().split(","),l=o[0],c=o[1],u=n[++s]||"";1&(u.match(/["]/g)||[]).length&&s<n.length-1;)u+="\n"+n[++s];switch(u=u.trim(),+l){case-1:if("BOT"===u){i[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?i[r][a]=!0:"FALSE"===u?i[r][a]=!1:isNaN(Ys(c))?isNaN(Ks(c).getDate())?i[r][a]=c:i[r][a]=Vs(c):i[r][a]=Ys(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),i[r][a++]=""!==u?u:null}if("EOD"===u)break}}else i[++r]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,n){return Go(function(t,n){switch(n.type){case"base64":return e(Ca(t),n);case"binary":return e(t,n);case"buffer":return e(ka&&Buffer.isBuffer(t)?t.toString("binary"):_a(t),n);case"array":return e(Ws(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],s=Uo(n["!ref"]),i=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,s.e.r-s.s.r+1,""),e(a,"TUPLES",0,s.e.c-s.s.c+1,""),e(a,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(a,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=Mo({r:o,c:l});if(r=i?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Ns(r.z||Ha[14],Ds(Vs(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,n){return Wo(t(e,n),n)},to_sheet:t,from_sheet:n}}(),Pc=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return Go(function(t,n){for(var r=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==r.length;++i){var l=r[i].trim().split(":");if("cell"===l[0]){var c=Fo(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,s=c.c,l[2]){case"t":o[a][s]=e(l[3]);break;case"v":o[a][s]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[a][s]=!!+l[4]:o[a][s]=+l[4],"vtf"==l[2]&&(o[a][s]=[o[a][s],u])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var n,r=[],a=[],s="",i=Bo(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=Mo({r:l,c:c}),(n=o?(e[l]||[])[c]:e[s])&&null!=n.v&&"z"!==n.t){switch(a=["cell",s,"t"],n.t){case"s":case"str":a.push(t(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=t(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=Ds(Vs(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||Ns(n.z||Ha[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return Wo(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,a,s,a,o(e),i].join("\n")}}}(),_c=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Ys(e))?isNaN(Ks(e).getDate())?t[n][r]=e:t[n][r]=Vs(e):t[n][r]=Ys(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in t&&(r[i]=(r[i]||0)+1);for(s in i=[],r)Object.prototype.hasOwnProperty.call(r,s)&&i.push([r[s],s]);if(!i.length)for(s in r=n)Object.prototype.hasOwnProperty.call(r,s)&&i.push([r[s],s]);return i.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[i.pop()[1]]||44}function a(e,t){var n=t||{},a="";var s=n.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,d=0,h=a.charCodeAt(0),f=!1,p=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?Ha[e]:e;return t=t.replace(Es,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(r.t="s",r.v=t):(r.t="n",r.f=t.slice(1));else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Ys(t)))if(!isNaN(Ks(t).getDate())||g&&t.match(g)){r.z=n.dateNF||Ha[14];var a=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(Es)||[]).forEach((function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:a=c}})),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==s?u:c+"T"+u}(0,n.dateNF,t.match(g)||[]),a=1),n.cellDates?(r.t="d",r.v=Vs(t,a)):(r.t="n",r.v=Ds(Vs(t,a))),!1!==n.cellText&&(r.w=Ns(r.z,r.v instanceof Date?Ds(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(s[o]||(s[o]=[]),s[o][l]=r):s[Mo({c:l,r:o})]=r),u=d+1,m=e.charCodeAt(u),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),p==h)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(p=e.charCodeAt(d)){case 34:34===m&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return d-u>0&&v(),s["!ref"]=zo(i),s}function s(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):Go(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){a[c]=[];var u=0;for(e(s[c].slice(0,o).trim(),a,c,u,r),u=1;u<=(s[c].length-o)/10+1;++u)e(s[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function i(e,t){var n="",r="string"==t.type?[0,0,0,0]:Cf(e,t);switch(t.type){case"base64":n=Ca(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof xa?xa.utils.decode(t.codepage,e):ka&&Buffer.isBuffer(e)?e.toString("binary"):_a(e);break;case"array":n=Ws(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Ai(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=Ai(n):"binary"==t.type&&"undefined"!==typeof xa&&t.codepage&&(n=xa.utils.decode(t.codepage,xa.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?Pc.to_sheet("string"==t.type?n:Ai(n),t):s(n,t)}return{to_workbook:function(e,t){return Wo(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,n=[],r=Uo(e["!ref"]),a=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){for(var i=[],o=r.s.c;o<=r.e.c;++o){var l=Mo({r:s,c:o});if((t=a?(e[s]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(Vo(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}n.push(i.join(""))}return n.join("\n")}}}();var Lc=function(){function e(e,t,n){if(e){So(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),s=r[a]||r[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,n);if(e.l=o,t(l,s,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Ha[14],r.cellDates&&(e[1].t="d",e[1].v=Ms(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=zo(d),l[s]=a,c.push(s),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[Mo(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Mo(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=b,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=zo(d),l[s]=a,c.push(s),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),h>0&&e[0].r>=h)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Mo(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(s=e[1])}}),r)}if(a["!ref"]=zo(d),l[i||s]=a,c.push(i||s),!u.length)return{SheetNames:c,Sheets:l};for(var f={},p=[],m=0;m<u.length;++m)l[c[m]]?(p.push(u[m]||c[m]),f[u[m]]=l[u[m]]||l[c[m]]):(p.push(u[m]),f[u[m]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].t="s",20768==r.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return r.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}function a(e,t,n){var r=ko(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var s=n.charCodeAt(a);r.write_shift(1,s>=128?95:s)}return r.write_shift(1,0),r}function s(e,t,n){var r=ko(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function i(e,t,n){var r=ko(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?Oo(t):Do(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var a=ko(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<r.length;++s){var i=r.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function h(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var i=32768&s;return s=(32767&s)-16446,n[1].v=(1-2*i)*(a*Math.pow(2,s+32)+r*Math.pow(2,s)),n}function f(e,t,n,r){var a=ko(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,i=0,o=0,l=0;return r<0&&(i=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,s=(r*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(i?32768:0),a.write_shift(2,o),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=ko(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Wl},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){So(e,0);var n=[],r=0,a="",s="",i="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(s+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";d=e[e.l++];)p+=String.fromCharCode(d);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),i=n.pop(),n.push(["AND","OR"][d-20]+"("+i+","+u+")");break;default:if(d<32&&c[d])u=n.pop(),i=n.pop(),n.push(i+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var m=n.slice(-r);n.length-=r,n.push(l[d][0]+"("+m.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&ma(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=Ao(),o=Uo(e["!ref"]),l=Array.isArray(e),c=[];Fh(r,0,function(e){var t=ko(2);return t.write_shift(2,e),t}(1030)),Fh(r,6,function(e){var t=ko(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),d=o.s.r;d<=u;++d)for(var h=Do(d),f=o.s.c;f<=o.e.c;++f){d===o.s.r&&(c[f]=Oo(f));var p=c[f]+h,m=l?(e[d]||[])[f]:e[p];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?Fh(r,13,s(d,f,m.v)):Fh(r,14,i(d,f,m.v));else Fh(r,15,a(d,f,Vo(m).slice(0,239)))}return Fh(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&ma(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=Ao();Fh(r,0,function(e){var t=ko(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var l=Bo(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&Fh(r,27,g(e.SheetNames[a],s++));var i=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=Uo(o["!ref"]),c=Array.isArray(o),u=[],h=Math.min(l.e.r,8191),p=l.s.r;p<=h;++p)for(var m=Do(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=Oo(v));var b=u[v]+m,x=c?(o[p]||[])[v]:o[b];if(x&&"z"!=x.t)if("n"==x.t)Fh(r,23,f(p,v,i,x.v));else Fh(r,22,d(p,v,i,Vo(x).slice(0,239)))}++i}}return Fh(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Pa(Ca(e)),n);case"binary":return t(Pa(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var Rc=function(){var e=Pi("t"),t=Pi("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var a={t:"s",v:bi(r[1])},s=n.match(t);return s&&(a.s=function(e){var t={},n=e.match(di),r=0,a=!1;if(n)for(;r!=n.length;++r){var s=pi(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=fa[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),a}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(a).map(n).filter((function(e){return e.v}))}}(),Dc=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),n.push("</"+a+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),Ic=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Oc=/<(?:\w+:)?r>/,Fc=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Mc(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=bi(Ai(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Ai(e),n&&(r.h=wi(r.t))):e.match(Oc)&&(r.r=Ai(e),r.t=bi(Ai((e.replace(Fc,"").match(Ic)||[]).join("").replace(di,""))),n&&(r.h=Dc(Rc(r.r)))),r):{t:""}}var Bc=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,zc=/<(?:\w+:)?(?:si|sstItem)>/g,Uc=/<\/(?:\w+:)?(?:si|sstItem)>/;function qc(e){if("undefined"!==typeof xa)return xa.utils.encode(da,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Vc(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function Wc(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function Hc(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Vc(e,4),t.U=Vc(e,4),t.W=Vc(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function Gc(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=36==r.Flags;break;case 26625:a=4==r.Flags;break;case 0:a=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function Yc(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function $c(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Gc(e,t),v:Yc(e,e.length-e.l)}}function Kc(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Jc(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(di,(function(e){var n=pi(e);switch(mi(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){r[e]=n[e]}));break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}})),r}function Xc(e){var t,n,r=0,a=qc(e),s=a.length+1;for((t=Aa(s))[0]=a.length,n=1;n!=s;++n)t[n]=a[n-1];for(n=s-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var Qc=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(a){for(var s,i,o,l=qc(a),c=function(e){for(var r=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(r^=n[a]),i*=2,--a;return r}(l),u=l.length,d=Aa(16),h=0;16!=h;++h)d[h]=0;for(1===(1&u)&&(s=c>>8,d[u]=r(e[0],s),--u,s=255&c,i=l[l.length-1],d[u]=r(i,s));u>0;)s=c>>8,d[--u]=r(l[u],s),s=255&c,d[--u]=r(l[u],s);for(u=15,o=15-l.length;o>0;)s=c>>8,d[u]=r(e[o],s),--o,s=255&c,d[--u]=r(l[u],s),--u,--o;return d}}(),Zc=function(e){var t=0,n=Qc(e);return function(e){var r=function(e,t,n,r,a){var s,i;for(a||(a=t),r||(r=Qc(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=r[n])>>5|i<<3),a[s]=i,++n;return[a,n,r]}("",e,t,n);return t=r[1],r[0]}};function eu(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=Vc(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=Vc(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=Gc(e,a),t-=a,n.EncryptionVerifier=Yc(e,t),n}(e,t),r}var tu=function(){function e(e,n){switch(n.type){case"base64":return t(Ca(e),n);case"binary":return t(e,n);case"buffer":return t(ka&&Buffer.isBuffer(e)?e.toString("binary"):_a(e),n);case"array":return t(Ws(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,s=/\\\w+\b/g,i=0,o=-1;r=s.exec(e);){if("\\cell"===r[0]){var l=e.slice(i,s.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[Mo({r:t,c:o})]=c}}i=s.lastIndex}o>a.e.c&&(a.e.c=o)})),n["!ref"]=zo(a),n}return{to_workbook:function(t,n){return Wo(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=Uo(e["!ref"]),a=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){n.push("\\trowd\\trautofit1");for(var i=r.s.c;i<=r.e.c;++i)n.push("\\cellx"+(i+1));for(n.push("\\pard\\intbl"),i=r.s.c;i<=r.e.c;++i){var o=Mo({r:s,c:i});(t=a?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(Vo(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function nu(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function ru(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),s=Math.min(t,n,r),i=a-s;if(0===i)return[0,0,t];var o,l=0,c=a+s;switch(o=i/(c>1?2-c:c),a){case t:l=((n-r)/i+6)%6;break;case n:l=(r-t)/i+2;break;case r:l=(t-n)/i+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),nu(function(e){var t,n=e[0],r=e[1],a=e[2],s=2*r*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*n;if(0!==r)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(n))}var au=6;function su(e){return Math.floor((e+Math.round(128/au)/256)*au)}function iu(e){return Math.floor((e-5)/au*100+.5)/100}function ou(e){return Math.round((e*au+5)/au*256)/256}function lu(e){return ou(iu(su(e)))}function cu(e){var t=Math.abs(e-lu(e)),n=au;if(t>.005)for(au=1;au<15;++au)Math.abs(e-lu(e))<=t&&(t=Math.abs(e-lu(e)),n=au);au=n}function uu(e){e.width?(e.wpx=su(e.width),e.wch=iu(e.wpx),e.MDW=au):e.wpx?(e.wch=iu(e.wpx),e.width=ou(e.wch),e.MDW=au):"number"==typeof e.wch&&(e.width=ou(e.wch),e.wpx=su(e.width),e.MDW=au),e.customWidth&&delete e.customWidth}var du=96;function hu(e){return 96*e/du}function fu(e){return e*du/96}var pu={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var mu=["numFmtId","fillId","fontId","borderId","xfId"],gu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var vu=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=_s(Ha),a=0;a<r.length;++a)t.NumberFmt[r[a]]=Ha[r[a]];var s=e[0].match(di);if(s)for(a=0;a<s.length;++a){var i=pi(s[a]);switch(mi(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=bi(Ai(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}Ss(o,l)}break;default:if(n.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=s.match(r))&&function(e,t,n,r){t.Fonts=[];var a={},s=!1;(e[0].match(di)||[]).forEach((function(e){var i=pi(e);switch(mi(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=Ai(i.val));break;case"<b":a.bold=i.val?Ni(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?Ni(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?Ni(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?Ni(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?Ni(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?Ni(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?Ni(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=fa[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=Ni(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var o=ml[a.color.index];81==a.color.index&&(o=ml[1]),o||(o=ml[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=ru(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}}))}(l,c,i,o),(l=s.match(n))&&function(e,t,n,r){t.Fills=[];var a={},s=!1;(e[0].match(di)||[]).forEach((function(e){var n=pi(e);switch(mi(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":n.patternType&&(a.patternType=n.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),n.indexed&&(a.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(a.bgColor.theme=parseInt(n.theme,10)),n.tint&&(a.bgColor.tint=parseFloat(n.tint)),n.rgb&&(a.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),n.theme&&(a.fgColor.theme=parseInt(n.theme,10)),n.tint&&(a.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(a.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+n[0]+" in fills")}}))}(l,c,0,o),(l=s.match(a))&&function(e,t,n,r){t.Borders=[];var a={},s=!1;(e[0].match(di)||[]).forEach((function(e){var n=pi(e);switch(mi(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},n.diagonalUp&&(a.diagonalUp=Ni(n.diagonalUp)),n.diagonalDown&&(a.diagonalDown=Ni(n.diagonalDown)),t.Borders.push(a);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+n[0]+" in borders")}}))}(l,c,0,o),(l=s.match(t))&&function(e,t,n){var r;t.CellXf=[];var a=!1;(e[0].match(di)||[]).forEach((function(e){var s=pi(e),i=0;switch(mi(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=s)[0],i=0;i<mu.length;++i)r[mu[i]]&&(r[mu[i]]=parseInt(r[mu[i]],10));for(i=0;i<gu.length;++i)r[gu[i]]&&(r[gu[i]]=Ni(r[gu[i]]));if(t.NumberFmt&&r.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[i]){r.numFmtId=i;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=Ni(s.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}}))}(l,c,o),c):c}}();var bu=Co;var xu=Co;var yu=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wu(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(di)||[]).forEach((function(e){var a=pi(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=a.val;break;case"<a:sysClr":r.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[yu.indexOf(a[0])]=r,r={}):r.name=a[0].slice(3,a[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function ju(){}function Nu(){}var Su=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Cu=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ku=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Eu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Au(e,t){var n;e&&0!==e.length||(e=Tu());var r={};if(!(n=e.match(Eu)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",Su,wu],["fontScheme",Cu,ju],["fmtScheme",ku,Nu]].forEach((function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)}))}(n[0],r,t),r.raw=e,r}function Tu(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[li];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function Pu(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Co(e,t)}(e,4);break;case 2:t.xclrValue=Zl(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function _u(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=Pu(e);break;case 6:r[1]=function(e,t){return Co(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function Lu(e,t,n,r){var a,s=Array.isArray(e);t.forEach((function(t){var i=Fo(t.ref);if(s?(e[i.r]||(e[i.r]=[]),a=e[i.r][i.c]):a=e[t.ref],!a){a={t:"z"},s?e[i.r][i.c]=a:e[t.ref]=a;var o=Uo(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=zo(o);l!==e["!ref"]&&(e["!ref"]=l)}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:n};t.h&&(c.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!n&&a.c[u].T)return;n&&!a.c[u].T&&a.c.splice(u,1)}if(n&&r)for(u=0;u<r.length;++u)if(c.a==r[u].id){c.a=r[u].name||c.a;break}a.c.push(c)}))}var Ru=Yo;var Du=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var s=!1,i=!1;0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,n+(s?"":"$")+Oo(l)+(i?"":"$")+Do(o)}return function(r,a){return t=a,r.replace(e,n)}}(),Iu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ou=function(){return function(e,t){return e.replace(Iu,(function(e,n,r,a,s,i){var o=Io(a)-(r?0:t.c),l=Ro(i)-(s?0:t.r);return n+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")}))}}();function Fu(e,t){return e.replace(Iu,(function(e,n,r,a,s,i){return n+("$"==r?r+a:Oo(Io(a)+t.c))+("$"==s?s+i:Do(Ro(i)+t.r))}))}function Mu(e,t,n){var r=Bo(t).s,a=Fo(n);return Fu(e,{r:a.r-r.r,c:a.c-r.c})}function Bu(e){return e.replace(/_xlfn\./g,"")}function zu(e){e.l+=1}function Uu(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function qu(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Vu(e);12==n.biff&&(r=4)}var a=e.read_shift(r),s=e.read_shift(r),i=Uu(e,2),o=Uu(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Vu(e){var t=Uu(e,2),n=Uu(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function Wu(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=Uu(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=Uu(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function Hu(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function Gu(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Yu(e){return[e.read_shift(1),e.read_shift(1)]}function $u(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Vl(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=gl[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=il(e);break;case 2:n[1]=Jl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Ku(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],s=0;s!=r;++s)a.push((12==n.biff?sl:ac)(e,8));return a}function Ju(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var s=0,i=[];s!=r&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=$u(e,n.biff);return i}function Xu(e,t,n){return e.l+=2,[Hu(e)]}function Qu(e){return e.l+=6,[]}function Zu(e){return e.l+=2,[Wl(e),1&e.read_shift(2)]}var ed=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var td={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:Co},3:{n:"PtgAdd",f:zu},4:{n:"PtgSub",f:zu},5:{n:"PtgMul",f:zu},6:{n:"PtgDiv",f:zu},7:{n:"PtgPower",f:zu},8:{n:"PtgConcat",f:zu},9:{n:"PtgLt",f:zu},10:{n:"PtgLe",f:zu},11:{n:"PtgEq",f:zu},12:{n:"PtgGe",f:zu},13:{n:"PtgGt",f:zu},14:{n:"PtgNe",f:zu},15:{n:"PtgIsect",f:zu},16:{n:"PtgUnion",f:zu},17:{n:"PtgRange",f:zu},18:{n:"PtgUplus",f:zu},19:{n:"PtgUminus",f:zu},20:{n:"PtgPercent",f:zu},21:{n:"PtgParen",f:zu},22:{n:"PtgMissArg",f:zu},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Gl(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,gl[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,il(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[jd[a],wd[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),s=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?wd:yd)[s[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,s=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,s]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,Wu(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,qu(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:Co},40:{n:"PtgMemNoMem",f:Co},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return Vu(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),s=Uu(e,2),i=Uu(e,2);return{s:{r:r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,Wu(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,qu(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[r,a]}},255:{}},nd={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rd={1:{n:"PtgElfLel",f:Zu},2:{n:"PtgElfRw",f:Xu},3:{n:"PtgElfCol",f:Xu},6:{n:"PtgElfRwV",f:Xu},7:{n:"PtgElfColV",f:Xu},10:{n:"PtgElfRadical",f:Xu},11:{n:"PtgElfRadicalS",f:Qu},13:{n:"PtgElfColS",f:Qu},15:{n:"PtgElfColSV",f:Qu},16:{n:"PtgElfRadicalLel",f:Zu},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&n,rt:ed[n>>2&31],idx:r,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},ad={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],s=0;s<=r;++s)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Gu},33:{n:"PtgAttrBaxcel",f:Gu},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Yu(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Yu(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function sd(e,t,n,r){if(r.biff<8)return Co(e,t);for(var a=e.l+t,s=[],i=0;i!==n.length;++i)switch(n[i][0]){case"PtgArray":n[i][1]=Ju(e,0,r),s.push(n[i][1]);break;case"PtgMemArea":n[i][2]=Ku(e,n[i][1],r),s.push(n[i][2]);break;case"PtgExp":r&&12==r.biff&&(n[i][1][1]=e.read_shift(4),s.push(n[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[i][0]}return 0!==(t=a-e.l)&&s.push(Co(e,t)),s}function id(e,t,n){for(var r,a,s=e.l+t,i=[];s!=e.l;)t=s-e.l,a=e[e.l],r=td[a]||td[nd[a]],24!==a&&25!==a||(r=(24===a?rd:ad)[e[e.l+1]]),r&&r.f?i.push([r.n,r.f(e,t,n)]):Co(e,t);return i}function od(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],s=0;s<r.length;++s){var i=r[s];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var ld={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cd(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function ud(e,t,n){var r=cd(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function dd(e,t,n,r,a){var s,i,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,b=e[0].length;v<b;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=d.pop(),i=d.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Gs(" ",e[0][m][1][1]);break;case 1:g=Gs("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}i+=g,m=-1}d.push(i+ld[x[0]]+s);break;case"PtgIsect":s=d.pop(),i=d.pop(),d.push(i+" "+s);break;case"PtgUnion":s=d.pop(),i=d.pop(),d.push(i+","+s);break;case"PtgRange":s=d.pop(),i=d.pop(),d.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=To(x[1][1],u,a),d.push(_o(o,c));break;case"PtgRefN":o=n?To(x[1][1],n,a):x[1][1],d.push(_o(o,c));break;case"PtgRef3d":h=x[1][1],o=To(x[1][2],u,a);p=ud(r,h,a);d.push(p+"!"+_o(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=x[1][0],w=x[1][1];y||(y=0);var j=0==(y&=127)?[]:d.slice(-y);d.length-=y,"User"===w&&(w=j.shift()),d.push(w+"("+j.join(",")+")");break;case"PtgBool":d.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(x[1]);break;case"PtgNum":d.push(String(x[1]));break;case"PtgStr":d.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Po(x[1][1],n?{s:n}:u,a),d.push(Lo(l,a));break;case"PtgArea":l=Po(x[1][1],u,a),d.push(Lo(l,a));break;case"PtgArea3d":h=x[1][1],l=x[1][2],p=ud(r,h,a),d.push(p+"!"+Lo(l,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=x[1][2];var N=(r.names||[])[f-1]||(r[0]||[])[f],S=N?N.Name:"SH33TJSNAME"+String(f);S&&"_xlfn."==S.slice(0,6)&&!a.xlfn&&(S=S.slice(6)),d.push(S);break;case"PtgNameX":var C,k=x[1][1];if(f=x[1][2],!(a.biff<=5)){var E="";if(14849==((r[k]||[])[0]||[])[0]||(1025==((r[k]||[])[0]||[])[0]?r[k][f]&&r[k][f].itab>0&&(E=r.SheetNames[r[k][f].itab-1]+"!"):E=r.SheetNames[f-1]+"!"),r[k]&&r[k][f])E+=r[k][f].Name;else if(r[0]&&r[0][f])E+=r[0][f].Name;else{var A=(cd(r,k,a)||"").split(";;");A[f-1]?E=A[f-1]:E+="SH33TJSERRX"}d.push(E);break}k<0&&(k=-k),r[k]&&(C=r[k][f]),C||(C={Name:"SH33TJSERRY"}),d.push(C.Name);break;case"PtgParen":var T="(",P=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:T=Gs(" ",e[0][m][1][1])+T;break;case 3:T=Gs("\r",e[0][m][1][1])+T;break;case 4:P=Gs(" ",e[0][m][1][1])+P;break;case 5:P=Gs("\r",e[0][m][1][1])+P;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}d.push(T+d.pop()+P);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:x[1][1],r:x[1][0]};var _={c:n.c,r:n.r};if(r.sharedf[Mo(o)]){var L=r.sharedf[Mo(o)];d.push(dd(L,u,_,r,a))}else{var R=!1;for(s=0;s!=r.arrayf.length;++s)if(i=r.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){d.push(dd(i[1],u,_,r,a)),R=!0;break}R||d.push(x[1])}break;case"PtgArray":d.push("{"+od(x[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(x))}if(3!=a.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var D=!0;switch((x=e[0][m])[1][0]){case 4:D=!1;case 0:g=Gs(" ",x[1][1]);break;case 5:D=!1;case 1:g=Gs("\r",x[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}d.push((D?g:"")+d.pop()+(D?"":g)),m=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function hd(e,t,n){var r,a=e.l+t,s=2==n.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Co(e,t-2)];var o=id(e,i,n);return t!==i+s&&(r=sd(e,t-i-s,o,n)),e.l=a,[o,r]}function fd(e,t,n){var r,a=e.l+t,s=e.read_shift(2),i=id(e,s,n);return 65535==s?[[],Co(e,t-2)]:(t!==s+2&&(r=sd(e,a-s-2,i,n)),[i,r])}function pd(e,t,n){var r=e.l+t,a=tc(e);2==n.biff&&++e.l;var s=function(e){var t;if(65535!==fo(e,e.l+6))return[il(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=function(e,t,n){var r,a=e.l+t,s=2==n.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Co(e,t-2)];var o=id(e,i,n);return t!==i+s&&(r=sd(e,t-i-s,o,n)),e.l=a,[o,r]}(e,r-e.l,n);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function md(e,t,n){var r=e.read_shift(4),a=id(e,r,n),s=e.read_shift(4);return[a,s>0?sd(e,s,a,n):null]}var gd=md,vd=md,bd=md,xd=md,yd={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wd={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jd={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Nd(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Sd(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Cd={},kd={};function Ed(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function Ad(e,t,n,r,a,s){try{r.cellNF&&(e.z=Ha[t])}catch(cw){if(r.WTF)throw cw}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Vs(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==Ha[t]&&Ss(ks[t]||"General",t),"e"===e.t)e.w=e.w||gl[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=ts(e.v);else if("d"===e.t){var i=Ds(e.v);e.w=(0|i)===i?i.toString(10):ts(i)}else{if(void 0===e.v)return"";e.w=ns(e.v,kd)}else"d"===e.t?e.w=Ns(t,Ds(e.v),kd):e.w=Ns(t,e.v,kd)}catch(cw){if(r.WTF)throw cw}if(r.cellStyles&&null!=n)try{e.s=s.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ru(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ru(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(cw){if(r.WTF&&s.Fills)throw cw}}}var Td=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Pd=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_d=/<(?:\w:)?hyperlink [^>]*>/gm,Ld=/"(\w*:\w*)"/,Rd=/<(?:\w:)?col\b[^>]*[\/]?>/g,Dd=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Id=/<(?:\w:)?pageMargins[^>]*\/>/g,Od=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Fd=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Md=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bd(e,t,n,r,a,s,i){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(Pd);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(Od);h?zd(h[0],o,a,n):(h=c.match(Fd))&&function(e,t,n,r,a){zd(e.slice(0,e.indexOf(">")),n,r,a)}(h[0],h[1],o,a,n);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=c.slice(f,f+50).match(Ld);p&&function(e,t){var n=Uo(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=zo(n))}(o,p[1])}var m=c.match(Md);m&&m[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Ud)||[]).forEach((function(e,n){var r=pi(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),Ni(r.rightToLeft)&&(t.Views[n].RTL=!0)}))}(m[1],a);var g=[];if(t.cellStyles){var v=c.match(Rd);v&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=pi(t[r],!0);a.hidden&&(a.hidden=Ni(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,cu(a.width)),uu(a);s<=i;)e[s++]=Hs(a)}}(g,v)}d&&qd(d[1],o,t,l,s,i);var b=u.match(Dd);b&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(b[0]));var x=[],y=u.match(Td);if(y)for(f=0;f!=y.length;++f)x[f]=Uo(y[f].slice(y[f].indexOf('"')+1));var w=u.match(_d);w&&function(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var s=pi(Ai(t[a]),!0);if(!s.ref)return;var i=((n||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+bi(s.location))):(s.Target="#"+bi(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Uo(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Mo({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}(o,w,r);var j=u.match(Id);if(j&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(n){e[n]&&(t[n]=parseFloat(e[n]))})),t}(pi(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=zo(l)),t.sheetRows>0&&o["!ref"]){var N=Uo(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>l.e.r&&(N.e.r=l.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>l.e.c&&(N.e.c=l.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=zo(N))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function zd(e,t,n,r){var a=pi(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=bi(Ai(a.codeName)))}var Ud=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var qd=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Pi("v"),i=Pi("f");return function(o,l,c,u,d,h){for(var f,p,m,g,v,b=0,x="",y=[],w=[],j=0,N=0,S=0,C="",k=0,E=0,A=0,T=0,P=Array.isArray(h.CellXf),_=[],L=[],R=Array.isArray(l),D=[],I={},O=!1,F=!!c.sheetStubs,M=o.split(t),B=0,z=M.length;B!=z;++B){var U=(x=M[B].trim()).length;if(0!==U){var q=0;e:for(b=0;b<U;++b)switch(x[b]){case">":if("/"!=x[b-1]){++b;break e}if(c&&c.cellStyles){if(k=null!=(p=pi(x.slice(q,b),!0)).r?parseInt(p.r,10):k+1,E=-1,c.sheetRows&&c.sheetRows<k)continue;I={},O=!1,p.ht&&(O=!0,I.hpt=parseFloat(p.ht),I.hpx=fu(I.hpt)),"1"==p.hidden&&(O=!0,I.hidden=!0),null!=p.outlineLevel&&(O=!0,I.level=+p.outlineLevel),O&&(D[k-1]=I)}break;case"<":q=b}if(q>=b)break;if(k=null!=(p=pi(x.slice(q,b),!0)).r?parseInt(p.r,10):k+1,E=-1,!(c.sheetRows&&c.sheetRows<k)){u.s.r>k-1&&(u.s.r=k-1),u.e.r<k-1&&(u.e.r=k-1),c&&c.cellStyles&&(I={},O=!1,p.ht&&(O=!0,I.hpt=parseFloat(p.ht),I.hpx=fu(I.hpt)),"1"==p.hidden&&(O=!0,I.hidden=!0),null!=p.outlineLevel&&(O=!0,I.level=+p.outlineLevel),O&&(D[k-1]=I)),y=x.slice(b).split(e);for(var V=0;V!=y.length&&"<"==y[V].trim().charAt(0);++V);for(y=y.slice(V),b=0;b!=y.length;++b)if(0!==(x=y[b].trim()).length){if(w=x.match(n),j=b,N=0,S=0,x="<c "+("<"==x.slice(0,1)?">":"")+x,null!=w&&2===w.length){for(j=0,C=w[1],N=0;N!=C.length&&!((S=C.charCodeAt(N)-64)<1||S>26);++N)j=26*j+S;E=--j}else++E;for(N=0;N!=x.length&&62!==x.charCodeAt(N);++N);if(++N,(p=pi(x.slice(0,N),!0)).r||(p.r=Mo({r:k-1,c:E})),f={t:""},null!=(w=(C=x.slice(N)).match(s))&&""!==w[1]&&(f.v=bi(w[1])),c.cellFormula){if(null!=(w=C.match(i))&&""!==w[1]){if(f.f=bi(Ai(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=Bu(f.f)),w[0].indexOf('t="array"')>-1)f.F=(C.match(a)||[])[1],f.F.indexOf(":")>-1&&_.push([Uo(f.F),f.F]);else if(w[0].indexOf('t="shared"')>-1){g=pi(w[0]);var W=bi(Ai(w[1]));c.xlfn||(W=Bu(W)),L[parseInt(g.si,10)]=[g,W,p.r]}}else(w=C.match(/<f[^>]*\/>/))&&L[(g=pi(w[0])).si]&&(f.f=Mu(L[g.si][1],L[g.si][2],p.r));var H=Fo(p.r);for(N=0;N<_.length;++N)H.r>=_[N][0].s.r&&H.r<=_[N][0].e.r&&H.c>=_[N][0].s.c&&H.c<=_[N][0].e.c&&(f.F=_[N][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=p.t||"n";switch(u.s.c>E&&(u.s.c=E),u.e.c<E&&(u.e.c=E),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!F)continue;f.t="z"}else m=Cd[parseInt(f.v,10)],f.v=m.t,f.r=m.r,c.cellHTML&&(f.h=m.h);break;case"str":f.t="s",f.v=null!=f.v?Ai(f.v):"",c.cellHTML&&(f.h=wi(f.v));break;case"inlineStr":w=C.match(r),f.t="s",null!=w&&(m=Mc(w[1]))?(f.v=m.t,c.cellHTML&&(f.h=m.h)):f.v="";break;case"b":f.v=Ni(f.v);break;case"d":c.cellDates?f.v=Vs(f.v,1):(f.v=Ds(Vs(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=vl[f.v]}if(A=T=0,v=null,P&&void 0!==p.s&&null!=(v=h.CellXf[p.s])&&(null!=v.numFmtId&&(A=v.numFmtId),c.cellStyles&&null!=v.fillId&&(T=v.fillId)),Ad(f,A,T,c,d,h),c.cellDates&&P&&"n"==f.t&&xs(Ha[A])&&(f.t="d",f.v=Ms(f.v)),p.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+p.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(R){var Y=Fo(p.r);l[Y.r]||(l[Y.r]=[]),l[Y.r][Y.c]=f}else l[p.r]=f}}}}D.length>0&&(l["!rows"]=D)}}();var Vd=sl;function Wd(e){return[Qo(e),il(e),"n"]}var Hd=sl;var Gd=["left","right","top","bottom","header","footer"];function Yd(e,t,n,r,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])}));var a=bi((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[n,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=Oo(o),t[0].forEach((function(e,n){i[c+Do(n)]={t:"n",v:e,z:t[1]},l=n})),u.e.r<l&&(u.e.r=l),++o})),o>0&&(i["!ref"]=zo(u)),i}var $d=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Kd=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Jd=[],Xd=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Qd(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var s=t[a];if(null==r[s[0]])r[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof r[s[0]]&&(r[s[0]]=Ni(r[s[0]]));break;case"int":"string"==typeof r[s[0]]&&(r[s[0]]=parseInt(r[s[0]],10))}}}function Zd(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=Ni(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function eh(e){Zd(e.WBProps,$d),Zd(e.CalcPr,Xd),Qd(e.WBView,Kd),Qd(e.Sheets,Jd),kd.date1904=Ni(e.WBProps.date1904)}var th="][*?/\\".split("");function nh(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return th.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}var rh=/<\w+:workbook/;function ah(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function sh(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Ih[16]={n:"BrtFRTArchID$",f:ah},Eo(e,(function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=dd(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:r.push(l),a=!0;break;case 36:case 38:r.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),eh(n),n.Names=s,n.supbooks=i,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},i=0;if(e.replace(di,(function(o,l){var c=pi(o);switch(mi(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(rh)&&(a="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=c[a];break;case"<fileVersion":delete c[0],n.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":$d.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=Ni(c[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:n.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(n.WBProps.CodeName=Ai(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],n.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=bi(Ai(c.name)),delete c[0],n.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(s={}).Name=Ai(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Ni(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=bi(Ai(e.slice(i,l))),n.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],n.CalcPr=c;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o})),-1===qi.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return eh(n),n}(e,n)}function ih(e,t,n,r,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,n,r,a,s,i){if(!e)return e;var o=t||{};r||(r={"!id":{}});var l,c,u,d,h,f,p,m,g,v,b=o.dense?[]:{},x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=[],w=!1,j=!1,N=[];o.biff=12,o["!row"]=0;var S=0,C=!1,k=[],E={},A=o.supbooks||a.supbooks||[[]];if(A.sharedf=E,A.arrayf=k,A.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=A,a.Names))for(var T=0;T<a.Names.length;++T)A[0][T+1]=a.Names[T];var P,_,L=[],R=[],D=!1;if(Ih[16]={n:"BrtShortReal",f:Wd},Eo(e,(function(e,t,T){if(!j)switch(T){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(j=!0),g=Do(h=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=fu(e.hpt)),R[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=Cd[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=gl[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=i.CellXf[e[0].iStyleRef])&&Ad(u,d.numFmtId,null,o,s,i),f=-1==e[0].c?f+1:e[0].c,o.dense?(b[h]||(b[h]=[]),b[h][f]=u):b[Oo(f)+g]=u,o.cellFormula){for(C=!1,S=0;S<k.length;++S){var I=k[S];c.r>=I[0].s.r&&c.r<=I[0].e.r&&f>=I[0].s.c&&f<=I[0].e.c&&(u.F=zo(I[0]),C=!0)}!C&&e.length>3&&(u.f=e[3])}if(x.s.r>c.r&&(x.s.r=c.r),x.s.c>f&&(x.s.c=f),x.e.r<c.r&&(x.e.r=c.r),x.e.c<f&&(x.e.c=f),o.cellDates&&d&&"n"==u.t&&xs(Ha[d.numFmtId])){var O=Ka(u.v);O&&(u.t="d",u.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}P&&("XLDAPR"==P.type&&(u.D=!0),P=void 0),_&&(_=void 0);break;case 1:case 12:if(!o.sheetStubs||w)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(b[h]||(b[h]=[]),b[h][f]=u):b[Oo(f)+g]=u,x.s.r>c.r&&(x.s.r=c.r),x.s.c>f&&(x.s.c=f),x.e.r<c.r&&(x.e.r=c.r),x.e.c<f&&(x.e.c=f),P&&("XLDAPR"==P.type&&(u.D=!0),P=void 0),_&&(_=void 0);break;case 176:N.push(e);break;case 49:P=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=r["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(b[h]||(b[h]=[]),b[h][f]||(b[h][f]={t:"z",v:void 0}),b[h][f].l=e):(p=Mo({c:f,r:h}),b[p]||(b[p]={t:"z",v:void 0}),b[p].l=e);break;case 426:if(!o.cellFormula)break;k.push(e),(v=o.dense?b[h][f]:b[Oo(f)+g]).f=dd(e[1],0,{r:c.r,c:f},A,o),v.F=zo(e[0]);break;case 427:if(!o.cellFormula)break;E[Mo(e[0].s)]=e[1],(v=o.dense?b[h][f]:b[Oo(f)+g]).f=dd(e[1],0,{r:c.r,c:f},A,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)L[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,cu(e.w/256)),uu(L[e.e+1]);break;case 161:b["!autofilter"]={ref:zo(e)};break;case 476:b["!margins"]=e;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:y.push(T),w=!0;break;case 38:y.pop(),w=!1;break;default:if(t.T);else if(!w||o.WTF)throw new Error("Unexpected record 0x"+T.toString(16))}}),o),delete o.supbooks,delete o["!row"],!b["!ref"]&&(x.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(b["!ref"]=zo(l||x)),o.sheetRows&&b["!ref"]){var I=Uo(b["!ref"]);o.sheetRows<=+I.e.r&&(I.e.r=o.sheetRows-1,I.e.r>x.e.r&&(I.e.r=x.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>x.e.c&&(I.e.c=x.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),b["!fullref"]=b["!ref"],b["!ref"]=zo(I))}return N.length>0&&(b["!merges"]=N),L.length>0&&(b["!cols"]=L),R.length>0&&(b["!rows"]=R),b}(e,r,n,a,s,i,o):Bd(e,r,n,a,s,i,o)}function oh(e,t,n,r,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return Eo(e,(function(e,r,l){switch(l){case 550:s["!rel"]=e;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(l);break;case 38:i.pop();break;default:if(r.T>0)i.push(l);else if(r.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,r,n,a,s):function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(Od);return o&&zd(o[0],0,a,n),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,0,n,a,s)}function lh(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var a in Ha)r.NumberFmt[a]=Ha[a];r.CellXf=[],r.Fonts=[];var s=[],i=!1;return Eo(e,(function(e,a,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],Ss(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=ru(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&r.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!i||n.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),r}(e,n,r):vu(e,n,r)}function ch(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return Eo(e,(function(e,a,s){switch(s){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var a=e.match(Bc);if(a){r=a[2].replace(zc,"").split(Uc);for(var s=0;s!=r.length;++s){var i=Mc(r[s].trim(),t);null!=i&&(n[n.length]=i)}a=pi(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}(e,n)}function uh(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],a={},s=!1;return Eo(e,(function(e,i,o){switch(o){case 632:r.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}}));var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var s=pi(a[0]),i={author:s.authorId&&n[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=Fo(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Mc(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),r.push(i)}}}})),r}(e,n)}function dh(e,t,n){return".bin"===t.slice(-4)?function(e){var t=[];return Eo(e,(function(e,n,r){if(63===r)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+r.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(di)||[]).forEach((function(e){var r=pi(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}})),t}(e)}function hh(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var a=r||{},s=!1;Eo(e,(function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),a)}(e,0,0,r)}function fh(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},s=[],i=!1,o=2;return Eo(e,(function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(n),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}})),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a,s=!1,i=2;return e.replace(di,(function(e){var t=pi(e);switch(mi(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(a=r.Types[o]);break;case"<rc":1==i?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==i&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),r}(e,0,n)}var ph,mh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function vh(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var a,s,i,o=e.match(mh);if(o)for(i=0;i!=o.length;++i)-1===(s=(a=o[i].match(gh))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return r}function bh(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,a,s=e.match(mh);if(s)for(a=0;a!=s.length;++a)-1===(r=(n=s[a].match(gh))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function xh(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ni(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Vs(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[bi(t)]=a}function yh(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||gl[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=ts(e.v):e.w=ns(e.v):e.w=function(e,t){var n=ph[e]||bi(e);return"General"===n?ns(t):Ns(n,t)}(t||"General",e.v)}catch(cw){if(n.WTF)throw cw}try{var r=ph[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&xs(r)){var a=Ka(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(cw){if(n.WTF)throw cw}}}function wh(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=pu[r.Pattern]||r.Pattern)}e[t.ID]=t}function jh(e,t,n,r,a,s,i,o,l,c){var u="General",d=r.StyleID,h={};c=c||{};var f=[],p=0;for(void 0===d&&o&&(d=o.StyleID),void 0===d&&i&&(d=i.StyleID);void 0!==s[d]&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&f.push(s[d].Interior),s[d].Parent);)d=s[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Ni(e);break;case"String":r.t="s",r.r=ji(bi(e)),r.v=e.indexOf("<")>-1?bi(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(Vs(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=bi(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=vl[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=ji(t||e))}if(yh(r,u,c),!1!==c.cellFormula)if(r.Formula){var m=bi(r.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),r.f=Du(m,a),delete r.Formula,"RC"==r.ArrayRange?r.F=Du("RC:RC",a):r.ArrayRange&&(r.F=Du(r.ArrayRange,a),l.push([Uo(r.F),r.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(r.F=l[p][1]);c.cellStyles&&(f.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),r.s=h),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function Nh(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Sh(e,t){var n=t||{};Cs();var r=ya(Bi(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof xa?xa.utils.decode(65001,va(r)):Ai(r));var a,s=r.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=Hs(n);return o.type="string",_c.to_workbook(r,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){s.indexOf("<"+e)>=0&&(i=!0)})),i)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return Wo(Mh(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach((function(e,n){Mf(r,Mh(e,t),"Sheet"+(n+1))})),r}(r,n);ph={"General Number":"General","General Date":Ha[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ha[15],"Short Date":Ha[14],"Long Time":Ha[19],"Medium Time":Ha[18],"Short Time":Ha[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ha[2],Standard:Ha[4],Percent:Ha[10],Scientific:Ha[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,d={},h=[],f=n.dense?[]:{},p="",m={},g={},v=vh('<Data ss:Type="String">'),b=0,x=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},N={},S="",C=0,k=[],E={},A={},T=0,P=[],_=[],L={},R=[],D=!1,I=[],O=[],F={},M=0,B=0,z={Sheets:[],WBProps:{date1904:!1}},U={};zi.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var q="";a=zi.exec(r);)switch(a[3]=(q=a[3]).toLowerCase()){case"data":if("data"==q){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?jh(r.slice(b,a.index),S,v,"comment"==c[c.length-1][0]?L:m,{c:x,r:y},j,R[x],g,I,n):(S="",v=vh(a[0]),b=a.index+a[0].length);break;case"cell":if("/"===a[1])if(_.length>0&&(m.c=_),(!n.sheetRows||n.sheetRows>y)&&void 0!==m.v&&(n.dense?(f[y]||(f[y]=[]),f[y][x]=m):f[Oo(x)+Do(y)]=m),m.HRef&&(m.l={Target:bi(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(M=x+(0|parseInt(m.MergeAcross,10)),B=y+(0|parseInt(m.MergeDown,10)),k.push({s:{c:x,r:y},e:{c:M,r:B}})),n.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var V=x;V<=M;++V)for(var W=y;W<=B;++W)(V>x||W>y)&&(n.dense?(f[W]||(f[W]=[]),f[W][V]={t:"z"}):f[Oo(V)+Do(W)]={t:"z"});x=M+1}else++x;else m.MergeAcross?x=M+1:++x;else(m=bh(a[0])).Index&&(x=+m.Index-1),x<w.s.c&&(w.s.c=x),x>w.e.c&&(w.e.c=x),"/>"===a[0].slice(-2)&&++x,_=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===a[0].slice(-2)&&(g=vh(a[0])).Index&&(y=+g.Index-1),x=0,++y):((g=vh(a[0])).Index&&(y=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=hu(F.hpx),O[y]=F),"1"==g.Hidden&&(F.hidden=!0,O[y]=F));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));h.push(p),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=zo(w),n.sheetRows&&n.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=n.sheetRows-1,f["!ref"]=zo(w))),k.length&&(f["!merges"]=k),R.length>0&&(f["!cols"]=R),O.length>0&&(f["!rows"]=O),d[p]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=x=0,c.push([a[3],!1]),l=vh(a[0]),p=bi(l.Name),f=n.dense?[]:{},k=[],I=[],O=[],U={name:p,Hidden:0},z.Sheets.push(U);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),R=[],D=!1}break;case"style":"/"===a[1]?wh(j,N,n):N=vh(a[0]);break;case"numberformat":N.nf=bi(vh(a[0]).Format||"General"),ph[N.nf]&&(N.nf=ph[N.nf]);for(var H=0;392!=H&&Ha[H]!=N.nf;++H);if(392==H)for(H=57;392!=H;++H)if(null==Ha[H]){Ss(N.nf,H);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=vh(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!D&&u.wpx>10){D=!0,au=6;for(var G=0;G<R.length;++G)R[G]&&uu(R[G])}D&&uu(u),R[u.Index-1||R.length]=u;for(var Y=0;Y<+u.Span;++Y)R[R.length]=Hs(u);break;case"namedrange":if("/"===a[1])break;z.Names||(z.Names=[]);var $=pi(a[0]),K={Name:$.Name,Ref:Du($.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(K.Sheet=z.Sheets.length-1),z.Names.push(K);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?S+=r.slice(C,a.index):C=a.index+a[0].length;break;case"interior":if(!n.cellStyles)break;N.Interior=vh(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Pl(E,q,r.slice(T,a.index)):T=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));Nh(L),_.push(L)}else c.push([a[3],!1]),L={a:(l=vh(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var J=vh(a[0]);f["!autofilter"]={ref:Du(J.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return Xh(r,n);if(0==c.length&&"uof"==a[3])return Xh(r,n);var X=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(a[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:X=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(r.slice(T,a.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2}else T=a.index+a[0].length;break;case"header":f["!margins"]||Ed(f["!margins"]={},"xlml"),isNaN(+pi(a[0]).Margin)||(f["!margins"].header=+pi(a[0]).Margin);break;case"footer":f["!margins"]||Ed(f["!margins"]={},"xlml"),isNaN(+pi(a[0]).Margin)||(f["!margins"].footer=+pi(a[0]).Margin);break;case"pagemargins":var Q=pi(a[0]);f["!margins"]||Ed(f["!margins"]={},"xlml"),isNaN(+Q.Top)||(f["!margins"].top=+Q.Top),isNaN(+Q.Left)||(f["!margins"].left=+Q.Left),isNaN(+Q.Right)||(f["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(f["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:X=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:X=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:X=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:X=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1}if(X)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?xh(A,q,P,r.slice(T,a.index)):(P=a,T=a.index+a[0].length);break}if(n.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var Z={};return n.bookSheets||n.bookProps||(Z.Sheets=d),Z.SheetNames=h,Z.Workbook=z,Z.SSF=Hs(Ha),Z.Props=E,Z.Custprops=A,Z}function Ch(e,t){switch(xf(t=t||{}),t.type||"base64"){case"base64":return Sh(Ca(e),t);case"binary":case"buffer":case"file":return Sh(e,t);case"array":return Sh(_a(e),t)}}function kh(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return ol(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return ol(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var Eh=[60,1084,2066,2165,2175];function Ah(e,t,n,r,a){var s=r,i=[],o=n.slice(n.l,n.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}i.push(o),n.l+=s;for(var l=fo(n,n.l),c=Oh[l],u=0;null!=c&&Eh.indexOf(l)>-1;)s=fo(n,n.l+2),u=n.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),o=n.slice(u,n.l+4+s),i.push(o),n.l+=4+s,c=Oh[l=fo(n,n.l)];var d=Ra(i);So(d,0);var h=0;d.lens=[];for(var f=0;f<i.length;++f)d.lens.push(h),h+=i[f].length;if(d.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+r;return t.f(d,d.length,a)}function Th(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ha[r])}catch(cw){if(t.WTF)throw cw}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||gl[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=ts(e.v):e.w=ns(e.v):e.w=Ns(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(cw){if(t.WTF)throw cw}if(t.cellDates&&r&&"n"==e.t&&xs(Ha[r]||String(r))){var a=Ka(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ph(e,t,n){return{v:e,ixfe:t,t:n}}function _h(e,t){var n={opts:{}},r={};var a,s,i,o,l,c,u,d,h=t.dense?[]:{},f={},p={},m=null,g=[],v="",b={},x="",y={},w=[],j=[],N=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},k=function(e){return e<8?ml[e]:e<64&&N[e-8]||ml[e]},E=function(e,t,n){if(!(F>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,a=t.XF.data;a&&a.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=a.patternType,(r=nu(k(a.icvFore)))&&(t.s.fgColor={rgb:r}),(r=nu(k(a.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,a=e,x=Mo(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<w.length;++r)if(!(w[r][0].s.c>e.c||w[r][0].s.r>e.r)&&!(w[r][0].e.c<e.c||w[r][0].e.r<e.r)){t.F=zo(w[r][0]),w[r][0].s.c==e.c&&w[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+dd(w[r][1],0,e,D,A));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[x]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var T=[],P=[],_=[],L=[],R=!1,D=[];D.SheetNames=A.snames,D.sharedf=A.sharedf,D.arrayf=A.arrayf,D.names=[],D.XTI=[];var I,O=0,F=0,M=0,B=[],z=[];A.codepage=1200,ma(1200);for(var U=!1;e.l<e.length-1;){var q=e.l,V=e.read_shift(2);if(0===V&&10===O)break;var W=e.l===e.length?0:e.read_shift(2),H=Oh[V];if(H&&H.f){if(t.bookSheets&&133===O&&133!==V)break;if(O=V,2===H.r||12==H.r){var G=e.read_shift(2);if(W-=2,!A.enc&&G!==V&&((255&G)<<8|G>>8)!==V)throw new Error("rt mismatch: "+G+"!="+V);12==H.r&&(e.l+=10,W-=10)}var Y={};if(Y=10===V?H.f(e,W,A):Ah(V,H,e,W,A),0==F&&-1===[9,521,1033,2057].indexOf(O))continue;switch(V){case 34:n.opts.Date1904=S.WBProps.date1904=Y;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=Y,!t.password)throw new Error("File is password-protected");if(null==Y.valid)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=Y;break;case 66:var $=Number(Y);switch($){case 21010:$=1200;break;case 32768:$=1e4;break;case 32769:$=1252}ma(A.codepage=$),U=!0;break;case 317:A.rrtabid=Y;break;case 25:A.winlocked=Y;break;case 439:n.opts.RefreshAll=Y;break;case 12:n.opts.CalcCount=Y;break;case 16:n.opts.CalcDelta=Y;break;case 17:n.opts.CalcIter=Y;break;case 13:n.opts.CalcMode=Y;break;case 14:n.opts.CalcPrecision=Y;break;case 95:n.opts.CalcSaveRecalc=Y;break;case 15:A.CalcRefMode=Y;break;case 2211:n.opts.FullCalc=Y;break;case 129:Y.fDialog&&(h["!type"]="dialog"),Y.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),Y.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:j.push(Y);break;case 430:D.push([Y]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(Y);break;case 24:case 536:I={Name:Y.Name,Ref:dd(Y.rgce,0,null,D,A)},Y.itab>0&&(I.Sheet=Y.itab-1),D.names.push(I),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(Y),"_xlnm._FilterDatabase"==Y.Name&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&"PtgArea3d"==Y.rgce[0][0][0]&&(z[Y.itab-1]={ref:zo(Y.rgce[0][0][1][2])});break;case 22:A.ExternCount=Y;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(Y),D.XTI=D.XTI.concat(Y);break;case 2196:if(A.biff<8)break;null!=I&&(I.Comment=Y[1]);break;case 18:h["!protect"]=Y;break;case 19:0!==Y&&A.WTF&&console.error("Password verifier: "+Y);break;case 133:f[Y.pos]=Y,A.snames.push(Y.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,h["!ref"]=zo(p),t.sheetRows&&t.sheetRows<=p.e.r){var K=p.e.r;p.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=zo(p),p.e.r=K}p.e.r++,p.e.c++}T.length>0&&(h["!merges"]=T),P.length>0&&(h["!objects"]=P),_.length>0&&(h["!cols"]=_),L.length>0&&(h["!rows"]=L),S.Sheets.push(C)}""===v?b=h:r[v]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),A.biffguess=0==Y.BIFFVer,0==Y.BIFFVer&&4096==Y.dt&&(A.biff=5,U=!0,ma(A.codepage=28591)),8==A.biff&&0==Y.BIFFVer&&16==Y.dt&&(A.biff=2),F++)break;if(h=t.dense?[]:{},A.biff<8&&!U&&(U=!0,ma(A.codepage=t.codepage||1252)),A.biff<5||0==Y.BIFFVer&&4096==Y.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-W,name:v};f[J.pos]=J,A.snames.push(v)}else v=(f[q]||{name:""}).name;32==Y.dt&&(h["!type"]="chart"),64==Y.dt&&(h["!type"]="macro"),T=[],P=[],A.arrayf=w=[],_=[],L=[],R=!1,C={Hidden:(f[q]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[Y.r]||[])[Y.c]:h[Mo({c:Y.c,r:Y.r})])&&++Y.c,c={ixfe:Y.ixfe,XF:j[Y.ixfe]||{},v:Y.val,t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:Y.c,r:Y.r},c,t);break;case 5:case 517:c={ixfe:Y.ixfe,XF:j[Y.ixfe],v:Y.val,t:Y.t},M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:Y.c,r:Y.r},c,t);break;case 638:c={ixfe:Y.ixfe,XF:j[Y.ixfe],v:Y.rknum,t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:Y.c,r:Y.r},c,t);break;case 189:for(var X=Y.c;X<=Y.C;++X){var Q=Y.rkrec[X-Y.c][0];c={ixfe:Q,XF:j[Q],v:Y.rkrec[X-Y.c][1],t:"n"},M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:X,r:Y.r},c,t)}break;case 6:case 518:case 1030:if("String"==Y.val){m=Y;break}if((c=Ph(Y.val,Y.cell.ixfe,Y.tt)).XF=j[c.ixfe],t.cellFormula){var Z=Y.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],ne=Mo({r:ee,c:te});y[ne]?c.f=""+dd(Y.formula,0,Y.cell,D,A):c.F=((t.dense?(h[ee]||[])[te]:h[ne])||{}).F}else c.f=""+dd(Y.formula,0,Y.cell,D,A)}M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E(Y.cell,c,t),m=Y;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=Y,(c=Ph(Y,m.cell.ixfe,"s")).XF=j[c.ixfe],t.cellFormula&&(c.f=""+dd(m.formula,0,m.cell,D,A)),M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E(m.cell,c,t),m=null;break;case 33:case 545:w.push(Y);var re=Mo(Y[0].s);if(s=t.dense?(h[Y[0].s.r]||[])[Y[0].s.c]:h[re],t.cellFormula&&s){if(!m)break;if(!re||!s)break;s.f=""+dd(Y[1],0,Y[0],D,A),s.F=zo(Y[0])}break;case 1212:if(!t.cellFormula)break;if(x){if(!m)break;y[Mo(m.cell)]=Y[0],((s=t.dense?(h[m.cell.r]||[])[m.cell.c]:h[Mo(m.cell)])||{}).f=""+dd(Y[0],0,a,D,A)}break;case 253:c=Ph(g[Y.isst].t,Y.ixfe,"s"),g[Y.isst].h&&(c.h=g[Y.isst].h),c.XF=j[c.ixfe],M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:Y.c,r:Y.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:Y.ixfe,XF:j[Y.ixfe],t:"z"},M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:Y.c,r:Y.r},c,t));break;case 190:if(t.sheetStubs)for(var ae=Y.c;ae<=Y.C;++ae){var se=Y.ixfe[ae-Y.c];c={ixfe:se,XF:j[se],t:"z"},M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:ae,r:Y.r},c,t)}break;case 214:case 516:case 4:(c=Ph(Y.val,Y.ixfe,"s")).XF=j[c.ixfe],M>0&&(c.z=B[c.ixfe>>8&63]),Th(c,t,n.opts.Date1904),E({c:Y.c,r:Y.r},c,t);break;case 0:case 512:1===F&&(p=Y);break;case 252:g=Y;break;case 1054:if(4==A.biff){B[M++]=Y[1];for(var ie=0;ie<M+163&&Ha[ie]!=Y[1];++ie);ie>=163&&Ss(Y[1],M+163)}else Ss(Y[1],Y[0]);break;case 30:B[M++]=Y;for(var oe=0;oe<M+163&&Ha[oe]!=Y;++oe);oe>=163&&Ss(Y,M+163);break;case 229:T=T.concat(Y);break;case 93:P[Y.cmo[0]]=A.lastobj=Y;break;case 438:A.lastobj.TxO=Y;break;case 127:A.lastobj.ImData=Y;break;case 440:for(l=Y[0].s.r;l<=Y[0].e.r;++l)for(o=Y[0].s.c;o<=Y[0].e.c;++o)(s=t.dense?(h[l]||[])[o]:h[Mo({c:o,r:l})])&&(s.l=Y[1]);break;case 2048:for(l=Y[0].s.r;l<=Y[0].e.r;++l)for(o=Y[0].s.c;o<=Y[0].e.c;++o)(s=t.dense?(h[l]||[])[o]:h[Mo({c:o,r:l})])&&s.l&&(s.l.Tooltip=Y[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;s=t.dense?(h[Y[0].r]||[])[Y[0].c]:h[Mo(Y[0])];var le=P[Y[2]];s||(t.dense?(h[Y[0].r]||(h[Y[0].r]=[]),s=h[Y[0].r][Y[0].c]={t:"z"}):s=h[Mo(Y[0])]={t:"z"},p.e.r=Math.max(p.e.r,Y[0].r),p.s.r=Math.min(p.s.r,Y[0].r),p.e.c=Math.max(p.e.c,Y[0].c),p.s.c=Math.min(p.s.c,Y[0].c)),s.c||(s.c=[]),i={a:Y[1],t:le.TxO.t},s.c.push(i);break;case 2173:j[Y.ixfe],Y.ext.forEach((function(e){e[0]}));break;case 125:if(!A.cellStyles)break;for(;Y.e>=Y.s;)_[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(1&Y.flags)},R||(R=!0,cu(Y.w/256)),uu(_[Y.e+1]);break;case 520:var ce={};null!=Y.level&&(L[Y.r]=ce,ce.level=Y.level),Y.hidden&&(L[Y.r]=ce,ce.hidden=!0),Y.hpt&&(L[Y.r]=ce,ce.hpt=Y.hpt,ce.hpx=fu(Y.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||Ed(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=Y;break;case 161:h["!margins"]||Ed(h["!margins"]={}),h["!margins"].header=Y.header,h["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(S.Views[0].RTL=!0);break;case 146:N=Y;break;case 2198:d=Y;break;case 140:u=Y;break;case 442:v?C.CodeName=Y||C.name:S.WBProps.CodeName=Y||"ThisWorkbook"}}else H||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=W}return n.SheetNames=_s(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&b["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=b)):n.Preamble=b,n.Sheets&&z.forEach((function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e})),n.Strings=g,n.SSF=Hs(Ha),A.enc&&(n.Encryption=A.enc),d&&(n.Themes=d),n.Metadata={},void 0!==u&&(n.Metadata.Country=u),D.names.length>0&&(S.Names=D.names),n.Workbook=S,n}var Lh="e0859ff2f94f6810ab9108002b27b3d9",Rh="02d5cdd59c2e1b10939708002b2cf9ae";function Dh(e,t){var n,r,a,s;if(t||(t={}),xf(t),ga(),t.codepage&&pa(t.codepage),e.FullPaths){if(Ts.find(e,"/encryption"))throw new Error("File is password-protected");n=Ts.find(e,"!CompObj"),r=Ts.find(e,"/Workbook")||Ts.find(e,"/Book")}else{switch(t.type){case"base64":e=Pa(Ca(e));break;case"binary":e=Pa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}So(e,0),r={content:e}}if(n&&kh(n),t.bookProps&&!t.bookSheets)a={};else{var i=ka?"buffer":"array";if(r&&r.content)a=_h(r.content,t);else if((s=Ts.find(e,"PerfectOffice_MAIN"))&&s.content)a=Lc.to_workbook(s.content,(t.type=i,t));else{if(!(s=Ts.find(e,"NativeContent_MAIN"))||!s.content)throw(s=Ts.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Lc.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&Ts.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Ts.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ts.utils.cfb_add(t,a,e.FileIndex[r].content)}})),Ts.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,n){var r=Ts.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Ul(r,ul,Rh);for(var s in a)t[s]=a[s]}catch(cw){if(n.WTF)throw cw}var i=Ts.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Ul(i,dl,Lh);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(cw){if(n.WTF)throw cw}t.HeadingPairs&&t.TitlesOfParts&&(kl(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var Ih={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,7&s&&(n.level=7&s),16&s&&(n.hidden=!0),32&s&&(n.hpt=a/20),n}},1:{f:function(e){return[Xo(e)]}},2:{f:function(e){return[Xo(e),rl(e),"n"]}},3:{f:function(e){return[Xo(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Xo(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Xo(e),il(e),"n"]}},6:{f:function(e){return[Xo(e),Yo(e),"str"]}},7:{f:function(e){return[Xo(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=Xo(e);a.r=n["!row"];var s=[a,Yo(e),"str"];if(n.cellFormula){e.l+=2;var i=vd(e,r-e.l,n);s[3]=dd(i,0,a,n.supbooks,n)}else e.l=r;return s}},9:{f:function(e,t,n){var r=e.l+t,a=Xo(e);a.r=n["!row"];var s=[a,il(e),"n"];if(n.cellFormula){e.l+=2;var i=vd(e,r-e.l,n);s[3]=dd(i,0,a,n.supbooks,n)}else e.l=r;return s}},10:{f:function(e,t,n){var r=e.l+t,a=Xo(e);a.r=n["!row"];var s=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var i=vd(e,r-e.l,n);s[3]=dd(i,0,a,n.supbooks,n)}else e.l=r;return s}},11:{f:function(e,t,n){var r=e.l+t,a=Xo(e);a.r=n["!row"];var s=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var i=vd(e,r-e.l,n);s[3]=dd(i,0,a,n.supbooks,n)}else e.l=r;return s}},12:{f:function(e){return[Qo(e)]}},13:{f:function(e){return[Qo(e),rl(e),"n"]}},14:{f:function(e){return[Qo(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Qo(e),e.read_shift(1),"b"]}},16:{f:Wd},17:{f:function(e){return[Qo(e),Yo(e),"str"]}},18:{f:function(e){return[Qo(e),e.read_shift(4),"s"]}},19:{f:Ko},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=tl(e),i=bd(e,0,n),o=el(e);e.l=r;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(r.underline=s);var i=e.read_shift(1);i>0&&(r.family=i);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=ml[r];l&&(t.rgb=nu(l));break;case 2:t.rgb=nu([s,i,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Yo(e),r}},44:{f:function(e,t){return[e.read_shift(2),Yo(e)]}},45:{f:bu},46:{f:xu},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jc},62:{f:function(e){return[Xo(e),Ko(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Mo(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Co,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=Zo(e,t-19),n}},148:{f:Vd,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?Yo(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=nl(e,t-8),n.name=Yo(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Hd},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Yo(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=al(e),s=e.read_shift(1),i=[a];if(i[2]=s,n.cellFormula){var o=gd(e,r-e.l,n);i[1]=o}else e.l=r;return i}},427:{f:function(e,t,n){var r=e.l+t,a=[sl(e,16)];if(n.cellFormula){var s=xd(e,r-e.l,n);a[1]=s,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Gd.forEach((function(n){t[n]=il(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=sl(e,16),a=el(e),s=Yo(e),i=Yo(e),o=Yo(e);e.l=n;var l={rfx:r,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ru},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=sl(e,16);return t.rfx=n.s,t.ref=Mo(n.s),e.l+=16,t}},636:{T:-1},637:{f:Jo},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Yo(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Oh={6:{f:pd},10:{f:ql},12:{f:Wl},13:{f:Wl},14:{f:Vl},15:{f:Vl},16:{f:il},17:{f:Vl},18:{f:Vl},19:{f:Wl},20:{f:mc},21:{f:mc},23:{f:xc},24:{f:bc},25:{f:Vl},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Jl(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:a},o,i,s]}}(e,0,n)}},29:{},34:{f:Vl},35:{f:gc},38:{f:il},39:{f:il},40:{f:il},41:{f:il},42:{f:Vl},43:{f:Vl},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?eu(e,t-2,r):function(e,t,n,r){var a={key:Wl(e),verificationBytes:Wl(e)};n.password&&(a.verifier=Xc(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=Zc(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=Gl(e,0,n),r}},51:{f:Wl},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Vl},65:{f:function(){}},66:{f:Wl},77:{},80:{},81:{},82:{},85:{f:Wl},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=Jl(e,0,n);return e.read_shift(t+r-e.l),a}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((wc[r]||Co)(e,t,n)),{cmo:[a,r,s],ft:i}}(e,t,n);var r=oc(e),a=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(cc[a](e,n-e.l))}catch(cw){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:a}}},94:{},95:{f:Vl},96:{},97:{},99:{f:Vl},125:{f:jc},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Wl},131:{f:Vl},132:{f:Vl},133:{f:function(e,t,n){var r=e.read_shift(4),a=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=Gl(e,0,n);return 0===i.length&&(i="Sheet1"),{pos:r,hs:a,dt:s,name:i}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=hl[t]||t,t=e.read_shift(2),n[1]=hl[t]||t,n}},141:{f:Wl},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(ec(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:Wl},157:{},158:{},160:{f:Sc},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=il(e),n.footer=il(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),s=[];e.l<n;)s.push(rc(e));if(e.l!==n)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:r,c:a,C:i,rkrec:s}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),s=[];e.l<n;)s.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:r,c:a,C:i,ixfe:s}}},193:{f:ql},197:{},198:{},199:{},200:{},201:{},202:{f:Vl},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Wl},220:{},221:{f:Vl},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=fl[o>>26],r.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&i,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:ql},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(ac(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<n;++i)s.push(Yl(e));return s.Count=r,s.Unique=a,s}},253:{f:function(e){var t=tc(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Hl},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vl},353:{f:ql},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(n.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=$l(e,s),o=[];r>e.l;)o.push(Kl(e));return[s,a,i,o]}},431:{f:Vl},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,a="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var i=e.read_shift(2);e.read_shift(2),Wl(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=$l(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(a.length!==i&&a.length!==2*i)throw new Error("cchText: "+i+" != "+a.length);return e.l=r+t,{t:a}}catch(cw){return e.l=r+t,{t:a}}}},439:{f:Vl},440:{f:function(e,t){var n=ac(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c,u,d="";16&a&&(s=Ql(e,e.l)),128&a&&(i=Ql(e,e.l)),257===(257&a)&&(o=Ql(e,e.l)),1===(257&a)&&(l=Xl(e,e.l)),8&a&&(d=Ql(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(u=_l(e)),e.l=n;var h=i||o||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&a&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),u&&(f.time=u),s&&(f.Tooltip=s),f}(e,t-24);return[n,r]}},441:{},442:{f:Kl},443:{},444:{f:Wl},445:{},446:{},448:{f:ql},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:ql},512:{f:fc},513:{f:Nc},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=tc(e),a=il(e);return r.val=a,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=tc(e);2==n.biff&&e.l++;var a=Kl(e,e.l,n);return r.val=a,r}},517:{f:pc},519:{f:Cc},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:yc},549:{f:dc},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=rc(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),Jl(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=sc(e);e.l++;var a=e.read_shift(1);return[fd(e,t-=8,n),a,r]}},2048:{f:function(e,t){e.read_shift(2);var n=ac(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(Da,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:uc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ql},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(_u(e,e.l));return{ixfe:n,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vl,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2);return[$l(e,r,n),$l(e,a,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var a,s=e.slice(e.l);e.l=r;try{a=ii(s,{type:"array"})}catch(cw){return}var i=ni(a,"theme/theme/theme1.xml",!0);if(i)return Au(i,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:ql},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Wl},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,16&a&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(ec(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fc},1:{},2:{f:function(e){var t=tc(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=tc(e);++e.l;var n=il(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=tc(e);++e.l;var a=Jl(e,0,n);return r.t="str",r.val=a,r}},5:{f:pc},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:uc},11:{},22:{f:Wl},30:{f:hc},31:{},32:{},33:{f:yc},36:{},37:{f:dc},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Wl},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,a=tc(e),s=e.read_shift(2),i=$l(e,s,n);return e.l=r,a.t="str",a.val=i,a}},223:{},234:{},354:{},421:{},518:{f:pd},521:{f:uc},536:{f:bc},547:{f:gc},561:{},579:{},1030:{f:pd},1033:{f:uc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Fh(e,t,n,r){var a=t;if(!isNaN(a)){var s=r||(n||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&co(n)&&e.push(n)}}function Mh(e,t){var n=t||{};var r=n.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Js(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<l.length;++i){var m=l[i].trim(),g=m.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var b=v[o].trim();if(b.match(/<t[dh]/i)){for(var x=b,y=0;"<"==x.charAt(0)&&(y=x.indexOf(">"))>-1;)x=x.slice(y+1);for(var w=0;w<p.length;++w){var j=p[w];j.s.c==u&&j.s.r<c&&c<=j.e.r&&(u=j.e.c+1,w=-1)}var N=pi(b.slice(0,b.indexOf(">")));h=N.colspan?+N.colspan:1,((d=+N.rowspan)>1||h>1)&&p.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var S=N.t||N["data-t"]||"";if(x.length)if(x=_i(x),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),x.length){var C={t:"s",v:x};n.raw||!x.trim().length||"s"==S||("TRUE"===x?C={t:"b",v:!0}:"FALSE"===x?C={t:"b",v:!1}:isNaN(Ys(x))?isNaN(Ks(x).getDate())||(C={t:"d",v:Vs(x)},n.cellDates||(C={t:"n",v:Ds(C.v)}),C.z=n.dateNF||Ha[14]):C={t:"n",v:Ys(x)}),n.dense?(r[c]||(r[c]=[]),r[c][u]=C):r[Mo({r:c,c:u})]=C,u+=h}else u+=h;else u+=h}}}}else{if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0}}return r["!ref"]=zo(f),p.length&&(r["!merges"]=p),r}function Bh(e,t,n,r){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>i)&&!(a[c].e.r<n||a[c].e.c<i)){if(a[c].s.r<n||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Mo({r:n,c:i}),d=r.dense?(e[n]||[])[i]:e[u],h=d&&null!=d.v&&(d.h||wi(d.w||(Vo(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+u,s.push(Mi("td",h,f))}}return"<tr>"+s.join("")+"</tr>"}var zh='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Uh="</body></html>";function qh(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Vh(e,t){var n=t||{},r=null!=n.header?n.header:zh,a=null!=n.footer?n.footer:Uh,s=[r],i=Bo(e["!ref"]);n.dense=Array.isArray(e),s.push(qh(0,0,n));for(var o=i.s.r;o<=i.e.r;++o)s.push(Bh(e,i,o,n));return s.push("</table>"+a),s.join("")}function Wh(e,t,n){var r=n||{};var a=0,s=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var i="string"==typeof r.origin?Fo(r.origin):r.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Bo(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,b=0,x=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var y=o[p];if(Gh(y)){if(r.display)continue;f[m]={hidden:!0}}var w=y.children;for(g=v=0;g<w.length;++g){var j=w[g];if(!r.display||!Gh(j)){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):_i(j.innerHTML),S=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<d.length;++h){var C=d[h];C.s.c==v+s&&C.s.r<m+a&&m+a<=C.e.r&&(v=C.e.c+1-s,h=-1)}x=+j.getAttribute("colspan")||1,((b=+j.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:m+a,c:v+s},e:{r:m+a+(b||1)-1,c:v+s+(x||1)-1}});var k={t:"s",v:N},E=j.getAttribute("data-t")||j.getAttribute("t")||"";null!=N&&(0==N.length?k.t=E||"z":r.raw||0==N.trim().length||"s"==E||("TRUE"===N?k={t:"b",v:!0}:"FALSE"===N?k={t:"b",v:!1}:isNaN(Ys(N))?isNaN(Ks(N).getDate())||(k={t:"d",v:Vs(N)},r.cellDates||(k={t:"n",v:Ds(k.v)}),k.z=r.dateNF||Ha[14]):k={t:"n",v:Ys(N)})),void 0===k.z&&null!=S&&(k.z=S);var A="",T=j.getElementsByTagName("A");if(T&&T.length)for(var P=0;P<T.length&&(!T[P].hasAttribute("href")||"#"==(A=T[P].getAttribute("href")).charAt(0));++P);A&&"#"!=A.charAt(0)&&(k.l={Target:A}),r.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+s]=k):e[Mo({c:v+s,r:m+a})]=k,c.e.c<v+s&&(c.e.c=v+s),v+=x}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=zo(c),m>=l&&(e["!fullref"]=zo((c.e.r=o.length-p+m-1+a,c))),e}function Hh(e,t){return Wh((t||{}).dense?[]:{},e,t)}function Gh(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Yh(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[bi(t.replace(/<[^>]*>/g,""))]}var $h={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Kh(e,t){var n=t||{};var r,a,s,i,o,l,c=Bi(e),u=[],d={name:""},h="",f=0,p={},m=[],g=n.dense?[]:{},v={value:""},b="",x=0,y=[],w=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,C={},k=[],E={},A=[],T=1,P=1,_=[],L={Names:[]},R={},D=["",""],I=[],O={},F="",M=0,B=!1,z=!1,U=0;for(zi.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=zi.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(N.e.c>=N.s.c&&N.e.r>=N.s.r?g["!ref"]=zo(N):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=n.sheetRows-1,g["!ref"]=zo(N)),k.length&&(g["!merges"]=k),A.length&&(g["!rows"]=A),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),m.push(s.name),p[s.name]=g,z=!1):"/"!==o[0].charAt(o[0].length-2)&&(s=pi(o[0],!1),w=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,g=n.dense?[]:{},k=[],A=[],z=!0);break;case"table-row-group":"/"===o[1]?--S:++S;break;case"table-row":case"\u884c":if("/"===o[1]){w+=T,T=1;break}if((i=pi(o[0],!1))["\u884c\u53f7"]?w=i["\u884c\u53f7"]-1:-1==w&&(w=0),(T=+i["number-rows-repeated"]||1)<10)for(U=0;U<T;++U)S>0&&(A[w+U]={level:S});j=-1;break;case"covered-table-cell":"/"!==o[1]&&++j,n.sheetStubs&&(n.dense?(g[w]||(g[w]=[]),g[w][j]={t:"z"}):g[Mo({r:w,c:j})]={t:"z"}),b="",y=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++j,v=pi(o[0],!1),P=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=n.cellFormula&&(l.f=Nd(bi(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=bi(v["string-value"]||""),n.dense?(g[w]||(g[w]=[]),g[w][j]=l):g[Mo({r:w,c:j})]=l),j+=P-1;else if("/"!==o[1]){b="",x=0,y=[],P=1;var q=T?w+T-1:w;if(++j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),w<N.s.r&&(N.s.r=w),q>N.e.r&&(N.e.r=q),I=[],O={},l={t:(v=pi(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},n.cellFormula)if(v.formula&&(v.formula=bi(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(E={s:{r:w,c:j},e:{r:w+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:j+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=zo(E),_.push([E,l.F])),v.formula)l.f=Nd(v.formula);else for(U=0;U<_.length;++U)w>=_[U][0].s.r&&w<=_[U][0].e.r&&j>=_[U][0].s.c&&j<=_[U][0].e.c&&(l.F=_[U][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(E={s:{r:w,c:j},e:{r:w+(parseInt(v["number-rows-spanned"],10)||0)-1,c:j+(parseInt(v["number-columns-spanned"],10)||0)-1}},k.push(E)),v["number-columns-repeated"]&&(P=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=Ni(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=Vs(v["date-value"]),n.cellDates||(l.t="n",l.v=Ds(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=Bs(v["time-value"])/86400,n.cellDates&&(l.t="d",l.v=Ms(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(b=bi(v["string-value"]),y=[])}}else{if(B=!1,"s"===l.t&&(l.v=b||"",y.length&&(l.R=y),B=0==x),R.Target&&(l.l=R),I.length>0&&(l.c=I,I=[]),b&&!1!==n.cellText&&(l.w=b),B&&(l.t="z",delete l.v),(!B||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=w))for(var V=0;V<T;++V){if(P=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(g[w+V]||(g[w+V]=[]),g[w+V][j]=0==V?l:Hs(l);--P>0;)g[w+V][j+P]=Hs(l);else for(g[Mo({r:w+V,c:j})]=l;--P>0;)g[Mo({r:w+V,c:j+P})]=Hs(l);N.e.c<=j&&(N.e.c=j)}j+=(P=parseInt(v["number-columns-repeated"]||"1",10))-1,P=0,l={},b="",y=[]}R={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r;O.t=b,y.length&&(O.R=y),O.a=F,I.push(O)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",M=0,b="",x=0,y=[];break;case"creator":"/"===o[1]?F=c.slice(M,o.index):M=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);b="",x=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(C[d.name]=h,(r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(h="",d=pi(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=pi(o[0],!1),h+=$h[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(f,o.index)}else f=o.index+o[0].length;break;case"named-range":D=Sd((a=pi(o[0],!1))["cell-range-address"]);var W={Name:a.name,Ref:D[0]+"!"+D[1]};z&&(W.Sheet=m.length),L.Names.push(W);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])pi(o[0],!1),x=o.index+o[0].length;else{var H=Yh(c.slice(x,o.index));b=(b.length>0?b+"\n":"")+H[0]}break;case"database-range":if("/"===o[1])break;try{p[(D=Sd(pi(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(cw){}break;case"a":if("/"!==o[1]){if(!(R=pi(o[0],!1)).href)break;R.Target=bi(R.href),delete R.href,"#"==R.Target.charAt(0)&&R.Target.indexOf(".")>-1?(D=Sd(R.Target.slice(1)),R.Target="#"+D[0]+"!"+D[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(o)}}var G={Sheets:p,SheetNames:m,Workbook:L};return n.bookSheets&&delete G.Sheets,G}function Jh(e,t){t=t||{},Zs(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,a=Bi(e);n=zi.exec(a);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=pi(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(ti(e,"META-INF/manifest.xml"),t);var n=ni(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=Kh(Ai(n),t);return Zs(e,"meta.xml")&&(r.Props=Sl(ti(e,"meta.xml"))),r}function Xh(e,t){return Kh(e,t)}function Qh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zh(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Ai(_a(e))}function ef(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function tf(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function nf(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function rf(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function af(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],s=nf(e,n),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=nf(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var c={data:r,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function sf(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function of(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=nf(e,r),s=af(e.slice(r[0],r[0]+a));r[0]+=a;var i={id:rf(s[1][0].data),messages:[]};s[2].forEach((function(t){var n=af(t.data),a=rf(n[3][0].data);i.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a})),(null==(t=s[3])?void 0:t[0])&&(i.merge=rf(s[3][0].data)>>>0>0),n.push(i)}return n}function lf(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=nf(t,n),a=[];n[0]<t.length;){var s=3&t[n[0]];if(0!=s){var i=0,o=0;if(1==s?(o=4+(t[n[0]]>>2&7),i=(224&t[n[0]++])<<3,i|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==s?(i=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(i=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[ef(a)],0==i)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(a.push(a[0].slice(-i)),o-=i;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-i,-i+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=ef(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function cf(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(lf(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ef(t)}function uf(e,t,n){var r,a=Qh(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],a=t+13;a>=t;--a)r=256*r+e[a];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,i),i+=16),2&s&&(u=a.getFloat64(i,!0),i+=8),4&s&&(d.setTime(d.getTime()+1e3*a.getFloat64(i,!0)),i+=8),8&s&&(l=a.getUint32(i,!0),i+=4),16&s&&(o=a.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:c};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));r={t:"s",v:n[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return r}function df(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var a,s=Qh(e),i=s.getUint32(4,!0),o=(r>1?12:8)+4*tf(i&(r>1?3470:398)),l=-1,c=-1,u=NaN,d=new Date(2001,0,1);switch(512&i&&(l=s.getUint32(o,!0),o+=4),o+=4*tf(i&(r>1?12288:4096)),16&i&&(c=s.getUint32(o,!0),o+=4),32&i&&(u=s.getFloat64(o,!0),o+=8),64&i&&(d.setTime(d.getTime()+1e3*s.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[c]};break;case 5:a={t:"d",v:d};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(l>-1)a={t:"s",v:n[l]};else if(c>-1)a={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,n,e[0]);case 5:return uf(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function hf(e){return nf(af(e)[1][0].data)}function ff(e,t){var n=af(t.data),r=rf(n[1][0].data),a=n[3],s=[];return(a||[]).forEach((function(t){var n=af(t.data),a=rf(n[1][0].data)>>>0;switch(r){case 1:s[a]=Zh(n[3][0].data);break;case 8:var i=af(e[hf(n[9][0].data)][0].data),o=e[hf(i[1][0].data)][0],l=rf(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=af(o.data);s[a]=c[3].map((function(e){return Zh(e.data)})).join("")}})),s}function pf(e,t){var n,r=af(t.data),a=(null==(n=null==r?void 0:r[7])?void 0:n[0])?rf(r[7][0].data)>>>0>0?1:0:-1,s=sf(r[5],(function(e){return function(e,t){var n,r,a,s,i,o,l,c,u,d,h,f,p,m,g,v,b=af(e),x=rf(b[1][0].data)>>>0,y=rf(b[2][0].data)>>>0,w=(null==(r=null==(n=b[8])?void 0:n[0])?void 0:r.data)&&rf(b[8][0].data)>0||!1;if((null==(s=null==(a=b[7])?void 0:a[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=b[7])?void 0:i[0])?void 0:o.data,v=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(d=null==(u=b[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=b[4])?void 0:h[0])?void 0:f.data,v=null==(m=null==(p=b[3])?void 0:p[0])?void 0:m.data}for(var j=w?4:1,N=Qh(g),S=[],C=0;C<g.length/2;++C){var k=N.getUint16(2*C,!0);k<65535&&S.push([C,k])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var E=[];for(C=0;C<S.length-1;++C)E[S[C][0]]=v.subarray(S[C][1]*j,S[C+1][1]*j);return S.length>=1&&(E[S[S.length-1][0]]=v.subarray(S[S.length-1][1]*j)),{R:x,cells:E}}(e,a)}));return{nrows:rf(r[4][0].data)>>>0,data:s.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n})),e}),[])}}function mf(e,t){var n={"!ref":"A1"},r=e[hf(af(t.data)[2][0].data)],a=rf(r[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,n){var r,a=af(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(rf(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(rf(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=zo(s);var i=af(a[4][0].data),o=ff(e,e[hf(i[4][0].data)][0]),l=(null==(r=i[17])?void 0:r[0])?ff(e,e[hf(i[17][0].data)][0]):[],c=af(i[3][0].data),u=0;c[1].forEach((function(t){var r=af(t.data),a=e[hf(r[2][0].data)][0],s=rf(a.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=pf(0,a);i.data.forEach((function(e,t){e.forEach((function(e,r){var a=Mo({r:u+t,c:r}),s=df(e,o,l);s&&(n[a]=s)}))})),u+=i.nrows}))}(e,r[0],n),n}function gf(e,t){var n={SheetNames:[],Sheets:{}};if(sf(af(t.data)[1],hf).forEach((function(t){e[t].forEach((function(t){if(2==rf(t.meta[1][0].data)){var r=function(e,t){var n,r=af(t.data),a={name:(null==(n=r[1])?void 0:n[0])?Zh(r[1][0].data):"",sheets:[]};return sf(r[2],hf).forEach((function(t){e[t].forEach((function(t){6e3==rf(t.meta[1][0].data)&&a.sheets.push(mf(e,t))}))})),a}(e,t);r.sheets.forEach((function(e,t){Mf(n,e,0==t?r.name:r.name+"_"+t,!0)}))}}))})),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function vf(e){var t,n,r,a,s={},i=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=cf(e.content)}catch(cw){return console.log("?? "+e.content.length+" "+(cw.message||cw))}try{n=of(t)}catch(cw){return console.log("## "+(cw.message||cw))}n.forEach((function(e){s[e.id]=e.messages,i.push(e.id)}))}})),!i.length)throw new Error("File has no messages");var o=(null==(a=null==(r=null==(n=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:a[0].data)&&1==rf(s[1][0].meta[1][0].data)&&s[1][0];if(o||i.forEach((function(e){s[e].forEach((function(e){if(1==rf(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}}))})),!o)throw new Error("Cannot find Document root");return gf(s,o)}function bf(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function xf(e){bf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function yf(e){return xl.WS.indexOf(e)>-1?"sheet":xl.CS&&e==xl.CS?"chart":xl.DS&&e==xl.DS?"dialog":xl.MS&&e==xl.MS?"macro":e&&e.length?e:"sheet"}function wf(e,t,n,r,a,s,i,o,l,c,u,d){try{s[r]=wl(ni(e,n,!0),t);var h,f=ti(e,t);switch(o){case"sheet":h=ih(f,t,a,l,s[r],c,u,d);break;case"chart":if(!(h=oh(f,t,a,l,s[r],c))||!h["!drawel"])break;var p=oi(h["!drawel"].Target,t),m=yl(p),g=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(ni(e,p,!0),wl(ni(e,m,!0),p)),v=oi(g,p),b=yl(v);h=Yd(ni(e,v,!0),0,0,wl(ni(e,b,!0),v),0,h);break;case"macro":y=t,s[r],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[r]);break;default:throw new Error("Unrecognized sheet type "+o)}i[r]=h;var x=[];s&&s[r]&&_s(s[r]).forEach((function(n){var a="";if(s[r][n].Type==xl.CMNT){a=oi(s[r][n].Target,t);var i=uh(ti(e,a,!0),a,l);if(!i||!i.length)return;Lu(h,i,!1)}s[r][n].Type==xl.TCMNT&&(a=oi(s[r][n].Target,t),x=x.concat(function(e,t){var n=[],r=!1,a={},s=0;return e.replace(di,(function(i,o){var l=pi(i);switch(mi(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&n.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i})),n}(ti(e,a,!0),l)))})),x&&x.length&&Lu(h,x,!0,l.people||[])}catch(cw){if(l.WTF)throw cw}var y}function jf(e){return"/"==e.charAt(0)?e.slice(1):e}function Nf(e,t){if(Cs(),xf(t=t||{}),Zs(e,"META-INF/manifest.xml"))return Jh(e,t);if(Zs(e,"objectdata.xml"))return Jh(e,t);if(Zs(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return vf(e);var n=Ts.utils.cfb_new();return ai(e).forEach((function(t){si(n,t,ri(e,t))})),vf(n)}if(!Zs(e,"[Content_Types].xml")){if(Zs(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Zs(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,a,s=ai(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(di)||[]).forEach((function(e){var r=pi(e);switch(r[0].replace(hi,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[bl[r.ContentType]]&&t[bl[r.ContentType]].push(r.PartName)}})),t.xmlns!==Ui)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(ni(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&ti(e,a="xl/workbook.xml",!0)&&i.workbooks.push(a),0===i.workbooks.length){if(!ti(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(a),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Cd=[],i.sst)try{Cd=ch(ti(e,jf(i.sst)),i.sst,t)}catch(cw){if(t.WTF)throw cw}t.cellStyles&&i.themes.length&&(l=function(e,t,n){return Au(e,n)}(ni(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=lh(ti(e,jf(i.style)),i.style,l,t))}i.links.map((function(n){try{wl(ni(e,yl(jf(n))),n);return hh(ti(e,jf(n)),0,n,t)}catch(cw){}}));var u=sh(ti(e,jf(i.workbooks[0])),i.workbooks[0],t),d={},h="";i.coreprops.length&&((h=ti(e,jf(i.coreprops[0]),!0))&&(d=Sl(h)),0!==i.extprops.length&&(h=ti(e,jf(i.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=Ai(e),Cl.forEach((function(n){var a=(e.match(Pi(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=bi(a));break;case"bool":t[n[1]]="true"===a;break;case"raw":var s=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(r[n[1]]=s[1])}})),r.HeadingPairs&&r.TitlesOfParts&&kl(r.HeadingPairs,r.TitlesOfParts,t,n)}(h,d,t));var f={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(h=ni(e,jf(i.custprops[0]),!0))&&(f=function(e,t){var n={},r="",a=e.match(El);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=pi(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=bi(o.name);break;case"</property>":r=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=bi(u);break;case"bool":n[r]=Ni(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=Vs(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return n}(h,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map((function(e){return e.name})):d.Worksheets&&d.SheetNames.length>0&&(r=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=f),t.bookSheets&&"undefined"!==typeof r&&(p.SheetNames=r),t.bookSheets?p.SheetNames:t.bookProps))return p;r={};var m={};t.bookDeps&&i.calcchain&&(m=dh(ti(e,jf(i.calcchain)),i.calcchain));var g,v,b=0,x={},y=u.Sheets;d.Worksheets=y.length,d.SheetNames=[];for(var w=0;w!=y.length;++w)d.SheetNames[w]=y[w].name;var j=o?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),S=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Zs(e,S)||(S="xl/_rels/workbook."+j+".rels");var C=wl(ni(e,S,!0),S.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=fh(ti(e,jf(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(di,(function(e){var a=pi(e);switch(mi(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),n}(ti(e,jf(i.people[0])),t)),C&&(C=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,yf(e["!id"][t.id].Type)]}))}catch(cw){return null}return e&&0!==e.length?e:null}(C,u.Sheets));var k=ti(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=d.Worksheets;++b){var E="sheet";if(C&&C[b]?(g="xl/"+C[b][1].replace(/[\/]?xl\//,""),Zs(e,g)||(g=C[b][1]),Zs(e,g)||(g=S.replace(/_rels\/.*$/,"")+C[b][1]),E=C[b][2]):g=(g="xl/worksheets/sheet"+(b+1-k)+"."+j).replace(/sheet0\./,"sheet."),v=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(d.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,T=0;T!=t.sheets.length;++T)"number"==typeof t.sheets[T]&&t.sheets[T]==b&&(A=1),"string"==typeof t.sheets[T]&&t.sheets[T].toLowerCase()==d.SheetNames[b].toLowerCase()&&(A=1);if(!A)continue e}}wf(e,g,v,d.SheetNames[b],b,x,r,E,t,u,l,c)}return p={Directory:i,Workbook:u,Props:d,Custprops:f,Deps:m,Sheets:r,SheetNames:d.SheetNames,Strings:Cd,Styles:c,Themes:l,SSF:Hs(Ha)},t&&t.bookFiles&&(e.files?(p.keys=s,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]})))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=ti(e,jf(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(p.vbaraw=ti(e,"xl/vbaProject.bin",!0))),p}function Sf(e,t){var n=t||{},r="Workbook",a=Ts.find(e,r);try{if(r="/!DataSpaces/Version",!(a=Ts.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=Vc(e,4),t.U=Vc(e,4),t.W=Vc(e,4)}(a.content),r="/!DataSpaces/DataSpaceMap",!(a=Ts.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(Wc(e));return t}(a.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Ts.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Ts.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);Hc(a.content)}catch(cw){}if(r="/EncryptionInfo",!(a=Ts.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=Vc(e);switch(t.Minor){case 2:return[t.Minor,$c(e)];case 3:return[t.Minor,Kc()];case 4:return[t.Minor,Jc(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(r="/EncryptedPackage",!(a=Ts.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,n.password||"",n);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function Cf(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Ca(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function kf(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Ch(e.slice(n),t);default:break e}return _c.to_workbook(e,t)}function Ef(e,t,n,r){return r?(n.type="string",_c.to_workbook(e,n)):_c.to_workbook(t,n)}function Af(e,t){ga();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return Af(new Uint8Array(e),((n=Hs(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,a=e,s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),kd={},n.dateNF&&(kd.dateNF=n.dateNF),n.type||(n.type=ka&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=ka?"buffer":"binary",a=function(e){if("undefined"!==typeof Ps)return Ps.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(cw){if(!cw.message||!cw.message.match(/onstruct/))throw cw}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||ka||(n.type="array")),"string"==n.type&&(s=!0,n.type="binary",n.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Ti(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(n=Hs(n)).type="array",Af(La(a),n)}switch((r=Cf(a,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return Ts.find(e,"EncryptedPackage")?Sf(e,t):Dh(e,t)}(Ts.read(a,n),n);break;case 9:if(r[1]<=8)return Dh(a,n);break;case 60:return Ch(a,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=Ac.to_workbook(e,n);return n.WTF=r,a}catch(cw){if(n.WTF=r,!cw.message.match(/SYLK bad record ID/)&&r)throw cw;return _c.to_workbook(e,t)}}(a,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return Tc.to_workbook(a,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=ka&&Buffer.isBuffer(e)?"buffer":"base64"),Nf(ii(n,r),r)}(a,n):Ef(e,a,n,s);case 239:return 60===r[3]?Ch(a,n):Ef(e,a,n,s);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=Ca(n)),n=xa.utils.decode(1200,n.slice(2),"str"),t.type="binary",kf(n,t)}(a,n);if(0===r[1]&&2===r[2]&&0===r[3])return Lc.to_workbook(a,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return Lc.to_workbook(a,n);if(0===r[2]&&(8===r[3]||9===r[3]))return Lc.to_workbook(a,n)}break;case 3:case 131:case 139:case 140:return Ec.to_workbook(a,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return tu.to_workbook(a,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=Cf(e,t);switch(t.type){case"base64":n=Ca(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Ws(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=Ai(n)),t.type="binary",kf(n,t)}(a,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return kc.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?Ec.to_workbook(a,n):Ef(e,a,n,s)}function Tf(e,t,n,r,a,s,i,o){var l=Do(n),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(cw){h.__rowNum__=n}else h.__rowNum__=n;if(!i||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=i?e[n][f]:e[r[f]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=s[f]){if(null==m)if("e"==p.t&&null===m)h[s[f]]=null;else if(void 0!==c)h[s[f]]=c;else{if(!u||null!==m)continue;h[s[f]]=null}else h[s[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:Vo(p,m,o);null!=m&&(d=!1)}}else{if(void 0===c)continue;null!=s[f]&&(h[s[f]]=c)}}return{row:h,isempty:d}}function Pf(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=Uo(u);break;case"number":(l=Uo(e["!ref"])).s.r=u;break;default:l=u}r>0&&(a=0);var d=Do(l.s.r),h=[],f=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,b=0,x={};g&&!e[v]&&(e[v]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(h[b]=Oo(b),n=g?e[v][b]:e[h[b]+d],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=h[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=i=Vo(n,null,c),m=x[i]||0){do{o=i+"_"+m++}while(x[o]);x[i]=m,x[o]=1}else x[i]=1;s[b]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(w[v]||{}).hidden){var j=Tf(e,l,v,h,r,s,g,c);(!1===j.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[p++]=j.row)}return f.length=p,f}var _f=/"/g;function Lf(e,t,n,r,a,s,i,o){for(var l=!0,c=[],u="",d=Do(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=o.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(o.rawNumbers&&"n"==f.t?f.v:Vo(f,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===a||m===s||34===m||o.forceQuotes){u='"'+u.replace(_f,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(_f,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(i)}function Rf(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=Uo(e["!ref"]),s=void 0!==r.FS?r.FS:",",i=s.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(d[p]=Oo(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||null!=(u=Lf(e,a,g,d,i,l,s,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((m++?o:"")+u));return delete r.dense,n.join("")}function Df(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=Rf(e,t);if("undefined"==typeof xa||"string"==t.type)return n;var r=xa.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function If(e,t,n){var r,a=n||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?Fo(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var d=Uo(i["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+s)}else-1==o&&(o=0,u.e.r=t.length-1+s);var h=a.header||[],f=0;t.forEach((function(e,t){_s(e).forEach((function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var c=e[n],u="z",d="",p=Mo({c:l+f,r:o+t+s});r=Of(i,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=Ds(c)),d=a.dateNF||Ha[14]):null===c&&a.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,d&&(r.z=d)):i[p]=r={t:u,v:c},d&&(r.z=d)):i[p]=c}))})),u.e.c=Math.max(u.e.c,l+h.length-1);var p=Do(o);if(s)for(f=0;f<h.length;++f)i[Oo(f+l)+p]={t:"s",v:h[f]};return i["!ref"]=zo(u),i}function Of(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=Fo(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Of(e,Mo("number"!=typeof t?t:{r:t,c:n||0}))}function Ff(){return{SheetNames:[],Sheets:{}}}function Mf(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=i+a);++a);}if(nh(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function Bf(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var zf={encode_col:Oo,encode_row:Do,encode_cell:Mo,encode_range:zo,decode_col:Io,decode_row:Ro,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Fo,decode_range:Bo,format_cell:Vo,sheet_add_aoa:Ho,sheet_add_json:If,sheet_add_dom:Wh,aoa_to_sheet:Go,json_to_sheet:function(e,t){return If(null,e,t)},table_to_sheet:Hh,table_to_book:function(e,t){return Wo(Hh(e,t),t)},sheet_to_csv:Rf,sheet_to_txt:Df,sheet_to_json:Pf,sheet_to_html:Vh,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,s=Uo(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=Oo(a);for(var u=s.s.r;u<=s.e.r;++u)for(i=Do(u),a=s.s.c;a<=s.e.c;++a)if(n=o[a]+i,r="",void 0!==(t=c?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:Pf,sheet_get_cell:Of,book_new:Ff,book_append_sheet:Mf,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Bf,cell_set_internal_link:function(e,t,n){return Bf(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:Uo(t),s="string"==typeof t?t:zo(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Of(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};ca.version;const Uf=e=>{let{isOpen:t,onClose:n,onImportSuccess:r,conseillers:a=[]}=e;const[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)([]),[d,h]=(0,s.useState)({}),[f,p]=(0,s.useState)(!1),[m,g]=(0,s.useState)(0),[v,b]=(0,s.useState)("");(0,s.useEffect)((()=>{if(t){o(null),c([]),h({}),g(0),b("");const e={};a.forEach((t=>{e[t.nomComplet||t.name||t]=0})),h(e)}}),[t,a]);const x=()=>Object.values(d).reduce(((e,t)=>e+(parseInt(t)||0)),0),y=()=>x()===m&&m>0;return t?(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content modal-large",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Importer des leads depuis Excel"}),(0,$r.jsx)("button",{className:"close-btn",onClick:n,disabled:f,children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i)if(y()){p(!0),b("");try{const e=new FormData;e.append("file",i),e.append("distribution",JSON.stringify(d));const t=await Yr.post("http://localhost:5000/api/leads/import-excel",e,{headers:{"Content-Type":"multipart/form-data"}});t.data.success&&(r({totalImported:t.data.data.totalImported,distribution:t.data.data.distribution,errors:t.data.data.errors}),n())}catch(v){var t,a;console.error("Erreur lors de l'importation:",v),b((null===(t=v.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Erreur lors de l'importation")}finally{p(!1)}}else b("Le total de la distribution (".concat(x(),") doit \xeatre \xe9gal au nombre de leads (").concat(m,")"));else b("Veuillez s\xe9lectionner un fichier")},children:[(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h4",{children:"\ud83d\udcc1 S\xe9lectionner le fichier"}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Fichier Excel/CSV:"}),(0,$r.jsx)("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:async e=>{const t=e.target.files[0];if(b(""),!t)return o(null),c([]),void g(0);const n=t.name.toLowerCase().substr(t.name.lastIndexOf("."));if([".xlsx",".xls",".csv"].includes(n)){o(t);try{let e=[];if(".csv"===n){const n=(await t.text()).split("\n").filter((e=>e.trim()));if(n.length<2)return void b("Le fichier CSV doit contenir au moins une ligne d'en-t\xeate et une ligne de donn\xe9es");const r=n[0].split(",").map((e=>e.trim().replace(/"/g,"")));for(let t=1;t<n.length;t++){const a=n[t].split(",").map((e=>e.trim().replace(/"/g,""))),s={};r.forEach(((e,t)=>{s[e]=a[t]||""})),s[r[0]]&&e.push(s)}}else{const n=Af(await t.arrayBuffer(),{type:"array"}),r=n.SheetNames[0],a=n.Sheets[r];e=zf.sheet_to_json(a)}const r={nom:["nom","Nom","NOM","lastName","last_name","Last Name"],prenom:["prenom","pr\xe9nom","Pr\xe9nom","PRENOM","firstName","first_name","First Name"],email:["email","Email","EMAIL","e-mail","mail","Mail"],telephone:["telephone","t\xe9l\xe9phone","T\xe9l\xe9phone","TELEPHONE","phone","tel","Phone"],ville:["ville","Ville","VILLE","city","City"],interet:["interet","int\xe9r\xeat","Int\xe9r\xeat","INTERET","interest","Interest"]},a=e.map((e=>{const t={};for(const[n,a]of Object.entries(r))for(const r of a)if(void 0!==e[r]&&""!==e[r]){t[n]=String(e[r]).trim();break}return t})).filter((e=>e.nom&&e.prenom&&e.email&&e.telephone&&e.ville));if(0===a.length)return void b("Aucun lead valide trouv\xe9. V\xe9rifiez que les colonnes Nom, Pr\xe9nom, Email, T\xe9l\xe9phone et Ville sont pr\xe9sentes et remplies.");c(a.slice(0,5)),g(a.length)}catch(v){console.error("Erreur lors de la lecture du fichier:",v),b("Erreur lors de la lecture du fichier. V\xe9rifiez le format.")}}else b("Format de fichier non support\xe9. Utilisez .xlsx, .xls ou .csv")},disabled:f,required:!0}),(0,$r.jsxs)("p",{className:"form-help",children:["Formats accept\xe9s: .xlsx, .xls, .csv",(0,$r.jsx)("br",{}),"Colonnes requises: Nom, Pr\xe9nom, Email, T\xe9l\xe9phone, Ville"]})]})]}),i&&l.length>0&&(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsxs)("h4",{children:["\ud83d\udc40 Aper\xe7u du fichier (",m," leads d\xe9tect\xe9s)"]}),(0,$r.jsxs)("div",{className:"preview-table",children:[(0,$r.jsxs)("table",{children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Nom"}),(0,$r.jsx)("th",{children:"Pr\xe9nom"}),(0,$r.jsx)("th",{children:"Email"}),(0,$r.jsx)("th",{children:"T\xe9l\xe9phone"}),(0,$r.jsx)("th",{children:"Ville"})]})}),(0,$r.jsx)("tbody",{children:l.map(((e,t)=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.nom}),(0,$r.jsx)("td",{children:e.prenom}),(0,$r.jsx)("td",{children:e.email}),(0,$r.jsx)("td",{children:e.telephone}),(0,$r.jsx)("td",{children:e.ville})]},t)))})]}),m>5&&(0,$r.jsxs)("p",{className:"preview-note",children:["... et ",m-5," autres leads"]})]})]}),i&&m>0&&(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsxs)("h4",{children:["\ud83d\udcca Distribution des leads (",x(),"/",m,")"]}),(0,$r.jsx)("div",{className:"distribution-grid",children:Object.entries(d).map((e=>{let[t,n]=e;return(0,$r.jsxs)("div",{className:"distribution-item",children:[(0,$r.jsxs)("label",{children:[t,":"]}),(0,$r.jsx)("input",{type:"number",min:"0",max:m,value:n,onChange:e=>((e,t)=>{const n=parseInt(t)||0;h((t=>u(u({},t),{},{[e]:n})))})(t,e.target.value),disabled:f,placeholder:"0"})]},t)}))}),(0,$r.jsxs)("div",{className:"distribution-summary ".concat(y()?"valid":"invalid"),children:[(0,$r.jsxs)("span",{children:["Total distribu\xe9: ",x()]}),(0,$r.jsxs)("span",{children:["Total leads: ",m]}),y()?(0,$r.jsx)("span",{className:"valid-icon",children:"\u2705 Distribution correcte"}):(0,$r.jsx)("span",{className:"error-icon",children:"\u274c Distribution incorrecte"})]})]}),v&&(0,$r.jsxs)("div",{className:"error-message",children:[(0,$r.jsx)("i",{className:"fas fa-exclamation-triangle"}),v]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:n,disabled:f,children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",disabled:!y()||f,children:f?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("i",{className:"fas fa-spinner fa-spin"})," Importation..."]}):(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("i",{className:"fas fa-upload"})," Importer"]})})]})]})]})}):null},qf="http://localhost:5000/api",Vf={async createConsultation(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Consultation effectu\xe9e";try{const r=await fetch("".concat(qf,"/consultations"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadId:e,conseillerId:t,reason:n})});if(!r.ok)throw new Error("Erreur HTTP: ".concat(r.status));return await r.json()}catch(r){throw console.error("Erreur lors de la cr\xe9ation de la consultation:",r),r}},async invalidateConsultation(e,t){try{const n=await fetch("".concat(qf,"/consultations/").concat(e,"/invalidate"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:t})});if(!n.ok)throw new Error("Erreur HTTP: ".concat(n.status));return await n.json()}catch(n){throw console.error("Erreur lors de l'annulation de la consultation:",n),n}},async getConsultationsByLead(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=await fetch("".concat(qf,"/consultations/lead/").concat(e,"?includeInvalid=").concat(t));if(!n.ok)throw new Error("Erreur HTTP: ".concat(n.status));return await n.json()}catch(n){throw console.error("Erreur lors de la r\xe9cup\xe9ration des consultations du lead:",n),n}},async getConsultationsByConseiller(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=await fetch("".concat(qf,"/consultations/conseiller/").concat(e,"?includeInvalid=").concat(t));if(!n.ok)throw new Error("Erreur HTTP: ".concat(n.status));return await n.json()}catch(n){throw console.error("Erreur lors de la r\xe9cup\xe9ration des consultations du conseiller:",n),n}}},Wf=e=>{var t;let{leadId:n,conseillerId:r,onConsultationChange:a}=e;const[i,o]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),[u,d]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),[p,m]=(0,s.useState)(""),g=async()=>{try{c(!0);const e=await Vf.getConsultationsByLead(n,!0);o(e.consultations||[])}catch(e){console.error("Erreur lors du chargement des consultations:",e)}finally{c(!1)}},v=()=>{d(!1),f(null),m("")},b=e=>new Date(e).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return(0,s.useEffect)((()=>{n&&g()}),[n]),(0,$r.jsxs)("div",{className:"consultation-manager",children:[(0,$r.jsxs)("div",{className:"consultation-header",children:[(0,$r.jsx)("h4",{children:"Consultations effectu\xe9es"}),(0,$r.jsx)("button",{className:"btn btn-primary btn-sm",onClick:async()=>{if(r)try{c(!0);const e=await Vf.createConsultation(n,r,"Consultation effectu\xe9e");e.consultation&&(await g(),a&&a("created",e.consultation),alert("Consultation enregistr\xe9e avec succ\xe8s!"))}catch(e){console.error("Erreur lors de la cr\xe9ation de la consultation:",e),alert("Erreur lors de l'enregistrement de la consultation")}finally{c(!1)}else alert("Aucun conseiller s\xe9lectionn\xe9")},disabled:l||!r,children:l?"Enregistrement...":"Enregistrer consultation"})]}),(0,$r.jsx)("div",{className:"consultation-list",children:0===i.length?(0,$r.jsx)("p",{className:"no-consultations",children:"Aucune consultation enregistr\xe9e"}):(0,$r.jsxs)("table",{className:"consultation-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Conseiller"}),(0,$r.jsx)("th",{children:"Statut"}),(0,$r.jsx)("th",{children:"Raison"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:i.map((e=>{var t;return(0,$r.jsxs)("tr",{className:e.isValid?"":"cancelled",children:[(0,$r.jsx)("td",{children:b(e.createdAt)}),(0,$r.jsx)("td",{children:(null===(t=e.conseiller)||void 0===t?void 0:t.name)||"N/A"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"status ".concat(e.isValid?"valid":"invalid"),children:e.isValid?"Valide":"Annul\xe9e"})}),(0,$r.jsx)("td",{children:e.reason}),(0,$r.jsx)("td",{children:e.isValid&&(0,$r.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(e=>{f(e),d(!0)})(e),disabled:l,children:"Annuler"})})]},e.id)}))})]})}),u&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Annuler la consultation"}),(0,$r.jsx)("button",{className:"modal-close",onClick:v,children:"\xd7"})]}),(0,$r.jsxs)("div",{className:"modal-body",children:[(0,$r.jsx)("p",{children:"Vous \xeates sur le point d'annuler cette consultation :"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date :"})," ",h&&b(h.createdAt)]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Conseiller :"})," ",null===h||void 0===h||null===(t=h.conseiller)||void 0===t?void 0:t.name]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{htmlFor:"cancelReason",children:"Raison de l'annulation *"}),(0,$r.jsx)("textarea",{id:"cancelReason",value:p,onChange:e=>m(e.target.value),placeholder:"Saisissez la raison de l'annulation...",rows:"3",required:!0})]})]}),(0,$r.jsxs)("div",{className:"modal-footer",children:[(0,$r.jsx)("button",{className:"btn btn-secondary",onClick:v,disabled:l,children:"Annuler"}),(0,$r.jsx)("button",{className:"btn btn-danger",onClick:async()=>{if(h&&p.trim())try{c(!0);const e=await Vf.invalidateConsultation(h.id,p);e.consultation&&(await g(),a&&a("cancelled",e.consultation),d(!1),f(null),m(""),alert("Consultation annul\xe9e avec succ\xe8s!"))}catch(e){console.error("Erreur lors de l'annulation de la consultation:",e),alert("Erreur lors de l'annulation de la consultation")}finally{c(!1)}else alert("Veuillez saisir une raison d'annulation")},disabled:l||!p.trim(),children:l?"Annulation...":"Confirmer l'annulation"})]})]})})]})},Hf=Object.create(null);Hf.open="0",Hf.close="1",Hf.ping="2",Hf.pong="3",Hf.message="4",Hf.upgrade="5",Hf.noop="6";const Gf=Object.create(null);Object.keys(Hf).forEach((e=>{Gf[Hf[e]]=e}));const Yf={type:"error",data:"parser error"},$f="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Kf="function"===typeof ArrayBuffer,Jf=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Xf=(e,t,n)=>{let{type:r,data:a}=e;return $f&&a instanceof Blob?t?n(a):Qf(a,n):Kf&&(a instanceof ArrayBuffer||Jf(a))?t?n(a):Qf(new Blob([a]),n):n(Hf[r]+(a||""))},Qf=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function Zf(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ep;const tp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",np="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let $=0;$<64;$++)np[tp.charCodeAt($)]=$;const rp="function"===typeof ArrayBuffer,ap=(e,t)=>{if("string"!==typeof e)return{type:"message",data:ip(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:sp(e.substring(1),t)};return Gf[n]?e.length>1?{type:Gf[n],data:e.substring(1)}:{type:Gf[n]}:Yf},sp=(e,t)=>{if(rp){const n=(e=>{let t,n,r,a,s,i=.75*e.length,o=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);const c=new ArrayBuffer(i),u=new Uint8Array(c);for(t=0;t<o;t+=4)n=np[e.charCodeAt(t)],r=np[e.charCodeAt(t+1)],a=np[e.charCodeAt(t+2)],s=np[e.charCodeAt(t+3)],u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|a>>2,u[l++]=(3&a)<<6|63&s;return c})(e);return ip(n,t)}return{base64:!0,data:e}},ip=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,op=String.fromCharCode(30);function lp(){return new TransformStream({transform(e,t){!function(e,t){$f&&e.data instanceof Blob?e.data.arrayBuffer().then(Zf).then(t):Kf&&(e.data instanceof ArrayBuffer||Jf(e.data))?t(Zf(e.data)):Xf(e,!1,(e=>{ep||(ep=new TextEncoder),t(ep.encode(e))}))}(e,(n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const e=new DataView(a.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{a=new Uint8Array(9);const e=new DataView(a.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!==typeof e.data&&(a[0]|=128),t.enqueue(a),t.enqueue(n)}))}})}let cp;function up(e){return e.reduce(((e,t)=>e+t.length),0)}function dp(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function hp(e){if(e)return function(e){for(var t in hp.prototype)e[t]=hp.prototype[t];return e}(e)}hp.prototype.on=hp.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},hp.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},hp.prototype.off=hp.prototype.removeListener=hp.prototype.removeAllListeners=hp.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var a=0;a<r.length;a++)if((n=r[a])===t||n.fn===t){r.splice(a,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},hp.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var a=(n=n.slice(0)).length;r<a;++r)n[r].apply(this,t)}return this},hp.prototype.emitReserved=hp.prototype.emit,hp.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},hp.prototype.hasListeners=function(e){return!!this.listeners(e).length};const fp="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),pp="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function mp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const gp=pp.setTimeout,vp=pp.clearTimeout;function bp(e,t){t.useNativeTimers?(e.setTimeoutFn=gp.bind(pp),e.clearTimeoutFn=vp.bind(pp)):(e.setTimeoutFn=pp.setTimeout.bind(pp),e.clearTimeoutFn=pp.clearTimeout.bind(pp))}function xp(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class yp extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class wp extends hp{constructor(e){super(),this.writable=!1,bp(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new yp(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=ap(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class jp extends wp{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(op),r=[];for(let a=0;a<n.length;a++){const e=ap(n[a],t);if(r.push(e),"error"===e.type)break}return r})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach(((e,s)=>{Xf(e,!1,(e=>{r[s]=e,++a===n&&t(r.join(op))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=xp()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let Np=!1;try{Np="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Qm){}const Sp=Np;function Cp(){}class kp extends jp{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}class Ep extends hp{constructor(e,t,n){super(),this.createRequest=e,bp(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=mp(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(cw){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(cw){}try{n.setRequestHeader("Accept","*/*")}catch(cw){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn((()=>{this._onError("number"===typeof n.status?n.status:0)}),0))},n.send(this._data)}catch(cw){return void this.setTimeoutFn((()=>{this._onError(cw)}),0)}"undefined"!==typeof document&&(this._index=Ep.requestsCount++,Ep.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Cp,e)try{this._xhr.abort()}catch(cw){}"undefined"!==typeof document&&delete Ep.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(Ep.requestsCount=0,Ep.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",Ap);else if("function"===typeof addEventListener){addEventListener("onpagehide"in pp?"pagehide":"unload",Ap,!1)}function Ap(){for(let e in Ep.requests)Ep.requests.hasOwnProperty(e)&&Ep.requests[e].abort()}const Tp=function(){const e=Pp({xdomain:!1});return e&&null!==e.responseType}();function Pp(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||Sp))return new XMLHttpRequest}catch(cw){}if(!t)try{return new(pp[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(cw){}}const _p="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class Lp extends wp{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=_p?{}:mp(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(Qm){return this.emitReserved("error",Qm)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;Xf(n,this.supportsBinary,(e=>{try{this.doWrite(n,e)}catch(cw){}r&&fp((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=xp()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Rp=pp.WebSocket||pp.MozWebSocket;const Dp={websocket:class extends Lp{createSocket(e,t,n){return _p?new Rp(e,t,n):t?new Rp(e,t):new Rp(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends wp{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(Qm){return this.emitReserved("error",Qm)}this._transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((e=>{const t=function(e,t){cp||(cp=new TextDecoder);const n=[];let r=0,a=-1,s=!1;return new TransformStream({transform(i,o){for(n.push(i);;){if(0===r){if(up(n)<1)break;const e=dp(n,1);s=128===(128&e[0]),a=127&e[0],r=a<126?3:126===a?1:2}else if(1===r){if(up(n)<2)break;const e=dp(n,2);a=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(up(n)<8)break;const e=dp(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),s=t.getUint32(0);if(s>Math.pow(2,21)-1){o.enqueue(Yf);break}a=s*Math.pow(2,32)+t.getUint32(4),r=3}else{if(up(n)<a)break;const e=dp(n,a);o.enqueue(ap(s?e:cp.decode(e),t)),r=0}if(0===a||a>e){o.enqueue(Yf);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=lp();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const a=()=>{n.read().then((e=>{let{done:t,value:n}=e;t||(this.onPacket(n),a())})).catch((e=>{}))};a();const s={type:"open"};this.query.sid&&(s.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(s).then((()=>this.onOpen()))}))}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then((()=>{r&&fp((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends kp{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Tp&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new Ep(Pp,this.uri(),e)}}},Ip=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Op=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Fp(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=Ip.exec(e||""),s={},i=14;for(;i--;)s[Op[i]]=a[i]||"";return-1!=n&&-1!=r&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,s.path),s.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,s.query),s}const Mp="function"===typeof addEventListener&&"function"===typeof removeEventListener,Bp=[];Mp&&addEventListener("offline",(()=>{Bp.forEach((e=>e()))}),!1);class zp extends hp{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const n=Fp(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=Fp(t.host).host);bp(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach((e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e})),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),Mp&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Bp.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);const e=this.opts.rememberUpgrade&&zp.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(e=>this._onClose("transport close",e)))}onOpen(){this.readyState="open",zp.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(e+="string"===typeof(t=r)?function(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))),n>0&&e>this._maxPayload)return this.writeBuffer.slice(0,n);e+=2}var t;return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,fp((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const a={type:e,data:t,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}_onError(e){if(zp.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Mp&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=Bp.indexOf(this._offlineEventListener);-1!==e&&Bp.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}zp.protocol=4;class Up extends zp{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;zp.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;zp.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function a(){n||(n=!0,c(),t.close(),t=null)}const s=e=>{const n=new Error("probe error: "+e);n.transport=t.name,a(),this.emitReserved("upgradeError",n)};function i(){s("transport closed")}function o(){s("socket closed")}function l(e){t&&e.name!==t.name&&a()}const c=()=>{t.removeListener("open",r),t.removeListener("error",s),t.removeListener("close",i),this.off("close",o),this.off("upgrading",l)};t.once("open",r),t.once("error",s),t.once("close",i),this.once("close",o),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}class qp extends Up{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map((e=>Dp[e])).filter((e=>!!e))),super(e,t)}}const Vp="function"===typeof ArrayBuffer,Wp=Object.prototype.toString,Hp="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Wp.call(Blob),Gp="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===Wp.call(File);function Yp(e){return Vp&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Hp&&e instanceof Blob||Gp&&e instanceof File}function $p(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if($p(e[t]))return!0;return!1}if(Yp(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return $p(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&$p(e[n]))return!0;return!1}function Kp(e){const t=[],n=e.data,r=e;return r.data=Jp(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Jp(e,t){if(!e)return e;if(Yp(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=Jp(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Jp(e[r],t));return n}return e}function Xp(e,t){return e.data=Qp(e.data,t),delete e.attachments,e}function Qp(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Qp(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Qp(e[n],t));return e}const Zp=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],em=5;var tm;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(tm||(tm={}));class nm{constructor(e){this.replacer=e}encode(e){return e.type!==tm.EVENT&&e.type!==tm.ACK||!$p(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===tm.EVENT?tm.BINARY_EVENT:tm.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==tm.BINARY_EVENT&&e.type!==tm.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Kp(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function rm(e){return"[object Object]"===Object.prototype.toString.call(e)}class am extends hp{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===tm.BINARY_EVENT;n||t.type===tm.BINARY_ACK?(t.type=n?tm.EVENT:tm.ACK,this.reconstructor=new sm(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Yp(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===tm[n.type])throw new Error("unknown packet type "+n.type);if(n.type===tm.BINARY_EVENT||n.type===tm.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const a=e.substring(r,t);if(a!=Number(a)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(a)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!am.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(cw){return!1}}static isPayloadValid(e,t){switch(e){case tm.CONNECT:return rm(t);case tm.DISCONNECT:return void 0===t;case tm.CONNECT_ERROR:return"string"===typeof t||rm(t);case tm.EVENT:case tm.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===Zp.indexOf(t[0]));case tm.ACK:case tm.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class sm{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Xp(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function im(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const om=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class lm extends hp{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[im(e,"open",this.onopen.bind(this)),im(e,"packet",this.onpacket.bind(this)),im(e,"error",this.onerror.bind(this)),im(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,n,r;if(om.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const o={type:tm.EVENT,data:s,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"===typeof s[s.length-1]){const e=this.ids++,t=s.pop();this._registerAckCallback(e,t),o.id=e}const l=null===(n=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===n?void 0:n.writable,c=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n,r=this;const a=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===a)return void(this.acks[e]=t);const s=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),a),i=function(){r.io.clearTimeoutFn(s);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];t.apply(r,n)};i.withError=!0,this.acks[e]=i}emitWithAck(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise(((t,r)=>{const a=(e,n)=>e?r(e):t(n);a.withError=!0,n.push(a),this.emit(e,...n)}))}_addToQueue(e){var t=this;let n;"function"===typeof e[e.length-1]&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((function(e){if(r!==t._queue[0])return;if(null!==e)r.tryCount>t._opts.retries&&(t._queue.shift(),n&&n(e));else if(t._queue.shift(),n){for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];n(null,...s)}return r.pending=!1,t._drainQueue()})),this._queue.push(r),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:tm.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach((e=>{if(!this.sendBuffer.some((t=>String(t.id)===e))){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}}))}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case tm.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case tm.EVENT:case tm.BINARY_EVENT:this.onevent(e);break;case tm.ACK:case tm.BINARY_ACK:this.onack(e);break;case tm.DISCONNECT:this.ondisconnect();break;case tm.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];t.packet({type:tm.ACK,id:e,data:a})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:tm.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function cm(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}cm.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},cm.prototype.reset=function(){this.attempts=0},cm.prototype.setMin=function(e){this.ms=e},cm.prototype.setMax=function(e){this.max=e},cm.prototype.setJitter=function(e){this.jitter=e};class um extends hp{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,bp(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new cm({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||a;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new qp(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=im(t,"open",(function(){n.onopen(),e&&e()})),a=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},s=im(t,"error",a);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn((()=>{r(),a(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(im(e,"ping",this.onping.bind(this)),im(e,"data",this.ondata.bind(this)),im(e,"error",this.onerror.bind(this)),im(e,"close",this.onclose.bind(this)),im(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(cw){this.onclose("parse error",cw)}}ondecoded(e){fp((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new lm(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const dm={};function hm(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=Fp(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,a=n.id,s=n.path,i=dm[a]&&s in dm[a].nsps;let o;return t.forceNew||t["force new connection"]||!1===t.multiplex||i?o=new um(r,t):(dm[a]||(dm[a]=new um(r,t)),o=dm[a]),n.query&&!t.query&&(t.query=n.queryKey),o.socket(n.path,t)}Object.assign(hm,{Manager:um,Socket:lm,io:hm,connect:hm});const fm={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:5000/api"}.REACT_APP_SOCKET_URL||"http://localhost:5000";let pm=null;const mm=()=>(pm||(pm=hm(fm,{transports:["websocket"]}),pm.on("connect",(()=>{console.log("Connect\xe9 au serveur WebSocket")})),pm.on("disconnect",(e=>{var t;(console.log("D\xe9connect\xe9 du serveur WebSocket:",e),"io server disconnect"===e)&&(null===(t=pm)||void 0===t||t.connect())})),pm.on("connect_error",(e=>{console.error("Erreur de connexion WebSocket:",e.message)}))),pm),gm=localStorage.getItem("token");gm&&(Yr.defaults.headers.common.Authorization="Bearer ".concat(gm));const vm=function(e){var t;let{userRole:n="conseillere"}=e;const[r,a]=(0,s.useState)(0),[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)(null),[d,h]=(0,s.useState)(!1),[f,p]=(0,s.useState)("dateCreation"),[m,g]=(0,s.useState)("desc");(0,s.useEffect)((()=>{const e=mm();return e.on("leadCreated",(()=>{console.log("[Leads] Lead cr\xe9\xe9 - actualisation de la liste"),a((e=>e+1))})),e.on("leadUpdated",(()=>{console.log("[Leads] Lead mis \xe0 jour - actualisation de la liste"),a((e=>e+1))})),e.on("leadDeleted",(()=>{console.log("[Leads] Lead supprim\xe9 - actualisation de la liste"),a((e=>e+1))})),e.on("clientCreated",(()=>{console.log("[Leads] Client cr\xe9\xe9 (conversion) - actualisation de la liste"),a((e=>e+1))})),()=>{e.off("leadCreated"),e.off("leadUpdated"),e.off("leadDeleted"),e.off("clientCreated")}}),[]);const v=e=>{f===e?g("asc"===m?"desc":"asc"):(p(e),g("asc"))},b=e=>f!==e?"\u2195\ufe0f":"asc"===m?"\u2191":"\u2193",x=(e,t)=>{if(!e||!t)return;const n=e.getBoundingClientRect(),r=window.innerHeight,a=window.innerWidth;e.classList.remove("dropdown-top","dropdown-left"),n.bottom>r-10&&e.classList.add("dropdown-top"),n.right>a-10&&e.classList.add("dropdown-left")};(0,s.useEffect)((()=>{const e=e=>{const t=e.target.closest(".actions-dropdown"),n=e.target.closest(".actions-dropdown-button");t||n||null===i||o(null)};return document.addEventListener("click",e,!0),document.addEventListener("touchstart",e,!0),()=>{document.removeEventListener("click",e,!0),document.removeEventListener("touchstart",e,!0)}}),[i]);const y=e=>{switch(e){case"Nouveau":return"fa-star";case"Contact\xe9":return"fa-phone";case"\xc0 recontacter":return"fa-phone-slash";case"Rendez-vous pris":return"fa-calendar-check";case"Consultation effectu\xe9e":return"fa-clipboard-check";case"Consultation manqu\xe9e":return"fa-calendar-times";case"Qualifi\xe9":return"fa-user-check";case"Non qualifi\xe9":return"fa-user-times";case"Pas int\xe9ress\xe9":return"fa-times-circle";case"Client":return"fa-user-tie";default:return"fa-circle"}},[w,j]=(0,s.useState)([]),[N,S]=(0,s.useState)(!0),C=async()=>{console.log("\ud83d\udd04 Chargement des leads depuis l'API...");try{S(!0);const e=localStorage.getItem("token"),t={};e?(t.Authorization="Bearer ".concat(e),console.log("\ud83d\udd11 Token configur\xe9 pour la requ\xeate:",e.substring(0,20)+"...")):console.log("\u26a0\ufe0f Aucun token trouv\xe9 dans localStorage");const n=await Yr.get("http://localhost:5000/api/leads",{headers:t});if(console.log("\ud83d\udce1 R\xe9ponse API loadLeads:",n.data),n.data.success){const e=n.data.data.leads.map((e=>({id:e.id,nom:e.nom,prenom:e.prenom,email:e.email,telephone:e.telephone,source:e.source,statut:e.statut,dateCreation:e.date_creation?e.date_creation.split("T")[0]:(new Date).toISOString().split("T")[0],conseillere:e.conseillere||"",interet:e.interet,notes:e.notes||""})));console.log("\u2705 Leads transform\xe9s:",e),j(e)}}catch(e){console.error("\u274c Erreur lors du chargement des leads:",e)}finally{S(!1)}};(0,s.useEffect)((()=>{C(),k()}),[]);const k=async()=>{if("conseillere"===n)return console.log("\ud83d\udc64 Utilisateur conseill\xe8re - pas de chargement des autres conseill\xe8res"),void ee([]);try{console.log("\ud83d\udd04 Chargement des conseillers pour Leads.js...");const e=await Zr();if(e.success&&e.data){ne(e.data);const t=ta(e.data);ee(t),console.log("\u2705 Conseillers charg\xe9s dans Leads.js:",t)}else{const t=ta(e.data);ee(t)}}catch(e){console.error("\u274c Erreur lors du chargement des conseillers dans Leads.js:",e)}},[E,A]=(0,s.useState)({statut:"",source:"",conseillere:""}),[T,P]=(0,s.useState)(""),[_,L]=(0,s.useState)(""),[R,D]=(0,s.useState)({nom:"",prenom:"",email:"",telephone:"",source:"Site web",statut:"Nouveau",conseillere:"",interet:"",notes:""}),[I,O]=(0,s.useState)(null),[F,M]=(0,s.useState)(!1),[B,z]=(0,s.useState)(!1),[U,q]=(0,s.useState)(!1),[V,W]=(0,s.useState)(!1),[H,G]=(0,s.useState)(!1),[Y,$]=(0,s.useState)(!1),[K,J]=(0,s.useState)({leadId:null,conseillere:""}),[X,Q]=(0,s.useState)({leadId:null,date:"",heure:"",notes:""}),[Z,ee]=(0,s.useState)(["wafaa chaouby","hame amni","sanaa sami"]),[te,ne]=(0,s.useState)([]),re=["Nouveau","Contact\xe9","\xc0 recontacter","Rendez-vous pris","Consultation effectu\xe9e","Consultation manqu\xe9e","Qualifi\xe9","Non qualifi\xe9","Pas int\xe9ress\xe9","Client"],ae=["Site web","LinkedIn","Facebook","R\xe9f\xe9rence","Autre"],se=["Permis d'\xe9tudes","Permis de travail","R\xe9sidence permanente","Visa visiteur","Citoyennet\xe9","Autre"];(0,s.useEffect)((()=>{if("conseillere"===n){const e=localStorage.getItem("userName");e&&(L(e),console.log("\ud83d\udc64 Nom de la conseill\xe8re connect\xe9e d\xe9fini:",e))}}),[n]),(0,s.useEffect)((()=>{if(Z.length>0&&!R.conseillere){const e=localStorage.getItem("userName");if(console.log("\ud83d\udc64 Utilisateur connect\xe9 r\xe9cup\xe9r\xe9 (Leads.js):",e),console.log("\ud83d\udccb Liste des conseill\xe8res disponibles (Leads.js):",Z),e){const t=Z.find((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())));t?(console.log("\u2705 Pr\xe9remplissage du champ conseill\xe8re (Leads.js) avec:",t),D((e=>u(u({},e),{},{conseillere:t})))):console.log("\u26a0\ufe0f Utilisateur connect\xe9 non trouv\xe9 dans la liste des conseill\xe8res (Leads.js):",{userName:e,conseilleresOptions:Z,recherchePartielle:Z.filter((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())))})}else console.log("\u26a0\ufe0f Aucun utilisateur connect\xe9 trouv\xe9 dans localStorage (Leads.js)")}}),[Z,R.conseillere]);const ie=()=>{let e=[];if("administrateur"===n||"directeur"===n)e=[...w];else if("conseillere"===n){const t=localStorage.getItem("userName");e=t?w.filter((e=>!e.conseillere||(e.conseillere.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(e.conseillere.toLowerCase())))):w.filter((e=>!e.conseillere))}else e=[...w];return e.filter((e=>{const t=""===T||"".concat(e.prenom," ").concat(e.nom).toLowerCase().includes(T.toLowerCase())||e.email.toLowerCase().includes(T.toLowerCase())||e.telephone.includes(T),n=""===E.statut||e.statut===E.statut,r=""===E.source||e.source===E.source,a=""===E.conseillere||e.conseillere===E.conseillere;return t&&n&&r&&a}))},oe=(()=>{const e=[...ie()].sort(((e,t)=>{let n,r;switch(f){case"nom":n="".concat(e.prenom," ").concat(e.nom).toLowerCase(),r="".concat(t.prenom," ").concat(t.nom).toLowerCase();break;case"email":n=e.email.toLowerCase(),r=t.email.toLowerCase();break;case"telephone":n=e.telephone,r=t.telephone;break;case"source":n=e.source.toLowerCase(),r=t.source.toLowerCase();break;case"statut":n=e.statut.toLowerCase(),r=t.statut.toLowerCase();break;case"dateCreation":n=new Date(e.dateCreation).getTime(),r=new Date(t.dateCreation).getTime();break;case"conseillere":n=(e.conseillere||"").toLowerCase(),r=(t.conseillere||"").toLowerCase();break;case"interet":n=e.interet.toLowerCase(),r=t.interet.toLowerCase();break;default:return 0}return n<r?"asc"===m?-1:1:n>r?"asc"===m?1:-1:0}));return e})(),le=e=>{const{name:t,value:n}=e.target;A(u(u({},E),{},{[t]:n}))},ce=e=>{const{name:t,value:n}=e.target;D(u(u({},R),{},{[t]:n}))},ue=()=>{const e=localStorage.getItem("userName");let t="";if(e&&Z.length>0){const n=Z.find((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())));n&&(t=n)}D({nom:"",prenom:"",email:"",telephone:"",source:"Site web",statut:"Nouveau",conseillere:t,interet:"",notes:""}),console.log("\ud83d\udd04 Formulaire lead r\xe9initialis\xe9 avec conseill\xe8re pr\xe9remplie:",t)},de=()=>{M(!1),ue()},he=async(e,t)=>{console.log("\ud83d\udd04 Tentative de changement de statut pour lead ".concat(e,": ").concat(t));const n=w.find((t=>t.id===e));if(n&&"Client"===n.statut)alert("\u274c Impossible de modifier le statut : ce lead a \xe9t\xe9 converti en client et son statut est verrouill\xe9.");else try{const n=await Yr.put("http://localhost:5000/api/leads/".concat(e),{statut:t});if(console.log("\ud83d\udce1 R\xe9ponse API:",n.data),n.data.success){const n=w.map((n=>n.id===e?u(u({},n),{},{statut:t}):n));j(n),console.log("\u2705 Statut du lead ".concat(e," mis \xe0 jour: ").concat(t))}}catch(i){var r,a,s;console.error("\u274c Erreur lors de la mise \xe0 jour du statut:",i),console.error("\ud83d\udcca D\xe9tails de l'erreur:",null===(r=i.response)||void 0===r?void 0:r.data),alert("Erreur lors de la mise \xe0 jour du statut: "+((null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||i.message))}},fe=e=>{O(e),q(!0)},pe=e=>{const{name:t,value:n}=e.target;"statut"!==t||"Client"!==I.statut?(me()||"statut"===t||"notes"===t)&&O(u(u({},I),{},{[t]:n})):alert("\u274c Impossible de modifier le statut : ce lead a \xe9t\xe9 converti en client et son statut est verrouill\xe9.")},me=()=>"administrateur"===n||"directeur"===n,ge=e=>{const{name:t,value:n}=e.target;Q(u(u({},X),{},{[t]:n}))};return(0,$r.jsxs)("div",{className:"leads-container",children:[(0,$r.jsxs)("div",{className:"page-header",children:[(0,$r.jsx)("h1",{children:"Gestion des Leads"}),(0,$r.jsxs)("div",{className:"header-actions",children:[(0,$r.jsxs)("button",{className:"btn btn-help",onClick:()=>$(!0),children:[(0,$r.jsx)("i",{className:"fas fa-question-circle"})," Aide"]}),(0,$r.jsxs)("button",{className:"btn btn-primary",onClick:()=>{M(!0),setTimeout((()=>{if(Z.length>0){const e=localStorage.getItem("userName");if(e){const t=Z.find((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())));t&&!R.conseillere&&(console.log("\u2705 Pr\xe9remplissage manuel du champ conseill\xe8re (Modal Leads):",t),D((e=>u(u({},e),{},{conseillere:t}))))}}}),100)},children:[(0,$r.jsx)("i",{className:"fas fa-plus"})," Nouveau Lead"]}),("administrateur"===n||"directeur"===n||"secretaire"===n)&&(0,$r.jsxs)("button",{className:"btn btn-secondary",onClick:()=>z(!0),children:[(0,$r.jsx)("i",{className:"fas fa-file-import"})," Importer Excel"]})]})]}),(0,$r.jsxs)("div",{className:"search-filter-container",style:{display:"flex",alignItems:"center",gap:"24px",marginBottom:"24px",background:"white",borderRadius:"12px",boxShadow:"var(--shadow-sm)",padding:"24px",flexWrap:"wrap"},children:[(0,$r.jsxs)("div",{style:{display:"flex",flex:1,alignItems:"center",minWidth:300,height:40,background:"#f8f9fa",borderRadius:8,padding:"0 16px",marginRight:16,marginBottom:8},children:[(0,$r.jsx)("i",{className:"fas fa-search",style:{marginRight:8,color:"var(--text-secondary)"}}),(0,$r.jsx)("input",{type:"text",placeholder:"Rechercher par nom, email ou t\xe9l\xe9phone...",value:T,onChange:e=>P(e.target.value),style:{border:"none",background:"transparent",outline:"none",width:"100%",fontSize:"1rem",height:40,lineHeight:"40px"}})]}),(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap",marginBottom:8},children:[(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,height:40},children:[(0,$r.jsx)("label",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:500,lineHeight:"40px",marginRight:4},children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:E.statut,onChange:le,style:{padding:"8px 12px",border:"1px solid var(--color-neutral-medium)",borderRadius:6,fontSize:"1rem",minWidth:120,height:40,boxSizing:"border-box"},children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),re.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,height:40},children:[(0,$r.jsx)("label",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:500,lineHeight:"40px",marginRight:4},children:"Source:"}),(0,$r.jsxs)("select",{name:"source",value:E.source,onChange:le,style:{padding:"8px 12px",border:"1px solid var(--color-neutral-medium)",borderRadius:6,fontSize:"1rem",minWidth:120,height:40,boxSizing:"border-box"},children:[(0,$r.jsx)("option",{value:"",children:"Toutes"}),ae.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,height:40},children:[(0,$r.jsx)("label",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:500,lineHeight:"40px",marginRight:4},children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:E.conseillere,onChange:le,disabled:"conseillere"===n,style:{backgroundColor:"conseillere"===n?"#f5f5f5":"white",color:"conseillere"===n?"#999":"black",cursor:"conseillere"===n?"not-allowed":"pointer",padding:"8px 12px",border:"1px solid var(--color-neutral-medium)",borderRadius:6,fontSize:"1rem",minWidth:120,height:40,boxSizing:"border-box"},children:[(0,$r.jsx)("option",{value:"",children:"conseillere"===n?_?"".concat(_):"Mes leads":"Toutes"}),"conseillere"!==n&&Z.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("button",{className:"btn-text",onClick:()=>{A({statut:"",source:"",conseillere:""}),P("")},style:{height:40,boxSizing:"border-box",display:"flex",alignItems:"center",gap:4,fontSize:"1rem",padding:"8px 12px",borderRadius:6,marginLeft:8,whiteSpace:"nowrap"},children:[(0,$r.jsx)("i",{className:"fas fa-times"})," R\xe9initialiser"]})]})]}),(0,$r.jsx)("div",{className:"leads-table-container",children:(0,$r.jsxs)("table",{className:"leads-table sortable-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsxs)("th",{className:"sortable-header ".concat("nom"===f?"active":""),onClick:()=>v("nom"),title:"Cliquer pour trier",children:["Nom complet ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("nom")})]}),(0,$r.jsxs)("th",{className:"sortable-header ".concat("email"===f?"active":""),onClick:()=>v("email"),title:"Cliquer pour trier",children:["Email ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("email")})]}),(0,$r.jsxs)("th",{className:"sortable-header ".concat("telephone"===f?"active":""),onClick:()=>v("telephone"),title:"Cliquer pour trier",children:["T\xe9l\xe9phone ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("telephone")})]}),(0,$r.jsxs)("th",{className:"sortable-header ".concat("source"===f?"active":""),onClick:()=>v("source"),title:"Cliquer pour trier",children:["Source ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("source")})]}),(0,$r.jsxs)("th",{className:"sortable-header ".concat("statut"===f?"active":""),onClick:()=>v("statut"),title:"Cliquer pour trier",children:["Statut ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("statut")})]}),(0,$r.jsxs)("th",{className:"sortable-header ".concat("dateCreation"===f?"active":""),onClick:()=>v("dateCreation"),title:"Cliquer pour trier",children:["Date cr\xe9ation ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("dateCreation")})]}),(0,$r.jsxs)("th",{className:"sortable-header ".concat("conseillere"===f?"active":""),onClick:()=>v("conseillere"),title:"Cliquer pour trier",children:["Conseill\xe8re ",(0,$r.jsx)("span",{className:"sort-indicator",children:b("conseillere")})]}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:N?(0,$r.jsx)("tr",{children:(0,$r.jsxs)("td",{colSpan:"8",className:"loading-state",style:{textAlign:"center",padding:"40px"},children:[(0,$r.jsx)("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"24px",color:"#007bff"}}),(0,$r.jsx)("p",{style:{margin:"10px 0 0 0"},children:"Chargement des leads depuis l'API backend..."})]})}):oe.length>0?oe.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsxs)("td",{className:"clickable",onClick:()=>fe(e),children:[e.prenom," ",e.nom]}),(0,$r.jsx)("td",{children:e.email}),(0,$r.jsx)("td",{children:e.telephone}),(0,$r.jsx)("td",{children:e.source}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("span",{className:"status-badge status-".concat(e.statut.toLowerCase().replace(/\s+/g,"-").replace(/[\xe9\xe8\xea]/g,"e")," ").concat("Client"===e.statut?"locked":""),children:[(0,$r.jsx)("i",{className:"fas ".concat(y(e.statut))}),e.statut]})}),(0,$r.jsx)("td",{children:e.dateCreation}),(0,$r.jsx)("td",{children:e.conseillere||(0,$r.jsxs)("button",{className:"btn-assign",onClick:()=>{return t=e.id,J({leadId:t,conseillere:""}),void W(!0);var t},disabled:"secretaire"!==n&&"administrateur"!==n&&"directeur"!==n,children:[(0,$r.jsx)("i",{className:"fas fa-user-plus"})," Assigner"]})}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"actions-dropdown",children:[(0,$r.jsx)("button",{className:"btn-action actions-dropdown-button",onClick:t=>{return n=e.id,(r=t).preventDefault(),r.stopPropagation(),void o((e=>{const t=e===n?null:n;return t===n&&setTimeout((()=>{var e;const t=null===(e=r.target.closest(".actions-dropdown"))||void 0===e?void 0:e.querySelector(".actions-dropdown-menu");t&&x(t,r.target)}),10),t}));var n,r},type:"button",children:(0,$r.jsx)("i",{className:"fas fa-ellipsis-v"})}),i===e.id&&(0,$r.jsxs)("div",{className:"dropdown-content actions-dropdown-menu show",children:[(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{t.stopPropagation(),fe(e),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-eye"})," Voir d\xe9tails"]}),"Client"!==e.statut&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{t.stopPropagation(),he(e.id,"Contact\xe9"),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-phone"})," Marquer comme contact\xe9"]}),(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{var n;t.stopPropagation(),n=e.id,Q({leadId:n,date:"",heure:"",notes:""}),G(!0),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-clock"})," Planifier un rappel"]}),(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{t.stopPropagation(),he(e.id,"Rendez-vous pris"),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-calendar-plus"})," Prendre rendez-vous"]}),(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{t.stopPropagation(),he(e.id,"Qualifi\xe9"),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-user-check"})," Qualifier"]}),(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{t.stopPropagation(),he(e.id,"Pas int\xe9ress\xe9"),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-user-times"})," Pas int\xe9ress\xe9"]}),(0,$r.jsxs)("button",{className:"actions-dropdown-item",onClick:t=>{t.stopPropagation(),(e=>{const t={id:e.id,nom:e.nom,prenom:e.prenom,email:e.email,telephone:e.telephone,source:e.source,interet:e.interet,conseillere:e.conseillere,statut:e.statut};c(t),h(!0),o(null)})(e),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-user-tie"})," Convertir en client"]})]}),"Client"===e.statut&&(0,$r.jsxs)("div",{className:"dropdown-info",children:[(0,$r.jsx)("i",{className:"fas fa-lock"})," Lead converti en client",(0,$r.jsx)("small",{children:"Le statut ne peut plus \xeatre modifi\xe9"})]}),("administrateur"===n||"directeur"===n)&&(0,$r.jsxs)("button",{className:"actions-dropdown-item danger",onClick:t=>{t.stopPropagation(),(async e=>{if(("administrateur"===n||"directeur"===n)&&window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce lead ?"))try{if((await Yr.delete("http://localhost:5000/api/leads/".concat(e))).data.success){const t=w.filter((t=>t.id!==e));j(t),console.log("\u2705 Lead ".concat(e," supprim\xe9 avec succ\xe8s"))}}catch(a){var t,r;console.error("Erreur lors de la suppression du lead:",a),alert("Erreur lors de la suppression du lead: "+((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message))}})(e.id),setTimeout((()=>o(null)),100)},children:[(0,$r.jsx)("i",{className:"fas fa-trash"})," Supprimer"]})]})]})})]},e.id))):(0,$r.jsx)("tr",{children:(0,$r.jsx)("td",{colSpan:"8",className:"no-results",children:"Aucun lead ne correspond aux crit\xe8res de recherche"})})})]})}),Y&&(0,$r.jsx)(Qr,{onClose:()=>$(!1)}),F&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Ajouter un nouveau lead"}),(0,$r.jsx)("button",{className:"close-btn",onClick:de,children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await Yr.post("http://localhost:5000/api/leads",{nom:R.nom,prenom:R.prenom,email:R.email,telephone:R.telephone,source:R.source,interet:R.interet,conseillere:R.conseillere,notes:R.notes});if(e.data.success){const t={id:e.data.data.id,nom:R.nom,prenom:R.prenom,email:R.email,telephone:R.telephone,source:R.source,statut:"Nouveau",dateCreation:(new Date).toISOString().split("T")[0],conseillere:R.conseillere,interet:R.interet,notes:R.notes};j((e=>[...e,t])),ue(),M(!1),alert("Lead cr\xe9\xe9 avec succ\xe8s et enregistr\xe9 en base de donn\xe9es !")}}catch(r){var t,n;console.error("Erreur lors de la cr\xe9ation du lead:",r),alert("Erreur lors de la cr\xe9ation du lead: "+((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||r.message))}},children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom:"}),(0,$r.jsx)("input",{type:"text",name:"nom",value:R.nom,onChange:ce,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pr\xe9nom:"}),(0,$r.jsx)("input",{type:"text",name:"prenom",value:R.prenom,onChange:ce,required:!0})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("input",{type:"email",name:"email",value:R.email,onChange:ce,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("input",{type:"tel",name:"telephone",value:R.telephone,onChange:ce,required:!0})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Source:"}),(0,$r.jsx)("select",{name:"source",value:R.source,onChange:ce,children:ae.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Int\xe9r\xeat principal:"}),(0,$r.jsxs)("select",{name:"interet",value:R.interet,onChange:ce,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),se.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:R.conseillere,onChange:ce,children:[(0,$r.jsx)("option",{value:"",children:"\xc0 assigner"}),Z.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Notes:"}),(0,$r.jsx)("textarea",{name:"notes",value:R.notes,onChange:ce,rows:"3"})]})}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:de,children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Ajouter"})]})]})]})}),(0,$r.jsx)(Uf,{isOpen:B,onClose:()=>z(!1),onImportSuccess:e=>{console.log("\u2705 Importation r\xe9ussie:",e),a((e=>e+1));let t="\u2705 ".concat(e.totalImported," leads import\xe9s avec succ\xe8s !");e.errors&&e.errors.length>0&&(t+="\n\n\u26a0\ufe0f ".concat(e.errors.length," erreurs rencontr\xe9es :"),e.errors.forEach((e=>{t+="\n\u2022 ".concat(e.lead,": ").concat(e.error)}))),alert(t)},conseillers:te}),U&&I&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content modal-large",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsxs)("h3",{children:["D\xe9tails du lead: ",I.prenom," ",I.nom]}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>q(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),console.log("\ud83d\udd04 Mise \xe0 jour du lead ".concat(I.id," via l'API..."));try{const e=w.find((e=>e.id===I.id)),t="Consultation effectu\xe9e"===I.statut&&"Consultation effectu\xe9e"!==(null===e||void 0===e?void 0:e.statut),n={nom:I.nom,prenom:I.prenom,email:I.email,telephone:I.telephone,source:I.source,statut:I.statut,interet:I.interet,conseillere:I.conseillere,notes:I.notes},r=await Yr.put("http://localhost:5000/api/leads/".concat(I.id),n);if(console.log("\ud83d\udce1 R\xe9ponse API updateLead:",r.data),r.data.success){if(t)try{console.log("\ud83d\udd0d Recherche du conseiller:",I.conseillere),console.log("\ud83d\udd0d Liste des conseillers:",te);const e=te.find((e=>e.nomComplet===I.conseillere));console.log("\ud83d\udd0d Conseiller trouv\xe9:",e),e?(console.log("\ud83d\udcdd Cr\xe9ation de la consultation pour le conseiller ID:",e.id),await Vf.createConsultation(I.id,e.id,"Consultation effectu\xe9e - mise \xe0 jour du statut"),console.log("\u2705 Consultation cr\xe9\xe9e automatiquement")):(console.warn("\u26a0\ufe0f Impossible de trouver le conseiller pour cr\xe9er la consultation"),console.warn("\u26a0\ufe0f Lead.conseillere:",I.conseillere),console.warn("\u26a0\ufe0f Conseillers disponibles:",te.map((e=>e.nomComplet))))}catch(a){console.error("\u274c Erreur lors de la cr\xe9ation de la consultation:",a)}const e=w.map((e=>e.id===I.id?I:e));j(e),q(!1),console.log("\u2705 Lead ".concat(I.id," mis \xe0 jour avec succ\xe8s")),alert("Lead mis \xe0 jour avec succ\xe8s !"+(t?" Consultation enregistr\xe9e automatiquement.":""))}}catch(s){var t,n,r;console.error("\u274c Erreur lors de la mise \xe0 jour du lead:",s),console.error("\ud83d\udcca D\xe9tails de l'erreur:",null===(t=s.response)||void 0===t?void 0:t.data),alert("Erreur lors de la mise \xe0 jour du lead: "+((null===(n=s.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||s.message))}},children:["Client"===I.statut&&(0,$r.jsxs)("div",{className:"modal-info-message",children:[(0,$r.jsx)("i",{className:"fas fa-info-circle"}),"Ce lead a \xe9t\xe9 converti en client. Certaines modifications sont restreintes pour pr\xe9server l'int\xe9grit\xe9 des donn\xe9es."]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom:"}),(0,$r.jsx)("input",{type:"text",name:"nom",value:I.nom,onChange:pe,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pr\xe9nom:"}),(0,$r.jsx)("input",{type:"text",name:"prenom",value:I.prenom,onChange:pe,required:!0})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("input",{type:"email",name:"email",value:I.email,onChange:pe,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("input",{type:"tel",name:"telephone",value:I.telephone,onChange:pe,required:!0})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Source:"}),(0,$r.jsx)("select",{name:"source",value:I.source,onChange:pe,children:ae.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsx)("select",{name:"statut",value:I.statut,onChange:pe,disabled:"Client"===I.statut,style:{backgroundColor:"Client"===I.statut?"#f8f9fa":"white",cursor:"Client"===I.statut?"not-allowed":"pointer"},children:re.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))}),"Client"===I.statut&&(0,$r.jsxs)("small",{style:{color:"#6c757d",display:"block",marginTop:"5px"},children:[(0,$r.jsx)("i",{className:"fas fa-lock"})," Le statut ne peut plus \xeatre modifi\xe9 car le lead a \xe9t\xe9 converti en client"]})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Int\xe9r\xeat principal:"}),(0,$r.jsxs)("select",{name:"interet",value:I.interet,onChange:pe,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),se.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:I.conseillere,onChange:pe,children:[(0,$r.jsx)("option",{value:"",children:"\xc0 assigner"}),Z.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de cr\xe9ation:"}),(0,$r.jsx)("input",{type:"text",value:I.dateCreation,readOnly:!0})]})}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Notes:"}),(0,$r.jsx)("textarea",{name:"notes",value:I.notes,onChange:pe,rows:"5"})]})}),(0,$r.jsx)(Wf,{leadId:I.id,conseillerId:null===(t=te.find((e=>e.nom===I.conseillere)))||void 0===t?void 0:t.id,onConsultationChange:(e,t)=>{console.log("Consultation ".concat(e,":"),t)}}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>q(!1),children:"Fermer"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Enregistrer les modifications"})]})]})]})}),V&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Assigner le lead \xe0 une conseill\xe8re"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>W(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=te.find((e=>e.nomComplet===K.conseillere));if(!e)return void alert("Conseiller non trouv\xe9");await Yr.post("http://localhost:5000/api/leads/".concat(K.leadId,"/assign"),{conseiller_id:e.id});const t=w.map((e=>e.id===K.leadId?u(u({},e),{},{conseillere:K.conseillere}):e));j(t),W(!1),alert("Lead assign\xe9 avec succ\xe8s")}catch(t){console.error("\u274c Erreur lors de l'assignation:",t),alert("Erreur lors de l'assignation du lead")}},children:[(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:K.conseillere,onChange:e=>{const{name:t,value:n}=e.target;J(u(u({},K),{},{[t]:n}))},required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),Z.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>W(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Assigner"})]})]})]})}),H&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Planifier un rappel"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>G(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),alert("Rappel planifi\xe9 pour le ".concat(X.date," \xe0 ").concat(X.heure));const t=w.map((e=>e.id===X.leadId?u(u({},e),{},{statut:"\xc0 recontacter"}):e));j(t),G(!1)},children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date:"}),(0,$r.jsx)("input",{type:"date",name:"date",value:X.date,onChange:ge,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Heure:"}),(0,$r.jsx)("input",{type:"time",name:"heure",value:X.heure,onChange:ge,required:!0})]})]}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Notes:"}),(0,$r.jsx)("textarea",{name:"notes",value:X.notes,onChange:ge,rows:"3"})]})}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>G(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Planifier"})]})]})]})}),l&&(0,$r.jsx)(oa,{lead:l,isOpen:d,onClose:()=>{c(null),h(!1)},onConvert:async(e,t,n)=>{try{const r=await sa(e,t,n);if(r.success){const t=w.map((t=>t.id===e?u(u({},t),{},{statut:"Client"}):t));j(t),alert("\u2705 Lead converti avec succ\xe8s!\n\nNum\xe9ro de dossier: ".concat(r.data.numeroDossier,"\nClient cr\xe9\xe9: ").concat(r.data.client.nom," ").concat(r.data.client.prenom)),C()}}catch(r){throw console.error("Erreur lors de la conversion:",r),alert("\u274c Erreur lors de la conversion: ".concat(r.message)),r}},currentUser:"administrateur"===n?"Administrateur":l.conseillere||"Administrateur"})]})},bm=e=>"MAD"===e?"DH":"$",xm=e=>"CAD"===e?1.14975:1.2,ym=e=>"CAD"===e?"14,975%":"20%";const wm=function(e){var t,n,r,a,i;let{client:o,userRole:l,onSave:c,onCancel:d,existingFacture:h=null}=e;const f=localStorage.getItem("userName")||l,p=h?u(u({},h),{},{monnaie:h.monnaie||"MAD",prestations:h.prestations&&Array.isArray(h.prestations)&&h.prestations.length>0?h.prestations:[{description:"",montant:0}],montantHT:null!==(t=null===h||void 0===h?void 0:h.montantHT)&&void 0!==t?t:0,tva:null!==(n=null===h||void 0===h?void 0:h.tva)&&void 0!==n?n:0,montantTTC:null!==(r=null===h||void 0===h?void 0:h.montantTTC)&&void 0!==r?r:0,transactions:null!==(a=null===h||void 0===h?void 0:h.transactions)&&void 0!==a?a:[]}):{id:Date.now(),clientId:null!==(i=null===o||void 0===o?void 0:o.id)&&void 0!==i?i:Date.now(),numero:"F-".concat((new Date).getFullYear(),"-").concat(String(Math.floor(1e3*Math.random())).padStart(3,"0")),date:(new Date).toISOString().split("T")[0],montantHT:0,tva:0,montantTTC:0,monnaie:"MAD",description:"",prestations:[{description:"",montant:0}],statut:"brouillon",dateValidation:null,datePaiement:null,validePar:"",transactions:[]},[m,g]=(0,s.useState)(p);(0,s.useEffect)((()=>{if(h&&h.prestations){console.log("\ud83d\udd25 Recalcul des montants au chargement de la facture existante");const e=h.prestations.reduce(((e,t)=>e+(parseFloat(t.montant)||0)),0),t=Math.round(100*e)/100,n=xm(h.monnaie||"MAD"),r=Math.round(t/n*100)/100,a=Math.round(100*(t-r))/100;console.log("\ud83d\udd25 Recalcul: TTC=".concat(t,", HT=").concat(r,", TVA=").concat(a)),h.montantHT===r&&h.montantTTC===t||g((e=>u(u({},e),{},{montantHT:r,tva:a,montantTTC:t})))}}),[h]);const[v,b]=(0,s.useState)(!h||"brouillon"===h.statut),x=()=>"brouillon"===m.statut?"conseillere"===l||"directeur"===l||"administrateur"===l:"directeur"===l||"administrateur"===l,y=e=>{const{name:t,value:n}=e.target;g(u(u({},m),{},{[t]:n}))},w=(e,t,n)=>{console.log("\ud83d\udd27 Modification prestation ".concat(e,", ").concat(t,":"),n);const r=[...m.prestations||[]];r[e][t]="montant"===t?parseFloat(n)||0:n;const a=r.reduce(((e,t)=>e+(parseFloat(t.montant)||0)),0),s=xm(m.monnaie||"MAD"),i=ym(m.monnaie||"MAD"),o=Math.round(100*a)/100,l=Math.round(o/s*100)/100,c=Math.round(100*(o-l))/100;console.log("\ud83d\udcb0 === CALCULS PRESTATIONS (TTC \u2192 HT) ==="),console.log("\ud83d\udcb0 Monnaie: ".concat(m.monnaie||"MAD"," (TVA ").concat(i,")")),console.log("\ud83d\udcb0 Montant TTC saisi: ".concat(o)),console.log("\ud83d\udcb0 Montant HT calcul\xe9: ".concat(l)),console.log("\ud83d\udcb0 TVA (".concat(i,") calcul\xe9e: ").concat(c)),g(u(u({},m),{},{prestations:r,montantHT:l,tva:c,montantTTC:o}))};return(0,$r.jsxs)("div",{className:"facture-form-container",children:[(0,$r.jsx)("h2",{children:h?"Modifier la facture":"Nouvelle facture"}),(0,$r.jsxs)("div",{className:"facture-header",children:[(0,$r.jsxs)("div",{className:"facture-info",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Num\xe9ro de facture"}),(0,$r.jsx)("input",{type:"text",name:"numero",value:m.numero,readOnly:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date"}),(0,$r.jsx)("input",{type:"date",name:"date",value:m.date,onChange:y,disabled:!v||!x()})]})]}),(0,$r.jsxs)("div",{className:"client-info",children:[(0,$r.jsx)("h3",{children:"Client"}),(0,$r.jsxs)("p",{children:[null===o||void 0===o?void 0:o.prenom," ",null===o||void 0===o?void 0:o.nom]}),(0,$r.jsx)("p",{children:null===o||void 0===o?void 0:o.email}),(0,$r.jsx)("p",{children:null===o||void 0===o?void 0:o.telephone}),(null===o||void 0===o?void 0:o.numeroDossier)&&(0,$r.jsxs)("p",{children:["Dossier: ",o.numeroDossier]})]}),(0,$r.jsx)("div",{className:"monnaie-section",children:(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Monnaie"}),(0,$r.jsxs)("select",{name:"monnaie",value:m.monnaie||"MAD",onChange:y,disabled:!v||!x(),children:[(0,$r.jsx)("option",{value:"MAD",children:"MAD (Dirham Marocain)"}),(0,$r.jsx)("option",{value:"CAD",children:"CAD (Dollar Canadien)"})]})]})})]}),(0,$r.jsxs)("div",{className:"prestations-section",children:[(0,$r.jsx)("h3",{children:"Prestations"}),(m.prestations||[]).map(((e,t)=>(0,$r.jsxs)("div",{className:"prestation-item",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Description"}),(0,$r.jsx)("input",{type:"text",value:e.description,onChange:e=>w(t,"description",e.target.value),disabled:!v||!x()})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Montant TTC"}),(0,$r.jsx)("input",{type:"number",value:e.montant,onChange:e=>w(t,"montant",e.target.value),disabled:!v||!x()})]}),v&&x()&&(m.prestations||[]).length>1&&(0,$r.jsx)("button",{type:"button",className:"btn-remove",onClick:()=>(e=>{const t=(m.prestations||[]).filter(((t,n)=>n!==e)),n=t.reduce(((e,t)=>e+(parseFloat(t.montant)||0)),0),r=xm(m.monnaie||"MAD"),a=ym(m.monnaie||"MAD"),s=Math.round(n/r*100)/100,i=Math.round(100*(n-s))/100;console.log("\ud83d\udcb0 === CALCULS SUPPRESSION (TTC BASE) ==="),console.log("\ud83d\udcb0 Monnaie: ".concat(m.monnaie||"MAD"," (TVA ").concat(a,")")),console.log("\ud83d\udcb0 Montant TTC: ".concat(n)),console.log("\ud83d\udcb0 Montant HT calcul\xe9: ".concat(s)),console.log("\ud83d\udcb0 TVA calcul\xe9e: ".concat(i)),g(u(u({},m),{},{prestations:t,montantHT:s,tva:i,montantTTC:n}))})(t),children:(0,$r.jsx)("i",{className:"fas fa-trash"})})]},t))),v&&x()&&(0,$r.jsxs)("button",{type:"button",className:"btn-add",onClick:()=>{g(u(u({},m),{},{prestations:[...m.prestations,{description:"",montant:0}]}))},children:[(0,$r.jsx)("i",{className:"fas fa-plus"})," Ajouter une prestation"]})]}),(0,$r.jsxs)("div",{className:"facture-totals",children:[(0,$r.jsxs)("div",{className:"total-item",children:[(0,$r.jsx)("span",{children:"Montant HT:"}),(0,$r.jsxs)("span",{children:[(m.montantHT||0).toFixed(2)," ",bm(m.monnaie)]})]}),(0,$r.jsxs)("div",{className:"total-item",children:[(0,$r.jsxs)("span",{children:["TVA (",ym(m.monnaie||"MAD"),"):"]}),(0,$r.jsxs)("span",{children:[(m.tva||0).toFixed(2)," ",bm(m.monnaie)]})]}),(0,$r.jsxs)("div",{className:"total-item total-ttc",children:[(0,$r.jsx)("span",{children:"Montant TTC:"}),(0,$r.jsxs)("span",{children:[(m.montantTTC||0).toFixed(2)," ",bm(m.monnaie)]})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Description / Notes"}),(0,$r.jsx)("textarea",{name:"description",value:m.description,onChange:y,disabled:!v||!x()})]}),(0,$r.jsxs)("div",{className:"facture-status",children:[(0,$r.jsxs)("div",{className:"status-badge",children:["Statut: ",(0,$r.jsx)("span",{className:"status-".concat(m.statut),children:m.statut})]}),m.dateValidation&&(0,$r.jsxs)("div",{className:"validation-info",children:["Finalis\xe9e le ",new Date(m.dateValidation).toLocaleDateString()," par ",m.validePar]})]}),(0,$r.jsx)("div",{className:"form-actions",children:v&&x()?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:d,children:"Annuler"}),(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{console.log("\ud83d\udcbe Sauvegarde brouillon - Facture actuelle:",m);const e=u(u({},m),{},{transactions:[...m.transactions||[],{date:(new Date).toISOString(),action:"sauvegarde",utilisateur:f,details:"Facture sauvegard\xe9e comme brouillon"}]});console.log("\ud83d\udcbe Facture \xe0 sauvegarder:",e),g(e),c(e)},children:"Enregistrer brouillon"}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>{console.log("\u2705 Validation facture - Facture actuelle:",m);const e=u(u({},m),{},{statut:"payable",dateValidation:(new Date).toISOString(),validePar:f,transactions:[...m.transactions||[],{date:(new Date).toISOString(),action:"validation",utilisateur:f,details:"Facture finalis\xe9e"}]});console.log("\u2705 Facture valid\xe9e \xe0 sauvegarder:",e),g(e),b(!1),c(e)},children:"Finaliser"})]}):(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:d,children:"Fermer"}),"brouillon"!==m.statut&&("directeur"===l||"administrateur"===l)&&(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>{"directeur"!==l&&"administrateur"!==l||(b(!0),g(u(u({},m),{},{transactions:[...m.transactions||[],{date:(new Date).toISOString(),action:"modification",utilisateur:f,details:"Modification d'une facture finalis\xe9e"}]})))},children:"Modifier"})]})}),(m.transactions||[]).length>0&&(0,$r.jsxs)("div",{className:"transactions-history",children:[(0,$r.jsx)("h3",{children:"Historique des transactions"}),(0,$r.jsx)("ul",{children:(m.transactions||[]).map(((e,t)=>(0,$r.jsxs)("li",{children:[new Date(e.date).toLocaleString()," - ",e.action," par ",e.utilisateur," - ",e.details]},t)))})]})]})};var jm=n(2284),Nm=Uint8Array,Sm=Uint16Array,Cm=Int32Array,km=new Nm([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Em=new Nm([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Am=new Nm([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tm=function(e,t){for(var n=new Sm(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var a=new Cm(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)a[s]=s-n[r]<<5|r;return{b:n,r:a}},Pm=Tm(km,2),_m=Pm.b,Lm=Pm.r;_m[28]=258,Lm[258]=28;for(var Rm=Tm(Em,0),Dm=Rm.b,Im=Rm.r,Om=new Sm(32768),Fm=0;Fm<32768;++Fm){var Mm=(43690&Fm)>>1|(21845&Fm)<<1;Mm=(61680&(Mm=(52428&Mm)>>2|(13107&Mm)<<2))>>4|(3855&Mm)<<4,Om[Fm]=((65280&Mm)>>8|(255&Mm)<<8)>>1}var Bm=function(e,t,n){for(var r=e.length,a=0,s=new Sm(t);a<r;++a)e[a]&&++s[e[a]-1];var i,o=new Sm(t);for(a=1;a<t;++a)o[a]=o[a-1]+s[a-1]<<1;if(n){i=new Sm(1<<t);var l=15-t;for(a=0;a<r;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],d=o[e[a]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)i[Om[d]>>l]=c}else for(i=new Sm(r),a=0;a<r;++a)e[a]&&(i[a]=Om[o[e[a]-1]++]>>15-e[a]);return i},zm=new Nm(288);for(Fm=0;Fm<144;++Fm)zm[Fm]=8;for(Fm=144;Fm<256;++Fm)zm[Fm]=9;for(Fm=256;Fm<280;++Fm)zm[Fm]=7;for(Fm=280;Fm<288;++Fm)zm[Fm]=8;var Um=new Nm(32);for(Fm=0;Fm<32;++Fm)Um[Fm]=5;var qm=Bm(zm,9,0),Vm=Bm(zm,9,1),Wm=Bm(Um,5,0),Hm=Bm(Um,5,1),Gm=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Ym=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},$m=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Km=function(e){return(e+7)/8|0},Jm=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new Nm(e.subarray(t,n))},Xm=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Qm=function(e,t,n){var r=new Error(t||Xm[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Qm),!n)throw r;return r},Zm=function(e,t,n,r){var a=e.length,s=r?r.length:0;if(!a||t.f&&!t.l)return n||new Nm(0);var i=!n,o=i||2!=t.i,l=t.i;i&&(n=new Nm(3*a));var c=function(e){var t=n.length;if(e>t){var r=new Nm(Math.max(2*t,e));r.set(n),n=r}},u=t.f||0,d=t.p||0,h=t.b||0,f=t.l,p=t.d,m=t.m,g=t.n,v=8*a;do{if(!f){u=Ym(e,d,1);var b=Ym(e,d+1,3);if(d+=3,!b){var x=e[(P=Km(d)+4)-4]|e[P-3]<<8,y=P+x;if(y>a){l&&Qm(0);break}o&&c(h+x),n.set(e.subarray(P,y),h),t.b=h+=x,t.p=d=8*y,t.f=u;continue}if(1==b)f=Vm,p=Hm,m=9,g=5;else if(2==b){var w=Ym(e,d,31)+257,j=Ym(e,d+10,15)+4,N=w+Ym(e,d+5,31)+1;d+=14;for(var S=new Nm(N),C=new Nm(19),k=0;k<j;++k)C[Am[k]]=Ym(e,d+3*k,7);d+=3*j;var E=Gm(C),A=(1<<E)-1,T=Bm(C,E,1);for(k=0;k<N;){var P,_=T[Ym(e,d,A)];if(d+=15&_,(P=_>>4)<16)S[k++]=P;else{var L=0,R=0;for(16==P?(R=3+Ym(e,d,3),d+=2,L=S[k-1]):17==P?(R=3+Ym(e,d,7),d+=3):18==P&&(R=11+Ym(e,d,127),d+=7);R--;)S[k++]=L}}var D=S.subarray(0,w),I=S.subarray(w);m=Gm(D),g=Gm(I),f=Bm(D,m,1),p=Bm(I,g,1)}else Qm(1);if(d>v){l&&Qm(0);break}}o&&c(h+131072);for(var O=(1<<m)-1,F=(1<<g)-1,M=d;;M=d){var B=(L=f[$m(e,d)&O])>>4;if((d+=15&L)>v){l&&Qm(0);break}if(L||Qm(2),B<256)n[h++]=B;else{if(256==B){M=d,f=null;break}var z=B-254;if(B>264){var U=km[k=B-257];z=Ym(e,d,(1<<U)-1)+_m[k],d+=U}var q=p[$m(e,d)&F],V=q>>4;q||Qm(3),d+=15&q;I=Dm[V];if(V>3){U=Em[V];I+=$m(e,d)&(1<<U)-1,d+=U}if(d>v){l&&Qm(0);break}o&&c(h+131072);var W=h+z;if(h<I){var H=s-I,G=Math.min(I,W);for(H+h<0&&Qm(3);h<G;++h)n[h]=r[H+h]}for(;h<W;++h)n[h]=n[h-I]}}t.l=f,t.p=M,t.b=h,t.f=u,f&&(u=1,t.m=m,t.d=p,t.n=g)}while(!u);return h!=n.length&&i?Jm(n,0,h):n.subarray(0,h)},eg=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},tg=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},ng=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var a=n.length,s=n.slice();if(!a)return{t:cg,l:0};if(1==a){var i=new Nm(n[0].s+1);return i[n[0].s]=1,{t:i,l:1}}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var o=n[0],l=n[1],c=0,u=1,d=2;for(n[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=a-1;)o=n[n[c].f<n[d].f?c++:d++],l=n[c!=u&&n[c].f<n[d].f?c++:d++],n[u++]={s:-1,f:o.f+l.f,l:o,r:l};var h=s[0].s;for(r=1;r<a;++r)s[r].s>h&&(h=s[r].s);var f=new Sm(h+1),p=rg(n[u-1],f,0);if(p>t){r=0;var m=0,g=p-t,v=1<<g;for(s.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));r<a;++r){var b=s[r].s;if(!(f[b]>t))break;m+=v-(1<<p-f[b]),f[b]=t}for(m>>=g;m>0;){var x=s[r].s;f[x]<t?m-=1<<t-f[x]++-1:++r}for(;r>=0&&m;--r){var y=s[r].s;f[y]==t&&(--f[y],++m)}p=t}return{t:new Nm(f),l:p}},rg=function(e,t,n){return-1==e.s?Math.max(rg(e.l,t,n+1),rg(e.r,t,n+1)):t[e.s]=n},ag=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Sm(++t),r=0,a=e[0],s=1,i=function(e){n[r++]=e},o=1;o<=t;++o)if(e[o]==a&&o!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(a),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(a);s=1,a=e[o]}return{c:n.subarray(0,r),n:t}},sg=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},ig=function(e,t,n){var r=n.length,a=Km(t+2);e[a]=255&r,e[a+1]=r>>8,e[a+2]=255^e[a],e[a+3]=255^e[a+1];for(var s=0;s<r;++s)e[a+s+4]=n[s];return 8*(a+4+r)},og=function(e,t,n,r,a,s,i,o,l,c,u){eg(t,u++,n),++a[256];for(var d=ng(a,15),h=d.t,f=d.l,p=ng(s,15),m=p.t,g=p.l,v=ag(h),b=v.c,x=v.n,y=ag(m),w=y.c,j=y.n,N=new Sm(19),S=0;S<b.length;++S)++N[31&b[S]];for(S=0;S<w.length;++S)++N[31&w[S]];for(var C=ng(N,7),k=C.t,E=C.l,A=19;A>4&&!k[Am[A-1]];--A);var T,P,_,L,R=c+5<<3,D=sg(a,zm)+sg(s,Um)+i,I=sg(a,h)+sg(s,m)+i+14+3*A+sg(N,k)+2*N[16]+3*N[17]+7*N[18];if(l>=0&&R<=D&&R<=I)return ig(t,u,e.subarray(l,l+c));if(eg(t,u,1+(I<D)),u+=2,I<D){T=Bm(h,f,0),P=h,_=Bm(m,g,0),L=m;var O=Bm(k,E,0);eg(t,u,x-257),eg(t,u+5,j-1),eg(t,u+10,A-4),u+=14;for(S=0;S<A;++S)eg(t,u+3*S,k[Am[S]]);u+=3*A;for(var F=[b,w],M=0;M<2;++M){var B=F[M];for(S=0;S<B.length;++S){var z=31&B[S];eg(t,u,O[z]),u+=k[z],z>15&&(eg(t,u,B[S]>>5&127),u+=B[S]>>12)}}}else T=qm,P=zm,_=Wm,L=Um;for(S=0;S<o;++S){var U=r[S];if(U>255){tg(t,u,T[(z=U>>18&31)+257]),u+=P[z+257],z>7&&(eg(t,u,U>>23&31),u+=km[z]);var q=31&U;tg(t,u,_[q]),u+=L[q],q>3&&(tg(t,u,U>>5&8191),u+=Em[q])}else tg(t,u,T[U]),u+=P[U]}return tg(t,u,T[256]),u+P[256]},lg=new Cm([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),cg=new Nm(0),ug=function(e,t,n,r,a,s){var i=s.z||e.length,o=new Nm(r+i+5*(1+Math.ceil(i/7e3))+a),l=o.subarray(r,o.length-a),c=s.l,u=7&(s.r||0);if(t){u&&(l[0]=s.r>>3);for(var d=lg[t-1],h=d>>13,f=8191&d,p=(1<<n)-1,m=s.p||new Sm(32768),g=s.h||new Sm(p+1),v=Math.ceil(n/3),b=2*v,x=function(t){return(e[t]^e[t+1]<<v^e[t+2]<<b)&p},y=new Cm(25e3),w=new Sm(288),j=new Sm(32),N=0,S=0,C=s.i||0,k=0,E=s.w||0,A=0;C+2<i;++C){var T=x(C),P=32767&C,_=g[T];if(m[P]=_,g[T]=P,E<=C){var L=i-C;if((N>7e3||k>24576)&&(L>423||!c)){u=og(e,l,0,y,w,j,S,k,A,C-A,u),k=N=S=0,A=C;for(var R=0;R<286;++R)w[R]=0;for(R=0;R<30;++R)j[R]=0}var D=2,I=0,O=f,F=P-_&32767;if(L>2&&T==x(C-F))for(var M=Math.min(h,L)-1,B=Math.min(32767,C),z=Math.min(258,L);F<=B&&--O&&P!=_;){if(e[C+D]==e[C+D-F]){for(var U=0;U<z&&e[C+U]==e[C+U-F];++U);if(U>D){if(D=U,I=F,U>M)break;var q=Math.min(F,U-2),V=0;for(R=0;R<q;++R){var W=C-F+R&32767,H=W-m[W]&32767;H>V&&(V=H,_=W)}}}F+=(P=_)-(_=m[P])&32767}if(I){y[k++]=268435456|Lm[D]<<18|Im[I];var G=31&Lm[D],Y=31&Im[I];S+=km[G]+Em[Y],++w[257+G],++j[Y],E=C+D,++N}else y[k++]=e[C],++w[e[C]]}}for(C=Math.max(C,E);C<i;++C)y[k++]=e[C],++w[e[C]];u=og(e,l,c,y,w,j,S,k,A,C-A,u),c||(s.r=7&u|l[u/8|0]<<3,u-=7,s.h=g,s.p=m,s.i=C,s.w=E)}else{for(C=s.w||0;C<i+c;C+=65535){var $=C+65535;$>=i&&(l[u/8|0]=c,$=i),u=ig(l,u+1,e.subarray(C,$))}s.i=i}return Jm(o,0,r+Km(u)+a)},dg=function(){var e=1,t=0;return{p:function(n){for(var r=e,a=t,s=0|n.length,i=0;i!=s;){for(var o=Math.min(i+2655,s);i<o;++i)a+=r+=n[i];r=(65535&r)+15*(r>>16),a=(65535&a)+15*(a>>16)}e=r,t=a},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},hg=function(e,t,n,r,a){if(!a&&(a={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),i=new Nm(s.length+e.length);i.set(s),i.set(e,s.length),e=i,a.w=s.length}return ug(e,null==t.level?6:t.level,null==t.mem?a.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,a)},fg=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},pg=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=dg();a.p(t.dictionary),fg(e,2,a.d())}},mg=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Qm(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Qm(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function gg(e,t){t||(t={});var n=dg();n.p(e);var r=hg(e,t,t.dictionary?6:2,4);return pg(r,t),fg(r,r.length-4,n.d()),r}function vg(e,t){return Zm(e.subarray(mg(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var bg="undefined"!=typeof TextDecoder&&new TextDecoder;try{bg.decode(cg,{stream:!0})}catch(cw){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var xg=function(){return"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:this}();function yg(){xg.console&&"function"==typeof xg.console.log&&xg.console.log.apply(xg.console,arguments)}var wg={log:yg,warn:function(e){xg.console&&("function"==typeof xg.console.warn?xg.console.warn.apply(xg.console,arguments):yg.call(null,arguments))},error:function(e){xg.console&&("function"==typeof xg.console.error?xg.console.error.apply(xg.console,arguments):yg(e))}};function jg(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){Eg(r.response,t,n)},r.onerror=function(){wg.error("could not download file")},r.send()}function Ng(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function Sg(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Cg,kg,Eg=xg.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,jm.A)(window))||window!==xg?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=xg.URL||xg.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?Ng(a.href)?jg(e,t,n):Sg(a,a.target="_blank"):Sg(a)):(a.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(a.href)}),4e4),setTimeout((function(){Sg(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(Ng(e))jg(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){Sg(r)}))}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,jm.A)(t)&&(wg.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return jg(e,t,n);var a="application/octet-stream"===e.type,s=/constructor/i.test(xg.HTMLElement)||xg.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&s)&&"object"===("undefined"==typeof FileReader?"undefined":(0,jm.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var e=o.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},o.readAsDataURL(e)}else{var l=xg.URL||xg.webkitURL,c=l.createObjectURL(e);r?r.location=c:location.href=c,r=null,setTimeout((function(){l.revokeObjectURL(c)}),4e4)}});function Ag(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],r=0;r<n.length;r++){var a=n[r].re,s=n[r].process,i=a.exec(e);i&&(t=s(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n}}function Tg(e,t){var n=e[0],r=e[1],a=e[2],s=e[3];n=_g(n,r,a,s,t[0],7,-680876936),s=_g(s,n,r,a,t[1],12,-389564586),a=_g(a,s,n,r,t[2],17,606105819),r=_g(r,a,s,n,t[3],22,-1044525330),n=_g(n,r,a,s,t[4],7,-176418897),s=_g(s,n,r,a,t[5],12,1200080426),a=_g(a,s,n,r,t[6],17,-1473231341),r=_g(r,a,s,n,t[7],22,-45705983),n=_g(n,r,a,s,t[8],7,1770035416),s=_g(s,n,r,a,t[9],12,-1958414417),a=_g(a,s,n,r,t[10],17,-42063),r=_g(r,a,s,n,t[11],22,-1990404162),n=_g(n,r,a,s,t[12],7,1804603682),s=_g(s,n,r,a,t[13],12,-40341101),a=_g(a,s,n,r,t[14],17,-1502002290),n=Lg(n,r=_g(r,a,s,n,t[15],22,1236535329),a,s,t[1],5,-165796510),s=Lg(s,n,r,a,t[6],9,-1069501632),a=Lg(a,s,n,r,t[11],14,643717713),r=Lg(r,a,s,n,t[0],20,-373897302),n=Lg(n,r,a,s,t[5],5,-701558691),s=Lg(s,n,r,a,t[10],9,38016083),a=Lg(a,s,n,r,t[15],14,-660478335),r=Lg(r,a,s,n,t[4],20,-405537848),n=Lg(n,r,a,s,t[9],5,568446438),s=Lg(s,n,r,a,t[14],9,-1019803690),a=Lg(a,s,n,r,t[3],14,-187363961),r=Lg(r,a,s,n,t[8],20,1163531501),n=Lg(n,r,a,s,t[13],5,-1444681467),s=Lg(s,n,r,a,t[2],9,-51403784),a=Lg(a,s,n,r,t[7],14,1735328473),n=Rg(n,r=Lg(r,a,s,n,t[12],20,-1926607734),a,s,t[5],4,-378558),s=Rg(s,n,r,a,t[8],11,-2022574463),a=Rg(a,s,n,r,t[11],16,1839030562),r=Rg(r,a,s,n,t[14],23,-35309556),n=Rg(n,r,a,s,t[1],4,-1530992060),s=Rg(s,n,r,a,t[4],11,1272893353),a=Rg(a,s,n,r,t[7],16,-155497632),r=Rg(r,a,s,n,t[10],23,-1094730640),n=Rg(n,r,a,s,t[13],4,681279174),s=Rg(s,n,r,a,t[0],11,-358537222),a=Rg(a,s,n,r,t[3],16,-722521979),r=Rg(r,a,s,n,t[6],23,76029189),n=Rg(n,r,a,s,t[9],4,-640364487),s=Rg(s,n,r,a,t[12],11,-421815835),a=Rg(a,s,n,r,t[15],16,530742520),n=Dg(n,r=Rg(r,a,s,n,t[2],23,-995338651),a,s,t[0],6,-198630844),s=Dg(s,n,r,a,t[7],10,1126891415),a=Dg(a,s,n,r,t[14],15,-1416354905),r=Dg(r,a,s,n,t[5],21,-57434055),n=Dg(n,r,a,s,t[12],6,1700485571),s=Dg(s,n,r,a,t[3],10,-1894986606),a=Dg(a,s,n,r,t[10],15,-1051523),r=Dg(r,a,s,n,t[1],21,-2054922799),n=Dg(n,r,a,s,t[8],6,1873313359),s=Dg(s,n,r,a,t[15],10,-30611744),a=Dg(a,s,n,r,t[6],15,-1560198380),r=Dg(r,a,s,n,t[13],21,1309151649),n=Dg(n,r,a,s,t[4],6,-145523070),s=Dg(s,n,r,a,t[11],10,-1120210379),a=Dg(a,s,n,r,t[2],15,718787259),r=Dg(r,a,s,n,t[9],21,-343485551),e[0]=qg(n,e[0]),e[1]=qg(r,e[1]),e[2]=qg(a,e[2]),e[3]=qg(s,e[3])}function Pg(e,t,n,r,a,s){return t=qg(qg(t,e),qg(r,s)),qg(t<<a|t>>>32-a,n)}function _g(e,t,n,r,a,s,i){return Pg(t&n|~t&r,e,t,a,s,i)}function Lg(e,t,n,r,a,s,i){return Pg(t&r|n&~r,e,t,a,s,i)}function Rg(e,t,n,r,a,s,i){return Pg(t^n^r,e,t,a,s,i)}function Dg(e,t,n,r,a,s,i){return Pg(n^(t|~r),e,t,a,s,i)}function Ig(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Tg(r,Og(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(Tg(r,a),t=0;t<16;t++)a[t]=0;return a[14]=8*n,Tg(r,a),r}function Og(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}Cg=xg.atob.bind(xg),kg=xg.btoa.bind(xg);var Fg="0123456789abcdef".split("");function Mg(e){for(var t="",n=0;n<4;n++)t+=Fg[e>>8*n+4&15]+Fg[e>>8*n&15];return t}function Bg(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function zg(e){return Ig(e).map(Bg).join("")}var Ug="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=Mg(e[t]);return e.join("")}(Ig("hello"));function qg(e,t){if(Ug){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}function Vg(e,t){var n,r,a,s;if(e!==n){for(var i=(a=e,s=1+(256/e.length|0),new Array(s+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+i.charCodeAt(l))%256,o[l]=o[c],o[c]=u}n=e,r=o}else o=r;var d=t.length,h=0,f=0,p="";for(l=0;l<d;l++)f=(f+(u=o[h=(h+1)%256]))%256,o[h]=o[f],o[f]=u,i=o[(o[h]+o[f])%256],p+=String.fromCharCode(t.charCodeAt(l)^i);return p}var Wg={print:4,modify:8,copy:16,"annot-forms":32};function Hg(e,t,n,r){this.v=1,this.r=2;var a=192;e.forEach((function(e){if(void 0!==Wg.perm)throw new Error("Invalid permission: "+e);a+=Wg[e]})),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var s=(t+this.padding).substr(0,32),i=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^a)),this.encryptionKey=zg(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Vg(this.encryptionKey,this.padding)}function Gg(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var a=e.charCodeAt(r);t+=a<33||35===a||37===a||40===a||41===a||47===a||60===a||62===a||91===a||93===a||123===a||125===a||a>126?"#"+("0"+a.toString(16)).slice(-2):e[r]}return t}function Yg(e){if("object"!==(0,jm.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,r){if(r=r||!1,"string"!=typeof e||"function"!=typeof n||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var a=Math.random().toString(35);return t[e][a]=[n,!!r],a},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],0===Object.keys(t[n]).length&&delete t[n],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),a=[];for(var s in t[n]){var i=t[n][s];try{i[0].apply(e,r)}catch(n){xg.console&&wg.error("jsPDF PubSub Error",n.message,n)}i[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function $g(e){if(!(this instanceof $g))return new $g(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function Kg(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Jg(e,t,n,r,a){if(!(this instanceof Jg))return new Jg(e,t,n,r,a);this.type="axial"===e?2:3,this.coords=t,this.colors=n,Kg.call(this,r,a)}function Xg(e,t,n,r,a){if(!(this instanceof Xg))return new Xg(e,t,n,r,a);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,Kg.call(this,r,a)}function Qg(e){var t,n="string"==typeof arguments[0]?arguments[0]:"p",r=arguments[1],a=arguments[2],s=arguments[3],i=[],o=1,l=16,c="S",u=null;"object"===(0,jm.A)(e=e||{})&&(n=e.orientation,r=e.unit||r,a=e.format||a,s=e.compress||e.compressPdf||s,null!==(u=e.encryption||null)&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),i=e.filters||(!0===s?["FlateEncode"]:i),r=r||"mm",n=(""+(n||"P")).toLowerCase();var d=e.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=Yg;var p="1.3",m=f.__private__.getPdfVersion=function(){return p};f.__private__.setPdfVersion=function(e){p=e};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return g};var v=f.__private__.getPageFormat=function(e){return g[e]};a=a||"a4";var b="compat",x="advanced",y=b;function w(){this.saveGraphicsState(),X(new _e(he,0,0,-he,0,un()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),c="n",y=x}function j(){this.restoreGraphicsState(),c="S",y=b}var N=f.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};f.advancedAPI=function(e){var t=y===b;return t&&w.call(this),"function"!=typeof e||(e(this),t&&j.call(this)),this},f.compatAPI=function(e){var t=y===x;return t&&j.call(this),"function"!=typeof e||(e(this),t&&w.call(this)),this},f.isAdvancedAPI=function(){return y===x};var S,C=function(e){if(y!==x)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},k=f.roundToPrecision=f.__private__.roundToPrecision=function(e,n){var r=t||n;if(isNaN(e)||isNaN(r))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(r).replace(/0+$/,"")};S=f.hpf=f.__private__.hpf="number"==typeof l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return k(e,l)}:"smart"===l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return k(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return k(e,16)};var E=f.f2=f.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return k(e,2)},A=f.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return k(e,3)},T=f.scale=f.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return y===b?e*he:y===x?e:void 0},P=function(e){return T(function(e){return y===b?un()-e:y===x?e:void 0}(e))};f.__private__.setPrecision=f.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var _,L="00000000000000000000000000000000",R=f.__private__.getFileId=function(){return L},D=f.__private__.setFileId=function(e){return L=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():L.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),null!==u&&(xt=new Hg(u.userPermissions,u.userPassword,u.ownerPassword,L)),L};f.setFileId=function(e){return D(e),this},f.getFileId=function(){return R()};var I=f.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),n=t<0?"+":"-",r=Math.floor(Math.abs(t/60)),a=Math.abs(t%60),s=[n,z(r),"'",z(a),"'"].join("");return["D:",e.getFullYear(),z(e.getMonth()+1),z(e.getDate()),z(e.getHours()),z(e.getMinutes()),z(e.getSeconds()),s].join("")},O=f.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),n=parseInt(e.substr(6,2),10)-1,r=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),i=parseInt(e.substr(14,2),10);return new Date(t,n,r,a,s,i,0)},F=f.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=I(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return _=t},M=f.__private__.getCreationDate=function(e){var t=_;return"jsDate"===e&&(t=O(_)),t};f.setCreationDate=function(e){return F(e),this},f.getCreationDate=function(e){return M(e)};var B,z=f.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},U=f.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},q=0,V=[],W=[],H=0,G=[],Y=[],$=!1,K=W;f.__private__.setCustomOutputDestination=function(e){$=!0,K=e};var J=function(e){$||(K=e)};f.__private__.resetCustomOutputDestination=function(){$=!1,K=W};var X=f.__private__.out=function(e){return e=e.toString(),H+=e.length+1,K.push(e),K},Q=f.__private__.write=function(e){return X(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},Z=f.__private__.getArrayBuffer=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n);t--;)r[t]=e.charCodeAt(t);return n},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(e){return te=y===x?e/he:e,this};var ne,re=f.__private__.getFontSize=f.getFontSize=function(){return y===b?te:te*he},ae=e.R2L||!1;f.__private__.setR2L=f.setR2L=function(e){return ae=e,this},f.__private__.getR2L=f.getR2L=function(){return ae};var se,ie=f.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))ne=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');ne=e}else ne=parseInt(e,10)};f.__private__.getZoomMode=function(){return ne};var oe,le=f.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');se=e};f.__private__.getPageMode=function(){return se};var ce=f.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');oe=e};f.__private__.getLayoutMode=function(){return oe},f.__private__.setDisplayMode=f.setDisplayMode=function(e,t,n){return ie(e),ce(t),le(n),this};var ue={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(e){if(-1===Object.keys(ue).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ue[e]},f.__private__.getDocumentProperties=function(){return ue},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(e){for(var t in ue)ue.hasOwnProperty(t)&&e[t]&&(ue[t]=e[t]);return this},f.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(ue).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ue[e]=t};var de,he,fe,pe,me,ge={},ve={},be=[],xe={},ye={},we={},je={},Ne=null,Se=0,Ce=[],ke=new Yg(f),Ee=e.hotfixes||[],Ae={},Te={},Pe=[],_e=function e(t,n,r,a,s,i){if(!(this instanceof e))return new e(t,n,r,a,s,i);isNaN(t)&&(t=1),isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(a)&&(a=1),isNaN(s)&&(s=0),isNaN(i)&&(i=0),this._matrix=[t,n,r,a,s,i]};Object.defineProperty(_e.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(_e.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(_e.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(_e.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(_e.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(_e.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(_e.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(_e.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(_e.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(_e.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(_e.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(_e.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(_e.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(_e.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(_e.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(_e.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),_e.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(e)},_e.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,n=e.sx*this.shy+e.shy*this.sy,r=e.shx*this.sx+e.sy*this.shx,a=e.shx*this.shy+e.sy*this.sy,s=e.tx*this.sx+e.ty*this.shx+this.tx,i=e.tx*this.shy+e.ty*this.sy+this.ty;return new _e(t,n,r,a,s,i)},_e.prototype.decompose=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,a=this.tx,s=this.ty,i=Math.sqrt(e*e+t*t),o=(e/=i)*n+(t/=i)*r;n-=e*o,r-=t*o;var l=Math.sqrt(n*n+r*r);return o/=l,e*(r/=l)<t*(n/=l)&&(e=-e,t=-t,o=-o,i=-i),{scale:new _e(i,0,0,l,0,0),translate:new _e(1,0,0,1,a,s),rotate:new _e(e,t,-t,e,0,0),skew:new _e(1,0,o,1,0,0)}},_e.prototype.toString=function(e){return this.join(" ")},_e.prototype.inversed=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,a=this.tx,s=this.ty,i=1/(e*r-t*n),o=r*i,l=-t*i,c=-n*i,u=e*i;return new _e(o,l,c,u,-o*a-c*s,-l*a-u*s)},_e.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,n=e.x*this.shy+e.y*this.sy+this.ty;return new nn(t,n)},_e.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),n=this.applyToPoint(new nn(e.x+e.w,e.y+e.h));return new rn(t.x,t.y,n.x-t.x,n.y-t.y)},_e.prototype.clone=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,a=this.tx,s=this.ty;return new _e(e,t,n,r,a,s)},f.Matrix=_e;var Le=f.matrixMult=function(e,t){return t.multiply(e)},Re=new _e(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Re;var De=function(e,t){if(!ye[e]){var n=(t instanceof Jg?"Sh":"P")+(Object.keys(xe).length+1).toString(10);t.id=n,ye[e]=n,xe[n]=t,ke.publish("addPattern",t)}};f.ShadingPattern=Jg,f.TilingPattern=Xg,f.addShadingPattern=function(e,t){return C("addShadingPattern()"),De(e,t),this},f.beginTilingPattern=function(e){C("beginTilingPattern()"),sn(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},f.endTilingPattern=function(e,t){C("endTilingPattern()"),t.stream=Y[B].join("\n"),De(e,t),ke.publish("endTilingPattern",t),Pe.pop().restore()};var Ie,Oe=f.__private__.newObject=function(){var e=Fe();return Me(e,!0),e},Fe=f.__private__.newObjectDeferred=function(){return q++,V[q]=function(){return H},q},Me=function(e,t){return t="boolean"==typeof t&&t,V[e]=H,t&&X(e+" 0 obj"),e},Be=f.__private__.newAdditionalObject=function(){var e={objId:Fe(),content:""};return G.push(e),e},ze=Fe(),Ue=Fe(),qe=f.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var n=parseFloat(t[0]);t=[n,n,n,"r"]}for(var r="#",a=0;a<3;a++)r+=("0"+Math.floor(255*parseFloat(t[a])).toString(16)).slice(-2);return r},Ve=f.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var n=e.ch1,r=e.ch2,a=e.ch3,s=e.ch4,i="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var o=new Ag(n);if(o.ok)n=o.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var l=parseInt(n.substr(1),16);n=l>>16&255,r=l>>8&255,a=255&l}if(void 0===r||void 0===s&&n===r&&r===a)if("string"==typeof n)t=n+" "+i[0];else if(2===e.precision)t=E(n/255)+" "+i[0];else t=A(n/255)+" "+i[0];else if(void 0===s||"object"===(0,jm.A)(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",i[1]].join(" ");if("string"==typeof n)t=[n,r,a,i[1]].join(" ");else if(2===e.precision)t=[E(n/255),E(r/255),E(a/255),i[1]].join(" ");else t=[A(n/255),A(r/255),A(a/255),i[1]].join(" ")}else if("string"==typeof n)t=[n,r,a,s,i[2]].join(" ");else if(2===e.precision)t=[E(n),E(r),E(a),E(s),i[2]].join(" ");else t=[A(n),A(r),A(a),A(s),i[2]].join(" ");return t},We=f.__private__.getFilters=function(){return i},He=f.__private__.putStream=function(e){var t=(e=e||{}).data||"",n=e.filters||We(),r=e.alreadyAppliedFilters||[],a=e.addLength1||!1,s=t.length,i=e.objectId,o=function(e){return e};if(null!==u&&void 0===i)throw new Error("ObjectId must be passed to putStream for file encryption");null!==u&&(o=xt.encryptor(i,0));var l={};!0===n&&(n=["FlateEncode"]);var c=e.additionalKeyValues||[],d=(l=void 0!==Qg.API.processDataByFilters?Qg.API.processDataByFilters(t,n):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(r)?r.join(" "):r.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===a&&c.push({key:"Length1",value:s})),0!=d.length)if(d.split("/").length-1==1)c.push({key:"Filter",value:d});else{c.push({key:"Filter",value:"["+d+"]"});for(var h=0;h<c.length;h+=1)if("DecodeParms"===c[h].key){for(var f=[],p=0;p<l.reverseChain.split("/").length-1;p+=1)f.push("null");f.push(c[h].value),c[h].value="["+f.join(" ")+"]"}}X("<<");for(var m=0;m<c.length;m++)X("/"+c[m].key+" "+c[m].value);X(">>"),0!==l.data.length&&(X("stream"),X(o(l.data)),X("endstream"))},Ge=f.__private__.putPage=function(e){var t=e.number,n=e.data,r=e.objId,a=e.contentsObjId;Me(r,!0),X("<</Type /Page"),X("/Parent "+e.rootDictionaryObjId+" 0 R"),X("/Resources "+e.resourceDictionaryObjId+" 0 R"),X("/MediaBox ["+parseFloat(S(e.mediaBox.bottomLeftX))+" "+parseFloat(S(e.mediaBox.bottomLeftY))+" "+S(e.mediaBox.topRightX)+" "+S(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&X("/CropBox ["+S(e.cropBox.bottomLeftX)+" "+S(e.cropBox.bottomLeftY)+" "+S(e.cropBox.topRightX)+" "+S(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&X("/BleedBox ["+S(e.bleedBox.bottomLeftX)+" "+S(e.bleedBox.bottomLeftY)+" "+S(e.bleedBox.topRightX)+" "+S(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&X("/TrimBox ["+S(e.trimBox.bottomLeftX)+" "+S(e.trimBox.bottomLeftY)+" "+S(e.trimBox.topRightX)+" "+S(e.trimBox.topRightY)+"]"),null!==e.artBox&&X("/ArtBox ["+S(e.artBox.bottomLeftX)+" "+S(e.artBox.bottomLeftY)+" "+S(e.artBox.topRightX)+" "+S(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&X("/UserUnit "+e.userUnit),ke.publish("putPage",{objId:r,pageContext:Ce[t],pageNumber:t,page:n}),X("/Contents "+a+" 0 R"),X(">>"),X("endobj");var s=n.join("\n");return y===x&&(s+="\nQ"),Me(a,!0),He({data:s,filters:We(),objectId:a}),X("endobj"),r},Ye=f.__private__.putPages=function(){var e,t,n=[];for(e=1;e<=Se;e++)Ce[e].objId=Fe(),Ce[e].contentsObjId=Fe();for(e=1;e<=Se;e++)n.push(Ge({number:e,data:Y[e],objId:Ce[e].objId,contentsObjId:Ce[e].contentsObjId,mediaBox:Ce[e].mediaBox,cropBox:Ce[e].cropBox,bleedBox:Ce[e].bleedBox,trimBox:Ce[e].trimBox,artBox:Ce[e].artBox,userUnit:Ce[e].userUnit,rootDictionaryObjId:ze,resourceDictionaryObjId:Ue}));Me(ze,!0),X("<</Type /Pages");var r="/Kids [";for(t=0;t<Se;t++)r+=n[t]+" 0 R ";X(r+"]"),X("/Count "+Se),X(">>"),X("endobj"),ke.publish("postPutPages")},$e=function(e){ke.publish("putFont",{font:e,out:X,newObject:Oe,putStream:He}),!0!==e.isAlreadyPutted&&(e.objectNumber=Oe(),X("<<"),X("/Type /Font"),X("/BaseFont /"+Gg(e.postScriptName)),X("/Subtype /Type1"),"string"==typeof e.encoding&&X("/Encoding /"+e.encoding),X("/FirstChar 32"),X("/LastChar 255"),X(">>"),X("endobj"))},Ke=function(e){e.objectNumber=Oe();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[S(e.x),S(e.y),S(e.x+e.width),S(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var n=e.pages[1].join("\n");He({data:n,additionalKeyValues:t,objectId:e.objectNumber}),X("endobj")},Je=function(e,t){t||(t=21);var n=Oe(),r=function(e,t){var n,r=[],a=1/(t-1);for(n=0;n<1;n+=a)r.push(n);if(r.push(1),0!=e[0].offset){var s={offset:0,color:e[0].color};e.unshift(s)}if(1!=e[e.length-1].offset){var i={offset:1,color:e[e.length-1].color};e.push(i)}for(var o="",l=0,c=0;c<r.length;c++){for(n=r[c];n>e[l+1].offset;)l++;var u=e[l].offset,d=(n-u)/(e[l+1].offset-u),h=e[l].color,f=e[l+1].color;o+=U(Math.round((1-d)*h[0]+d*f[0]).toString(16))+U(Math.round((1-d)*h[1]+d*f[1]).toString(16))+U(Math.round((1-d)*h[2]+d*f[2]).toString(16))}return o.trim()}(e.colors,t),a=[];a.push({key:"FunctionType",value:"0"}),a.push({key:"Domain",value:"[0.0 1.0]"}),a.push({key:"Size",value:"["+t+"]"}),a.push({key:"BitsPerSample",value:"8"}),a.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),a.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),He({data:r,additionalKeyValues:a,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),X("endobj"),e.objectNumber=Oe(),X("<< /ShadingType "+e.type),X("/ColorSpace /DeviceRGB");var s="/Coords ["+S(parseFloat(e.coords[0]))+" "+S(parseFloat(e.coords[1]))+" ";2===e.type?s+=S(parseFloat(e.coords[2]))+" "+S(parseFloat(e.coords[3])):s+=S(parseFloat(e.coords[2]))+" "+S(parseFloat(e.coords[3]))+" "+S(parseFloat(e.coords[4]))+" "+S(parseFloat(e.coords[5])),X(s+="]"),e.matrix&&X("/Matrix ["+e.matrix.toString()+"]"),X("/Function "+n+" 0 R"),X("/Extend [true true]"),X(">>"),X("endobj")},Xe=function(e,t){var n=Fe(),r=Oe();t.push({resourcesOid:n,objectOid:r}),e.objectNumber=r;var a=[];a.push({key:"Type",value:"/Pattern"}),a.push({key:"PatternType",value:"1"}),a.push({key:"PaintType",value:"1"}),a.push({key:"TilingType",value:"1"}),a.push({key:"BBox",value:"["+e.boundingBox.map(S).join(" ")+"]"}),a.push({key:"XStep",value:S(e.xStep)}),a.push({key:"YStep",value:S(e.yStep)}),a.push({key:"Resources",value:n+" 0 R"}),e.matrix&&a.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),He({data:e.stream,additionalKeyValues:a,objectId:e.objectNumber}),X("endobj")},Qe=function(e){for(var t in e.objectNumber=Oe(),X("<<"),e)switch(t){case"opacity":X("/ca "+E(e[t]));break;case"stroke-opacity":X("/CA "+E(e[t]))}X(">>"),X("endobj")},Ze=function(e){Me(e.resourcesOid,!0),X("<<"),X("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in X("/Font <<"),ge)ge.hasOwnProperty(e)&&(!1===d||!0===d&&h.hasOwnProperty(e))&&X("/"+e+" "+ge[e].objectNumber+" 0 R");X(">>")}(),function(){if(Object.keys(xe).length>0){for(var e in X("/Shading <<"),xe)xe.hasOwnProperty(e)&&xe[e]instanceof Jg&&xe[e].objectNumber>=0&&X("/"+e+" "+xe[e].objectNumber+" 0 R");ke.publish("putShadingPatternDict"),X(">>")}}(),function(e){if(Object.keys(xe).length>0){for(var t in X("/Pattern <<"),xe)xe.hasOwnProperty(t)&&xe[t]instanceof f.TilingPattern&&xe[t].objectNumber>=0&&xe[t].objectNumber<e&&X("/"+t+" "+xe[t].objectNumber+" 0 R");ke.publish("putTilingPatternDict"),X(">>")}}(e.objectOid),function(){if(Object.keys(we).length>0){var e;for(e in X("/ExtGState <<"),we)we.hasOwnProperty(e)&&we[e].objectNumber>=0&&X("/"+e+" "+we[e].objectNumber+" 0 R");ke.publish("putGStateDict"),X(">>")}}(),function(){for(var e in X("/XObject <<"),Ae)Ae.hasOwnProperty(e)&&Ae[e].objectNumber>=0&&X("/"+e+" "+Ae[e].objectNumber+" 0 R");ke.publish("putXobjectDict"),X(">>")}(),X(">>"),X("endobj")},et=function(){var e=[];(function(){for(var e in ge)ge.hasOwnProperty(e)&&(!1===d||!0===d&&h.hasOwnProperty(e))&&$e(ge[e])})(),function(){var e;for(e in we)we.hasOwnProperty(e)&&Qe(we[e])}(),function(){for(var e in Ae)Ae.hasOwnProperty(e)&&Ke(Ae[e])}(),function(e){var t;for(t in xe)xe.hasOwnProperty(t)&&(xe[t]instanceof Jg?Je(xe[t]):xe[t]instanceof Xg&&Xe(xe[t],e))}(e),ke.publish("putResources"),e.forEach(Ze),Ze({resourcesOid:Ue,objectOid:Number.MAX_SAFE_INTEGER}),ke.publish("postPutResources")},tt=function(e){ve[e.fontName]=ve[e.fontName]||{},ve[e.fontName][e.fontStyle]=e.id},nt=function(e,t,n,r,a){var s={id:"F"+(Object.keys(ge).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:n,encoding:r,isStandardFont:a||!1,metadata:{}};return ke.publish("addFont",{font:s,instance:this}),ge[s.id]=s,tt(s),s.id},rt=f.__private__.pdfEscape=f.pdfEscape=function(e,t){return function(e,t){var n,r,a,s,i,o,l,c,u;if(a=(t=t||{}).sourceEncoding||"Unicode",i=t.outputEncoding,(t.autoencode||i)&&ge[de].metadata&&ge[de].metadata[a]&&ge[de].metadata[a].encoding&&(s=ge[de].metadata[a].encoding,!i&&ge[de].encoding&&(i=ge[de].encoding),!i&&s.codePages&&(i=s.codePages[0]),"string"==typeof i&&(i=s[i]),i)){for(l=!1,o=[],n=0,r=e.length;n<r;n++)(c=i[e.charCodeAt(n)])?o.push(String.fromCharCode(c)):o.push(e[n]),o[n].charCodeAt(0)>>8&&(l=!0);e=o.join("")}for(n=e.length;void 0===l&&0!==n;)e.charCodeAt(n-1)>>8&&(l=!0),n--;if(!l)return e;for(o=t.noBOM?[]:[254,255],n=0,r=e.length;n<r;n++){if((u=(c=e.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(u),o.push(c-(u<<8))}return String.fromCharCode.apply(void 0,o)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},at=f.__private__.beginPage=function(e){Y[++Se]=[],Ce[Se]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},ot(Se),J(Y[B])},st=function(e,t){var r,s,i;switch(n=t||n,"string"==typeof e&&(r=v(e.toLowerCase()),Array.isArray(r)&&(s=r[0],i=r[1])),Array.isArray(e)&&(s=e[0]*he,i=e[1]*he),isNaN(s)&&(s=a[0],i=a[1]),(s>14400||i>14400)&&(wg.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),i=Math.min(14400,i)),a=[s,i],n.substr(0,1)){case"l":i>s&&(a=[i,s]);break;case"p":s>i&&(a=[i,s])}at(a),Bt(Ft),X(Yt),0!==Zt&&X(Zt+" J"),0!==en&&X(en+" j"),ke.publish("addPage",{pageNumber:Se})},it=function(e){e>0&&e<=Se&&(Y.splice(e,1),Ce.splice(e,1),Se--,B>Se&&(B=Se),this.setPage(B))},ot=function(e){e>0&&e<=Se&&(B=e)},lt=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Y.length-1},ct=function(e,t,n){var r,a=void 0;return n=n||{},e=void 0!==e?e:ge[de].fontName,t=void 0!==t?t:ge[de].fontStyle,r=e.toLowerCase(),void 0!==ve[r]&&void 0!==ve[r][t]?a=ve[r][t]:void 0!==ve[e]&&void 0!==ve[e][t]?a=ve[e][t]:!1===n.disableWarning&&wg.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),a||n.noFallback||null==(a=ve.times[t])&&(a=ve.times.normal),a},ut=f.__private__.putInfo=function(){var e=Oe(),t=function(e){return e};for(var n in null!==u&&(t=xt.encryptor(e,0)),X("<<"),X("/Producer ("+rt(t("jsPDF "+Qg.version))+")"),ue)ue.hasOwnProperty(n)&&ue[n]&&X("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+rt(t(ue[n]))+")");X("/CreationDate ("+rt(t(_))+")"),X(">>"),X("endobj")},dt=f.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||ze;switch(Oe(),X("<<"),X("/Type /Catalog"),X("/Pages "+t+" 0 R"),ne||(ne="fullwidth"),ne){case"fullwidth":X("/OpenAction [3 0 R /FitH null]");break;case"fullheight":X("/OpenAction [3 0 R /FitV null]");break;case"fullpage":X("/OpenAction [3 0 R /Fit]");break;case"original":X("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+ne;"%"===n.substr(n.length-1)&&(ne=parseInt(ne)/100),"number"==typeof ne&&X("/OpenAction [3 0 R /XYZ null null "+E(ne)+"]")}switch(oe||(oe="continuous"),oe){case"continuous":X("/PageLayout /OneColumn");break;case"single":X("/PageLayout /SinglePage");break;case"two":case"twoleft":X("/PageLayout /TwoColumnLeft");break;case"tworight":X("/PageLayout /TwoColumnRight")}se&&X("/PageMode /"+se),ke.publish("putCatalog"),X(">>"),X("endobj")},ht=f.__private__.putTrailer=function(){X("trailer"),X("<<"),X("/Size "+(q+1)),X("/Root "+q+" 0 R"),X("/Info "+(q-1)+" 0 R"),null!==u&&X("/Encrypt "+xt.oid+" 0 R"),X("/ID [ <"+L+"> <"+L+"> ]"),X(">>")},ft=f.__private__.putHeader=function(){X("%PDF-"+p),X("%\xba\xdf\xac\xe0")},pt=f.__private__.putXRef=function(){var e="0000000000";X("xref"),X("0 "+(q+1)),X("0000000000 65535 f ");for(var t=1;t<=q;t++)"function"==typeof V[t]?X((e+V[t]()).slice(-10)+" 00000 n "):void 0!==V[t]?X((e+V[t]).slice(-10)+" 00000 n "):X("0000000000 00000 n ")},mt=f.__private__.buildDocument=function(){q=0,H=0,W=[],V=[],G=[],ze=Fe(),Ue=Fe(),J(W),ke.publish("buildDocument"),ft(),Ye(),function(){ke.publish("putAdditionalObjects");for(var e=0;e<G.length;e++){var t=G[e];Me(t.objId,!0),X(t.content),X("endobj")}ke.publish("postPutAdditionalObjects")}(),et(),null!==u&&(xt.oid=Oe(),X("<<"),X("/Filter /Standard"),X("/V "+xt.v),X("/R "+xt.r),X("/U <"+xt.toHexString(xt.U)+">"),X("/O <"+xt.toHexString(xt.O)+">"),X("/P "+xt.P),X(">>"),X("endobj")),ut(),dt();var e=H;return pt(),ht(),X("startxref"),X(""+e),X("%%EOF"),J(Y[B]),W.join("\n")},gt=f.__private__.getBlob=function(e){return new Blob([Z(e)],{type:"application/pdf"})},vt=f.output=f.__private__.output=(Ie=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return mt();case"save":f.save(t.filename);break;case"arraybuffer":return Z(mt());case"blob":return gt(mt());case"bloburi":case"bloburl":if(void 0!==xg.URL&&"function"==typeof xg.URL.createObjectURL)return xg.URL&&xg.URL.createObjectURL(gt(mt()))||void 0;wg.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",r=mt();try{n=kg(r)}catch(e){n=kg(unescape(encodeURIComponent(r)))}return"data:application/pdf;filename="+t.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(xg)){var a="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(a=t.pdfObjectUrl,s="");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+a+'"'+s+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",o=xg.open();return null!==o&&o.document.write(i),o}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(xg)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=xg.open();if(null!==c){c.document.write(l);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(xg))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var d='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',h=xg.open();if(null!==h&&(h.document.write(d),h.document.title=t.filename),h||"undefined"==typeof safari)return h;break;case"datauri":case"dataurl":return xg.document.location.href=this.output("datauristring",t);default:return null}},Ie.foo=function(){try{return Ie.apply(this,arguments)}catch(Ie){var e=Ie.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var t="Error in function "+e.split("\n")[0].split("<")[0]+": "+Ie.message;if(!xg.console)throw new Error(t);xg.console.error(t,Ie),xg.alert&&alert(t)}},Ie.foo.bar=Ie,Ie.foo),bt=function(e){return!0===Array.isArray(Ee)&&Ee.indexOf(e)>-1};switch(r){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=1==bt("px_scaling")?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if("number"!=typeof r)throw new Error("Invalid unit: "+r);he=r}var xt=null;F(),D();var yt=f.__private__.getPageInfo=f.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ce[e].objId,pageNumber:e,pageContext:Ce[e]}},wt=f.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Ce)if(Ce[t].objId===e)break;return yt(t)},jt=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Ce[B].objId,pageNumber:B,pageContext:Ce[B]}};f.addPage=function(){return st.apply(this,arguments),this},f.setPage=function(){return ot.apply(this,arguments),J.call(this,Y[B]),this},f.insertPage=function(e){return this.addPage(),this.movePage(B,e),this},f.movePage=function(e,t){var n,r;if(e>t){n=Y[e],r=Ce[e];for(var a=e;a>t;a--)Y[a]=Y[a-1],Ce[a]=Ce[a-1];Y[t]=n,Ce[t]=r,this.setPage(t)}else if(e<t){n=Y[e],r=Ce[e];for(var s=e;s<t;s++)Y[s]=Y[s+1],Ce[s]=Ce[s+1];Y[t]=n,Ce[t]=r,this.setPage(t)}return this},f.deletePage=function(){return it.apply(this,arguments),this},f.__private__.text=f.text=function(e,t,n,r,a){var s,i,o,l,c,u,d,f,p,m=(r=r||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof n||Array.isArray(n))){var g=n;n=t,t=e,e=g}if(arguments[3]instanceof _e==0?(o=arguments[4],l=arguments[5],"object"===(0,jm.A)(d=arguments[3])&&null!==d||("string"==typeof o&&(l=o,o=null),"string"==typeof d&&(l=d,d=null),"number"==typeof d&&(o=d,d=null),r={flags:d,angle:o,align:l})):(C("The transform parameter of text() with a Matrix value"),p=a),isNaN(t)||isNaN(n)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return m;var v,b="",w="number"==typeof r.lineHeightFactor?r.lineHeightFactor:Ot,j=m.internal.scaleFactor;function N(e){return e=e.split("\t").join(Array(r.TabLen||9).join(" ")),rt(e,d)}function k(e){for(var t,n=e.concat(),r=[],a=n.length;a--;)"string"==typeof(t=n.shift())?r.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?r.push(t[0]):r.push([t[0],t[1],t[2]]);return r}function E(e,t){var n;if("string"==typeof e)n=t(e)[0];else if(Array.isArray(e)){for(var r,a,s=e.concat(),i=[],o=s.length;o--;)"string"==typeof(r=s.shift())?i.push(t(r)[0]):Array.isArray(r)&&"string"==typeof r[0]&&(a=t(r[0],r[1],r[2]),i.push([a[0],a[1],a[2]]));n=i}return n}var A=!1,P=!0;if("string"==typeof e)A=!0;else if(Array.isArray(e)){var _=e.concat();i=[];for(var L,R=_.length;R--;)("string"!=typeof(L=_.shift())||Array.isArray(L)&&"string"!=typeof L[0])&&(P=!1);A=P}if(!1===A)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var D=te/m.internal.scaleFactor,I=D*(w-1);switch(r.baseline){case"bottom":n-=I;break;case"top":n+=D-I;break;case"hanging":n+=D-2*I;break;case"middle":n+=D/2-I}if((u=r.maxWidth||0)>0&&("string"==typeof e?e=m.splitTextToSize(e,u):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce((function(e,t){return e.concat(m.splitTextToSize(t,u))}),[]))),s={text:e,x:t,y:n,options:r,mutex:{pdfEscape:rt,activeFontKey:de,fonts:ge,activeFontSize:te}},ke.publish("preProcessText",s),e=s.text,o=(r=s.options).angle,p instanceof _e==0&&o&&"number"==typeof o){o*=Math.PI/180,0===r.rotationDirection&&(o=-o),y===x&&(o=-o);var O=Math.cos(o),F=Math.sin(o);p=new _e(O,F,-F,O,0,0)}else o&&o instanceof _e&&(p=o);y!==x||p||(p=Re),void 0!==(c=r.charSpace||Xt)&&(b+=S(T(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=r.horizontalScale)&&(b+=S(100*f)+" Tz\n"),r.lang;var M=-1,B=void 0!==r.renderingMode?r.renderingMode:r.stroke,z=m.internal.getCurrentPageInfo().pageContext;switch(B){case 0:case!1:case"fill":M=0;break;case 1:case!0:case"stroke":M=1;break;case 2:case"fillThenStroke":M=2;break;case 3:case"invisible":M=3;break;case 4:case"fillAndAddForClipping":M=4;break;case 5:case"strokeAndAddPathForClipping":M=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":M=6;break;case 7:case"addToPathForClipping":M=7}var U=void 0!==z.usedRenderingMode?z.usedRenderingMode:-1;-1!==M?b+=M+" Tr\n":-1!==U&&(b+="0 Tr\n"),-1!==M&&(z.usedRenderingMode=M),l=r.align||"left";var q,V=te*w,W=m.internal.pageSize.getWidth(),H=ge[de];c=r.charSpace||Xt,u=r.maxWidth||0,d=Object.assign({autoencode:!0,noBOM:!0},r.flags);var G=[],Y=function(e){return m.getStringUnitWidth(e,{font:H,charSpace:c,fontSize:te,doKerning:!1})*te/j};if("[object Array]"===Object.prototype.toString.call(e)){var $;i=k(e),"left"!==l&&(q=i.map(Y));var K,J=0;if("right"===l){t-=q[0],e=[],R=i.length;for(var Q=0;Q<R;Q++)0===Q?(K=Vt(t),$=Wt(n)):(K=T(J-q[Q]),$=-V),e.push([i[Q],K,$]),J=q[Q]}else if("center"===l){t-=q[0]/2,e=[],R=i.length;for(var Z=0;Z<R;Z++)0===Z?(K=Vt(t),$=Wt(n)):(K=T((J-q[Z])/2),$=-V),e.push([i[Z],K,$]),J=q[Z]}else if("left"===l){e=[],R=i.length;for(var ee=0;ee<R;ee++)e.push(i[ee])}else if("justify"===l&&"Identity-H"===H.encoding){e=[],R=i.length,u=0!==u?u:W;for(var ne=0,re=0;re<R;re++)if($=0===re?Wt(n):-V,K=0===re?Vt(t):ne,re<R-1){var se=T((u-q[re])/(i[re].split(" ").length-1)),ie=i[re].split(" ");e.push([ie[0]+" ",K,$]),ne=0;for(var oe=1;oe<ie.length;oe++){var le=(Y(ie[oe-1]+" "+ie[oe])-Y(ie[oe]))*j+se;oe==ie.length-1?e.push([ie[oe],le,0]):e.push([ie[oe]+" ",le,0]),ne-=le}}else e.push([i[re],K,$]);e.push(["",ne,0])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],R=i.length,u=0!==u?u:W,re=0;re<R;re++)$=0===re?Wt(n):-V,K=0===re?Vt(t):0,re<R-1?G.push(S(T((u-q[re])/(i[re].split(" ").length-1)))):G.push(0),e.push([i[re],K,$])}}!0===("boolean"==typeof r.R2L?r.R2L:ae)&&(e=E(e,(function(e,t,n){return[e.split("").reverse().join(""),t,n]}))),s={text:e,x:t,y:n,options:r,mutex:{pdfEscape:rt,activeFontKey:de,fonts:ge,activeFontSize:te}},ke.publish("postProcessText",s),e=s.text,v=s.mutex.isHex||!1;var ce=ge[de].encoding;"WinAnsiEncoding"!==ce&&"StandardEncoding"!==ce||(e=E(e,(function(e,t,n){return[N(e),t,n]}))),i=k(e),e=[];for(var ue,he,fe,pe=Array.isArray(i[0])?1:0,me="",ve=function(e,t,n){var a="";return n instanceof _e?(n="number"==typeof r.angle?Le(n,new _e(1,0,0,1,e,t)):Le(new _e(1,0,0,1,e,t),n),y===x&&(n=Le(new _e(1,0,0,-1,0,0),n)),a=n.join(" ")+" Tm\n"):a=S(e)+" "+S(t)+" Td\n",a},be=0;be<i.length;be++){switch(me="",pe){case 1:fe=(v?"<":"(")+i[be][0]+(v?">":")"),ue=parseFloat(i[be][1]),he=parseFloat(i[be][2]);break;case 0:fe=(v?"<":"(")+i[be]+(v?">":")"),ue=Vt(t),he=Wt(n)}void 0!==G&&void 0!==G[be]&&(me=G[be]+" Tw\n"),0===be?e.push(me+ve(ue,he,p)+fe):0===pe?e.push(me+fe):1===pe&&e.push(me+ve(ue,he,p)+fe)}e=0===pe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var xe="BT\n/";return xe+=de+" "+te+" Tf\n",xe+=S(te*w)+" TL\n",xe+=Kt+"\n",xe+=b,xe+=e,X(xe+="ET"),h[de]=!0,m};var Nt=f.__private__.clip=f.clip=function(e){return X("evenodd"===e?"W*":"W"),this};f.clipEvenOdd=function(){return Nt("evenodd")},f.__private__.discardPath=f.discardPath=function(){return X("n"),this};var St=f.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(e){return St(e)&&(c=e),this};var Ct=f.__private__.getStyle=f.getStyle=function(e){var t=c;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},kt=f.close=function(){return X("h"),this};f.stroke=function(){return X("S"),this},f.fill=function(e){return Et("f",e),this},f.fillEvenOdd=function(e){return Et("f*",e),this},f.fillStroke=function(e){return Et("B",e),this},f.fillStrokeEvenOdd=function(e){return Et("B*",e),this};var Et=function(e,t){"object"===(0,jm.A)(t)?Pt(t,e):X(e)},At=function(e){null===e||y===x&&void 0===e||(e=Ct(e),X(e))};function Tt(e,t,n,r,a){var s=new Xg(t||this.boundingBox,n||this.xStep,r||this.yStep,this.gState,a||this.matrix);s.stream=this.stream;var i=e+"$$"+this.cloneIndex+++"$$";return De(i,s),s}var Pt=function(e,t){var n=ye[e.key],r=xe[n];if(r instanceof Jg)X("q"),X(_t(t)),r.gState&&f.setGState(r.gState),X(e.matrix.toString()+" cm"),X("/"+n+" sh"),X("Q");else if(r instanceof Xg){var a=new _e(1,0,0,-1,0,un());e.matrix&&(a=a.multiply(e.matrix||Re),n=Tt.call(r,e.key,e.boundingBox,e.xStep,e.yStep,a).id),X("q"),X("/Pattern cs"),X("/"+n+" scn"),r.gState&&f.setGState(r.gState),X(t),X("Q")}},_t=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Lt=f.moveTo=function(e,t){return X(S(T(e))+" "+S(P(t))+" m"),this},Rt=f.lineTo=function(e,t){return X(S(T(e))+" "+S(P(t))+" l"),this},Dt=f.curveTo=function(e,t,n,r,a,s){return X([S(T(e)),S(P(t)),S(T(n)),S(P(r)),S(T(a)),S(P(s)),"c"].join(" ")),this};f.__private__.line=f.line=function(e,t,n,r,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!St(a))throw new Error("Invalid arguments passed to jsPDF.line");return y===b?this.lines([[n-e,r-t]],e,t,[1,1],a||"S"):this.lines([[n-e,r-t]],e,t,[1,1]).stroke()},f.__private__.lines=f.lines=function(e,t,n,r,a,s){var i,o,l,c,u,d,h,f,p,m,g,v;if("number"==typeof e&&(v=n,n=t,t=e,e=v),r=r||[1,1],s=s||!1,isNaN(t)||isNaN(n)||!Array.isArray(e)||!Array.isArray(r)||!St(a)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(Lt(t,n),i=r[0],o=r[1],c=e.length,m=t,g=n,l=0;l<c;l++)2===(u=e[l]).length?(m=u[0]*i+m,g=u[1]*o+g,Rt(m,g)):(d=u[0]*i+m,h=u[1]*o+g,f=u[2]*i+m,p=u[3]*o+g,m=u[4]*i+m,g=u[5]*o+g,Dt(d,h,f,p,m,g));return s&&kt(),At(a),this},f.path=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.c;switch(n.op){case"m":Lt(r[0],r[1]);break;case"l":Rt(r[0],r[1]);break;case"c":Dt.apply(this,r);break;case"h":kt()}}return this},f.__private__.rect=f.rect=function(e,t,n,r,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!St(a))throw new Error("Invalid arguments passed to jsPDF.rect");return y===b&&(r=-r),X([S(T(e)),S(P(t)),S(T(n)),S(T(r)),"re"].join(" ")),At(a),this},f.__private__.triangle=f.triangle=function(e,t,n,r,a,s,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a)||isNaN(s)||!St(i))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-e,r-t],[a-n,s-r],[e-a,t-s]],e,t,[1,1],i,!0),this},f.__private__.roundedRect=f.roundedRect=function(e,t,n,r,a,s,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a)||isNaN(s)||!St(i))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return a=Math.min(a,.5*n),s=Math.min(s,.5*r),this.lines([[n-2*a,0],[a*o,0,a,s-s*o,a,s],[0,r-2*s],[0,s*o,-a*o,s,-a,s],[2*a-n,0],[-a*o,0,-a,-s*o,-a,-s],[0,2*s-r],[0,-s*o,a*o,-s,a,-s]],e+a,t,[1,1],i,!0),this},f.__private__.ellipse=f.ellipse=function(e,t,n,r,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!St(a))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*n,i=4/3*(Math.SQRT2-1)*r;return Lt(e+n,t),Dt(e+n,t-i,e+s,t-r,e,t-r),Dt(e-s,t-r,e-n,t-i,e-n,t),Dt(e-n,t+i,e-s,t+r,e,t+r),Dt(e+s,t+r,e+n,t+i,e+n,t),At(a),this},f.__private__.circle=f.circle=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||!St(r))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,n,n,r)},f.setFont=function(e,t,n){return n&&(t=N(t,n)),de=ct(e,t,{disableWarning:!1}),this};var It=f.__private__.getFont=f.getFont=function(){return ge[ct.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var e,t,n={};for(e in ve)if(ve.hasOwnProperty(e))for(t in n[e]=[],ve[e])ve[e].hasOwnProperty(t)&&n[e].push(t);return n},f.addFont=function(e,t,n,r,a){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?a=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(n=N(n,r)),nt.call(this,e,t,n,a=a||"Identity-H")};var Ot,Ft=e.lineWidth||.200025,Mt=f.__private__.getLineWidth=f.getLineWidth=function(){return Ft},Bt=f.__private__.setLineWidth=f.setLineWidth=function(e){return Ft=e,X(S(T(e))+" w"),this};f.__private__.setLineDash=Qg.API.setLineDash=Qg.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map((function(e){return S(T(e))})).join(" "),t=S(T(t)),X("["+e+"] "+t+" d"),this};var zt=f.__private__.getLineHeight=f.getLineHeight=function(){return te*Ot};f.__private__.getLineHeight=f.getLineHeight=function(){return te*Ot};var Ut=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Ot=e),this},qt=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Ot};Ut(e.lineHeight);var Vt=f.__private__.getHorizontalCoordinate=function(e){return T(e)},Wt=f.__private__.getVerticalCoordinate=function(e){return y===x?e:Ce[B].mediaBox.topRightY-Ce[B].mediaBox.bottomLeftY-T(e)},Ht=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(e){return S(Vt(e))},Gt=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(e){return S(Wt(e))},Yt=e.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return qe(Yt)},f.__private__.setStrokeColor=f.setDrawColor=function(e,t,n,r){return Yt=Ve({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"draw",precision:2}),X(Yt),this};var $t=e.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return qe($t)},f.__private__.setFillColor=f.setFillColor=function(e,t,n,r){return $t=Ve({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"fill",precision:2}),X($t),this};var Kt=e.textColor||"0 g",Jt=f.__private__.getTextColor=f.getTextColor=function(){return qe(Kt)};f.__private__.setTextColor=f.setTextColor=function(e,t,n,r){return Kt=Ve({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"text",precision:3}),this};var Xt=e.charSpace,Qt=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Xt||0)};f.__private__.setCharSpace=f.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xt=e,this};var Zt=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zt=t,X(t+" J"),this};var en=0;f.__private__.setLineJoin=f.setLineJoin=function(e){var t=f.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return en=t,X(t+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return X(S(T(e))+" M"),this},f.GState=$g,f.setGState=function(e){(e="string"==typeof e?we[je[e]]:tn(null,e)).equals(Ne)||(X("/"+e.id+" gs"),Ne=e)};var tn=function(e,t){if(!e||!je[e]){var n=!1;for(var r in we)if(we.hasOwnProperty(r)&&we[r].equals(t)){n=!0;break}if(n)t=we[r];else{var a="GS"+(Object.keys(we).length+1).toString(10);we[a]=t,t.id=a}return e&&(je[e]=t.id),ke.publish("addGState",t),t}};f.addGState=function(e,t){return tn(e,t),this},f.saveGraphicsState=function(){return X("q"),be.push({key:de,size:te,color:Kt}),this},f.restoreGraphicsState=function(){X("Q");var e=be.pop();return de=e.key,te=e.size,Kt=e.color,Ne=null,this},f.setCurrentTransformationMatrix=function(e){return X(e.toString()+" cm"),this},f.comment=function(e){return X("#"+e),this};var nn=function(e,t){var n=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var r=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(e){a=e.toString()}}),this},rn=function(e,t,n,r){nn.call(this,e,t),this.type="rect";var a=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var s=r||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}}),this},an=function(){this.page=Se,this.currentPage=B,this.pages=Y.slice(0),this.pagesContext=Ce.slice(0),this.x=fe,this.y=pe,this.matrix=me,this.width=ln(B),this.height=un(B),this.outputDestination=K,this.id="",this.objectNumber=-1};an.prototype.restore=function(){Se=this.page,B=this.currentPage,Ce=this.pagesContext,Y=this.pages,fe=this.x,pe=this.y,me=this.matrix,cn(B,this.width),dn(B,this.height),K=this.outputDestination};var sn=function(e,t,n,r,a){Pe.push(new an),Se=B=0,Y=[],fe=e,pe=t,me=a,at([n,r])};for(var on in f.beginFormObject=function(e,t,n,r,a){return sn(e,t,n,r,a),this},f.endFormObject=function(e){return function(e){if(Te[e])Pe.pop().restore();else{var t=new an,n="Xo"+(Object.keys(Ae).length+1).toString(10);t.id=n,Te[e]=n,Ae[n]=t,ke.publish("addFormObject",t),Pe.pop().restore()}}(e),this},f.doFormObject=function(e,t){var n=Ae[Te[e]];return X("q"),X(t.toString()+" cm"),X("/"+n.id+" Do"),X("Q"),this},f.getFormObject=function(e){var t=Ae[Te[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},f.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(Eg(gt(mt()),e),"function"==typeof Eg.unload&&xg.setTimeout&&setTimeout(Eg.unload,911),this):new Promise((function(t,n){try{var r=Eg(gt(mt()),e);"function"==typeof Eg.unload&&xg.setTimeout&&setTimeout(Eg.unload,911),t(r)}catch(e){n(e.message)}}))},Qg.API)Qg.API.hasOwnProperty(on)&&("events"===on&&Qg.API.events.length?function(e,t){var n,r,a;for(a=t.length-1;-1!==a;a--)n=t[a][0],r=t[a][1],e.subscribe.apply(e,[n].concat("function"==typeof r?[r]:r))}(ke,Qg.API.events):f[on]=Qg.API[on]);var ln=f.getPageWidth=function(e){return(Ce[e=e||B].mediaBox.topRightX-Ce[e].mediaBox.bottomLeftX)/he},cn=f.setPageWidth=function(e,t){Ce[e].mediaBox.topRightX=t*he+Ce[e].mediaBox.bottomLeftX},un=f.getPageHeight=function(e){return(Ce[e=e||B].mediaBox.topRightY-Ce[e].mediaBox.bottomLeftY)/he},dn=f.setPageHeight=function(e,t){Ce[e].mediaBox.topRightY=t*he+Ce[e].mediaBox.bottomLeftY};return f.internal={pdfEscape:rt,getStyle:Ct,getFont:It,getFontSize:re,getCharSpace:Qt,getTextColor:Jt,getLineHeight:zt,getLineHeightFactor:qt,getLineWidth:Mt,write:Q,getHorizontalCoordinate:Vt,getVerticalCoordinate:Wt,getCoordinateString:Ht,getVerticalCoordinateString:Gt,collections:{},newObject:Oe,newAdditionalObject:Be,newObjectDeferred:Fe,newObjectDeferredBegin:Me,getFilters:We,putStream:He,events:ke,scaleFactor:he,pageSize:{getWidth:function(){return ln(B)},setWidth:function(e){cn(B,e)},getHeight:function(){return un(B)},setHeight:function(e){dn(B,e)}},encryptionOptions:u,encryption:xt,getEncryptor:function(e){return null!==u?xt.encryptor(e,0):function(e){return e}},output:vt,getNumberOfPages:lt,pages:Y,out:X,f2:E,f3:A,getPageInfo:yt,getPageInfoByObjId:wt,getCurrentPageInfo:jt,getPDFVersion:m,Point:nn,Rectangle:rn,Matrix:_e,hasHotfix:bt},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ln(B)},set:function(e){cn(B,e)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return un(B)},set:function(e){dn(B,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,n=ee.length;t<n;t++){var r=nt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===d&&(h[r]=!0);var a=e[t][0].split("-");tt({id:r,fontName:a[0],fontStyle:a[1]||""})}ke.publish("addFonts",{fonts:ge,dictionary:ve})}.call(f,ee),de="F1",st(a,n),ke.publish("initialized"),f}Hg.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Hg.prototype.toHexString=function(e){return e.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},Hg.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Hg.prototype.processOwnerPassword=function(e,t){return Vg(zg(t).substr(0,5),e)},Hg.prototype.encryptor=function(e,t){var n=zg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return Vg(n,e)}},$g.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||(0,jm.A)(e)!==(0,jm.A)(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return 0===r},Qg.API={events:[]},Qg.version="3.0.1";var Zg=Qg.API,ev=1,tv=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nv=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},rv=function(e){return e.toFixed(2)},av=function(e){return e.toFixed(5)};Zg.__acroform__={};var sv=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},iv=function(e){return e*ev},ov=function(e){var t=new Sv,n=Mv.internal.getHeight(e)||0,r=Mv.internal.getWidth(e)||0;return t.BBox=[0,0,Number(rv(r)),Number(rv(n))],t},lv=Zg.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},cv=Zg.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},uv=Zg.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(e&1<<t)?0:1},dv=Zg.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return uv(e,t-1)},hv=Zg.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return lv(e,t-1)},fv=Zg.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return cv(e,t-1)},pv=Zg.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,a=e[0],s=e[1],i=e[2],o=e[3],l={};return l.lowerLeft_X=n(a)||0,l.lowerLeft_Y=r(s+o)||0,l.upperRight_X=n(a+i)||0,l.upperRight_Y=r(s)||0,[Number(rv(l.lowerLeft_X)),Number(rv(l.lowerLeft_Y)),Number(rv(l.upperRight_X)),Number(rv(l.upperRight_Y))]},mv=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=gv(e,n),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+rv(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=ov(e);return s.scope=e.scope,s.stream=t.join("\n"),s}},gv=function(e,t){var n=0===e.fontSize?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},a=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map((function(e){return e.split("\n")})):a.map((function(e){return[e]}));var s=n,i=Mv.internal.getHeight(e)||0;i=i<0?-i:i;var o=Mv.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(t,n,r){if(t+1<a.length){var s=n+" "+a[t+1][0];return vv(s,e,r).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var c,u,d=vv("3",e,s).height,h=e.multiline?i-s:(i-d)/2,f=h+=2,p=0,m=0,g=0;if(s<=0){t="(...) Tj\n",t+="% Width of Text: "+vv(t,e,s=12).width+", FieldWidth:"+o+"\n";break}for(var v="",b=0,x=0;x<a.length;x++)if(a.hasOwnProperty(x)){var y=!1;if(1!==a[x].length&&g!==a[x].length-1){if((d+2)*(b+2)+2>i)continue e;v+=a[x][g],y=!0,m=x,x--}else{v=" "==(v+=a[x][g]+" ").substr(v.length-1)?v.substr(0,v.length-1):v;var w=parseInt(x),j=l(w,v,s),N=x>=a.length-1;if(j&&!N){v+=" ",g=0;continue}if(j||N){if(N)m=w;else if(e.multiline&&(d+2)*(b+2)+2>i)continue e}else{if(!e.multiline)continue e;if((d+2)*(b+2)+2>i)continue e;m=w}}for(var S="",C=p;C<=m;C++){var k=a[C];if(e.multiline){if(C===m){S+=k[g]+" ",g=(g+1)%k.length;continue}if(C===p){S+=k[k.length-1]+" ";continue}}S+=k[0]+" "}switch(S=" "==S.substr(S.length-1)?S.substr(0,S.length-1):S,u=vv(S,e,s).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}t+=rv(c)+" "+rv(f)+" Td\n",t+="("+tv(S)+") Tj\n",t+=-rv(c)+" 0 Td\n",f=-(s+2),u=0,p=y?m:m+1,b++,v=""}break}return r.text=t,r.fontSize=s,r},vv=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:a}},bv={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},xv=function(e,t){var n={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find((function(e){return e.type===n.type&&e.object===n.object}))&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},yv=function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(kv.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(bv)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ev=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Cv,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",(function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})),e.internal.events.subscribe("buildDocument",(function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];r.objId=void 0,r.hasAnnotation&&xv(r,e)}}(e)})),e.internal.events.subscribe("putCatalog",(function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)})),e.internal.events.subscribe("postPutPages",(function(t){!function(e,t){var n=!e;for(var r in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(r)){var a=e[r],s=[],i=a.Rect;if(a.Rect&&(a.Rect=pv(a.Rect,t)),t.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Mv.createDefaultAppearanceStream(a),"object"===(0,jm.A)(a)&&"function"==typeof a.getKeyValueListForStream&&(s=a.getKeyValueListForStream()),a.Rect=i,a.hasAppearanceStream&&!a.appearanceStreamContent){var o=mv(a);s.push({key:"AP",value:"<</N "+o+">>"}),t.internal.acroformPlugin.xForms.push(o)}if(a.appearanceStreamContent){var l="";for(var c in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(c)){var u=a.appearanceStreamContent[c];if(l+="/"+c+" ",l+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var r in u)if(u.hasOwnProperty(r)){var d=u[r];"function"==typeof d&&(d=d.call(t,a)),l+="/"+r+" "+d+" ",t.internal.acroformPlugin.xForms.indexOf(d)>=0||t.internal.acroformPlugin.xForms.push(d)}}else"function"==typeof(d=u)&&(d=d.call(t,a)),l+="/"+r+" "+d,t.internal.acroformPlugin.xForms.indexOf(d)>=0||t.internal.acroformPlugin.xForms.push(d);l+=">>"}s.push({key:"AP",value:"<<\n"+l+">>"})}t.internal.putStream({additionalKeyValues:s,objectId:a.objId}),t.internal.out("endobj")}n&&function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=n,a=e[n];t.internal.newObjectDeferredBegin(a.objId,!0),"object"===(0,jm.A)(a)&&"function"==typeof a.putStream&&a.putStream(),delete e[r]}}(t.internal.acroformPlugin.xForms,t)}(t,e)})),e.internal.acroformPlugin.isInitialized=!0}},wv=Zg.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(e){return e};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(0!==s&&(a+=" "),(0,jm.A)(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":"/"!==e[s].substr(0,1)?(void 0!==t&&n&&(r=n.internal.getEncryptor(t)),a+="("+tv(r(e[s].toString()))+")"):a+=e[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},jv=function(e,t,n){var r=function(e){return e};return void 0!==t&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+tv(r(e))+")"},Nv=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Nv.prototype.toString=function(){return this.objId+" 0 R"},Nv.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Nv.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter((function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)}));for(var n in t)if(!1===Object.getOwnPropertyDescriptor(this,t[n]).configurable){var r=t[n],a=this[r];a&&(Array.isArray(a)?e.push({key:r,value:wv(a,this.objId,this.scope)}):a instanceof Nv?(a.scope=this.scope,e.push({key:r,value:a.objId+" 0 R"})):"function"!=typeof a&&e.push({key:r,value:a}))}return e};var Sv=function(){Nv.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};sv(Sv,Nv);var Cv=function(){Nv.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+tv(t(e))+")"}},set:function(t){e=t}})};sv(Cv,Nv);var kv=function e(){Nv.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(t,3))},set:function(e){!0===Boolean(e)?this.F=hv(t,3):this.F=fv(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');n=e}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==r.length)return r},set:function(e){r=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(e){r[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(e){r[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(e){r[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(e){r[3]=e}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Dv)return;s="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+tv(t(s))+")"},set:function(e){s=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(e){s=e}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/ev:c},set:function(e){c=e}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(e){u=e}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Dv||this instanceof Ov))return jv(d,this.objId,this.scope)},set:function(e){e=e.toString(),d=e}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof _v==0?jv(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof _v==0?"("===e.substr(0,1)?nv(e.substr(1,e.length-2)):nv(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof _v==1?nv(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof _v==1?"/"+e:e}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof _v==0?jv(f,this.objId,this.scope):f},set:function(e){e=e.toString(),f=this instanceof _v==0?"("===e.substr(0,1)?nv(e.substr(1,e.length-2)):nv(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof _v==1?nv(f.substr(1,f.length-1)):f},set:function(e){e=e.toString(),f=this instanceof _v==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(e){e=Boolean(e),m=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(e){p=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,1):this.Ff=fv(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,2):this.Ff=fv(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,3):this.Ff=fv(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');g=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(g){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};sv(kv,Nv);var Ev=function(){kv.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return wv(t,this.objId,this.scope)},set:function(e){var n,r;r=[],"string"==typeof(n=e)&&(r=function(e,t,n){n||(n=1);for(var r,a=[];r=t.exec(e);)a.push(r[n]);return a}(n,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,18):this.Ff=fv(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=hv(this.Ff,19):this.Ff=fv(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=hv(this.Ff,20),t.sort()):this.Ff=fv(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,22):this.Ff=fv(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,23):this.Ff=fv(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,27):this.Ff=fv(this.Ff,27)}}),this.hasAppearanceStream=!1};sv(Ev,kv);var Av=function(){Ev.call(this),this.fontName="helvetica",this.combo=!1};sv(Av,Ev);var Tv=function(){Av.call(this),this.combo=!0};sv(Tv,Av);var Pv=function(){Tv.call(this),this.edit=!0};sv(Pv,Tv);var _v=function(){kv.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,15):this.Ff=fv(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,16):this.Ff=fv(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,17):this.Ff=fv(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,26):this.Ff=fv(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var n,r=[];for(n in r.push("<<"),t)r.push("/"+n+" ("+tv(e(t[n]))+")");return r.push(">>"),r.join("\n")}},set:function(e){"object"===(0,jm.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};sv(_v,kv);var Lv=function(){_v.call(this),this.pushButton=!0};sv(Lv,_v);var Rv=function(){_v.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};sv(Rv,_v);var Dv=function(){var e,t;kv.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,n=[];for(t in n.push("<<"),r)n.push("/"+t+" ("+tv(e(r[t]))+")");return n.push(">>"),n.join("\n")},set:function(e){"object"===(0,jm.A)(e)&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){"string"==typeof e&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(e){n="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Mv.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};sv(Dv,kv),Rv.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Rv.prototype.createOption=function(e){var t=new Dv;return t.Parent=this,t.optionName=e,this.Kids.push(t),Bv.call(this.scope,t),t};var Iv=function(){_v.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Mv.CheckBox.createAppearanceStream()};sv(Iv,_v);var Ov=function(){kv.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,13):this.Ff=fv(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,21):this.Ff=fv(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,23):this.Ff=fv(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,24):this.Ff=fv(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,25):this.Ff=fv(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,26):this.Ff=fv(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};sv(Ov,kv);var Fv=function(){Ov.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(dv(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=hv(this.Ff,14):this.Ff=fv(this.Ff,14)}}),this.password=!0};sv(Fv,Ov);var Mv={CheckBox:{createAppearanceStream:function(){return{N:{On:Mv.CheckBox.YesNormal},D:{On:Mv.CheckBox.YesPushDown,Off:Mv.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=ov(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=gv(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+rv(Mv.internal.getWidth(e))+" "+rv(Mv.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+rv(s.fontSize)+" Tf "+a),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join("\n"),t},YesNormal:function(e){var t=ov(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),a=[],s=Mv.internal.getHeight(e),i=Mv.internal.getWidth(e),o=gv(e,e.caption);return a.push("1 g"),a.push("0 0 "+rv(i)+" "+rv(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+rv(i-1)+" "+rv(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+n+" "+rv(o.fontSize)+" Tf "+r),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=ov(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+rv(Mv.internal.getWidth(e))+" "+rv(Mv.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Mv.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Mv.RadioButton.Circle.YesNormal,t.D[e]=Mv.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=ov(e);t.scope=e.scope;var n=[],r=Mv.internal.getWidth(e)<=Mv.internal.getHeight(e)?Mv.internal.getWidth(e)/4:Mv.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Mv.internal.Bezier_C,s=Number((r*a).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+av(Mv.internal.getWidth(e)/2)+" "+av(Mv.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=ov(e);t.scope=e.scope;var n=[],r=Mv.internal.getWidth(e)<=Mv.internal.getHeight(e)?Mv.internal.getWidth(e)/4:Mv.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),s=Number((a*Mv.internal.Bezier_C).toFixed(5)),i=Number((r*Mv.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+av(Mv.internal.getWidth(e)/2)+" "+av(Mv.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),n.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),n.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),n.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+av(Mv.internal.getWidth(e)/2)+" "+av(Mv.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=ov(e);t.scope=e.scope;var n=[],r=Mv.internal.getWidth(e)<=Mv.internal.getHeight(e)?Mv.internal.getWidth(e)/4:Mv.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),s=Number((a*Mv.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+av(Mv.internal.getWidth(e)/2)+" "+av(Mv.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),n.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),n.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),n.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Mv.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Mv.RadioButton.Cross.YesNormal,t.D[e]=Mv.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=ov(e);t.scope=e.scope;var n=[],r=Mv.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+rv(Mv.internal.getWidth(e)-2)+" "+rv(Mv.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(rv(r.x1.x)+" "+rv(r.x1.y)+" m"),n.push(rv(r.x2.x)+" "+rv(r.x2.y)+" l"),n.push(rv(r.x4.x)+" "+rv(r.x4.y)+" m"),n.push(rv(r.x3.x)+" "+rv(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=ov(e);t.scope=e.scope;var n=Mv.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+rv(Mv.internal.getWidth(e))+" "+rv(Mv.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+rv(Mv.internal.getWidth(e)-2)+" "+rv(Mv.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(rv(n.x1.x)+" "+rv(n.x1.y)+" m"),r.push(rv(n.x2.x)+" "+rv(n.x2.y)+" l"),r.push(rv(n.x4.x)+" "+rv(n.x4.y)+" m"),r.push(rv(n.x3.x)+" "+rv(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=ov(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+rv(Mv.internal.getWidth(e))+" "+rv(Mv.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};Mv.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Mv.internal.getWidth(e),n=Mv.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},Mv.internal.getWidth=function(e){var t=0;return"object"===(0,jm.A)(e)&&(t=iv(e.Rect[2])),t},Mv.internal.getHeight=function(e){var t=0;return"object"===(0,jm.A)(e)&&(t=iv(e.Rect[3])),t};var Bv=Zg.addField=function(e){if(yv(this,e),!(e instanceof kv))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Zg.AcroFormChoiceField=Ev,Zg.AcroFormListBox=Av,Zg.AcroFormComboBox=Tv,Zg.AcroFormEditBox=Pv,Zg.AcroFormButton=_v,Zg.AcroFormPushButton=Lv,Zg.AcroFormRadioButton=Rv,Zg.AcroFormCheckBox=Iv,Zg.AcroFormTextField=Ov,Zg.AcroFormPasswordField=Fv,Zg.AcroFormAppearance=Mv,Zg.AcroForm={ChoiceField:Ev,ListBox:Av,ComboBox:Tv,EditBox:Pv,Button:_v,PushButton:Lv,RadioButton:Rv,CheckBox:Iv,TextField:Ov,PasswordField:Fv,Appearance:Mv},Qg.AcroForm={ChoiceField:Ev,ListBox:Av,ComboBox:Tv,EditBox:Pv,Button:_v,PushButton:Lv,RadioButton:Rv,CheckBox:Iv,TextField:Ov,PasswordField:Fv,Appearance:Mv};Qg.AcroForm;function zv(e){return e.reduce((function(e,t,n){return e[t]=n,e}),{})}!function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(e,r){var a,s,i,o,l,c=t;if("RGBA"===(r=r||t)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(j(e))for(l in n)for(i=n[l],a=0;a<i.length;a+=1){for(o=!0,s=0;s<i[a].length;s+=1)if(void 0!==i[a][s]&&i[a][s]!==e[s]){o=!1;break}if(!0===o){c=l;break}}else for(l in n)for(i=n[l],a=0;a<i.length;a+=1){for(o=!0,s=0;s<i[a].length;s+=1)if(void 0!==i[a][s]&&i[a][s]!==e.charCodeAt(s)){o=!1;break}if(!0===o){c=l;break}}return c===t&&r!==t&&(c=r),c},a=function e(t){for(var n=this.internal.write,r=this.internal.putStream,a=(0,this.internal.getFilters)();-1!==a.indexOf("FlateEncode");)a.splice(a.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:t.width}),s.push({key:"Height",value:t.height}),t.colorSpace===g.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===g.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)){for(var i="",o=0,l=t.transparency.length;o<l;o++)i+=t.transparency[o]+" "+t.transparency[o]+" ";s.push({key:"Mask",value:"["+i+"]"})}void 0!==t.sMask&&s.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(r({data:t.data,additionalKeyValues:s,alreadyAppliedFilters:c,objectId:t.objectId}),n("endobj"),"sMask"in t&&void 0!==t.sMask){var u="/Predictor "+t.predictor+" /Colors 1 /BitsPerComponent "+t.bitsPerComponent+" /Columns "+t.width,d={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:t.bitsPerComponent,decodeParameters:u,data:t.sMask};"filter"in t&&(d.filter=t.filter),e.call(this,d)}if(t.colorSpace===g.INDEXED){var h=this.internal.newObject();r({data:S(new Uint8Array(t.palette)),objectId:h}),n("endobj")}},s=function(){var e=this.internal.collections.addImage_images;for(var t in e)a.call(this,e[t])},i=function(){var e,t=this.internal.collections.addImage_images,n=this.internal.write;for(var r in t)n("/I"+(e=t[r]).index,e.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",i))},l=function(){var e=this.internal.collections.addImage_images;return o.call(this),e},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(t){return"function"==typeof e["process"+t.toUpperCase()]},d=function(e){return"object"===(0,jm.A)(e)&&1===e.nodeType},h=function(t,n){if("IMG"===t.nodeName&&t.hasAttribute("src")){var r=""+t.getAttribute("src");if(0===r.indexOf("data:image/"))return Cg(unescape(r).split("base64,").pop());var a=e.loadFile(r,!0);if(void 0!==a)return a}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var s;switch(n){case"PNG":s="image/png";break;case"WEBP":s="image/webp";break;default:s="image/jpeg"}return Cg(t.toDataURL(s,1).split("base64,").pop())}},f=function(e){var t=this.internal.collections.addImage_images;if(t)for(var n in t)if(e===t[n].alias)return t[n]},p=function(e,t,n){return e||t||(e=-96,t=-96),e<0&&(e=-1*n.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*n.height*72/t/this.internal.scaleFactor),0===e&&(e=t*n.width/n.height),0===t&&(t=e*n.height/n.width),[e,t]},m=function(e,t,n,r,a,s){var i=p.call(this,n,r,a),o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=l.call(this);if(n=i[0],r=i[1],u[a.index]=a,s){s*=Math.PI/180;var d=Math.cos(s),h=Math.sin(s),f=function(e){return e.toFixed(4)},m=[f(d),f(h),f(-1*h),f(d),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,o(e),c(t+r),"cm"].join(" ")),this.internal.write(m.join(" ")),this.internal.write([o(n),"0","0",o(r),"0","0","cm"].join(" "))):this.internal.write([o(n),"0","0",o(r),o(e),c(t+r),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+a.index+" Do"),this.internal.write("Q")},g=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(e){var t,n,r=0;if("string"==typeof e)for(n=e.length,t=0;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;else if(j(e))for(n=e.byteLength/2,t=0;t<n;t++)r=(r<<5)-r+e[t],r|=0;return r},x=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},y=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null},w=e.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};e.__addimage__.isArrayBuffer=function(e){return w()&&e instanceof ArrayBuffer};var j=e.__addimage__.isArrayBufferView=function(e){return w()&&"undefined"!=typeof Uint32Array&&(e instanceof Int8Array||e instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)},N=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n},S=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",n=j(e)?e:new Uint8Array(e),r=0;r<n.length;r+=8192)t+=String.fromCharCode.apply(null,n.subarray(r,r+8192));return t};e.addImage=function(){var e,n,r,a,s,i,l,c,u;if("number"==typeof arguments[1]?(n=t,r=arguments[1],a=arguments[2],s=arguments[3],i=arguments[4],l=arguments[5],c=arguments[6],u=arguments[7]):(n=arguments[1],r=arguments[2],a=arguments[3],s=arguments[4],i=arguments[5],l=arguments[6],c=arguments[7],u=arguments[8]),"object"===(0,jm.A)(e=arguments[0])&&!d(e)&&"imageData"in e){var h=e;e=h.imageData,n=h.format||n||t,r=h.x||r||0,a=h.y||a||0,s=h.w||h.width||s,i=h.h||h.height||i,l=h.alias||l,c=h.compression||c,u=h.rotation||h.angle||u}var f=this.internal.getFilters();if(void 0===c&&-1!==f.indexOf("FlateEncode")&&(c="SLOW"),isNaN(r)||isNaN(a))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var p=C.call(this,e,n,l,c);return m.call(this,r,a,s,i,p,u),this};var C=function(n,a,s,i){var o,l,p;if("string"==typeof n&&r(n)===t){n=unescape(n);var m=k(n,!1);(""!==m||void 0!==(m=e.loadFile(n,!0)))&&(n=m)}if(d(n)&&(n=h(n,a)),a=r(n,a),!u(a))throw new Error("addImage does not support files of type '"+a+"', please ensure that a plugin for '"+a+"' support is added.");if((null==(p=s)||0===p.length)&&(s=function(e){return"string"==typeof e||j(e)?b(e):j(e.data)?b(e.data):null}(n)),(o=f.call(this,s))||(w()&&(n instanceof Uint8Array||"RGBA"===a||(l=n,n=N(n))),o=this["process"+a.toUpperCase()](n,c.call(this),s,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:v.NONE}(i),l)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},k=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var n,r="";if("string"==typeof e){var a;n=null!==(a=y(e))&&void 0!==a?a:e;try{r=Cg(n)}catch(e){if(t)throw x(n)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return r};e.getImageProperties=function(n){var a,s,i="";if(d(n)&&(n=h(n)),"string"==typeof n&&r(n)===t&&(""===(i=k(n,!1))&&(i=e.loadFile(n)||""),n=i),s=r(n),!u(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(!w()||n instanceof Uint8Array||(n=N(n)),!(a=this["process"+s.toUpperCase()](n)))throw new Error("An unknown error occurred whilst processing the image");return a.fileType=s,a}}(Qg.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};Qg.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var n,r,a,s=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,o=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,c=!1,u=0;u<l.length&&!c;u++)switch((n=l[u]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var d=0;d<l.length;d++){n=l[d];var h=this.internal.pdfEscape,f=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),m=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(p.objId),v=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(r="/Rect ["+s(n.bounds.x)+" "+i(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+i(n.bounds.y)+"] ")+"/Contents ("+h(g(n.contents))+")",a+=" /Popup "+m.objId+" 0 R",a+=" /P "+o.objId+" 0 R",a+=" /T ("+h(g(v))+") >>",p.content=a;var b=p.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+s(n.bounds.x+30)+" "+i(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+i(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",m.content=a,this.internal.write(p.objId,"0 R",m.objId,"0 R");break;case"freetext":r="/Rect ["+s(n.bounds.x)+" "+i(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+i(n.bounds.y+n.bounds.h)+"] ";var x=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+h(f(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+x+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var y=this.annotations._nameMap[n.options.name];n.options.pageNumber=y.page,n.options.top=y.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+h(f(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var w=i(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+w+" "+n.options.zoom+"]"}""!=a&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,n,r,a){var s=this.internal.getCurrentPageInfo(),i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:i(e),y:o(t),w:i(e+n),h:o(t+r)},options:a,type:"link"})},e.textWithLink=function(e,t,n,r){var a,s,i=this.getTextWidth(e),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==r.maxWidth){s=r.maxWidth;var l=this.splitTextToSize(e,s).length;a=Math.ceil(o*l)}else s=i,a=o;return this.text(e,t,n,r),n+=.2*o,"center"===r.align&&(t-=i/2),"right"===r.align&&(t-=i),this.link(t,n-o,s,a,r),i},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(Qg.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},i=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(e){return i(e)&&a.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return i(e)&&s(e)&&4==t[e.charCodeAt(0)].length},d=e.__arabicParser__.resolveLigatures=function(e){var t=0,r=n,a="",s=0;for(t=0;t<e.length;t+=1)void 0!==r[e.charCodeAt(t)]?(s++,"number"==typeof(r=r[e.charCodeAt(t)])&&(a+=String.fromCharCode(r),r=n,s=0),t===e.length-1&&(r=n,a+=e.charAt(t-(s-1)),t-=s-1,s=0)):(r=n,a+=e.charAt(t-s),t-=s,s=0);return a};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==r[e.charCodeAt(0)]};var h=e.__arabicParser__.getCorrectForm=function(e,t,n){return i(e)?!1===s(e)?-1:!c(e)||!i(t)&&!i(n)||!i(n)&&o(t)||o(e)&&!i(t)||o(e)&&l(t)||o(e)&&o(t)?0:u(e)&&i(t)&&!o(t)&&i(n)&&c(n)?3:o(e)||!i(n)?1:2:-1},f=function(e){var n=0,r=0,a=0,s="",o="",l="",c=(e=e||"").split("\\s+"),u=[];for(n=0;n<c.length;n+=1){for(u.push(""),r=0;r<c[n].length;r+=1)s=c[n][r],o=c[n][r-1],l=c[n][r+1],i(s)?(a=h(s,o,l),u[n]+=-1!==a?String.fromCharCode(t[s.charCodeAt(0)][a]):s):u[n]+=s;u[n]=d(u[n])}return u.join(" ")},p=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(t)){var r=0;for(n=[],r=0;r<t.length;r+=1)Array.isArray(t[r])?n.push([f(t[r][0]),t[r][1],t[r][2]]):n.push([f(t[r])]);e=n}else e=f(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",p])}(Qg.API),Qg.API.autoPrint=function(e){var t;if("javascript"===((e=e||{}).variant=e.variant||"non-conform",e.variant))this.addJS("print({});");else this.internal.events.subscribe("postPutResources",(function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+t+" 0 R")}));return this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(e){n=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(e){r=e}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var n;if("2d"!==(e=e||"2d"))return null;for(n in t)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=t[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Qg.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var a=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var i=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return i},set:function(e){i=e}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return r.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){r.call(this);var n=(t=t||{}).fontSize||this.getFontSize(),a=t.font||this.getFont(),s=t.scaleFactor||this.internal.scaleFactor,i=0,o=0,l=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var u=t.maxWidth;u>0?"string"==typeof e?e=this.splitTextToSize(e,u):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce((function(e,t){return e.concat(c.splitTextToSize(t,u))}),[])):e=Array.isArray(e)?e:[e];for(var d=0;d<e.length;d++)i<(l=this.getStringUnitWidth(e[d],{font:a})*n)&&(i=l);return 0!==i&&(o=e.length),{w:i/=s,h:Math.max((o*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/s,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var e;e=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var a=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,o=this.internal.__cell__.margins||t,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==a.lineNumber&&(a.lineNumber===e.lineNumber?(e.x=(a.x||0)+(a.width||0),e.y=a.y||0):a.y+a.height+e.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=o.top,c&&l&&(this.printHeaderRow(e.lineNumber,!0),e.y+=l[0].height)):e.y=a.y+a.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===n?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-i,e.y+i,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+i,{align:"center",baseline:"top",maxWidth:e.width-i-i}):this.text(e.text,e.x+i,e.y+i,{align:"left",baseline:"top",maxWidth:e.width-i-i})),this.internal.__cell__.lastCell=e,this};e.table=function(e,n,l,c,u){if(r.call(this),!l)throw new Error("No data for PDF table.");var d,h,f,p,m=[],g=[],v=[],b={},x={},y=[],w=[],j=(u=u||{}).autoSize||!1,N=!1!==u.printHeaders,S=u.css&&void 0!==u.css["font-size"]?16*u.css["font-size"]:u.fontSize||12,C=u.margins||Object.assign({width:this.getPageWidth()},t),k="number"==typeof u.padding?u.padding:3,E=u.headerBackgroundColor||"#c8c8c8",A=u.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=N,this.internal.__cell__.margins=C,this.internal.__cell__.table_font_size=S,this.internal.__cell__.padding=k,this.internal.__cell__.headerBackgroundColor=E,this.internal.__cell__.headerTextColor=A,this.setFontSize(S),null==c)g=m=Object.keys(l[0]),v=m.map((function(){return"left"}));else if(Array.isArray(c)&&"object"===(0,jm.A)(c[0]))for(m=c.map((function(e){return e.name})),g=c.map((function(e){return e.prompt||e.name||""})),v=c.map((function(e){return e.align||"left"})),d=0;d<c.length;d+=1)x[c[d].name]=c[d].width*(19.049976/25.4);else Array.isArray(c)&&"string"==typeof c[0]&&(g=m=c,v=m.map((function(){return"left"})));if(j||Array.isArray(c)&&"string"==typeof c[0])for(d=0;d<m.length;d+=1){for(b[p=m[d]]=l.map((function(e){return e[p]})),this.setFont(void 0,"bold"),y.push(this.getTextDimensions(g[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),h=b[p],this.setFont(void 0,"normal"),f=0;f<h.length;f+=1)y.push(this.getTextDimensions(h[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);x[p]=Math.max.apply(null,y)+k+k,y=[]}if(N){var T={};for(d=0;d<m.length;d+=1)T[m[d]]={},T[m[d]].text=g[d],T[m[d]].align=v[d];var P=o.call(this,T,x);w=m.map((function(t){return new s(e,n,x[t],P,T[t].text,void 0,T[t].align)})),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var _=c.reduce((function(e,t){return e[t.name]=t.align,e}),{});for(d=0;d<l.length;d+=1){"rowStart"in u&&u.rowStart instanceof Function&&u.rowStart({row:d,data:l[d]},this);var L=o.call(this,l[d],x);for(f=0;f<m.length;f+=1){var R=l[d][m[f]];"cellStart"in u&&u.cellStart instanceof Function&&u.cellStart({row:d,col:f,data:R},this),i.call(this,new s(e,n,x[m[f]],L,R,d+2,_[m[f]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=n,this};var o=function(e,t){var n=this.internal.__cell__.padding,r=this.internal.__cell__.table_font_size,a=this.internal.scaleFactor;return Object.keys(e).map((function(r){var a=e[r];return this.splitTextToSize(a.hasOwnProperty("text")?a.text:a,t[r]-n-n)}),this).map((function(e){return this.getLineHeightFactor()*e.length*r/a+n+n}),this).reduce((function(e,t){return Math.max(e,t)}),0)};e.setTableHeaderRow=function(e){r.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var a;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var o=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(o[0],o[1],o[2],o[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){a=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(a.y=this.internal.__cell__.margins.top||0,l.push(a)),a.lineNumber=e;var u=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,a),this.setTextColor(u)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),n=!1}}(Qg.API);var Uv={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},qv=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Vv=zv(qv),Wv=[100,200,300,400,500,600,700,800,900],Hv=zv(Wv);function Gv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(e){return Uv[e=e||"normal"]?e:"normal"}(e.style),r=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),a=function(e){return"number"==typeof Vv[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,n,r].join(" ")}}}function Yv(e,t,n,r){var a;for(a=n;a>=0&&a<t.length;a+=r)if(e[t[a]])return e[t[a]];for(a=n;a>=0&&a<t.length;a-=r)if(e[t[a]])return e[t[a]]}var $v={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Kv={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Jv(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Xv(e){return e.trimLeft()}function Qv(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function Zv(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var eb,tb,nb,rb,ab=["times"];!function(e){var t,n,r,a,s,i,o,l,c,u=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new l,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new i,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new i,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new d(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var d=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var a=0;Object.defineProperty(this,"posX",{get:function(){return a},set:function(e){isNaN(e)||(a=e)}});var s=0;Object.defineProperty(this,"posY",{get:function(){return s},set:function(e){isNaN(e)||(s=e)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),c.margin=t}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=e}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(e){o=e}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(e){e instanceof u&&(c=e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(e){c.path=e}});var d=[];Object.defineProperty(this,"ctxStack",{get:function(){return d},set:function(e){d=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=h(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=h(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var f=null;function p(e,t){if(null===f){var n=function(e){var t=[];return Object.keys(e).forEach((function(n){e[n].forEach((function(e){var r=null;switch(e){case"bold":r={family:n,weight:"bold"};break;case"italic":r={family:n,style:"italic"};break;case"bolditalic":r={family:n,weight:"bold",style:"italic"};break;case"":case"normal":r={family:n}}null!==r&&(r.ref={name:n,style:e},t.push(r))}))})),t}(e.getFontList());f=function(e){for(var t={},n=0;n<e.length;++n){var r=Gv(e[n]),a=r.family,s=r.stretch,i=r.style,o=r.weight;t[a]=t[a]||{},t[a][s]=t[a][s]||{},t[a][s][i]=t[a][s][i]||{},t[a][s][i][o]=r}return t}(n.concat(t))}return f}var m=null;Object.defineProperty(this,"fontFaces",{get:function(){return m},set:function(e){f=null,m=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var n=t[1];t[2];var r=t[3],a=t[4];t[5];var s=t[6],i=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(a)[2];a="px"===i?Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor):"em"===i?Math.floor(parseFloat(a)*this.pdf.getFontSize()):Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(a);var o=function(e){var t,n,r=[],a=e.trim();if(""===a)return ab;if(a in Kv)return[Kv[a]];for(;""!==a;){switch(n=null,t=(a=Xv(a)).charAt(0)){case'"':case"'":n=Qv(a.substring(1),t);break;default:n=Zv(a)}if(null===n)return ab;if(r.push(n[0]),""!==(a=Xv(n[1]))&&","!==a.charAt(0))return ab;a=a.replace(/^,/,"")}return r}(s);if(this.fontFaces){var l=function(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",a=Object.assign({},$v,n.genericFontFamilies||{}),s=null,i=null,o=0;o<t.length;++o)if(a[(s=Gv(t[o])).family]&&(s.family=a[s.family]),e.hasOwnProperty(s.family)){i=e[s.family];break}if(!(i=i||e[r]))throw new Error("Could not find a font-family for the rule '"+Jv(s)+"' and default family '"+r+"'.");if(i=function(e,t){if(t[e])return t[e];var n=Vv[e],r=n<=Vv.normal?-1:1,a=Yv(t,qv,n,r);if(!a)throw new Error("Could not find a matching font-stretch value for "+e);return a}(s.stretch,i),i=function(e,t){if(t[e])return t[e];for(var n=Uv[e],r=0;r<n.length;++r)if(t[n[r]])return t[n[r]];throw new Error("Could not find a matching font-style for "+e)}(s.style,i),!(i=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var n=Hv[e],r=Yv(t,Wv,n,e<400?-1:1);if(!r)throw new Error("Could not find a matching font-weight for value "+e);return r}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+Jv(s)+"'.");return i}(p(this.pdf,this.fontFaces),o.map((function(e){return{family:e,stretch:"normal",weight:r,style:n}})));this.pdf.setFont(l.ref.name,l.ref.style)}else{var c="";("bold"===r||parseInt(r,10)>=700||"bold"===n)&&(c="bold"),"italic"===n&&(c+="italic"),0===c.length&&(c="normal");for(var u="",d={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},h=0;h<o.length;h++){if(void 0!==this.pdf.internal.getFont(o[h],c,{noFallback:!0,disableWarning:!0})){u=o[h];break}if("bolditalic"===c&&void 0!==this.pdf.internal.getFont(o[h],"bold",{noFallback:!0,disableWarning:!0}))u=o[h],c="bold";else if(void 0!==this.pdf.internal.getFont(o[h],"normal",{noFallback:!0,disableWarning:!0})){u=o[h],c="normal";break}}if(""===u)for(var f=0;f<o.length;f++)if(d[o[f]]){u=d[o[f]];break}u=""===u?"Times":u,this.pdf.setFont(u,c)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,F.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,F.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};d.prototype.setLineDash=function(e){this.lineDash=e},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){y.call(this,"fill",!1)},d.prototype.stroke=function(){y.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw wg.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new i(e,t)},d.prototype.closePath=function(){var e=new i(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,jm.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new i(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(e.x,e.y)},d.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw wg.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new i(n.x,n.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),y.call(this,null,!0)},d.prototype.quadraticCurveTo=function(e,t,n,r){if(isNaN(n)||isNaN(r)||isNaN(e)||isNaN(t))throw wg.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new i(n,r)),s=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"qct",x1:s.x,y1:s.y,x:a.x,y:a.y}),this.ctx.lastPoint=new i(a.x,a.y)},d.prototype.bezierCurveTo=function(e,t,n,r,a,s){if(isNaN(a)||isNaN(s)||isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw wg.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new i(a,s)),l=this.ctx.transform.applyToPoint(new i(e,t)),c=this.ctx.transform.applyToPoint(new i(n,r));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new i(o.x,o.y)},d.prototype.arc=function(e,t,n,r,a,s){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a))throw wg.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new i(e,t));e=o.x,t=o.y;var l=this.ctx.transform.applyToPoint(new i(0,n)),c=this.ctx.transform.applyToPoint(new i(0,0));n=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(a-r)>=2*Math.PI&&(r=0,a=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:n,startAngle:r,endAngle:a,counterclockwise:s})},d.prototype.arcTo=function(e,t,n,r,a){throw new Error("arcTo not implemented.")},d.prototype.rect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw wg.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this.lineTo(e+n,t),this.lineTo(e,t)},d.prototype.fillRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw wg.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,n,r),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},d.prototype.strokeRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw wg.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(e,t,n,r),this.stroke())},d.prototype.clearRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw wg.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,n,r))},d.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var r=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r}},d.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(e){var t,n,r,a;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,n=0,r=0,a=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==s)t=parseInt(s[1]),n=parseInt(s[2]),r=parseInt(s[3]),a=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(s[1]),n=parseInt(s[2]),r=parseInt(s[3]),a=parseFloat(s[4]);else{if(a=1,"string"==typeof e&&"#"!==e.charAt(0)){var i=new Ag(e);e=i.ok?i.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,n=e.substring(2,3),n+=n,r=e.substring(3,4),r+=r):(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7)),t=parseInt(t,16),n=parseInt(n,16),r=parseInt(r,16)}}return{r:t,g:n,b:r,a:a,style:e}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},p=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};d.prototype.fillText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw wg.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r=isNaN(r)?void 0:r,!f.call(this)){var a=D(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;A.call(this,{text:e,x:t,y:n,scale:s,angle:a,align:this.textAlign,maxWidth:r})}},d.prototype.strokeText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw wg.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){r=isNaN(r)?void 0:r;var a=D(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;A.call(this,{text:e,x:t,y:n,scale:s,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:r})}},d.prototype.measureText=function(e){if("string"!=typeof e)throw wg.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,n=this.pdf.internal.scaleFactor,r=t.internal.getFontSize(),a=t.getStringUnitWidth(e)*r/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:a*=Math.round(96*n/72*1e4)/1e4})},d.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw wg.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new l(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},d.prototype.rotate=function(e){if(isNaN(e))throw wg.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new l(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},d.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw wg.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new l(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(n)},d.prototype.transform=function(e,t,n,r,a,s){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a)||isNaN(s))throw wg.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var i=new l(e,t,n,r,a,s);this.ctx.transform=this.ctx.transform.multiply(i)},d.prototype.setTransform=function(e,t,n,r,a,s){e=isNaN(e)?1:e,t=isNaN(t)?0:t,n=isNaN(n)?0:n,r=isNaN(r)?1:r,a=isNaN(a)?0:a,s=isNaN(s)?0:s,this.ctx.transform=new l(e,t,n,r,a,s)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(e,t,n,r,a,s,i,c,u){var d=this.pdf.getImageProperties(e),h=1,f=1,p=1,v=1;void 0!==r&&void 0!==c&&(p=c/r,v=u/a,h=d.width/r*c/r,f=d.height/a*u/a),void 0===s&&(s=t,i=n,t=0,n=0),void 0!==r&&void 0===c&&(c=r,u=a),void 0===r&&void 0===c&&(c=d.width,u=d.height);for(var y,j=this.ctx.transform.decompose(),N=D(j.rotate.shx),S=new l,C=(S=(S=(S=S.multiply(j.translate)).multiply(j.skew)).multiply(j.scale)).applyToRectangle(new o(s-t*p,i-n*v,r*h,a*f)),k=g.call(this,C),E=[],A=0;A<k.length;A+=1)-1===E.indexOf(k[A])&&E.push(k[A]);if(x(E),this.autoPaging)for(var T=E[0],P=E[E.length-1],_=T;_<P+1;_++){this.pdf.setPage(_);var L=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],R=1===_?this.posY+this.margin[0]:this.margin[0],I=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],O=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],F=1===_?0:I+(_-2)*O;if(0!==this.ctx.clip_path.length){var M=this.path;y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(y,this.posX+this.margin[3],-F+R+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=M}var B=JSON.parse(JSON.stringify(C));B=b([B],this.posX+this.margin[3],-F+R+this.ctx.prevPageLastElemOffset)[0];var z=(_>T||_<P)&&m.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],L,O,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",B.x,B.y,B.w,B.h,null,null,N),z&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",C.x,C.y,C.w,C.h,null,null,N)};var g=function(e,t,n){var r=[];t=t||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var a=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":r.push(Math.floor((e.y+a)/n)+1);break;case"arc":r.push(Math.floor((e.y+a-e.radius)/n)+1),r.push(Math.floor((e.y+a+e.radius)/n)+1);break;case"qct":var s=I(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);r.push(Math.floor((s.y+a)/n)+1),r.push(Math.floor((s.y+s.h+a)/n)+1);break;case"bct":var i=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);r.push(Math.floor((i.y+a)/n)+1),r.push(Math.floor((i.y+i.h+a)/n)+1);break;case"rect":r.push(Math.floor((e.y+a)/n)+1),r.push(Math.floor((e.y+e.h+a)/n)+1)}for(var o=0;o<r.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<r[o];)v.call(this);return r},v=function(){var e=this.fillStyle,t=this.strokeStyle,n=this.font,r=this.lineCap,a=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=n,this.lineCap=r,this.lineWidth=a,this.lineJoin=s},b=function(e,t,n){for(var r=0;r<e.length;r++)switch(e[r].type){case"bct":e[r].x2+=t,e[r].y2+=n;case"qct":e[r].x1+=t,e[r].y1+=n;default:e[r].x+=t,e[r].y+=n}return e},x=function(e){return e.sort((function(e,t){return e-t}))},y=function(e,t){for(var n,r,a=this.fillStyle,s=this.strokeStyle,i=this.lineCap,o=this.lineWidth,l=Math.abs(o*this.ctx.transform.scaleX),c=this.lineJoin,u=JSON.parse(JSON.stringify(this.path)),d=JSON.parse(JSON.stringify(this.path)),h=[],f=0;f<d.length;f++)if(void 0!==d[f].x)for(var p=g.call(this,d[f]),y=0;y<p.length;y+=1)-1===h.indexOf(p[y])&&h.push(p[y]);for(var j=0;j<h.length;j++)for(;this.pdf.internal.getNumberOfPages()<h[j];)v.call(this);if(x(h),this.autoPaging)for(var N=h[0],S=h[h.length-1],C=N;C<S+1;C++){this.pdf.setPage(C),this.fillStyle=a,this.strokeStyle=s,this.lineCap=i,this.lineWidth=l,this.lineJoin=c;var k=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],E=1===C?this.posY+this.margin[0]:this.margin[0],A=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],P=1===C?0:A+(C-2)*T;if(0!==this.ctx.clip_path.length){var _=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(n,this.posX+this.margin[3],-P+E+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=_}if(r=JSON.parse(JSON.stringify(u)),this.path=b(r,this.posX+this.margin[3],-P+E+this.ctx.prevPageLastElemOffset),!1===t||0===C){var L=(C>N||C<S)&&m.call(this);L&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],k,T,null).clip().discardPath()),w.call(this,e,t),L&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=l,w.call(this,e,t),this.lineWidth=o;this.path=u},w=function(e,t){if(("stroke"!==e||t||!p.call(this))&&("stroke"===e||t||!f.call(this))){for(var n,r,a=[],s=this.path,i=0;i<s.length;i++){var o=s[i];switch(o.type){case"begin":a.push({begin:!0});break;case"close":a.push({close:!0});break;case"mt":a.push({start:o,deltas:[],abs:[]});break;case"lt":var l=a.length;if(s[i-1]&&!isNaN(s[i-1].x)&&(n=[o.x-s[i-1].x,o.y-s[i-1].y],l>0))for(;l>=0;l--)if(!0!==a[l-1].close&&!0!==a[l-1].begin){a[l-1].deltas.push(n),a[l-1].abs.push(o);break}break;case"bct":n=[o.x1-s[i-1].x,o.y1-s[i-1].y,o.x2-s[i-1].x,o.y2-s[i-1].y,o.x-s[i-1].x,o.y-s[i-1].y],a[a.length-1].deltas.push(n);break;case"qct":var c=s[i-1].x+2/3*(o.x1-s[i-1].x),u=s[i-1].y+2/3*(o.y1-s[i-1].y),d=o.x+2/3*(o.x1-o.x),h=o.y+2/3*(o.y1-o.y),m=o.x,g=o.y;n=[c-s[i-1].x,u-s[i-1].y,d-s[i-1].x,h-s[i-1].y,m-s[i-1].x,g-s[i-1].y],a[a.length-1].deltas.push(n);break;case"arc":a.push({deltas:[],abs:[],arc:!0}),Array.isArray(a[a.length-1].abs)&&a[a.length-1].abs.push(o)}}r=t?null:"stroke"===e?"stroke":"fill";for(var v=!1,b=0;b<a.length;b++)if(a[b].arc)for(var x=a[b].abs,y=0;y<x.length;y++){var w=x[y];"arc"===w.type?S.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,t,!v):T.call(this,w.x,w.y),v=!0}else if(!0===a[b].close)this.pdf.internal.out("h"),v=!1;else if(!0!==a[b].begin){var j=a[b].start.x,N=a[b].start.y;P.call(this,a[b].deltas,j,N),v=!0}r&&C.call(this,r),t&&k.call(this)}},j=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-n;case"top":return e+t-n;case"hanging":return e+t-2*n;case"middle":return e+t/2-n;default:return e}},N=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(e,t,n,r,a,s,i,o,l){for(var c=L.call(this,n,r,a,s),u=0;u<c.length;u++){var d=c[u];0===u&&(l?E.call(this,d.x1+e,d.y1+t):T.call(this,d.x1+e,d.y1+t)),_.call(this,e,t,d.x2,d.y2,d.x3,d.y3,d.x4,d.y4)}o?k.call(this):C.call(this,i)},C=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},k=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(e,t){this.pdf.internal.out(n(e)+" "+r(t)+" m")},A=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var n=this.pdf.getTextDimensions(e.text),r=j.call(this,e.y),a=N.call(this,r)-n.h,s=this.ctx.transform.applyToPoint(new i(e.x,r)),c=this.ctx.transform.decompose(),u=new l;u=(u=(u=u.multiply(c.translate)).multiply(c.skew)).multiply(c.scale);for(var d,h,f,p=this.ctx.transform.applyToRectangle(new o(e.x,r,n.w,n.h)),v=u.applyToRectangle(new o(e.x,a,n.w,n.h)),y=g.call(this,v),S=[],C=0;C<y.length;C+=1)-1===S.indexOf(y[C])&&S.push(y[C]);if(x(S),this.autoPaging)for(var k=S[0],E=S[S.length-1],A=k;A<E+1;A++){this.pdf.setPage(A);var T=1===A?this.posY+this.margin[0]:this.margin[0],P=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_=this.pdf.internal.pageSize.height-this.margin[2],L=_-this.margin[0],R=this.pdf.internal.pageSize.width-this.margin[1],D=R-this.margin[3],I=1===A?0:P+(A-2)*L;if(0!==this.ctx.clip_path.length){var O=this.path;d=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(d,this.posX+this.margin[3],-1*I+T),w.call(this,"fill",!0),this.path=O}var F=b([JSON.parse(JSON.stringify(v))],this.posX+this.margin[3],-I+T+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),f=this.lineWidth,this.lineWidth=f*e.scale);var M="text"!==this.autoPaging;if(M||F.y+F.h<=_){if(M||F.y>=T&&F.x<=R){var B=M?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||R-F.x)[0],z=b([JSON.parse(JSON.stringify(p))],this.posX+this.margin[3],-I+T+this.ctx.prevPageLastElemOffset)[0],U=M&&(A>k||A<E)&&m.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],D,L,null).clip().discardPath()),this.pdf.text(B,z.x,z.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),U&&this.pdf.restoreGraphicsState()}}else F.y<_&&(this.ctx.prevPageLastElemOffset+=_-F.y);e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=f)}else e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),f=this.lineWidth,this.lineWidth=f*e.scale),this.pdf.text(e.text,s.x+this.posX,s.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=f)},T=function(e,t,a,s){a=a||0,s=s||0,this.pdf.internal.out(n(e+a)+" "+r(t+s)+" l")},P=function(e,t,n){return this.pdf.lines(e,t,n,null,null)},_=function(e,n,r,i,o,l,c,u){this.pdf.internal.out([t(a(r+e)),t(s(i+n)),t(a(o+e)),t(s(l+n)),t(a(c+e)),t(s(u+n)),"c"].join(" "))},L=function(e,t,n,r){for(var a=2*Math.PI,s=Math.PI/2;t>n;)t-=a;var i=Math.abs(n-t);i<a&&r&&(i=a-i);for(var o=[],l=r?-1:1,c=t;i>1e-5;){var u=c+l*Math.min(i,s);o.push(R.call(this,e,c,u)),i-=Math.abs(u-c),c=u}return o},R=function(e,t,n){var r=(n-t)/2,a=e*Math.cos(r),s=e*Math.sin(r),i=a,o=-s,l=i*i+o*o,c=l+i*a+o*s,u=4/3*(Math.sqrt(2*l*c)-c)/(i*s-o*a),d=i-u*o,h=o+u*i,f=d,p=-h,m=r+t,g=Math.cos(m),v=Math.sin(m);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:d*g-h*v,y2:d*v+h*g,x3:f*g-p*v,y3:f*v+p*g,x4:e*Math.cos(n),y4:e*Math.sin(n)}},D=function(e){return 180*e/Math.PI},I=function(e,t,n,r,a,s){var i=e+.5*(n-e),l=t+.5*(r-t),c=a+.5*(n-a),u=s+.5*(r-s),d=Math.min(e,a,i,c),h=Math.max(e,a,i,c),f=Math.min(t,s,l,u),p=Math.max(t,s,l,u);return new o(d,f,h-d,p-f)},O=function(e,t,n,r,a,s,i,l){var c,u,d,h,f,p,m,g,v,b,x,y,w,j,N=n-e,S=r-t,C=a-n,k=s-r,E=i-a,A=l-s;for(u=0;u<41;u++)v=(m=(d=e+(c=u/40)*N)+c*((f=n+c*C)-d))+c*(f+c*(a+c*E-f)-m),b=(g=(h=t+c*S)+c*((p=r+c*k)-h))+c*(p+c*(s+c*A-p)-g),0==u?(x=v,y=b,w=v,j=b):(x=Math.min(x,v),y=Math.min(y,b),w=Math.max(w,v),j=Math.max(j,b));return new o(Math.round(x),Math.round(y),Math.round(w-x),Math.round(j-y))},F=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,n=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(Qg.API),function(e){var t=function(e){var t,n,r,a,s,i,o,l,c,u;for(/[^\x00-\xFF]/.test(e),n=[],r=0,a=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;a>r;r+=4)0!==(s=(e.charCodeAt(r)<<24)+(e.charCodeAt(r+1)<<16)+(e.charCodeAt(r+2)<<8)+e.charCodeAt(r+3))?(i=(s=((s=((s=((s=(s-(u=s%85))/85)-(c=s%85))/85)-(l=s%85))/85)-(o=s%85))/85)%85,n.push(i+33,o+33,l+33,c+33,u+33)):n.push(122);return function(e,t){for(var n=t;n>0;n--)e.pop()}(n,t.length),String.fromCharCode.apply(String,n)+"~>"},n=function(e){var t,n,r,a,s,i=String,o="length",l=255,c="charCodeAt",u="slice",d="replace";for(e[u](-2),e=e[u](0,-2)[d](/\s/g,"")[d]("z","!!!!!"),r=[],a=0,s=(e+=t="uuuuu"[u](e[o]%5||5))[o];s>a;a+=5)n=52200625*(e[c](a)-33)+614125*(e[c](a+1)-33)+7225*(e[c](a+2)-33)+85*(e[c](a+3)-33)+(e[c](a+4)-33),r.push(l&n>>24,l&n>>16,l&n>>8,l&n);return function(e,t){for(var n=t;n>0;n--)e.pop()}(r,t[o]),i.fromCharCode.apply(i,r)},r=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var n="",r=0;r<e.length;r+=2)n+=String.fromCharCode("0x"+(e[r]+e[r+1]));return n},a=function(e){for(var t=new Uint8Array(e.length),n=e.length;n--;)t[n]=e.charCodeAt(n);return(t=gg(t)).reduce((function(e,t){return e+String.fromCharCode(t)}),"")};e.processDataByFilters=function(e,s){var i=0,o=e||"",l=[];for("string"==typeof(s=s||[])&&(s=[s]),i=0;i<s.length;i+=1)switch(s[i]){case"ASCII85Decode":case"/ASCII85Decode":o=n(o),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":o=t(o),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":o=r(o),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":o=o.split("").map((function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)})).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":o=a(o),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[i]+'" is not implemented')}return{data:o,reverseChain:l.reverse().join(" ")}}}(Qg.API),(rb=Qg.API).loadFile=function(e,t,n){return function(e,t,n){t=!1!==t,n="function"==typeof n?n:function(){};var r=void 0;try{r=function(e,t,n){var r=new XMLHttpRequest,a=0,s=function(e){var t=e.length,n=[],r=String.fromCharCode;for(a=0;a<t;a+=1)n.push(r(255&e.charCodeAt(a)));return n.join("")};if(r.open("GET",e,!t),r.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(r.onload=function(){200===r.status?n(s(this.responseText)):n(void 0)}),r.send(null),t&&200===r.status)return s(r.responseText)}(e,t,n)}catch(e){}return r}(e,t,n)},rb.loadImageFile=rb.loadFile,function(e){function t(){return(xg.html2canvas?Promise.resolve(xg.html2canvas):n.e(239).then(n.t.bind(n,5239,23))).catch((function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))})).then((function(e){return e.default?e.default:e}))}function r(){return(xg.DOMPurify?Promise.resolve(xg.DOMPurify):n.e(977).then(n.bind(n,7977))).catch((function(e){return Promise.reject(new Error("Could not load dompurify: "+e))})).then((function(e){return e.default?e.default:e}))}var a=function(e){var t=(0,jm.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},s=function(e,t){var n=document.createElement(e);for(var r in t.className&&(n.className=t.className),t.innerHTML&&t.dompurify&&(n.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)n.style[r]=t.style[r];return n},i=function e(t){var n=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),r=e.convert(Promise.resolve(),n);return(r=r.setProgress(1,e,1,[e])).set(t)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(e,t){return e.__proto__=t||i.prototype,e},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(e,t){return this.then((function(){switch(t=t||function(e){switch(a(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(r).then((function(t){return this.set({src:s("div",{innerHTML:e,dompurify:t})})}));case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}}))},i.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=function e(t,n){for(var r=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),a=t.firstChild;a;a=a.nextSibling)!0!==n&&1===a.nodeType&&"SCRIPT"===a.nodeName||r.appendChild(e(a,n));return 1===t.nodeType&&("CANVAS"===t.nodeName?(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(r.value=t.value),r.addEventListener("load",(function(){r.scrollTop=t.scrollTop,r.scrollLeft=t.scrollLeft}),!0)),r}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},i.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then((function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)})).then((function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)}))},i.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then((function(e){var t=this.opt.jsPDF,n=this.opt.fontFaces,r="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,a=Object.assign({async:!0,allowTaint:!0,scale:r,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete a.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=n,n)for(var s=0;s<n.length;++s){var i=n[s],o=i.src.find((function(e){return"truetype"===e.format}));o&&t.addFont(o.url,i.ref.name,i.ref.style)}return a.windowHeight=a.windowHeight||0,a.windowHeight=0==a.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):a.windowHeight,t.context2d.save(!0),e(this.prop.container,a)})).then((function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)}))},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e}))},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},i.prototype.output=function(e,t,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},i.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(e,t)}))},i.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}}))},i.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},i.prototype.set=function(e){if("object"!==a(e))return this;var t=Object.keys(e||{}).map((function(t){if(t in i.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}}),this);return this.then((function(){return this.thenList(t)}))},i.prototype.get=function(e,t){return this.then((function(){var n=e in i.template.prop?this.prop[e]:this.opt[e];return t?t(n):n}))},i.prototype.setMargin=function(e){return this.then((function(){switch(a(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e})).then(this.setPageSize)},i.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then((function(){(e=e||Qg.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e}))},i.prototype.setProgress=function(e,t,n,r){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=n&&(this.progress.n=n),null!=r&&(this.progress.stack=r),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(e,t,n,r){return this.setProgress(e?this.progress.val+e:null,t||null,n?this.progress.n+n:null,r?this.progress.stack.concat(r):null)},i.prototype.then=function(e,t){var n=this;return this.thenCore(e,t,(function(e,t){return n.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,(function(t){return n.updateProgress(null,e),t})).then(e,t).then((function(e){return n.updateProgress(1),e}))}))},i.prototype.thenCore=function(e,t,n){n=n||Promise.prototype.then,e&&(e=e.bind(this)),t&&(t=t.bind(this));var r=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:i.convert(Object.assign({},this),Promise.prototype),a=n.call(r,e,t);return i.convert(a,this.__proto__)},i.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},i.prototype.thenList=function(e){var t=this;return e.forEach((function(e){t=t.thenCore(e)})),t},i.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return i.convert(t,this)},i.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},i.prototype.error=function(e){return this.then((function(){throw new Error(e)}))},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Qg.getPageSize=function(e,t,n){if("object"===(0,jm.A)(e)){var r=e;e=r.orientation,t=r.unit||t,n=r.format||n}t=t||"mm",n=n||"a4",e=(""+(e||"P")).toLowerCase();var a,s=(""+n).toLowerCase(),i={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":a=1;break;case"mm":a=72/25.4;break;case"cm":a=72/2.54;break;case"in":a=72;break;case"px":a=.75;break;case"pc":case"em":a=12;break;case"ex":a=6;break;default:throw"Invalid unit: "+t}var o,l=0,c=0;if(i.hasOwnProperty(s))l=i[s][1]/a,c=i[s][0]/a;else try{l=n[1],c=n[0]}catch(rb){throw new Error("Invalid format: "+n)}if("p"===e||"portrait"===e)e="p",c>l&&(o=c,c=l,l=o);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",l>c&&(o=c,c=l,l=o)}return{width:c,height:l,unit:t,k:a,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(Gv):null;var n=new i(t);return t.worker?n:n.from(e).doCallback()}}(Qg.API),Qg.API.addJS=function(e){return nb=e,this.internal.events.subscribe("postPutResources",(function(){eb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(eb+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),tb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+nb+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){void 0!==eb&&void 0!==tb&&this.internal.out("/Names <</JavaScript "+eb+" 0 R>>")})),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),a=0;a<r.length;a++){var s=r[a],i=n.exec(s);if(null!=i){var o=i[1];e.internal.newObjectDeferredBegin(o,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(a=0;a<l;a++){var u=e.internal.newObject();c.push(u);var d=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var h=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<c.length;a++)e.internal.write("(page_"+(a+1)+")"+c[a]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+h+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,n){var r={title:t,options:n,children:[]};return null==e&&(e=this.root),e.children.push(r),r},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var n=0;n<t.children.length;n++)this.genIds_r(t.children[n])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<t.children.length;r++){var a=t.children[r];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(t)),r>0&&this.line("/Prev "+this.makeRef(t.children[r-1])),r<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[r+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var s=this.count=this.count_r({count:0},a);if(s>0&&this.line("/Count "+s),a.options&&a.options.pageNumber){var i=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+i.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var n=0;n<t.children.length;n++)e.count++,this.count_r(e,t.children[n]);return e.count}}])}(Qg.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,n,r,a,s,i){var o,l=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(o=function(e){for(var n,r=256*e.charCodeAt(4)+e.charCodeAt(5),a=e.length,s={width:0,height:0,numcomponents:1},i=4;i<a;i+=2){if(i+=r,-1!==t.indexOf(e.charCodeAt(i+1))){n=256*e.charCodeAt(i+5)+e.charCodeAt(i+6),s={width:256*e.charCodeAt(i+7)+e.charCodeAt(i+8),height:n,numcomponents:e.charCodeAt(i+9)};break}r=256*e.charCodeAt(i+2)+e.charCodeAt(i+3)}return s}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}c={data:e,width:o.width,height:o.height,colorSpace:i,bitsPerComponent:8,filter:l,index:n,alias:r}}return c}}(Qg.API);var sb,ib,ob,lb,cb,ub=function(){var e,t,n;function r(e){var t,n,r,a,s,i,o,l,c,u,d,h,f,p;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},i=null;;){switch(t=this.readUInt32(),c=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":i&&this.animation.frames.push(i),this.pos+=4,i={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},s=this.readUInt16(),a=this.readUInt16()||100,i.delay=1e3*s/a,i.disposeOp=this.data[this.pos++],i.blendOp=this.data[this.pos++],i.data=[];break;case"IDAT":case"fdAT":for("fdAT"===c&&(this.pos+=4,t-=4),e=(null!=i?i.data:void 0)||this.imgData,h=0;0<=t?h<t:h>t;0<=t?++h:--h)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(r=this.palette.length/3,this.transparency.indexed=this.read(t),this.transparency.indexed.length>r)throw new Error("More transparent colors than palette size");if((u=r-this.transparency.indexed.length)>0)for(f=0;0<=u?f<u:f>u;0<=u?++f:--f)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":o=(d=this.read(t)).indexOf(0),l=String.fromCharCode.apply(String,d.slice(0,o)),this.text[l]=String.fromCharCode.apply(String,d.slice(o+1));break;case"IEND":return i&&this.animation.frames.push(i),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,n=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*n,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)n.push(this.data[this.pos++]);return n},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(e){var t=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*t),r=0,a=this;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);function s(s,i,o,l){var c,u,d,h,f,p,m,g,v,b,x,y,w,j,N,S,C,k,E,A,T,P=Math.ceil((a.width-s)/o),_=Math.ceil((a.height-i)/l),L=a.width==P&&a.height==_;for(j=t*P,y=L?n:new Uint8Array(j*_),p=e.length,w=0,u=0;w<_&&r<p;){switch(e[r++]){case 0:for(h=C=0;C<j;h=C+=1)y[u++]=e[r++];break;case 1:for(h=k=0;k<j;h=k+=1)c=e[r++],f=h<t?0:y[u-t],y[u++]=(c+f)%256;break;case 2:for(h=E=0;E<j;h=E+=1)c=e[r++],d=(h-h%t)/t,N=w&&y[(w-1)*j+d*t+h%t],y[u++]=(N+c)%256;break;case 3:for(h=A=0;A<j;h=A+=1)c=e[r++],d=(h-h%t)/t,f=h<t?0:y[u-t],N=w&&y[(w-1)*j+d*t+h%t],y[u++]=(c+Math.floor((f+N)/2))%256;break;case 4:for(h=T=0;T<j;h=T+=1)c=e[r++],d=(h-h%t)/t,f=h<t?0:y[u-t],0===w?N=S=0:(N=y[(w-1)*j+d*t+h%t],S=d&&y[(w-1)*j+(d-1)*t+h%t]),m=f+N-S,g=Math.abs(m-f),b=Math.abs(m-N),x=Math.abs(m-S),v=g<=b&&g<=x?f:b<=x?N:S,y[u++]=(c+v)%256;break;default:throw new Error("Invalid filter algorithm: "+e[r-1])}if(!L){var R=((i+w*l)*a.width+s)*t,D=w*j;for(h=0;h<P;h+=1){for(var I=0;I<t;I+=1)n[R++]=y[D++];R+=(o-1)*t}}w++}}return e=vg(e),1==a.interlaceMethod?(s(0,0,8,8),s(4,0,8,8),s(0,4,4,8),s(2,0,4,4),s(0,2,2,4),s(1,0,2,2),s(0,1,1,2)):s(0,0,1,1),n},r.prototype.decodePalette=function(){var e,t,n,r,a,s,i,o,l;for(n=this.palette,s=this.transparency.indexed||[],a=new Uint8Array((s.length||0)+n.length),r=0,e=0,t=i=0,o=n.length;i<o;t=i+=3)a[r++]=n[t],a[r++]=n[t+1],a[r++]=n[t+2],a[r++]=null!=(l=s[e++])?l:255;return a},r.prototype.copyToImageData=function(e,t){var n,r,a,s,i,o,l,c,u,d,h;if(r=this.colors,u=null,n=this.hasAlphaChannel,this.palette.length&&(u=null!=(h=this._decodedPalette)?h:this._decodedPalette=this.decodePalette(),r=4,n=!0),c=(a=e.data||e).length,i=u||t,s=o=0,1===r)for(;s<c;)l=u?4*t[s/4]:o,d=i[l++],a[s++]=d,a[s++]=d,a[s++]=d,a[s++]=n?i[l++]:255,o=l;else for(;s<c;)l=u?4*t[s/4]:o,a[s++]=i[l++],a[s++]=i[l++],a[s++]=i[l++],a[s++]=n?i[l++]:255,o=l},r.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e};var a=function(){if("[object Window]"===Object.prototype.toString.call(xg)){try{t=xg.document.createElement("canvas"),n=t.getContext("2d")}catch(e){return!1}return!0}return!1};return a(),e=function(e){var r;if(!0===a())return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(r=new Image).src=t.toDataURL(),r;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(t){var n,r,a,s,i,o,l,c;if(this.animation){for(c=[],r=i=0,o=(l=this.animation.frames).length;i<o;r=++i)n=l[r],a=t.createImageData(n.width,n.height),s=this.decodePixels(new Uint8Array(n.data)),this.copyToImageData(a,s),n.imageData=a,c.push(n.image=e(a));return c}},r.prototype.renderFrame=function(e,t){var n,r,a;return n=(r=this.animation.frames)[t],a=r[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=a?a.disposeOp:void 0)?e.clearRect(a.xOffset,a.yOffset,a.width,a.height):2===(null!=a?a.disposeOp:void 0)&&e.putImageData(a.imageData,a.xOffset,a.yOffset),0===n.blendOp&&e.clearRect(n.xOffset,n.yOffset,n.width,n.height),e.drawImage(n.image,n.xOffset,n.yOffset)},r.prototype.animate=function(e){var t,n,r,a,s,i,o=this;return n=0,i=this.animation,a=i.numFrames,r=i.frames,s=i.numPlays,(t=function(){var i,l;if(i=n++%a,l=r[i],o.renderFrame(e,i),a>1&&n/a<s)return o.animation._timeout=setTimeout(t,l.delay)})()},r.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},r.prototype.render=function(e){var t,n;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(n=t.createImageData(this.width,this.height),this.copyToImageData(n,this.decodePixels()),t.putImageData(n,0,0))},r}();function db(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,a=e[t++],s=a>>7,i=1<<1+(7&a);e[t++],e[t++];var o=null,l=null;s&&(o=t,l=i,t+=3*i);var c=!0,u=[],d=0,h=null,f=0,p=null;for(this.width=n,this.height=r;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(0===E)break;t+=E}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var m=e[t++];d=e[t++]|e[t++]<<8,h=e[t++],0==(1&m)&&(h=null),f=m>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(0===E)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++],w=y>>6&1,j=1<<1+(7&y),N=o,S=l,C=!1;y>>7&&(C=!0,N=t,S=j,t+=3*j);var k=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(0===E)break;t+=E}u.push({x:g,y:v,width:b,height:x,has_local_palette:C,palette_offset:N,palette_size:S,data_offset:k,data_length:t-k,transparent_index:h,interlaced:!!w,delay:d,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(e){if(e<0||e>=u.length)throw new Error("Frame index out of range.");return u[e]},this.decodeAndBlitFrameBGRA=function(t,r){var a=this.frameInfo(t),s=a.width*a.height,i=new Uint8Array(s);hb(e,a.data_offset,i,s);var o=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var c=a.width,u=n-c,d=c,h=4*(a.y*n+a.x),f=4*((a.y+a.height)*n+a.x),p=h,m=4*u;!0===a.interlaced&&(m+=4*n*7);for(var g=8,v=0,b=i.length;v<b;++v){var x=i[v];if(0===d&&(d=c,(p+=m)>=f&&(m=4*u+4*n*(g-1),p=h+(c+u)*(g<<1),g>>=1)),x===l)p+=4;else{var y=e[o+3*x],w=e[o+3*x+1],j=e[o+3*x+2];r[p++]=j,r[p++]=w,r[p++]=y,r[p++]=255}--d}},this.decodeAndBlitFrameRGBA=function(t,r){var a=this.frameInfo(t),s=a.width*a.height,i=new Uint8Array(s);hb(e,a.data_offset,i,s);var o=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var c=a.width,u=n-c,d=c,h=4*(a.y*n+a.x),f=4*((a.y+a.height)*n+a.x),p=h,m=4*u;!0===a.interlaced&&(m+=4*n*7);for(var g=8,v=0,b=i.length;v<b;++v){var x=i[v];if(0===d&&(d=c,(p+=m)>=f&&(m=4*u+4*n*(g-1),p=h+(c+u)*(g<<1),g>>=1)),x===l)p+=4;else{var y=e[o+3*x],w=e[o+3*x+1],j=e[o+3*x+2];r[p++]=y,r[p++]=w,r[p++]=j,r[p++]=255}--d}}}function hb(e,t,n,r){for(var a=e[t++],s=1<<a,i=s+1,o=i+1,l=a+1,c=(1<<l)-1,u=0,d=0,h=0,f=e[t++],p=new Int32Array(4096),m=null;;){for(;u<16&&0!==f;)d|=e[t++]<<u,u+=8,1===f?f=e[t++]:--f;if(u<l)break;var g=d&c;if(d>>=l,u-=l,g!==s){if(g===i)break;for(var v=g<o?g:m,b=0,x=v;x>s;)x=p[x]>>8,++b;var y=x;if(h+b+(v!==g?1:0)>r)return void wg.log("Warning, gif stream longer than expected.");n[h++]=y;var w=h+=b;for(v!==g&&(n[h++]=y),x=v;b--;)x=p[x],n[--w]=255&x,x>>=8;null!==m&&o<4096&&(p[o++]=m<<8|y,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=g}else o=i+1,c=(1<<(l=a+1))-1,m=null}return h!==r&&wg.log("Warning, gif stream shorter than expected."),n}function fb(e){var t,n,r,a,s,i=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(65535),h=new Array(65535),f=new Array(64),p=new Array(64),m=[],g=0,v=7,b=new Array(64),x=new Array(64),y=new Array(64),w=new Array(256),j=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],k=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],P=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],_=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(e,t){for(var n=0,r=0,a=new Array,s=1;s<=16;s++){for(var i=1;i<=e[s];i++)a[t[r]]=[],a[t[r]][0]=n,a[t[r]][1]=s,r++,n++;n*=2}return a}function R(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(g|=1<<v),n--,--v<0&&(255==g?(D(255),D(0)):D(g),v=7,g=0)}function D(e){m.push(e)}function I(e){D(e>>8&255),D(255&e)}function O(e,t,n,r,a){for(var s,i=a[0],o=a[240],l=function(e,t){var n,r,a,s,i,o,l,c,u,d,h=0;for(u=0;u<8;++u){n=e[h],r=e[h+1],a=e[h+2],s=e[h+3],i=e[h+4],o=e[h+5],l=e[h+6];var p=n+(c=e[h+7]),m=n-c,g=r+l,v=r-l,b=a+o,x=a-o,y=s+i,w=s-i,j=p+y,N=p-y,S=g+b,C=g-b;e[h]=j+S,e[h+4]=j-S;var k=.707106781*(C+N);e[h+2]=N+k,e[h+6]=N-k;var E=.382683433*((j=w+x)-(C=v+m)),A=.5411961*j+E,T=1.306562965*C+E,P=.707106781*(S=x+v),_=m+P,L=m-P;e[h+5]=L+A,e[h+3]=L-A,e[h+1]=_+T,e[h+7]=_-T,h+=8}for(h=0,u=0;u<8;++u){n=e[h],r=e[h+8],a=e[h+16],s=e[h+24],i=e[h+32],o=e[h+40],l=e[h+48];var R=n+(c=e[h+56]),D=n-c,I=r+l,O=r-l,F=a+o,M=a-o,B=s+i,z=s-i,U=R+B,q=R-B,V=I+F,W=I-F;e[h]=U+V,e[h+32]=U-V;var H=.707106781*(W+q);e[h+16]=q+H,e[h+48]=q-H;var G=.382683433*((U=z+M)-(W=O+D)),Y=.5411961*U+G,$=1.306562965*W+G,K=.707106781*(V=M+O),J=D+K,X=D-K;e[h+40]=X+Y,e[h+24]=X-Y,e[h+8]=J+$,e[h+56]=J-$,h++}for(u=0;u<64;++u)d=e[u]*t[u],f[u]=d>0?d+.5|0:d-.5|0;return f}(e,t),c=0;c<64;++c)p[N[c]]=l[c];var u=p[0]-n;n=p[0],0==u?R(r[0]):(R(r[h[s=32767+u]]),R(d[s]));for(var m=63;m>0&&0==p[m];)m--;if(0==m)return R(i),n;for(var g,v=1;v<=m;){for(var b=v;0==p[v]&&v<=m;)++v;var x=v-b;if(x>=16){g=x>>4;for(var y=1;y<=g;++y)R(o);x&=15}s=32767+p[v],R(a[(x<<4)+h[s]]),R(d[s]),v++}return 63!=m&&R(i),n}function F(e){e=Math.min(Math.max(e,1),100),s!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=i((t[n]*e+50)/100);r=Math.min(Math.max(r,1),255),o[N[n]]=r}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var d=i((a[s]*e+50)/100);d=Math.min(Math.max(d,1),255),l[N[s]]=d}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var m=0;m<8;m++)c[f]=1/(o[N[f]]*h[p]*h[m]*8),u[f]=1/(l[N[f]]*h[p]*h[m]*8),f++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),s=e)}this.encode=function(e,s){s&&F(s),m=new Array,g=0,v=7,I(65496),I(65504),I(16),D(74),D(70),D(73),D(70),D(0),D(1),D(1),D(0),I(1),I(1),D(0),D(0),function(){I(65499),I(132),D(0);for(var e=0;e<64;e++)D(o[e]);D(1);for(var t=0;t<64;t++)D(l[t])}(),function(e,t){I(65472),I(17),D(8),I(t),I(e),D(3),D(1),D(17),D(0),D(2),D(17),D(1),D(3),D(17),D(1)}(e.width,e.height),function(){I(65476),I(418),D(0);for(var e=0;e<16;e++)D(S[e+1]);for(var t=0;t<=11;t++)D(C[t]);D(16);for(var n=0;n<16;n++)D(k[n+1]);for(var r=0;r<=161;r++)D(E[r]);D(1);for(var a=0;a<16;a++)D(A[a+1]);for(var s=0;s<=11;s++)D(T[s]);D(17);for(var i=0;i<16;i++)D(P[i+1]);for(var o=0;o<=161;o++)D(_[o])}(),I(65498),I(12),D(3),D(1),D(0),D(2),D(17),D(3),D(17),D(0),D(63),D(0);var i=0,d=0,h=0;g=0,v=7,this.encode.displayName="_encode_";for(var f,p,w,N,L,M,B,z,U,q=e.data,V=e.width,W=e.height,H=4*V,G=0;G<W;){for(f=0;f<H;){for(L=H*G+f,B=-1,z=0,U=0;U<64;U++)M=L+(z=U>>3)*H+(B=4*(7&U)),G+z>=W&&(M-=H*(G+1+z-W)),f+B>=H&&(M-=f+B-H+4),p=q[M++],w=q[M++],N=q[M++],b[U]=(j[p]+j[w+256|0]+j[N+512|0]>>16)-128,x[U]=(j[p+768|0]+j[w+1024|0]+j[N+1280|0]>>16)-128,y[U]=(j[p+1280|0]+j[w+1536|0]+j[N+1792|0]>>16)-128;i=O(b,c,i,t,r),d=O(x,u,d,n,a),h=O(y,u,h,n,a),f+=32}G+=8}if(v>=0){var Y=[];Y[1]=v+1,Y[0]=(1<<v+1)-1,R(Y)}return I(65497),new Uint8Array(m)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=L(S,C),n=L(A,T),r=L(k,E),a=L(P,_),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var r=e;r<t;r++)h[32767+r]=n,d[32767+r]=[],d[32767+r][1]=n,d[32767+r][0]=r;for(var a=-(t-1);a<=-e;a++)h[32767+a]=n,d[32767+a]=[],d[32767+a][1]=n,d[32767+a][0]=t-1+a;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)j[e]=19595*e,j[e+256|0]=38470*e,j[e+512|0]=7471*e+32768,j[e+768|0]=-11059*e,j[e+1024|0]=-21709*e,j[e+1280|0]=32768*e+8421375,j[e+1536|0]=-27439*e,j[e+1792|0]=-5329*e}(),F(e)}function pb(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function mb(e){function t(e){if(!e)throw Error("assert :P")}function n(e,t,n){for(var r=0;4>r;r++)if(e[t+r]!=n.charCodeAt(r))return!0;return!1}function r(e,t,n,r,a){for(var s=0;s<a;s++)e[t+s]=n[r+s]}function a(e,t,n,r){for(var a=0;a<r;a++)e[t+a]=n}function s(e){return new Int32Array(e)}function i(e,t){for(var n=[],r=0;r<e;r++)n.push(new t);return n}function o(e,t){var n=[];return function e(n,r,a){for(var s=a[r],i=0;i<s&&(n.push(a.length>r+1?[]:new t),!(a.length<r+1));i++)e(n[i],r+1,a)}(n,0,e),n}var l=function(){var e=this;function l(e,t){for(var n=1<<t-1>>>0;e&n;)n>>>=1;return n?(e&n-1)+n:e}function c(e,n,r,a,s){t(!(a%r));do{e[n+(a-=r)]=s}while(0<a)}function u(e,n,r,a,i){if(t(2328>=i),512>=i)var o=s(512);else if(null==(o=s(i)))return 0;return function(e,n,r,a,i,o){var u,h,f=n,p=1<<r,m=s(16),g=s(16);for(t(0!=i),t(null!=a),t(null!=e),t(0<r),h=0;h<i;++h){if(15<a[h])return 0;++m[a[h]]}if(m[0]==i)return 0;for(g[1]=0,u=1;15>u;++u){if(m[u]>1<<u)return 0;g[u+1]=g[u]+m[u]}for(h=0;h<i;++h)u=a[h],0<a[h]&&(o[g[u]++]=h);if(1==g[15])return(a=new d).g=0,a.value=o[0],c(e,f,1,p,a),p;var v,b=-1,x=p-1,y=0,w=1,j=1,N=1<<r;for(h=0,u=1,i=2;u<=r;++u,i<<=1){if(w+=j<<=1,0>(j-=m[u]))return 0;for(;0<m[u];--m[u])(a=new d).g=u,a.value=o[h++],c(e,f+y,i,N,a),y=l(y,u)}for(u=r+1,i=2;15>=u;++u,i<<=1){if(w+=j<<=1,0>(j-=m[u]))return 0;for(;0<m[u];--m[u]){if(a=new d,(y&x)!=b){for(f+=N,v=1<<(b=u)-r;15>b&&!(0>=(v-=m[b]));)++b,v<<=1;p+=N=1<<(v=b-r),e[n+(b=y&x)].g=v+r,e[n+b].value=f-n-b}a.g=u-r,a.value=o[h++],c(e,f+(y>>r),i,N,a),y=l(y,u)}}return w!=2*g[15]-1?0:p}(e,n,r,a,i,o)}function d(){this.value=this.g=0}function h(){this.value=this.g=0}function f(){this.G=i(5,d),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Bn,h)}function p(e,n,r,a){t(null!=e),t(null!=n),t(2147483648>a),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=n,e.pa=r,e.Jd=n,e.Yc=r+a,e.Zc=4<=a?r+a-4+1:r,k(e)}function m(e,t){for(var n=0;0<t--;)n|=A(e,128)<<t;return n}function g(e,t){var n=m(e,t);return E(e)?-n:n}function v(e,n,r,a){var s,i=0;for(t(null!=e),t(null!=n),t(4294967288>a),e.Sb=a,e.Ra=0,e.u=0,e.h=0,4<a&&(a=4),s=0;s<a;++s)i+=n[r+s]<<8*s;e.Ra=i,e.bb=a,e.oa=n,e.pa=r}function b(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<qn-8>>>0,++e.bb,e.u-=8;N(e)&&(e.h=1,e.u=0)}function x(e,n){if(t(0<=n),!e.h&&n<=Un){var r=j(e)&zn[n];return e.u+=n,b(e),r}return e.h=1,e.u=0}function y(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function j(e){return e.Ra>>>(e.u&qn-1)>>>0}function N(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>qn}function S(e,t){e.u=t,e.h=N(e)}function C(e){e.u>=Vn&&(t(e.u>=Vn),b(e))}function k(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function E(e){return m(e,1)}function A(e,t){var n=e.Ca;0>e.b&&k(e);var r=e.b,a=n*t>>>8,s=(e.I>>>r>a)+0;for(s?(n-=a,e.I-=a+1<<r>>>0):n=a+1,r=n,a=0;256<=r;)a+=8,r>>=8;return r=7^a+Wn[r],e.b-=r,e.Ca=(n<<r)-1,s}function T(e,t,n){e[t+0]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function P(e,t){return e[t+0]|e[t+1]<<8}function _(e,t){return P(e,t)|e[t+2]<<16}function L(e,t){return P(e,t)|P(e,t+2)<<16}function R(e,n){var r=1<<n;return t(null!=e),t(0<n),e.X=s(r),null==e.X?0:(e.Mb=32-n,e.Xa=n,1)}function D(e,n){t(null!=e),t(null!=n),t(e.Xa==n.Xa),r(n.X,0,e.X,0,1<<n.Xa)}function I(){this.X=[],this.Xa=this.Mb=0}function O(e,n,r,a){t(null!=r),t(null!=a);var s=r[0],i=a[0];return 0==s&&(s=(e*i+n/2)/n),0==i&&(i=(n*s+e/2)/e),0>=s||0>=i?0:(r[0]=s,a[0]=i,1)}function F(e,t){return e+(1<<t)-1>>>t}function M(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function B(t,n){e[n]=function(n,r,a,s,i,o,l){var c;for(c=0;c<i;++c){var u=e[t](o[l+c-1],a,s+c);o[l+c]=M(n[r+c],u)}}}function z(){this.ud=this.hd=this.jd=0}function U(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function q(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function V(e,t){return q(e+(e-t+.5>>1))}function W(e,t,n){return Math.abs(t-n)-Math.abs(e-n)}function H(e,t,n,r,a,s,i){for(r=s[i-1],n=0;n<a;++n)s[i+n]=r=M(e[t+n],r)}function G(e,t,n,r,a){var s;for(s=0;s<n;++s){var i=e[t+s],o=i>>8&255,l=16711935&(l=(l=16711935&i)+((o<<16)+o));r[a+s]=(4278255360&i)+l>>>0}}function Y(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function $(e,t,n,r,a,s){var i;for(i=0;i<r;++i){var o=t[n+i],l=o>>>8,c=o,u=255&(u=(u=o>>>16)+((e.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(l<<24>>24)>>>5)+((e.ud<<24>>24)*(u<<24>>24)>>>5)),a[s+i]=(4278255360&o)+(u<<16)+c}}function K(t,n,r,a,s){e[n]=function(e,t,n,r,i,o,l,c,u){for(r=l;r<c;++r)for(l=0;l<u;++l)i[o++]=s(n[a(e[t++])])},e[t]=function(t,n,i,o,l,c,u){var d=8>>t.b,h=t.Ea,f=t.K[0],p=t.w;if(8>d)for(t=(1<<t.b)-1,p=(1<<d)-1;n<i;++n){var m,g=0;for(m=0;m<h;++m)m&t||(g=a(o[l++])),c[u++]=s(f[g&p]),g>>=d}else e["VP8LMapColor"+r](o,l,f,p,c,u,n,i,h)}}function J(e,t,n,r,a){for(n=t+n;t<n;){var s=e[t++];r[a++]=s>>16&255,r[a++]=s>>8&255,r[a++]=255&s}}function X(e,t,n,r,a){for(n=t+n;t<n;){var s=e[t++];r[a++]=s>>16&255,r[a++]=s>>8&255,r[a++]=255&s,r[a++]=s>>24&255}}function Q(e,t,n,r,a){for(n=t+n;t<n;){var s=(i=e[t++])>>16&240|i>>12&15,i=240&i|i>>28&15;r[a++]=s,r[a++]=i}}function Z(e,t,n,r,a){for(n=t+n;t<n;){var s=(i=e[t++])>>16&248|i>>13&7,i=i>>5&224|i>>3&31;r[a++]=s,r[a++]=i}}function ee(e,t,n,r,a){for(n=t+n;t<n;){var s=e[t++];r[a++]=255&s,r[a++]=s>>8&255,r[a++]=s>>16&255}}function te(e,t,n,a,s,i){if(0==i)for(n=t+n;t<n;)T(a,((i=e[t++])[0]>>24|i[1]>>8&65280|i[2]<<8&16711680|i[3]<<24)>>>0),s+=32;else r(a,s,e,t,n)}function ne(t,n){e[n][0]=e[t+"0"],e[n][1]=e[t+"1"],e[n][2]=e[t+"2"],e[n][3]=e[t+"3"],e[n][4]=e[t+"4"],e[n][5]=e[t+"5"],e[n][6]=e[t+"6"],e[n][7]=e[t+"7"],e[n][8]=e[t+"8"],e[n][9]=e[t+"9"],e[n][10]=e[t+"10"],e[n][11]=e[t+"11"],e[n][12]=e[t+"12"],e[n][13]=e[t+"13"],e[n][14]=e[t+"0"],e[n][15]=e[t+"0"]}function re(e){return e==Vr||e==Wr||e==Hr||e==Gr}function ae(){this.eb=[],this.size=this.A=this.fb=0}function se(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ie(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ae,this.f.kb=new se,this.sd=null}function oe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function ue(e,t){var n=e.T,a=t.ba.f.RGBA,s=a.eb,i=a.fb+e.ka*a.A,o=va[t.ba.S],l=e.y,c=e.O,u=e.f,d=e.N,h=e.ea,f=e.W,p=t.cc,m=t.dc,g=t.Mc,v=t.Nc,b=e.ka,x=e.ka+e.T,y=e.U,w=y+1>>1;for(0==b?o(l,c,null,null,u,d,h,f,u,d,h,f,s,i,null,null,y):(o(t.ec,t.fc,l,c,p,m,g,v,u,d,h,f,s,i-a.A,s,i,y),++n);b+2<x;b+=2)p=u,m=d,g=h,v=f,d+=e.Rc,f+=e.Rc,i+=2*a.A,o(l,(c+=2*e.fa)-e.fa,l,c,p,m,g,v,u,d,h,f,s,i-a.A,s,i,y);return c+=e.fa,e.j+x<e.o?(r(t.ec,t.fc,l,c,y),r(t.cc,t.dc,u,d,w),r(t.Mc,t.Nc,h,f,w),n--):1&x||o(l,c,null,null,u,d,h,f,u,d,h,f,s,i+a.A,null,null,y),n}function de(e,n,r){var a=e.F,s=[e.J];if(null!=a){var i=e.U,o=n.ba.S,l=o==zr||o==Hr;n=n.ba.f.RGBA;var c=[0],u=e.ka;c[0]=e.T,e.Kb&&(0==u?--c[0]:(--u,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-u));var d=n.eb;u=n.fb+u*n.A,e=Cr(a,s[0],e.width,i,c,d,u+(l?0:3),n.A),t(r==c),e&&re(o)&&Nr(d,u,l,i,c,n.A)}return 0}function he(e){var t=e.ma,n=t.ba.S,r=11>n,a=n==Fr||n==Br||n==zr||n==Ur||12==n||re(n);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!On(t.Oa,e,a?11:12))return 0;if(a&&re(n)&&xn(),e.da)alert("todo:use_scaling");else{if(r){if(t.Ib=ce,e.Kb){if(n=e.U+1>>1,t.memory=s(e.U+2*n),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+n,t.Ib=ue,xn()}}else alert("todo:EmitYUV");a&&(t.Jb=de,r&&vn())}if(r&&!_a){for(e=0;256>e;++e)La[e]=89858*(e-128)+ka>>Ca,Ia[e]=-22014*(e-128)+ka,Da[e]=-45773*(e-128),Ra[e]=113618*(e-128)+ka>>Ca;for(e=Ea;e<Aa;++e)t=76283*(e-16)+ka>>Ca,Oa[e-Ea]=He(t,255),Fa[e-Ea]=He(t+8>>4,15);_a=1}return 1}function fe(e){var n=e.ma,r=e.U,a=e.T;return t(!(1&e.ka)),0>=r||0>=a?0:(r=n.Ib(e,n),null!=n.Jb&&n.Jb(e,n,r),n.Dc+=r,1)}function pe(e){e.ma.memory=null}function me(e,t,n,r){return 47!=x(e,8)?0:(t[0]=x(e,14)+1,n[0]=x(e,14)+1,r[0]=x(e,1),0!=x(e,3)?0:!e.h)}function ge(e,t){if(4>e)return e+1;var n=e-2>>1;return(2+(1&e)<<n)+x(t,n)+1}function ve(e,t){return 120<t?t-120:1<=(n=((n=Qr[t-1])>>4)*e+(8-(15&n)))?n:1;var n}function be(e,t,n){var r=j(n),a=e[t+=255&r].g-8;return 0<a&&(S(n,n.u+8),r=j(n),t+=e[t].value,t+=r&(1<<a)-1),S(n,n.u+e[t].g),e[t].value}function xe(e,n,r){return r.g+=e.g,r.value+=e.value<<n>>>0,t(8>=r.g),e.g}function ye(e,n,r){var a=e.xc;return t((n=0==a?0:e.vc[e.md*(r>>a)+(n>>a)])<e.Wb),e.Ya[n]}function we(e,n,a,s){var i=e.ab,o=e.c*n,l=e.C;n=l+n;var c=a,u=s;for(s=e.Ta,a=e.Ua;0<i--;){var d=e.gc[i],h=l,f=n,p=c,m=u,g=(u=s,c=a,d.Ea);switch(t(h<f),t(f<=d.nc),d.hc){case 2:Yn(p,m,(f-h)*g,u,c);break;case 0:var v=h,b=f,x=u,y=c,w=(k=d).Ea;0==v&&(Hn(p,m,null,null,1,x,y),H(p,m+1,0,0,w-1,x,y+1),m+=w,y+=w,++v);for(var j=1<<k.b,N=j-1,S=F(w,k.b),C=k.K,k=k.w+(v>>k.b)*S;v<b;){var E=C,A=k,T=1;for(Gn(p,m,x,y-w,1,x,y);T<w;){var P=(T&~N)+j;P>w&&(P=w),(0,Qn[E[A++]>>8&15])(p,m+ +T,x,y+T-w,P-T,x,y+T),T=P}m+=w,y+=w,++v&N||(k+=S)}f!=d.nc&&r(u,c-g,u,c+(f-h-1)*g,g);break;case 1:for(g=p,b=m,w=(p=d.Ea)-(y=p&~(x=(m=1<<d.b)-1)),v=F(p,d.b),j=d.K,d=d.w+(h>>d.b)*v;h<f;){for(N=j,S=d,C=new z,k=b+y,E=b+p;b<k;)Y(N[S++],C),Zn(C,g,b,m,u,c),b+=m,c+=m;b<E&&(Y(N[S++],C),Zn(C,g,b,w,u,c),b+=w,c+=w),++h&x||(d+=v)}break;case 3:if(p==u&&m==c&&0<d.b){for(b=u,p=g=c+(f-h)*g-(y=(f-h)*F(d.Ea,d.b)),m=u,x=c,v=[],y=(w=y)-1;0<=y;--y)v[y]=m[x+y];for(y=w-1;0<=y;--y)b[p+y]=v[y];$n(d,h,f,u,g,u,c)}else $n(d,h,f,p,m,u,c)}c=s,u=a}u!=a&&r(s,a,c,u,o)}function je(e,n){var r=e.V,a=e.Ba+e.c*e.C,s=n-e.C;if(t(n<=e.l.o),t(16>=s),0<s){var i=e.l,o=e.Ta,l=e.Ua,c=i.width;if(we(e,s,r,a),s=l=[l],t((r=e.C)<(a=n)),t(i.v<i.va),a>i.o&&(a=i.o),r<i.j){var u=i.j-r;r=i.j,s[0]+=u*c}if(r>=a?r=0:(s[0]+=4*i.v,i.ka=r-i.j,i.U=i.va-i.v,i.T=a-r,r=1),r){if(l=l[0],11>(r=e.ca).S){var d=r.f.RGBA,h=(a=r.S,s=i.U,i=i.T,u=d.eb,d.A),f=i;for(d=d.fb+e.Ma*d.A;0<f--;){var p=o,m=l,g=s,v=u,b=d;switch(a){case Or:er(p,m,g,v,b);break;case Fr:tr(p,m,g,v,b);break;case Vr:tr(p,m,g,v,b),Nr(v,b,0,g,1,0);break;case Mr:ar(p,m,g,v,b);break;case Br:te(p,m,g,v,b,1);break;case Wr:te(p,m,g,v,b,1),Nr(v,b,0,g,1,0);break;case zr:te(p,m,g,v,b,0);break;case Hr:te(p,m,g,v,b,0),Nr(v,b,1,g,1,0);break;case Ur:nr(p,m,g,v,b);break;case Gr:nr(p,m,g,v,b),Sr(v,b,g,1,0);break;case qr:rr(p,m,g,v,b);break;default:t(0)}l+=c,d+=h}e.Ma+=i}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=r.height)}}e.C=n,t(e.C<=e.i)}function Ne(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var n=e.Ya[t].G,r=e.Ya[t].H;if(0<n[1][r[1]+0].g||0<n[2][r[2]+0].g||0<n[3][r[3]+0].g)return 0}return 1}function Se(e,n,r,a,s,i){if(0!=e.Z){var o=e.qd,l=e.rd;for(t(null!=ga[e.Z]);n<r;++n)ga[e.Z](o,l,a,s,a,s,i),o=a,l=s,s+=i;e.qd=o,e.rd=l}}function Ce(e,n){var r=e.l.ma,a=0==r.Z||1==r.Z?e.l.j:e.C;if(a=e.C<a?a:e.C,t(n<=e.l.o),n>a){var s=e.l.width,i=r.ca,o=r.tb+s*a,l=e.V,c=e.Ba+e.c*a,u=e.gc;t(1==e.ab),t(3==u[0].hc),Jn(u[0],a,n,l,c,i,o),Se(r,a,n,i,o,s)}e.C=e.Ma=n}function ke(e,n,r,a,s,i,o){var l=e.$/a,c=e.$%a,u=e.m,d=e.s,h=r+e.$,f=h;s=r+a*s;var p=r+a*i,m=280+d.ua,g=e.Pb?l:16777216,v=0<d.ua?d.Wa:null,b=d.wc,x=h<p?ye(d,c,l):null;t(e.C<i),t(p<=s);var y=!1;e:for(;;){for(;y||h<p;){var w=0;if(l>=g){var k=h-r;t((g=e).Pb),g.wd=g.m,g.xd=k,0<g.s.ua&&D(g.s.Wa,g.s.vb),g=l+ea}if(c&b||(x=ye(d,c,l)),t(null!=x),x.Qb&&(n[h]=x.qb,y=!0),!y)if(C(u),x.jc){w=u,k=n;var E=h,A=x.pd[j(w)&Bn-1];t(x.jc),256>A.g?(S(w,w.u+A.g),k[E]=A.value,w=0):(S(w,w.u+A.g-256),t(256<=A.value),w=A.value),0==w&&(y=!0)}else w=be(x.G[0],x.H[0],u);if(u.h)break;if(y||256>w){if(!y)if(x.nd)n[h]=(x.qb|w<<8)>>>0;else{if(C(u),y=be(x.G[1],x.H[1],u),C(u),k=be(x.G[2],x.H[2],u),E=be(x.G[3],x.H[3],u),u.h)break;n[h]=(E<<24|y<<16|w<<8|k)>>>0}if(y=!1,++h,++c>=a&&(c=0,++l,null!=o&&l<=i&&!(l%16)&&o(e,l),null!=v))for(;f<h;)w=n[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w}else if(280>w){if(w=ge(w-256,u),k=be(x.G[4],x.H[4],u),C(u),k=ve(a,k=ge(k,u)),u.h)break;if(h-r<k||s-h<w)break e;for(E=0;E<w;++E)n[h+E]=n[h+E-k];for(h+=w,c+=w;c>=a;)c-=a,++l,null!=o&&l<=i&&!(l%16)&&o(e,l);if(t(h<=s),c&b&&(x=ye(d,c,l)),null!=v)for(;f<h;)w=n[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w}else{if(!(w<m))break e;for(y=w-280,t(null!=v);f<h;)w=n[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w;w=h,t(!(y>>>(k=v).Xa)),n[w]=k.X[y],y=!0}y||t(u.h==N(u))}if(e.Pb&&u.h&&h<s)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&D(e.s.vb,e.s.Wa);else{if(u.h)break e;null!=o&&o(e,l>i?i:l),e.a=0,e.$=h-r}return 1}return e.a=3,0}function Ee(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var n=e.Wa;null!=n&&(n.X=null),e.vb=null,t(null!=e)}function Ae(){var t=new on;return null==t?null:(t.a=0,t.xb=ma,ne("Predictor","VP8LPredictors"),ne("Predictor","VP8LPredictors_C"),ne("PredictorAdd","VP8LPredictorsAdd"),ne("PredictorAdd","VP8LPredictorsAdd_C"),Yn=G,Zn=$,er=J,tr=X,nr=Q,rr=Z,ar=ee,e.VP8LMapColor32b=Kn,e.VP8LMapColor8b=Xn,t)}function Te(e,n,r,o,l){var c=1,h=[e],p=[n],m=o.m,g=o.s,v=null,b=0;e:for(;;){if(r)for(;c&&x(m,1);){var y=h,w=p,N=o,k=1,E=N.m,A=N.gc[N.ab],T=x(E,2);if(N.Oc&1<<T)c=0;else{switch(N.Oc|=1<<T,A.hc=T,A.Ea=y[0],A.nc=w[0],A.K=[null],++N.ab,t(4>=N.ab),T){case 0:case 1:A.b=x(E,3)+2,k=Te(F(A.Ea,A.b),F(A.nc,A.b),0,N,A.K),A.K=A.K[0];break;case 3:var P,_=x(E,8)+1,L=16<_?0:4<_?1:2<_?2:3;if(y[0]=F(A.Ea,L),A.b=L,P=k=Te(_,1,0,N,A.K)){var D,I=_,O=A,B=1<<(8>>O.b),z=s(B);if(null==z)P=0;else{var U=O.K[0],q=O.w;for(z[0]=O.K[0][0],D=1;D<1*I;++D)z[D]=M(U[q+D],z[D-1]);for(;D<4*B;++D)z[D]=0;O.K[0]=null,O.K[0]=z,P=1}}k=P;break;case 2:break;default:t(0)}c=k}}if(h=h[0],p=p[0],c&&x(m,1)&&!(c=1<=(b=x(m,4))&&11>=b)){o.a=3;break e}var V;if(V=c)t:{var W,H,G,Y=o,$=h,K=p,J=b,X=r,Q=Y.m,Z=Y.s,ee=[null],te=1,ne=0,re=Zr[J];n:for(;;){if(X&&x(Q,1)){var ae=x(Q,3)+2,se=F($,ae),ie=F(K,ae),oe=se*ie;if(!Te(se,ie,0,Y,ee))break n;for(ee=ee[0],Z.xc=ae,W=0;W<oe;++W){var le=ee[W]>>8&65535;ee[W]=le,le>=te&&(te=le+1)}}if(Q.h)break n;for(H=0;5>H;++H){var ce=Kr[H];!H&&0<J&&(ce+=1<<J),ne<ce&&(ne=ce)}var ue=i(te*re,d),de=te,he=i(de,f);if(null==he)var fe=null;else t(65536>=de),fe=he;var pe=s(ne);if(null==fe||null==pe||null==ue){Y.a=1;break n}var me=ue;for(W=G=0;W<te;++W){var ge=fe[W],ve=ge.G,be=ge.H,ye=0,we=1,je=0;for(H=0;5>H;++H){ce=Kr[H],ve[H]=me,be[H]=G,!H&&0<J&&(ce+=1<<J);r:{var Ne,Se=ce,Ce=Y,Ae=pe,Pe=me,_e=G,Le=0,Re=Ce.m,De=x(Re,1);if(a(Ae,0,0,Se),De){var Ie=x(Re,1)+1,Oe=x(Re,1),Fe=x(Re,0==Oe?1:8);Ae[Fe]=1,2==Ie&&(Ae[Fe=x(Re,8)]=1);var Me=1}else{var Be=s(19),ze=x(Re,4)+4;if(19<ze){Ce.a=3;var Ue=0;break r}for(Ne=0;Ne<ze;++Ne)Be[Xr[Ne]]=x(Re,3);var qe=void 0,Ve=void 0,We=Ce,He=Be,Ge=Se,Ye=Ae,$e=0,Ke=We.m,Je=8,Xe=i(128,d);a:for(;u(Xe,0,7,He,19);){if(x(Ke,1)){var Qe=2+2*x(Ke,3);if((qe=2+x(Ke,Qe))>Ge)break a}else qe=Ge;for(Ve=0;Ve<Ge&&qe--;){C(Ke);var Ze=Xe[0+(127&j(Ke))];S(Ke,Ke.u+Ze.g);var et=Ze.value;if(16>et)Ye[Ve++]=et,0!=et&&(Je=et);else{var tt=16==et,nt=et-16,rt=$r[nt],at=x(Ke,Yr[nt])+rt;if(Ve+at>Ge)break a;for(var st=tt?Je:0;0<at--;)Ye[Ve++]=st}}$e=1;break a}$e||(We.a=3),Me=$e}(Me=Me&&!Re.h)&&(Le=u(Pe,_e,8,Ae,Se)),Me&&0!=Le?Ue=Le:(Ce.a=3,Ue=0)}if(0==Ue)break n;if(we&&1==Jr[H]&&(we=0==me[G].g),ye+=me[G].g,G+=Ue,3>=H){var it,ot=pe[0];for(it=1;it<ce;++it)pe[it]>ot&&(ot=pe[it]);je+=ot}}if(ge.nd=we,ge.Qb=0,we&&(ge.qb=(ve[3][be[3]+0].value<<24|ve[1][be[1]+0].value<<16|ve[2][be[2]+0].value)>>>0,0==ye&&256>ve[0][be[0]+0].value&&(ge.Qb=1,ge.qb+=ve[0][be[0]+0].value<<8)),ge.jc=!ge.Qb&&6>je,ge.jc){var lt,ct=ge;for(lt=0;lt<Bn;++lt){var ut=lt,dt=ct.pd[ut],ht=ct.G[0][ct.H[0]+ut];256<=ht.value?(dt.g=ht.g+256,dt.value=ht.value):(dt.g=0,dt.value=0,ut>>=xe(ht,8,dt),ut>>=xe(ct.G[1][ct.H[1]+ut],16,dt),ut>>=xe(ct.G[2][ct.H[2]+ut],0,dt),xe(ct.G[3][ct.H[3]+ut],24,dt))}}}Z.vc=ee,Z.Wb=te,Z.Ya=fe,Z.yc=ue,V=1;break t}V=0}if(!(c=V)){o.a=3;break e}if(0<b){if(g.ua=1<<b,!R(g.Wa,b)){o.a=1,c=0;break e}}else g.ua=0;var ft=o,pt=h,mt=p,gt=ft.s,vt=gt.xc;if(ft.c=pt,ft.i=mt,gt.md=F(pt,vt),gt.wc=0==vt?-1:(1<<vt)-1,r){o.xb=pa;break e}if(null==(v=s(h*p))){o.a=1,c=0;break e}c=(c=ke(o,v,0,h,p,p,null))&&!m.h;break e}return c?(null!=l?l[0]=v:(t(null==v),t(r)),o.$=0,r||Ee(g)):Ee(g),c}function Pe(e,n){var r=e.c*e.i,a=r+n+16*n;return t(e.c<=n),e.V=s(a),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+r+n,1)}function _e(e,n){var r=e.C,a=n-r,s=e.V,i=e.Ba+e.c*r;for(t(n<=e.l.o);0<a;){var o=16<a?16:a,l=e.l.ma,c=e.l.width,u=c*o,d=l.ca,h=l.tb+c*r,f=e.Ta,p=e.Ua;we(e,o,s,i),kr(f,p,d,h,u),Se(l,r,r+o,d,h,c),a-=o,s+=o*e.c,r+=o}t(r==n),e.C=e.Ma=n}function Le(){this.ub=this.yd=this.td=this.Rb=0}function Re(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function De(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ie(){this.Yb=function(){var e=[];return function e(t,n,r){for(var a=r[n],s=0;s<a&&(t.push(r.length>n+1?[]:0),!(r.length<n+1));s++)e(t[s],n+1,r)}(e,0,[3,11]),e}()}function Oe(){this.jb=s(3),this.Wc=o([4,8],Ie),this.Xc=o([4,17],Ie)}function Fe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Me(){this.ld=this.La=this.dd=this.tc=0}function Be(){this.Na=this.la=0}function ze(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ue(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qe(){this.uc=this.M=this.Nb=0,this.wa=Array(new Me),this.Y=0,this.ya=Array(new Ue),this.aa=0,this.l=new Ge}function Ve(){this.y=s(16),this.f=s(8),this.ea=s(8)}function We(){this.cb=this.a=0,this.sc="",this.m=new y,this.Od=new Le,this.Kc=new Re,this.ed=new Fe,this.Qa=new De,this.Ic=this.$c=this.Aa=0,this.D=new qe,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,y),this.ia=0,this.pb=i(4,ze),this.Pa=new Oe,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ve),this.Hd=0,this.rb=Array(new Be),this.sb=0,this.wa=Array(new Me),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ue),this.L=this.aa=0,this.gd=o([4,2],Me),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function He(e,t){return 0>e?0:e>t?t:e}function Ge(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ye(){var e=new We;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ra||(ra=Xe)),e}function $e(e,t,n){return 0==e.a&&(e.a=t,e.sc=n,e.cb=0),0}function Ke(e,t,n){return 3<=n&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function Je(e,n){if(null==e)return 0;if(e.a=0,e.sc="OK",null==n)return $e(e,2,"null VP8Io passed to VP8GetHeaders()");var r=n.data,s=n.w,i=n.ha;if(4>i)return $e(e,7,"Truncated header.");var o=r[s+0]|r[s+1]<<8|r[s+2]<<16,l=e.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return $e(e,3,"Incorrect keyframe parameters.");if(!l.yd)return $e(e,4,"Frame not displayable.");s+=3,i-=3;var c=e.Kc;if(l.Rb){if(7>i)return $e(e,7,"cannot parse picture header");if(!Ke(r,s,i))return $e(e,3,"Bad code word");c.c=16383&(r[s+4]<<8|r[s+3]),c.Td=r[s+4]>>6,c.i=16383&(r[s+6]<<8|r[s+5]),c.Ud=r[s+6]>>6,s+=7,i-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,n.width=c.c,n.height=c.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,a((o=e.Pa).jb,0,255,o.jb.length),t(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,a(o.Zb,0,0,o.Zb.length),a(o.Lb,0,0,o.Lb)}if(l.ub>i)return $e(e,7,"bad partition length");p(o=e.m,r,s,l.ub),s+=l.ub,i-=l.ub,l.Rb&&(c.Ld=E(o),c.Kd=E(o)),c=e.Qa;var u,d=e.Pa;if(t(null!=o),t(null!=c),c.Cb=E(o),c.Cb){if(c.Bb=E(o),E(o)){for(c.Fb=E(o),u=0;4>u;++u)c.Zb[u]=E(o)?g(o,7):0;for(u=0;4>u;++u)c.Lb[u]=E(o)?g(o,6):0}if(c.Bb)for(u=0;3>u;++u)d.jb[u]=E(o)?m(o,8):255}else c.Bb=0;if(o.Ka)return $e(e,3,"cannot parse segment header");if((c=e.ed).zd=E(o),c.Tb=m(o,6),c.wb=m(o,3),c.Pc=E(o),c.Pc&&E(o)){for(d=0;4>d;++d)E(o)&&(c.vd[d]=g(o,6));for(d=0;4>d;++d)E(o)&&(c.od[d]=g(o,6))}if(e.L=0==c.Tb?0:c.zd?1:2,o.Ka)return $e(e,3,"cannot parse filter header");var h=i;if(i=u=s,s=u+h,c=h,e.Xb=(1<<m(e.m,2))-1,h<3*(d=e.Xb))r=7;else{for(u+=3*d,c-=3*d,h=0;h<d;++h){var f=r[i+0]|r[i+1]<<8|r[i+2]<<16;f>c&&(f=c),p(e.Jc[+h],r,u,f),u+=f,c-=f,i+=3}p(e.Jc[+d],r,u,c),r=u<s?0:5}if(0!=r)return $e(e,r,"cannot parse partitions");for(r=m(u=e.m,7),i=E(u)?g(u,4):0,s=E(u)?g(u,4):0,c=E(u)?g(u,4):0,d=E(u)?g(u,4):0,u=E(u)?g(u,4):0,h=e.Qa,f=0;4>f;++f){if(h.Cb){var v=h.Zb[f];h.Fb||(v+=r)}else{if(0<f){e.pb[f]=e.pb[0];continue}v=r}var b=e.pb[f];b.Sc[0]=ta[He(v+i,127)],b.Sc[1]=na[He(v+0,127)],b.Eb[0]=2*ta[He(v+s,127)],b.Eb[1]=101581*na[He(v+c,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=ta[He(v+d,117)],b.Qc[1]=na[He(v+u,127)],b.lc=v+u}if(!l.Rb)return $e(e,4,"Not a key frame.");for(E(o),l=e.Pa,r=0;4>r;++r){for(i=0;8>i;++i)for(s=0;3>s;++s)for(c=0;11>c;++c)d=A(o,ca[r][i][s][c])?m(o,8):oa[r][i][s][c],l.Wc[r][i].Yb[s][c]=d;for(i=0;17>i;++i)l.Xc[r][i]=l.Wc[r][ua[i]]}return e.kc=E(o),e.kc&&(e.Bd=m(o,8)),e.cb=1}function Xe(e,t,n,r,a,s,i){var o=t[a].Yb[n];for(n=0;16>a;++a){if(!A(e,o[n+0]))return a;for(;!A(e,o[n+1]);)if(o=t[++a].Yb[0],n=0,16==a)return 16;var l=t[a+1].Yb;if(A(e,o[n+2])){var c=e,u=0;if(A(c,(h=o)[(d=n)+3]))if(A(c,h[d+6])){for(o=0,d=2*(u=A(c,h[d+8]))+(h=A(c,h[d+9+u])),u=0,h=aa[d];h[o];++o)u+=u+A(c,h[o]);u+=3+(8<<d)}else A(c,h[d+7])?(u=7+2*A(c,165),u+=A(c,145)):u=5+A(c,159);else u=A(c,h[d+4])?3+A(c,h[d+5]):2;o=l[2]}else u=1,o=l[1];l=i+sa[a],0>(c=e).b&&k(c);var d,h=c.b,f=(d=c.Ca>>1)-(c.I>>h)>>31;--c.b,c.Ca+=f,c.Ca|=1,c.I-=(d+1&f)<<h,s[l]=((u^f)-f)*r[(0<a)+0]}return 16}function Qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,a(e.zc,0,0,e.zc.length),e.ja=0}function Ze(e,n){if(null==e)return 0;if(null==n)return $e(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!Je(e,n))return 0;if(t(e.cb),null==n.ac||n.ac(n)){n.ob&&(e.L=0);var o=Ba[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=n.v-o>>4,e.zb=n.j-o>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=n.o+15+o>>4,e.Hb=n.va+15+o>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var l=e.ed;for(o=0;4>o;++o){var c;if(e.Qa.Cb){var u=e.Qa.Lb[o];e.Qa.Fb||(u+=l.Tb)}else u=l.Tb;for(c=0;1>=c;++c){var d=e.gd[o][c],h=u;if(l.Pc&&(h+=l.vd[0],c&&(h+=l.od[0])),0<(h=0>h?0:63<h?63:h)){var f=h;0<l.wb&&(f=4<l.wb?f>>2:f>>1)>9-l.wb&&(f=9-l.wb),1>f&&(f=1),d.dd=f,d.tc=2*h+f,d.ld=40<=h?2:15<=h?1:0}else d.tc=0;d.La=c}}}o=0}else $e(e,6,"Frame setup failed"),o=e.a;if(o=0==o){if(o){e.$c=0,0<e.Aa||(e.Ic=Ua);e:{o=e.Ic,l=4*(f=e.za);var p=32*f,m=f+1,g=0<e.L?f*(0<e.Aa?2:1):0,v=(2==e.Aa?2:1)*f;if((d=l+832+(c=3*(16*o+Ba[e.L])/2*p)+(u=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=d)o=0;else{if(d>e.Vb){if(e.Vb=0,e.Ec=s(d),e.Fc=0,null==e.Ec){o=$e(e,1,"no memory during frame initialization.");break e}e.Vb=d}d=e.Ec,h=e.Fc,e.Ac=d,e.Bc=h,h+=l,e.Gd=i(p,Ve),e.Hd=0,e.rb=i(m+1,Be),e.sb=1,e.wa=g?i(g,Me):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=f),t(!0),e.oc=d,e.pc=h,h+=832,e.ya=i(v,Ue),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=f),e.R=16*f,e.B=8*f,f=(p=Ba[e.L])*e.R,p=p/2*e.B,e.sa=d,e.ta=h+f,e.qa=e.sa,e.ra=e.ta+16*o*e.R+p,e.Ha=e.qa,e.Ia=e.ra+8*o*e.B+p,e.$c=0,h+=c,e.mb=u?d:null,e.nb=u?h:null,t(h+u<=e.Fc+e.Vb),Qe(e),a(e.Ac,e.Bc,0,l),o=1}}if(o){if(n.ka=0,n.y=e.sa,n.O=e.ta,n.f=e.qa,n.N=e.ra,n.ea=e.Ha,n.Vd=e.Ia,n.fa=e.R,n.Rc=e.B,n.F=null,n.J=0,!_r){for(o=-255;255>=o;++o)Er[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)Ar[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)Tr[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Pr[255+o]=0>o?0:255<o?255:o;_r=1}sr=ct,ir=st,lr=it,cr=ot,ur=lt,or=at,dr=$t,hr=Kt,fr=Qt,pr=Zt,mr=Jt,gr=Xt,vr=en,br=tn,xr=qt,yr=Vt,wr=Wt,jr=Ht,ha[0]=St,ha[1]=dt,ha[2]=jt,ha[3]=Nt,ha[4]=Ct,ha[5]=Et,ha[6]=kt,ha[7]=At,ha[8]=Pt,ha[9]=Tt,da[0]=vt,da[1]=ft,da[2]=pt,da[3]=mt,da[4]=bt,da[5]=xt,da[6]=yt,fa[0]=Dt,fa[1]=ht,fa[2]=_t,fa[3]=Lt,fa[4]=Ot,fa[5]=It,fa[6]=Ft,o=1}else o=0}o&&(o=function(e,n){for(e.M=0;e.M<e.Va;++e.M){var i,o=e.Jc[e.M&e.Xb],l=e.m,c=e;for(i=0;i<c.za;++i){var u=l,d=c,h=d.Ac,f=d.Bc+4*i,p=d.zc,m=d.ya[d.aa+i];if(d.Qa.Bb?m.$b=A(u,d.Pa.jb[0])?2+A(u,d.Pa.jb[2]):A(u,d.Pa.jb[1]):m.$b=0,d.kc&&(m.Ad=A(u,d.Bd)),m.Za=!A(u,145)+0,m.Za){var g=m.Ob,v=0;for(d=0;4>d;++d){var b,x=p[0+d];for(b=0;4>b;++b){x=la[h[f+b]][x];for(var y=ia[A(u,x[0])];0<y;)y=ia[2*y+A(u,x[y])];x=-y,h[f+b]=x}r(g,v,h,f,4),v+=4,p[0+d]=x}}else x=A(u,156)?A(u,128)?1:3:A(u,163)?2:0,m.Ob[0]=x,a(h,f,x,4),a(p,0,x,4);m.Dd=A(u,142)?A(u,114)?A(u,183)?1:3:2:0}if(c.m.Ka)return $e(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=o,u=(l=e).rb[l.sb-1],h=l.rb[l.sb+l.ja],i=l.ya[l.aa+l.ja],f=l.kc?i.Ad:0)u.la=h.la=0,i.Za||(u.Na=h.Na=0),i.Hc=0,i.Gc=0,i.ia=0;else{var w,j;if(u=h,h=c,f=l.Pa.Xc,p=l.ya[l.aa+l.ja],m=l.pb[p.$b],d=p.ad,g=0,v=l.rb[l.sb-1],x=b=0,a(d,g,0,384),p.Za)var N=0,S=f[3];else{y=s(16);var C=u.Na+v.Na;if(C=ra(h,f[1],C,m.Eb,0,y,0),u.Na=v.Na=(0<C)+0,1<C)sr(y,0,d,g);else{var k=y[0]+3>>3;for(y=0;256>y;y+=16)d[g+y]=k}N=1,S=f[0]}var E=15&u.la,T=15&v.la;for(y=0;4>y;++y){var P=1&T;for(k=j=0;4>k;++k)E=E>>1|(P=(C=ra(h,S,C=P+(1&E),m.Sc,N,d,g))>N)<<7,j=j<<2|(3<C?3:1<C?2:0!=d[g+0]),g+=16;E>>=4,T=T>>1|P<<7,b=(b<<8|j)>>>0}for(S=E,N=T>>4,w=0;4>w;w+=2){for(j=0,E=u.la>>4+w,T=v.la>>4+w,y=0;2>y;++y){for(P=1&T,k=0;2>k;++k)C=P+(1&E),E=E>>1|(P=0<(C=ra(h,f[2],C,m.Qc,0,d,g)))<<3,j=j<<2|(3<C?3:1<C?2:0!=d[g+0]),g+=16;E>>=2,T=T>>1|P<<5}x|=j<<4*w,S|=E<<4<<w,N|=(240&T)<<w}u.la=S,v.la=N,p.Hc=b,p.Gc=x,p.ia=43690&x?0:m.ia,f=!(b|x)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[i.$b][i.Za],l.wa[l.Y+l.ja].La|=!f),c.Ka)return $e(e,7,"Premature end-of-file encountered.")}if(Qe(e),l=n,c=1,i=(o=e).D,u=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)e:{if(i.M=o.M,i.uc=u,Dn(o,i),c=1,i=(j=o.D).Nb,u=(x=Ba[o.L])*o.R,h=x/2*o.B,y=16*i*o.R,k=8*i*o.B,f=o.sa,p=o.ta-u+y,m=o.qa,d=o.ra-h+k,g=o.Ha,v=o.Ia-h+k,T=0==(E=j.M),b=E>=o.Va-1,2==o.Aa&&Dn(o,j),j.uc)for(P=(C=o).D.M,t(C.D.uc),j=C.yb;j<C.Hb;++j){N=j,S=P;var _=(L=(U=C).D).Nb;w=U.R;var L=L.wa[L.Y+N],R=U.sa,D=U.ta+16*_*w+16*N,I=L.dd,O=L.tc;if(0!=O)if(t(3<=O),1==U.L)0<N&&yr(R,D,w,O+4),L.La&&jr(R,D,w,O),0<S&&xr(R,D,w,O+4),L.La&&wr(R,D,w,O);else{var F=U.B,M=U.qa,B=U.ra+8*_*F+8*N,z=U.Ha,U=U.Ia+8*_*F+8*N;_=L.ld,0<N&&(hr(R,D,w,O+4,I,_),pr(M,B,z,U,F,O+4,I,_)),L.La&&(gr(R,D,w,O,I,_),br(M,B,z,U,F,O,I,_)),0<S&&(dr(R,D,w,O+4,I,_),fr(M,B,z,U,F,O+4,I,_)),L.La&&(mr(R,D,w,O,I,_),vr(M,B,z,U,F,O,I,_))}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(j=16*E,E=16*(E+1),T?(l.y=o.sa,l.O=o.ta+y,l.f=o.qa,l.N=o.ra+k,l.ea=o.Ha,l.W=o.Ia+k):(j-=x,l.y=f,l.O=p,l.f=m,l.N=d,l.ea=g,l.W=v),b||(E-=x),E>l.o&&(E=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&j<E&&(l.J=hn(o,l,j,E-j),l.F=o.mb,null==l.F&&0==l.F.length)){c=$e(o,3,"Could not decode alpha data.");break e}j<l.j&&(x=l.j-j,j=l.j,t(!(1&x)),l.O+=o.R*x,l.N+=o.B*(x>>1),l.W+=o.B*(x>>1),null!=l.F&&(l.J+=l.width*x)),j<E&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=j-l.j,l.U=l.va-l.v,l.T=E-j,c=l.put(l))}i+1!=o.Ic||b||(r(o.sa,o.ta-u,f,p+16*o.R,u),r(o.qa,o.ra-h,m,d+8*o.B,h),r(o.Ha,o.Ia-h,g,v+8*o.B,h))}if(!c)return $e(e,6,"Output aborted.")}return 1}(e,n)),null!=n.bc&&n.bc(n),o&=1}return o?(e.cb=0,o):0}function et(e,t,n,r,a){a=e[t+n+32*r]+(a>>3),e[t+n+32*r]=-256&a?0>a?0:255:a}function tt(e,t,n,r,a,s){et(e,t,0,n,r+a),et(e,t,1,n,r+s),et(e,t,2,n,r-s),et(e,t,3,n,r-a)}function nt(e){return(20091*e>>16)+e}function rt(e,t,n,r){var a,i=0,o=s(16);for(a=0;4>a;++a){var l=e[t+0]+e[t+8],c=e[t+0]-e[t+8],u=(35468*e[t+4]>>16)-nt(e[t+12]),d=nt(e[t+4])+(35468*e[t+12]>>16);o[i+0]=l+d,o[i+1]=c+u,o[i+2]=c-u,o[i+3]=l-d,i+=4,t++}for(a=i=0;4>a;++a)l=(e=o[i+0]+4)+o[i+8],c=e-o[i+8],u=(35468*o[i+4]>>16)-nt(o[i+12]),et(n,r,0,0,l+(d=nt(o[i+4])+(35468*o[i+12]>>16))),et(n,r,1,0,c+u),et(n,r,2,0,c-u),et(n,r,3,0,l-d),i++,r+=32}function at(e,t,n,r){var a=e[t+0]+4,s=35468*e[t+4]>>16,i=nt(e[t+4]),o=35468*e[t+1]>>16;tt(n,r,0,a+i,e=nt(e[t+1]),o),tt(n,r,1,a+s,e,o),tt(n,r,2,a-s,e,o),tt(n,r,3,a-i,e,o)}function st(e,t,n,r,a){rt(e,t,n,r),a&&rt(e,t+16,n,r+4)}function it(e,t,n,r){ir(e,t+0,n,r,1),ir(e,t+32,n,r+128,1)}function ot(e,t,n,r){var a;for(e=e[t+0]+4,a=0;4>a;++a)for(t=0;4>t;++t)et(n,r,t,a,e)}function lt(e,t,n,r){e[t+0]&&cr(e,t+0,n,r),e[t+16]&&cr(e,t+16,n,r+4),e[t+32]&&cr(e,t+32,n,r+128),e[t+48]&&cr(e,t+48,n,r+128+4)}function ct(e,t,n,r){var a,i=s(16);for(a=0;4>a;++a){var o=e[t+0+a]+e[t+12+a],l=e[t+4+a]+e[t+8+a],c=e[t+4+a]-e[t+8+a],u=e[t+0+a]-e[t+12+a];i[0+a]=o+l,i[8+a]=o-l,i[4+a]=u+c,i[12+a]=u-c}for(a=0;4>a;++a)o=(e=i[0+4*a]+3)+i[3+4*a],l=i[1+4*a]+i[2+4*a],c=i[1+4*a]-i[2+4*a],u=e-i[3+4*a],n[r+0]=o+l>>3,n[r+16]=u+c>>3,n[r+32]=o-l>>3,n[r+48]=u-c>>3,r+=64}function ut(e,t,n){var r,a=t-32,s=Dr,i=255-e[a-1];for(r=0;r<n;++r){var o,l=s,c=i+e[t-1];for(o=0;o<n;++o)e[t+o]=l[c+e[a+o]];t+=32}}function dt(e,t){ut(e,t,4)}function ht(e,t){ut(e,t,8)}function ft(e,t){ut(e,t,16)}function pt(e,t){var n;for(n=0;16>n;++n)r(e,t+32*n,e,t-32,16)}function mt(e,t){var n;for(n=16;0<n;--n)a(e,t,e[t-1],16),t+=32}function gt(e,t,n){var r;for(r=0;16>r;++r)a(t,n+32*r,e,16)}function vt(e,t){var n,r=16;for(n=0;16>n;++n)r+=e[t-1+32*n]+e[t+n-32];gt(r>>5,e,t)}function bt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t-1+32*n];gt(r>>4,e,t)}function xt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t+n-32];gt(r>>4,e,t)}function yt(e,t){gt(128,e,t)}function wt(e,t,n){return e+2*t+n+2>>2}function jt(e,t){var n,a=t-32;for(a=new Uint8Array([wt(e[a-1],e[a+0],e[a+1]),wt(e[a+0],e[a+1],e[a+2]),wt(e[a+1],e[a+2],e[a+3]),wt(e[a+2],e[a+3],e[a+4])]),n=0;4>n;++n)r(e,t+32*n,a,0,a.length)}function Nt(e,t){var n=e[t-1],r=e[t-1+32],a=e[t-1+64],s=e[t-1+96];T(e,t+0,16843009*wt(e[t-1-32],n,r)),T(e,t+32,16843009*wt(n,r,a)),T(e,t+64,16843009*wt(r,a,s)),T(e,t+96,16843009*wt(a,s,s))}function St(e,t){var n,r=4;for(n=0;4>n;++n)r+=e[t+n-32]+e[t-1+32*n];for(r>>=3,n=0;4>n;++n)a(e,t+32*n,r,4)}function Ct(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],s=e[t-1-32],i=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+96]=wt(r,a,e[t-1+96]),e[t+1+96]=e[t+0+64]=wt(n,r,a),e[t+2+96]=e[t+1+64]=e[t+0+32]=wt(s,n,r),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=wt(i,s,n),e[t+3+64]=e[t+2+32]=e[t+1+0]=wt(o,i,s),e[t+3+32]=e[t+2+0]=wt(l,o,i),e[t+3+0]=wt(c,l,o)}function kt(e,t){var n=e[t+1-32],r=e[t+2-32],a=e[t+3-32],s=e[t+4-32],i=e[t+5-32],o=e[t+6-32],l=e[t+7-32];e[t+0+0]=wt(e[t+0-32],n,r),e[t+1+0]=e[t+0+32]=wt(n,r,a),e[t+2+0]=e[t+1+32]=e[t+0+64]=wt(r,a,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=wt(a,s,i),e[t+3+32]=e[t+2+64]=e[t+1+96]=wt(s,i,o),e[t+3+64]=e[t+2+96]=wt(i,o,l),e[t+3+96]=wt(o,l,l)}function Et(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],s=e[t-1-32],i=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=s+i+1>>1,e[t+1+0]=e[t+2+64]=i+o+1>>1,e[t+2+0]=e[t+3+64]=o+l+1>>1,e[t+3+0]=l+c+1>>1,e[t+0+96]=wt(a,r,n),e[t+0+64]=wt(r,n,s),e[t+0+32]=e[t+1+96]=wt(n,s,i),e[t+1+32]=e[t+2+96]=wt(s,i,o),e[t+2+32]=e[t+3+96]=wt(i,o,l),e[t+3+32]=wt(o,l,c)}function At(e,t){var n=e[t+0-32],r=e[t+1-32],a=e[t+2-32],s=e[t+3-32],i=e[t+4-32],o=e[t+5-32],l=e[t+6-32],c=e[t+7-32];e[t+0+0]=n+r+1>>1,e[t+1+0]=e[t+0+64]=r+a+1>>1,e[t+2+0]=e[t+1+64]=a+s+1>>1,e[t+3+0]=e[t+2+64]=s+i+1>>1,e[t+0+32]=wt(n,r,a),e[t+1+32]=e[t+0+96]=wt(r,a,s),e[t+2+32]=e[t+1+96]=wt(a,s,i),e[t+3+32]=e[t+2+96]=wt(s,i,o),e[t+3+64]=wt(i,o,l),e[t+3+96]=wt(o,l,c)}function Tt(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],s=e[t-1+96];e[t+0+0]=n+r+1>>1,e[t+2+0]=e[t+0+32]=r+a+1>>1,e[t+2+32]=e[t+0+64]=a+s+1>>1,e[t+1+0]=wt(n,r,a),e[t+3+0]=e[t+1+32]=wt(r,a,s),e[t+3+32]=e[t+1+64]=wt(a,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function Pt(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],s=e[t-1+96],i=e[t-1-32],o=e[t+0-32],l=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=n+i+1>>1,e[t+0+32]=e[t+2+64]=r+n+1>>1,e[t+0+64]=e[t+2+96]=a+r+1>>1,e[t+0+96]=s+a+1>>1,e[t+3+0]=wt(o,l,c),e[t+2+0]=wt(i,o,l),e[t+1+0]=e[t+3+32]=wt(n,i,o),e[t+1+32]=e[t+3+64]=wt(r,n,i),e[t+1+64]=e[t+3+96]=wt(a,r,n),e[t+1+96]=wt(s,a,r)}function _t(e,t){var n;for(n=0;8>n;++n)r(e,t+32*n,e,t-32,8)}function Lt(e,t){var n;for(n=0;8>n;++n)a(e,t,e[t-1],8),t+=32}function Rt(e,t,n){var r;for(r=0;8>r;++r)a(t,n+32*r,e,8)}function Dt(e,t){var n,r=8;for(n=0;8>n;++n)r+=e[t+n-32]+e[t-1+32*n];Rt(r>>4,e,t)}function It(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t+n-32];Rt(r>>3,e,t)}function Ot(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t-1+32*n];Rt(r>>3,e,t)}function Ft(e,t){Rt(128,e,t)}function Mt(e,t,n){var r=e[t-n],a=e[t+0],s=3*(a-r)+Lr[1020+e[t-2*n]-e[t+n]],i=Rr[112+(s+4>>3)];e[t-n]=Dr[255+r+Rr[112+(s+3>>3)]],e[t+0]=Dr[255+a-i]}function Bt(e,t,n,r){var a=e[t+0],s=e[t+n];return Ir[255+e[t-2*n]-e[t-n]]>r||Ir[255+s-a]>r}function zt(e,t,n,r){return 4*Ir[255+e[t-n]-e[t+0]]+Ir[255+e[t-2*n]-e[t+n]]<=r}function Ut(e,t,n,r,a){var s=e[t-3*n],i=e[t-2*n],o=e[t-n],l=e[t+0],c=e[t+n],u=e[t+2*n],d=e[t+3*n];return 4*Ir[255+o-l]+Ir[255+i-c]>r?0:Ir[255+e[t-4*n]-s]<=a&&Ir[255+s-i]<=a&&Ir[255+i-o]<=a&&Ir[255+d-u]<=a&&Ir[255+u-c]<=a&&Ir[255+c-l]<=a}function qt(e,t,n,r){var a=2*r+1;for(r=0;16>r;++r)zt(e,t+r,n,a)&&Mt(e,t+r,n)}function Vt(e,t,n,r){var a=2*r+1;for(r=0;16>r;++r)zt(e,t+r*n,1,a)&&Mt(e,t+r*n,1)}function Wt(e,t,n,r){var a;for(a=3;0<a;--a)qt(e,t+=4*n,n,r)}function Ht(e,t,n,r){var a;for(a=3;0<a;--a)Vt(e,t+=4,n,r)}function Gt(e,t,n,r,a,s,i,o){for(s=2*s+1;0<a--;){if(Ut(e,t,n,s,i))if(Bt(e,t,n,o))Mt(e,t,n);else{var l=e,c=t,u=n,d=l[c-2*u],h=l[c-u],f=l[c+0],p=l[c+u],m=l[c+2*u],g=27*(b=Lr[1020+3*(f-h)+Lr[1020+d-p]])+63>>7,v=18*b+63>>7,b=9*b+63>>7;l[c-3*u]=Dr[255+l[c-3*u]+b],l[c-2*u]=Dr[255+d+v],l[c-u]=Dr[255+h+g],l[c+0]=Dr[255+f-g],l[c+u]=Dr[255+p-v],l[c+2*u]=Dr[255+m-b]}t+=r}}function Yt(e,t,n,r,a,s,i,o){for(s=2*s+1;0<a--;){if(Ut(e,t,n,s,i))if(Bt(e,t,n,o))Mt(e,t,n);else{var l=e,c=t,u=n,d=l[c-u],h=l[c+0],f=l[c+u],p=Rr[112+(4+(m=3*(h-d))>>3)],m=Rr[112+(m+3>>3)],g=p+1>>1;l[c-2*u]=Dr[255+l[c-2*u]+g],l[c-u]=Dr[255+d+m],l[c+0]=Dr[255+h-p],l[c+u]=Dr[255+f-g]}t+=r}}function $t(e,t,n,r,a,s){Gt(e,t,n,1,16,r,a,s)}function Kt(e,t,n,r,a,s){Gt(e,t,1,n,16,r,a,s)}function Jt(e,t,n,r,a,s){var i;for(i=3;0<i;--i)Yt(e,t+=4*n,n,1,16,r,a,s)}function Xt(e,t,n,r,a,s){var i;for(i=3;0<i;--i)Yt(e,t+=4,1,n,16,r,a,s)}function Qt(e,t,n,r,a,s,i,o){Gt(e,t,a,1,8,s,i,o),Gt(n,r,a,1,8,s,i,o)}function Zt(e,t,n,r,a,s,i,o){Gt(e,t,1,a,8,s,i,o),Gt(n,r,1,a,8,s,i,o)}function en(e,t,n,r,a,s,i,o){Yt(e,t+4*a,a,1,8,s,i,o),Yt(n,r+4*a,a,1,8,s,i,o)}function tn(e,t,n,r,a,s,i,o){Yt(e,t+4,1,a,8,s,i,o),Yt(n,r+4,1,a,8,s,i,o)}function nn(){this.ba=new ie,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function an(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function sn(){this.ua=0,this.Wa=new I,this.vb=new I,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new f,this.yc=new d}function on(){this.xb=this.a=0,this.l=new Ge,this.ca=new ie,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new sn,this.ab=0,this.gc=i(4,an),this.Oc=0}function ln(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ge,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function cn(e,t,n,r,a,s,i){for(e=null==e?0:e[t+0],t=0;t<i;++t)a[s+t]=e+n[r+t]&255,e=a[s+t]}function un(e,t,n,r,a,s,i){var o;if(null==e)cn(null,null,n,r,a,s,i);else for(o=0;o<i;++o)a[s+o]=e[t+o]+n[r+o]&255}function dn(e,t,n,r,a,s,i){if(null==e)cn(null,null,n,r,a,s,i);else{var o,l=e[t+0],c=l,u=l;for(o=0;o<i;++o)c=u+(l=e[t+o])-c,u=n[r+o]+(-256&c?0>c?0:255:c)&255,c=l,a[s+o]=u}}function hn(e,n,a,i){var o=n.width,l=n.o;if(t(null!=e&&null!=n),0>a||0>=i||a+i>l)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new ln,(c=null==e.ga)||(c=n.width*n.o,t(0==e.Gb.length),e.Gb=s(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var u=e.Fa,d=e.P,h=e.qc,f=e.mb,p=e.nb,m=d+1,g=h-1,b=c.l;if(t(null!=u&&null!=f&&null!=n),ga[0]=null,ga[1]=cn,ga[2]=un,ga[3]=dn,c.ca=f,c.tb=p,c.c=n.width,c.i=n.height,t(0<c.c&&0<c.i),1>=h)n=0;else if(c.$a=3&u[d+0],c.Z=u[d+0]>>2&3,c.Lc=u[d+0]>>4&3,d=u[d+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||d)n=0;else if(b.put=fe,b.ac=he,b.bc=pe,b.ma=c,b.width=n.width,b.height=n.height,b.Da=n.Da,b.v=n.v,b.va=n.va,b.j=n.j,b.o=n.o,c.$a)e:{t(1==c.$a),n=Ae();t:for(;;){if(null==n){n=0;break e}if(t(null!=c),c.mc=n,n.c=c.c,n.i=c.i,n.l=c.l,n.l.ma=c,n.l.width=c.c,n.l.height=c.i,n.a=0,v(n.m,u,m,g),!Te(c.c,c.i,1,n,null))break t;if(1==n.ab&&3==n.gc[0].hc&&Ne(n.s)?(c.ic=1,u=n.c*n.i,n.Ta=null,n.Ua=0,n.V=s(u),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(c.ic=0,n=Pe(n,c.c)),!n)break t;n=1;break e}c.mc=null,n=0}else n=g>=c.c*c.i;c=!n}if(c)return null;1!=e.ga.Lc?e.Ga=0:i=l-a}t(null!=e.ga),t(a+i<=l);e:{if(n=(u=e.ga).c,l=u.l.o,0==u.$a){if(m=e.rc,g=e.Vc,b=e.Fa,d=e.P+1+a*n,h=e.mb,f=e.nb+a*n,t(d<=e.P+e.qc),0!=u.Z)for(t(null!=ga[u.Z]),c=0;c<i;++c)ga[u.Z](m,g,b,d,h,f,n),m=h,g=f,f+=n,d+=n;else for(c=0;c<i;++c)r(h,f,b,d,n),m=h,g=f,f+=n,d+=n;e.rc=m,e.Vc=g}else{if(t(null!=u.mc),n=a+i,t(null!=(c=u.mc)),t(n<=c.i),c.C>=n)n=1;else if(u.ic||vn(),u.ic){u=c.V,m=c.Ba,g=c.c;var x=c.i,y=(b=1,d=c.$/g,h=c.$%g,f=c.m,p=c.s,c.$),w=g*x,j=g*n,S=p.wc,k=y<j?ye(p,h,d):null;t(y<=w),t(n<=x),t(Ne(p));t:for(;;){for(;!f.h&&y<j;){if(h&S||(k=ye(p,h,d)),t(null!=k),C(f),256>(x=be(k.G[0],k.H[0],f)))u[m+y]=x,++y,++h>=g&&(h=0,++d<=n&&!(d%16)&&Ce(c,d));else{if(!(280>x)){b=0;break t}x=ge(x-256,f);var E,A=be(k.G[4],k.H[4],f);if(C(f),!(y>=(A=ve(g,A=ge(A,f)))&&w-y>=x)){b=0;break t}for(E=0;E<x;++E)u[m+y+E]=u[m+y+E-A];for(y+=x,h+=x;h>=g;)h-=g,++d<=n&&!(d%16)&&Ce(c,d);y<j&&h&S&&(k=ye(p,h,d))}t(f.h==N(f))}Ce(c,d>n?n:d);break t}!b||f.h&&y<w?(b=0,c.a=f.h?5:3):c.$=y,n=b}else n=ke(c,c.V,c.Ba,c.c,c.i,n,_e);if(!n){i=0;break e}}a+i>=l&&(e.Cc=1),i=1}if(!i)return null;if(e.Cc&&(null!=(i=e.ga)&&(i.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+a*o}function fn(e,t,n,r,a,s){for(;0<a--;){var i,o=e,l=t+(n?1:0),c=e,u=t+(n?0:3);for(i=0;i<r;++i){var d=c[u+4*i];255!=d&&(d*=32897,o[l+4*i+0]=o[l+4*i+0]*d>>23,o[l+4*i+1]=o[l+4*i+1]*d>>23,o[l+4*i+2]=o[l+4*i+2]*d>>23)}t+=s}}function pn(e,t,n,r,a){for(;0<r--;){var s;for(s=0;s<n;++s){var i=e[t+2*s+0],o=15&(c=e[t+2*s+1]),l=4369*o,c=(240&c|c>>4)*l>>16;e[t+2*s+0]=(240&i|i>>4)*l>>16&240|(15&i|i<<4)*l>>16>>4&15,e[t+2*s+1]=240&c|o}t+=a}}function mn(e,t,n,r,a,s,i,o){var l,c,u=255;for(c=0;c<a;++c){for(l=0;l<r;++l){var d=e[t+l];s[i+4*l]=d,u&=d}t+=n,i+=o}return 255!=u}function gn(e,t,n,r,a){var s;for(s=0;s<a;++s)n[r+s]=e[t+s]>>8}function vn(){Nr=fn,Sr=pn,Cr=mn,kr=gn}function bn(n,r,a){e[n]=function(e,n,s,i,o,l,c,u,d,h,f,p,m,g,v,b,x){var y,w=x-1>>1,j=o[l+0]|c[u+0]<<16,N=d[h+0]|f[p+0]<<16;t(null!=e);var S=3*j+N+131074>>2;for(r(e[n+0],255&S,S>>16,m,g),null!=s&&(S=3*N+j+131074>>2,r(s[i+0],255&S,S>>16,v,b)),y=1;y<=w;++y){var C=o[l+y]|c[u+y]<<16,k=d[h+y]|f[p+y]<<16,E=j+C+N+k+524296,A=E+2*(C+N)>>3;S=A+j>>1,j=(E=E+2*(j+k)>>3)+C>>1,r(e[n+2*y-1],255&S,S>>16,m,g+(2*y-1)*a),r(e[n+2*y-0],255&j,j>>16,m,g+(2*y-0)*a),null!=s&&(S=E+N>>1,j=A+k>>1,r(s[i+2*y-1],255&S,S>>16,v,b+(2*y-1)*a),r(s[i+2*y+0],255&j,j>>16,v,b+(2*y+0)*a)),j=C,N=k}1&x||(S=3*j+N+131074>>2,r(e[n+x-1],255&S,S>>16,m,g+(x-1)*a),null!=s&&(S=3*N+j+131074>>2,r(s[i+x-1],255&S,S>>16,v,b+(x-1)*a)))}}function xn(){va[Or]=ba,va[Fr]=ya,va[Mr]=xa,va[Br]=wa,va[zr]=ja,va[Ur]=Na,va[qr]=Sa,va[Vr]=ya,va[Wr]=wa,va[Hr]=ja,va[Gr]=Na}function yn(e){return e&~Pa?0>e?0:255:e>>Ta}function wn(e,t){return yn((19077*e>>8)+(26149*t>>8)-14234)}function jn(e,t,n){return yn((19077*e>>8)-(6419*t>>8)-(13320*n>>8)+8708)}function Nn(e,t){return yn((19077*e>>8)+(33050*t>>8)-17685)}function Sn(e,t,n,r,a){r[a+0]=wn(e,n),r[a+1]=jn(e,t,n),r[a+2]=Nn(e,t)}function Cn(e,t,n,r,a){r[a+0]=Nn(e,t),r[a+1]=jn(e,t,n),r[a+2]=wn(e,n)}function kn(e,t,n,r,a){var s=jn(e,t,n);t=s<<3&224|Nn(e,t)>>3,r[a+0]=248&wn(e,n)|s>>5,r[a+1]=t}function En(e,t,n,r,a){var s=240&Nn(e,t)|15;r[a+0]=240&wn(e,n)|jn(e,t,n)>>4,r[a+1]=s}function An(e,t,n,r,a){r[a+0]=255,Sn(e,t,n,r,a+1)}function Tn(e,t,n,r,a){Cn(e,t,n,r,a),r[a+3]=255}function Pn(e,t,n,r,a){Sn(e,t,n,r,a),r[a+3]=255}function He(e,t){return 0>e?0:e>t?t:e}function _n(t,n,r){e[t]=function(e,t,a,s,i,o,l,c,u){for(var d=c+(-2&u)*r;c!=d;)n(e[t+0],a[s+0],i[o+0],l,c),n(e[t+1],a[s+0],i[o+0],l,c+r),t+=2,++s,++o,c+=2*r;1&u&&n(e[t+0],a[s+0],i[o+0],l,c)}}function Ln(e,t,n){return 0==n?0==e?0==t?6:5:0==t?4:0:n}function Rn(e,t,n,r,a){switch(e>>>30){case 3:ir(t,n,r,a,0);break;case 2:or(t,n,r,a);break;case 1:cr(t,n,r,a)}}function Dn(e,t){var n,s,i=t.M,o=t.Nb,l=e.oc,c=e.pc+40,u=e.oc,d=e.pc+584,h=e.oc,f=e.pc+600;for(n=0;16>n;++n)l[c+32*n-1]=129;for(n=0;8>n;++n)u[d+32*n-1]=129,h[f+32*n-1]=129;for(0<i?l[c-1-32]=u[d-1-32]=h[f-1-32]=129:(a(l,c-32-1,127,21),a(u,d-32-1,127,9),a(h,f-32-1,127,9)),s=0;s<e.za;++s){var p=t.ya[t.aa+s];if(0<s){for(n=-1;16>n;++n)r(l,c+32*n-4,l,c+32*n+12,4);for(n=-1;8>n;++n)r(u,d+32*n-4,u,d+32*n+4,4),r(h,f+32*n-4,h,f+32*n+4,4)}var m=e.Gd,g=e.Hd+s,v=p.ad,b=p.Hc;if(0<i&&(r(l,c-32,m[g].y,0,16),r(u,d-32,m[g].f,0,8),r(h,f-32,m[g].ea,0,8)),p.Za){var x=l,y=c-32+16;for(0<i&&(s>=e.za-1?a(x,y,m[g].y[15],4):r(x,y,m[g+1].y,0,4)),n=0;4>n;n++)x[y+128+n]=x[y+256+n]=x[y+384+n]=x[y+0+n];for(n=0;16>n;++n,b<<=2)x=l,y=c+Ma[n],ha[p.Ob[n]](x,y),Rn(b,v,16*+n,x,y)}else if(x=Ln(s,i,p.Ob[0]),da[x](l,c),0!=b)for(n=0;16>n;++n,b<<=2)Rn(b,v,16*+n,l,c+Ma[n]);for(n=p.Gc,x=Ln(s,i,p.Dd),fa[x](u,d),fa[x](h,f),b=v,x=u,y=d,255&(p=n|0)&&(170&p?lr(b,256,x,y):ur(b,256,x,y)),p=h,b=f,255&(n>>=8)&&(170&n?lr(v,320,p,b):ur(v,320,p,b)),i<e.Ub-1&&(r(m[g].y,0,l,c+480,16),r(m[g].f,0,u,d+224,8),r(m[g].ea,0,h,f+224,8)),n=8*o*e.B,m=e.sa,g=e.ta+16*s+16*o*e.R,v=e.qa,p=e.ra+8*s+n,b=e.Ha,x=e.Ia+8*s+n,n=0;16>n;++n)r(m,g+n*e.R,l,c+32*n,16);for(n=0;8>n;++n)r(v,p+n*e.B,u,d+32*n,8),r(b,x+n*e.B,h,f+32*n,8)}}function In(e,r,a,s,i,o,l,c,u){var d=[0],h=[0],f=0,p=null!=u?u.kd:0,m=null!=u?u:new rn;if(null==e||12>a)return 7;m.data=e,m.w=r,m.ha=a,r=[r],a=[a],m.gb=[m.gb];e:{var g=r,b=a,x=m.gb;if(t(null!=e),t(null!=b),t(null!=x),x[0]=0,12<=b[0]&&!n(e,g[0],"RIFF")){if(n(e,g[0]+8,"WEBP")){x=3;break e}var y=L(e,g[0]+4);if(12>y||4294967286<y){x=3;break e}if(p&&y>b[0]-8){x=7;break e}x[0]=y,g[0]+=12,b[0]-=12}x=0}if(0!=x)return x;for(y=0<m.gb[0],a=a[0];;){e:{var j=e;b=r,x=a;var N=d,S=h,C=g=[0];if((A=f=[f])[0]=0,8>x[0])x=7;else{if(!n(j,b[0],"VP8X")){if(10!=L(j,b[0]+4)){x=3;break e}if(18>x[0]){x=7;break e}var k=L(j,b[0]+8),E=1+_(j,b[0]+12);if(2147483648<=E*(j=1+_(j,b[0]+15))){x=3;break e}null!=C&&(C[0]=k),null!=N&&(N[0]=E),null!=S&&(S[0]=j),b[0]+=18,x[0]-=18,A[0]=1}x=0}}if(f=f[0],g=g[0],0!=x)return x;if(b=!!(2&g),!y&&f)return 3;if(null!=o&&(o[0]=!!(16&g)),null!=l&&(l[0]=b),null!=c&&(c[0]=0),l=d[0],g=h[0],f&&b&&null==u){x=0;break}if(4>a){x=7;break}if(y&&f||!y&&!f&&!n(e,r[0],"ALPH")){a=[a],m.na=[m.na],m.P=[m.P],m.Sa=[m.Sa];e:{k=e,x=r,y=a;var A=m.gb;N=m.na,S=m.P,C=m.Sa,E=22,t(null!=k),t(null!=y),j=x[0];var T=y[0];for(t(null!=N),t(null!=C),N[0]=null,S[0]=null,C[0]=0;;){if(x[0]=j,y[0]=T,8>T){x=7;break e}var P=L(k,j+4);if(4294967286<P){x=3;break e}var R=8+P+1&-2;if(E+=R,0<A&&E>A){x=3;break e}if(!n(k,j,"VP8 ")||!n(k,j,"VP8L")){x=0;break e}if(T[0]<R){x=7;break e}n(k,j,"ALPH")||(N[0]=k,S[0]=j+8,C[0]=P),j+=R,T-=R}}if(a=a[0],m.na=m.na[0],m.P=m.P[0],m.Sa=m.Sa[0],0!=x)break}a=[a],m.Ja=[m.Ja],m.xa=[m.xa];e:if(A=e,x=r,y=a,N=m.gb[0],S=m.Ja,C=m.xa,k=x[0],j=!n(A,k,"VP8 "),E=!n(A,k,"VP8L"),t(null!=A),t(null!=y),t(null!=S),t(null!=C),8>y[0])x=7;else{if(j||E){if(A=L(A,k+4),12<=N&&A>N-12){x=3;break e}if(p&&A>y[0]-8){x=7;break e}S[0]=A,x[0]+=8,y[0]-=8,C[0]=E}else C[0]=5<=y[0]&&47==A[k+0]&&!(A[k+4]>>5),S[0]=y[0];x=0}if(a=a[0],m.Ja=m.Ja[0],m.xa=m.xa[0],r=r[0],0!=x)break;if(4294967286<m.Ja)return 3;if(null==c||b||(c[0]=m.xa?2:1),l=[l],g=[g],m.xa){if(5>a){x=7;break}c=l,p=g,b=o,null==e||5>a?e=0:5<=a&&47==e[r+0]&&!(e[r+4]>>5)?(y=[0],A=[0],N=[0],v(S=new w,e,r,a),me(S,y,A,N)?(null!=c&&(c[0]=y[0]),null!=p&&(p[0]=A[0]),null!=b&&(b[0]=N[0]),e=1):e=0):e=0}else{if(10>a){x=7;break}c=g,null==e||10>a||!Ke(e,r+3,a-3)?e=0:(p=e[r+0]|e[r+1]<<8|e[r+2]<<16,b=16383&(e[r+7]<<8|e[r+6]),e=16383&(e[r+9]<<8|e[r+8]),1&p||3<(p>>1&7)||!(p>>4&1)||p>>5>=m.Ja||!b||!e?e=0:(l&&(l[0]=b),c&&(c[0]=e),e=1))}if(!e)return 3;if(l=l[0],g=g[0],f&&(d[0]!=l||h[0]!=g))return 3;null!=u&&(u[0]=m,u.offset=r-u.w,t(4294967286>r-u.w),t(u.offset==u.ha-a));break}return 0==x||7==x&&f&&null==u?(null!=o&&(o[0]|=null!=m.na&&0<m.na.length),null!=s&&(s[0]=l),null!=i&&(i[0]=g),0):x}function On(e,t,n){var r=t.width,a=t.height,s=0,i=0,o=r,l=a;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,l=e.bd,s=e.v,i=e.j,11>n||(s&=-2,i&=-2),0>s||0>i||0>=o||0>=l||s+o>r||i+l>a))return 0;if(t.v=s,t.j=i,t.va=s+o,t.o=i+l,t.U=o,t.T=l,t.da=null!=e&&0<e.da,t.da){if(!O(o,l,n=[e.ib],s=[e.hb]))return 0;t.ib=n[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*r/4&&t.hb<3*a/4,t.Kb=0),1}function Fn(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Mn(e,t,n,r){if(null==r||0>=e||0>=t)return 2;if(null!=n){if(n.Da){var a=n.cd,i=n.bd,o=-2&n.v,l=-2&n.j;if(0>o||0>l||0>=a||0>=i||o+a>e||l+i>t)return 2;e=a,t=i}if(n.da){if(!O(e,t,a=[n.ib],i=[n.hb]))return 2;e=a[0],t=i[0]}}r.width=e,r.height=t;e:{var c=r.width,u=r.height;if(e=r.S,0>=c||0>=u||!(e>=Or&&13>e))e=2;else{if(0>=r.Rd&&null==r.sd){o=i=a=t=0;var d=(l=c*qa[e])*u;if(11>e||(i=(u+1)/2*(t=(c+1)/2),12==e&&(o=(a=c)*u)),null==(u=s(d+2*i+o))){e=1;break e}r.sd=u,11>e?((c=r.f.RGBA).eb=u,c.fb=0,c.A=l,c.size=d):((c=r.f.kb).y=u,c.O=0,c.fa=l,c.Fd=d,c.f=u,c.N=0+d,c.Ab=t,c.Cd=i,c.ea=u,c.W=0+d+i,c.Db=t,c.Ed=i,12==e&&(c.F=u,c.J=0+d+2*i),c.Tc=o,c.lb=a)}if(t=1,a=r.S,i=r.width,o=r.height,a>=Or&&13>a)if(11>a)e=r.f.RGBA,t&=(l=Math.abs(e.A))*(o-1)+i<=e.size,t&=l>=i*qa[a],t&=null!=e.eb;else{e=r.f.kb,l=(i+1)/2,d=(o+1)/2,c=Math.abs(e.fa),u=Math.abs(e.Ab);var h=Math.abs(e.Db),f=Math.abs(e.lb),p=f*(o-1)+i;t&=c*(o-1)+i<=e.Fd,t&=u*(d-1)+l<=e.Cd,t=(t&=h*(d-1)+l<=e.Ed)&c>=i&u>=l&h>=l,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==a&&(t&=f>=i,t&=p<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=n&&n.fd&&(e=Fn(r)),e}var Bn=64,zn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Un=24,qn=32,Vn=8,Wn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,n){return t[n+0]},e.Predictor3=function(e,t,n){return t[n+1]},e.Predictor4=function(e,t,n){return t[n-1]},e.Predictor5=function(e,t,n){return U(U(e,t[n+1]),t[n+0])},e.Predictor6=function(e,t,n){return U(e,t[n-1])},e.Predictor7=function(e,t,n){return U(e,t[n+0])},e.Predictor8=function(e,t,n){return U(t[n-1],t[n+0])},e.Predictor9=function(e,t,n){return U(t[n+0],t[n+1])},e.Predictor10=function(e,t,n){return U(U(e,t[n-1]),U(t[n+0],t[n+1]))},e.Predictor11=function(e,t,n){var r=t[n+0];return 0>=W(r>>24&255,e>>24&255,(t=t[n-1])>>24&255)+W(r>>16&255,e>>16&255,t>>16&255)+W(r>>8&255,e>>8&255,t>>8&255)+W(255&r,255&e,255&t)?r:e},e.Predictor12=function(e,t,n){var r=t[n+0];return(q((e>>24&255)+(r>>24&255)-((t=t[n-1])>>24&255))<<24|q((e>>16&255)+(r>>16&255)-(t>>16&255))<<16|q((e>>8&255)+(r>>8&255)-(t>>8&255))<<8|q((255&e)+(255&r)-(255&t)))>>>0},e.Predictor13=function(e,t,n){var r=t[n-1];return(V((e=U(e,t[n+0]))>>24&255,r>>24&255)<<24|V(e>>16&255,r>>16&255)<<16|V(e>>8&255,r>>8&255)<<8|V(255&e,255&r))>>>0};var Hn=e.PredictorAdd0;e.PredictorAdd1=H,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var Gn=e.PredictorAdd2;K("ColorIndexInverseTransform","MapARGB","32b",(function(e){return e>>8&255}),(function(e){return e})),K("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(e){return e}),(function(e){return e>>8&255}));var Yn,$n=e.ColorIndexInverseTransform,Kn=e.MapARGB,Jn=e.VP8LColorIndexInverseTransformAlpha,Xn=e.MapAlpha,Qn=e.VP8LPredictorsAdd=[];Qn.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Zn,er,tr,nr,rr,ar,sr,ir,or,lr,cr,ur,dr,hr,fr,pr,mr,gr,vr,br,xr,yr,wr,jr,Nr,Sr,Cr,kr,Er=s(511),Ar=s(2041),Tr=s(225),Pr=s(767),_r=0,Lr=Ar,Rr=Tr,Dr=Pr,Ir=Er,Or=0,Fr=1,Mr=2,Br=3,zr=4,Ur=5,qr=6,Vr=7,Wr=8,Hr=9,Gr=10,Yr=[2,3,7],$r=[3,3,11],Kr=[280,256,256,256,40],Jr=[0,1,1,1,0],Xr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Qr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Zr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ea=8,ta=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],na=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ra=null,aa=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],sa=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ia=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],oa=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],la=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ca=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ua=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],da=[],ha=[],fa=[],pa=1,ma=2,ga=[],va=[];bn("UpsampleRgbLinePair",Sn,3),bn("UpsampleBgrLinePair",Cn,3),bn("UpsampleRgbaLinePair",Pn,4),bn("UpsampleBgraLinePair",Tn,4),bn("UpsampleArgbLinePair",An,4),bn("UpsampleRgba4444LinePair",En,2),bn("UpsampleRgb565LinePair",kn,2);var ba=e.UpsampleRgbLinePair,xa=e.UpsampleBgrLinePair,ya=e.UpsampleRgbaLinePair,wa=e.UpsampleBgraLinePair,ja=e.UpsampleArgbLinePair,Na=e.UpsampleRgba4444LinePair,Sa=e.UpsampleRgb565LinePair,Ca=16,ka=1<<Ca-1,Ea=-227,Aa=482,Ta=6,Pa=(256<<Ta)-1,_a=0,La=s(256),Ra=s(256),Da=s(256),Ia=s(256),Oa=s(Aa-Ea),Fa=s(Aa-Ea);_n("YuvToRgbRow",Sn,3),_n("YuvToBgrRow",Cn,3),_n("YuvToRgbaRow",Pn,4),_n("YuvToBgraRow",Tn,4),_n("YuvToArgbRow",An,4),_n("YuvToRgba4444Row",En,2),_n("YuvToRgb565Row",kn,2);var Ma=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ba=[0,2,8],za=[8,7,6,4,4,2,2,2,1,1,1,1],Ua=1;this.WebPDecodeRGBA=function(e,n,r,a,s){var i=Fr,o=new nn,l=new ie;o.ba=l,l.S=i,l.width=[l.width],l.height=[l.height];var c=l.width,u=l.height,d=new oe;if(null==d||null==e)var h=2;else t(null!=d),h=In(e,n,r,d.width,d.height,d.Pd,d.Qd,d.format,null);if(0!=h?c=0:(null!=c&&(c[0]=d.width[0]),null!=u&&(u[0]=d.height[0]),c=1),c){l.width=l.width[0],l.height=l.height[0],null!=a&&(a[0]=l.width),null!=s&&(s[0]=l.height);e:{if(a=new Ge,(s=new rn).data=e,s.w=n,s.ha=r,s.kd=1,n=[0],t(null!=s),(0==(e=In(s.data,s.w,s.ha,null,null,null,n,null,s))||7==e)&&n[0]&&(e=4),0==(n=e)){if(t(null!=o),a.data=s.data,a.w=s.w+s.offset,a.ha=s.ha-s.offset,a.put=fe,a.ac=he,a.bc=pe,a.ma=o,s.xa){if(null==(e=Ae())){o=1;break e}if(function(e,n){var r=[0],a=[0],s=[0];t:for(;;){if(null==e)return 0;if(null==n)return e.a=2,0;if(e.l=n,e.a=0,v(e.m,n.data,n.w,n.ha),!me(e.m,r,a,s)){e.a=3;break t}if(e.xb=ma,n.width=r[0],n.height=a[0],!Te(r[0],a[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,a)){if(a=0==(n=Mn(a.width,a.height,o.Oa,o.ba))){t:{a=e;n:for(;;){if(null==a){a=0;break t}if(t(null!=a.s.yc),t(null!=a.s.Ya),t(0<a.s.Wb),t(null!=(r=a.l)),t(null!=(s=r.ma)),0!=a.xb){if(a.ca=s.ba,a.tb=s.tb,t(null!=a.ca),!On(s.Oa,r,Br)){a.a=2;break n}if(!Pe(a,r.width))break n;if(r.da)break n;if((r.da||re(a.ca.S))&&vn(),11>a.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=a.ca.f.kb.F&&vn()),a.Pb&&0<a.s.ua&&null==a.s.vb.X&&!R(a.s.vb,a.s.Wa.Xa)){a.a=1;break n}a.xb=0}if(!ke(a,a.V,a.Ba,a.c,a.i,r.o,je))break n;s.Dc=a.Ma,a=1;break t}t(0!=a.a),a=0}a=!a}a&&(n=e.a)}else n=e.a}else{if(null==(e=new Ye)){o=1;break e}if(e.Fa=s.na,e.P=s.P,e.qc=s.Sa,Je(e,a)){if(0==(n=Mn(a.width,a.height,o.Oa,o.ba))){if(e.Aa=0,r=o.Oa,t(null!=(s=e)),null!=r){if(0<(c=0>(c=r.Md)?0:100<c?255:255*c/100)){for(u=d=0;4>u;++u)12>(h=s.pb[u]).lc&&(h.ia=c*za[0>h.lc?0:h.lc]>>3),d|=h.ia;d&&(alert("todo:VP8InitRandom"),s.ia=1)}s.Ga=r.Id,100<s.Ga?s.Ga=100:0>s.Ga&&(s.Ga=0)}Ze(e,a)||(n=e.a)}}else n=e.a}0==n&&null!=o.Oa&&o.Oa.fd&&(n=Fn(o.ba))}o=n}i=0!=o?null:11>i?l.f.RGBA.eb:l.f.kb.y}else i=null;return i};var qa=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(e[t++]);return n}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function d(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new l;var h=[0],f=[0],p=[],m=new l,g=e,v=function(e,t){var n={},r=0,a=!1,s=0,i=0;if(n.frames=[],!function(e,t){for(var n=0;n<4;n++)if(e[t+n]!="RIFF".charCodeAt(n))return!0;return!1}(e,t)){for(d(e,t+=4),t+=8;t<e.length;){var o=c(e,t),l=d(e,t+=4);t+=4;var h=l+(1&l);switch(o){case"VP8 ":case"VP8L":void 0===n.frames[r]&&(n.frames[r]={}),(m=n.frames[r]).src_off=a?i:t-8,m.src_size=s+l+8,r++,a&&(a=!1,s=0,i=0);break;case"VP8X":(m=n.header={}).feature_flags=e[t];var f=t+4;m.canvas_width=1+u(e,f),f+=3,m.canvas_height=1+u(e,f),f+=3;break;case"ALPH":a=!0,s=h+8,i=t-8;break;case"ANIM":(m=n.header).bgcolor=d(e,t),f=t+4,m.loop_count=(g=e)[(v=f)+0]|g[v+1]<<8,f+=2;break;case"ANMF":var p,m;(m=n.frames[r]={}).offset_x=2*u(e,t),t+=3,m.offset_y=2*u(e,t),t+=3,m.width=1+u(e,t),t+=3,m.height=1+u(e,t),t+=3,m.duration=u(e,t),t+=3,p=e[t++],m.dispose=1&p,m.blend=p>>1&1}"ANMF"!=o&&(t+=h)}var g,v;return n}}(g,0);v.response=g,v.rgbaoutput=!0,v.dataurl=!1;var b=v.header?v.header:null,x=v.frames?v.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],f=[b.canvas_width];for(var y=0;y<x.length&&0!=x[y].blend;y++);}var w=x[0],j=m.WebPDecodeRGBA(g,w.src_off,w.src_size,f,h);w.rgba=j,w.imgwidth=f[0],w.imgheight=h[0];for(var N=0;N<f[0]*h[0]*4;N++)p[N]=j[N];return this.width=f,this.height=h,this.data=p,this}!function(e){var t=function(t,r,l,c){var u=4,d=s;switch(c){case e.image_compression.FAST:u=1,d=a;break;case e.image_compression.MEDIUM:u=6,d=i;break;case e.image_compression.SLOW:u=9,d=o}var h=gg(t=n(t,r,l,d),{level:u});return e.__addimage__.arrayBufferToBinaryString(h)},n=function(e,t,n,r){for(var a,s,i,o=e.length/t,l=new Uint8Array(e.length+o),d=c(),h=0;h<o;h+=1){if(i=h*t,a=e.subarray(i,i+t),r)l.set(r(a,n,s),i+h);else{for(var f,p=d.length,m=[];f<p;f+=1)m[f]=d[f](a,n,s);var g=u(m.concat());l.set(m[g],i+h)}s=a}return l},r=function(e){var t=Array.apply([],e);return t.unshift(0),t},a=function(e,t){var n,r=[],a=e.length;r[0]=1;for(var s=0;s<a;s+=1)n=e[s-t]||0,r[s+1]=e[s]-n+256&255;return r},s=function(e,t,n){var r,a=[],s=e.length;a[0]=2;for(var i=0;i<s;i+=1)r=n&&n[i]||0,a[i+1]=e[i]-r+256&255;return a},i=function(e,t,n){var r,a,s=[],i=e.length;s[0]=3;for(var o=0;o<i;o+=1)r=e[o-t]||0,a=n&&n[o]||0,s[o+1]=e[o]+256-(r+a>>>1)&255;return s},o=function(e,t,n){var r,a,s,i,o=[],c=e.length;o[0]=4;for(var u=0;u<c;u+=1)r=e[u-t]||0,a=n&&n[u]||0,s=n&&n[u-t]||0,i=l(r,a,s),o[u+1]=e[u]-i+256&255;return o},l=function(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),a=Math.abs(e-n),s=Math.abs(e+t-n-n);return r<=a&&r<=s?e:a<=s?t:n},c=function(){return[r,a,s,i,o]},u=function(e){var t=e.map((function(e){return e.reduce((function(e,t){return e+Math.abs(t)}),0)}));return t.indexOf(Math.min.apply(null,t))};e.processPNG=function(n,r,a,s){var i,o,l,c,u,d,h,f,p,m,g,v,b,x,y,w=this.decode.FLATE_DECODE,j="";if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){if(n=(l=new ub(n)).imgData,o=l.bits,i=l.colorSpace,u=l.colors,-1!==[4,6].indexOf(l.colorType)){if(8===l.bits){p=(f=32==l.pixelBitlength?new Uint32Array(l.decodePixels().buffer):16==l.pixelBitlength?new Uint16Array(l.decodePixels().buffer):new Uint8Array(l.decodePixels().buffer)).length,g=new Uint8Array(p*l.colors),m=new Uint8Array(p);var N,S=l.pixelBitlength-l.bits;for(x=0,y=0;x<p;x++){for(b=f[x],N=0;N<S;)g[y++]=b>>>N&255,N+=l.bits;m[x]=b>>>N&255}}if(16===l.bits){p=(f=new Uint32Array(l.decodePixels().buffer)).length,g=new Uint8Array(p*(32/l.pixelBitlength)*l.colors),m=new Uint8Array(p*(32/l.pixelBitlength)),v=l.colors>1,x=0,y=0;for(var C=0;x<p;)b=f[x++],g[y++]=b>>>0&255,v&&(g[y++]=b>>>16&255,b=f[x++],g[y++]=b>>>0&255),m[C++]=b>>>16&255;o=8}s!==e.image_compression.NONE?(n=t(g,l.width*l.colors,l.colors,s),h=t(m,l.width,1,s)):(n=g,h=m,w=void 0)}if(3===l.colorType&&(i=this.color_spaces.INDEXED,d=l.palette,l.transparency.indexed)){var k=l.transparency.indexed,E=0;for(x=0,p=k.length;x<p;++x)E+=k[x];if((E/=255)===p-1&&-1!==k.indexOf(0))c=[k.indexOf(0)];else if(E!==p){for(f=l.decodePixels(),m=new Uint8Array(f.length),x=0,p=f.length;x<p;x++)m[x]=k[f[x]];h=t(m,l.width,1)}}var A=function(t){var n;switch(t){case e.image_compression.FAST:n=11;break;case e.image_compression.MEDIUM:n=13;break;case e.image_compression.SLOW:n=14;break;default:n=12}return n}(s);return w===this.decode.FLATE_DECODE&&(j="/Predictor "+A+" "),j+="/Colors "+u+" /BitsPerComponent "+o+" /Columns "+l.width,(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:a,data:n,index:r,filter:w,decodeParameters:j,transparency:c,palette:d,sMask:h,predictor:A,width:l.width,height:l.height,bitsPerComponent:o,colorSpace:i}}}}(Qg.API),function(e){e.processGIF89A=function(t,n,r,a){var s=new db(t),i=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:i,height:o},u=new fb(100).encode(c,100);return e.processJPEG.call(this,u,n,r,a)},e.processGIF87A=e.processGIF89A}(Qg.API),pb.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},pb.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(e){wg.log("bit decode error:"+e)}},pb.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}0!==n&&(this.pos+=4-n)}},pb.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+2*a*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}0!==t&&(this.pos+=4-t)}},pb.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(a<this.palette.length){var i=this.palette[a];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==e&&(this.pos+=4-e)}},pb.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,c=s>>15?255:0,u=r*this.width*4+4*a;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=i,this.data[u+3]=c}this.pos+=e}},pb.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&n)/n*255|0,c=(i>>11)/t*255|0,u=a*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},pb.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;this.data[i]=s,this.data[i+1]=a,this.data[i+2]=r,this.data[i+3]=255}this.pos+=this.width%4}},pb.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=r,this.data[o+3]=i}},pb.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,a){var s=new pb(t,!1),i=s.width,o=s.height,l={data:s.getData(),width:i,height:o},c=new fb(100).encode(l,100);return e.processJPEG.call(this,c,n,r,a)}}(Qg.API),mb.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,a){var s=new mb(t),i=s.width,o=s.height,l={data:s.getData(),width:i,height:o},c=new fb(100).encode(l,100);return e.processJPEG.call(this,c,n,r,a)}}(Qg.API),Qg.API.processRGBA=function(e,t,n){for(var r=e.data,a=r.length,s=new Uint8Array(a/4*3),i=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var u=r[c],d=r[c+1],h=r[c+2],f=r[c+3];s[o++]=u,s[o++]=d,s[o++]=h,i[l++]=f}var p=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:p,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Qg.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},sb=Qg.API,ib=sb.getCharWidthsArray=function(e,t){var n,r,a=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=c.fof?c.fof:1,d=!1!==t.doKerning,h=0,f=e.length,p=0,m=o[0]||l,g=[];for(n=0;n<f;n++)r=e.charCodeAt(n),"function"==typeof a.metadata.widthOfString?g.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(r))+i*(1e3/s)||0)/1e3):(h=d&&"object"===(0,jm.A)(c[r])&&!isNaN(parseInt(c[r][p],10))?c[r][p]/u:0,g.push((o[r]||m)/l+h)),p=r;return g},ob=sb.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return sb.processArabic&&(e=sb.processArabic(e)),"function"==typeof r.metadata.widthOfString?r.metadata.widthOfString(e,n,a)/n:ib.apply(this,arguments).reduce((function(e,t){return e+t}),0)},lb=function(e,t,n,r){for(var a=[],s=0,i=e.length,o=0;s!==i&&o+t[s]<n;)o+=t[s],s++;a.push(e.slice(0,s));var l=s;for(o=0;s!==i;)o+t[s]>r&&(a.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&a.push(e.slice(l,s)),a},cb=function(e,t,n){n||(n={});var r,a,s,i,o,l,c,u=[],d=[u],h=n.textIndent||0,f=0,p=0,m=e.split(" "),g=ib.apply(this,[" ",n])[0];if(l=-1===n.lineIndent?m[0].length+2:n.lineIndent||0){var v=Array(l).join(" "),b=[];m.map((function(e){(e=e.split(/\s*\n/)).length>1?b=b.concat(e.map((function(e,t){return(t&&e.length?"\n":"")+e}))):b.push(e[0])})),m=b,l=ob.apply(this,[v,n])}for(s=0,i=m.length;s<i;s++){var x=0;if(r=m[s],l&&"\n"==r[0]&&(r=r.substr(1),x=1),h+f+(p=(a=ib.apply(this,[r,n])).reduce((function(e,t){return e+t}),0))>t||x){if(p>t){for(o=lb.apply(this,[r,a,t-(h+f),t]),u.push(o.shift()),u=[o.pop()];o.length;)d.push([o.shift()]);p=a.slice(r.length-(u[0]?u[0].length:0)).reduce((function(e,t){return e+t}),0)}else u=[r];d.push(u),h=p+l,f=g}else u.push(r),h+=f+p,f=g}return c=l?function(e,t){return(t?v:"")+e.join(" ")}:function(e){return e.join(" ")},d.map(c)},sb.splitTextToSize=function(e,t,n){var r,a=(n=n||{}).fontSize||this.internal.getFontSize(),s=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle);return t.metadata.Unicode?{widths:t.metadata.Unicode.widths||{0:1},kerning:t.metadata.Unicode.kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/a;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=n.lineIndent;var o,l,c=[];for(o=0,l=r.length;o<l;o++)c=c.concat(cb.apply(this,[r[o],i,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},r={},a=0;a<16;a++)n[t[a]]="0123456789abcdef"[a],r["0123456789abcdef"[a]]=t[a];var s=function(e){return"0x"+parseInt(e,10).toString(16)},i=e.__fontmetrics__.compress=function(e){var t,n,a,o,l=["{"];for(var c in e){if(t=e[c],isNaN(parseInt(c,10))?n="'"+c+"'":(c=parseInt(c,10),n=(n=s(c).slice(2)).slice(0,-1)+r[n.slice(-1)]),"number"==typeof t)t<0?(a=s(t).slice(3),o="-"):(a=s(t).slice(2),o=""),a=o+a.slice(0,-1)+r[a.slice(-1)];else{if("object"!==(0,jm.A)(t))throw new Error("Don't know what to do with value type "+(0,jm.A)(t)+".");a=i(t)}l.push(n+a)}return l.push("}"),l.join("")},o=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,r,a,s,i={},o=1,l=i,c=[],u="",d="",h=e.length-1,f=1;f<h;f+=1)"'"==(s=e[f])?t?(a=t.join(""),t=void 0):t=[]:t?t.push(s):"{"==s?(c.push([l,a]),l={},a=void 0):"}"==s?((r=c.pop())[0][r[1]]=l,a=void 0,l=r[0]):"-"==s?o=-1:void 0===a?n.hasOwnProperty(s)?(u+=n[s],a=parseInt(u,16)*o,o=1,u=""):u+=s:n.hasOwnProperty(s)?(d+=n[s],l[a]=parseInt(d,16)*o,o=1,a=void 0,d=""):d+=s;return i},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,n=u.Unicode[t.postScriptName];n&&(t.metadata.Unicode={},t.metadata.Unicode.widths=n.widths,t.metadata.Unicode.kerning=n.kerning);var r=c.Unicode[t.postScriptName];r&&(t.metadata.Unicode.encoding=r,t.encoding=r.codePages[0])}])}(Qg.API),function(e){var t=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n};e.API.events.push(["addFont",function(n){var r=void 0,a=n.font,s=n.instance;if(!a.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if("string"!=typeof(r=!1===s.existsFileInVFS(a.postScriptName)?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");!function(n,r){r=/^\x00\x01\x00\x00/.test(r)?t(r):t(Cg(r)),n.metadata=e.API.TTFFont.open(r),n.metadata.Unicode=n.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n.metadata.glyIdsUsed=[0]}(a,r)}}])}(Qg),function(){function e(){return(xg.canvg?Promise.resolve(xg.canvg):n.e(455).then(n.bind(n,8455))).catch((function(e){return Promise.reject(new Error("Could not load canvg: "+e))})).then((function(e){return e.default?e.default:e}))}Qg.API.addSvgAsImage=function(t,n,r,a,s,i,o,l){if(isNaN(n)||isNaN(r))throw wg.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw wg.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=a,c.height=s;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return e().then((function(e){return e.fromString(u,t,d)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(e){return e.render(d)})).then((function(){h.addImage(c.toDataURL("image/jpeg",1),n,r,a,s,o,l)}))}}(),Qg.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(t,n);return this},Qg.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,a,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],c=0,u=0,d=0;function h(e,t){var n,r=!1;for(n=0;n<e.length;n+=1)e[n]===t&&(r=!0);return r}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var f=o.length;for(d=0;d<f;d+=1)n[o[d]].value=n[o[d]].defaultValue,n[o[d]].explicitSet=!1}if("object"===(0,jm.A)(e))for(a in e)if(s=e[a],h(o,a)&&void 0!==s){if("boolean"===n[a].type&&"boolean"==typeof s)n[a].value=s;else if("name"===n[a].type&&h(n[a].valueSet,s))n[a].value=s;else if("integer"===n[a].type&&Number.isInteger(s))n[a].value=s;else if("array"===n[a].type){for(c=0;c<s.length;c+=1)if(r=!0,1===s[c].length&&"number"==typeof s[c][0])l.push(String(s[c]-1));else if(s[c].length>1){for(u=0;u<s[c].length;u+=1)"number"!=typeof s[c][u]&&(r=!1);!0===r&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}n[a].value="["+l.join(" ")+"]"}else n[a].value=n[a].defaultValue;n[a].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){var e,t=[];for(e in n)!0===n[e].explicitSet&&("name"===n[e].type?t.push("/"+e+" /"+n[e].value):t.push("/"+e+" "+n[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(e)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),i=n.length+r.length+a.length+t.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(t+n+r+a+s),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Qg.API),function(e){var t=e.API,n=t.pdfEscape16=function(e,t){for(var n,r=t.metadata.Unicode.widths,a=["","0","00","000","0000"],s=[""],i=0,o=e.length;i<o;++i){if(n=t.metadata.characterToGlyph(e.charCodeAt(i)),t.metadata.glyIdsUsed.push(n),t.metadata.toUnicode[n]=e.charCodeAt(i),-1==r.indexOf(n)&&(r.push(n),r.push([parseInt(t.metadata.widthOfGlyph(n),10)])),"0"==n)return s.join("");n=n.toString(16),s.push(a[4-n.length],n)}return s.join("")},r=function(e){var t,n,r,a,s,i,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=[],i=0,o=(n=Object.keys(e).sort((function(e,t){return e-t}))).length;i<o;i++)t=n[i],r.length>=100&&(s+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar",r=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(a=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),r.push("<"+t+"><"+a+">"));return r.length&&(s+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar\n"),s+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var n=t.font,a=t.out,s=t.newObject,i=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"Identity-H"===n.encoding){for(var o=n.metadata.Unicode.widths,l=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),c="",u=0;u<l.length;u++)c+=String.fromCharCode(l[u]);var d=s();i({data:c,addLength1:!0,objectId:d}),a("endobj");var h=s();i({data:r(n.metadata.toUnicode),addLength1:!0,objectId:h}),a("endobj");var f=s();a("<<"),a("/Type /FontDescriptor"),a("/FontName /"+Gg(n.fontName)),a("/FontFile2 "+d+" 0 R"),a("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),a("/Flags "+n.metadata.flags),a("/StemV "+n.metadata.stemV),a("/ItalicAngle "+n.metadata.italicAngle),a("/Ascent "+n.metadata.ascender),a("/Descent "+n.metadata.decender),a("/CapHeight "+n.metadata.capHeight),a(">>"),a("endobj");var p=s();a("<<"),a("/Type /Font"),a("/BaseFont /"+Gg(n.fontName)),a("/FontDescriptor "+f+" 0 R"),a("/W "+e.API.PDFObject.convert(o)),a("/CIDToGIDMap /Identity"),a("/DW 1000"),a("/Subtype /CIDFontType2"),a("/CIDSystemInfo"),a("<<"),a("/Supplement 0"),a("/Registry (Adobe)"),a("/Ordering ("+n.encoding+")"),a(">>"),a(">>"),a("endobj"),n.objectNumber=s(),a("<<"),a("/Type /Font"),a("/Subtype /Type0"),a("/ToUnicode "+h+" 0 R"),a("/BaseFont /"+Gg(n.fontName)),a("/Encoding /"+n.encoding),a("/DescendantFonts ["+p+" 0 R]"),a(">>"),a("endobj"),n.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var n=t.font,a=t.out,s=t.newObject,i=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var o=n.metadata.rawData,l="",c=0;c<o.length;c++)l+=String.fromCharCode(o[c]);var u=s();i({data:l,addLength1:!0,objectId:u}),a("endobj");var d=s();i({data:r(n.metadata.toUnicode),addLength1:!0,objectId:d}),a("endobj");var h=s();a("<<"),a("/Descent "+n.metadata.decender),a("/CapHeight "+n.metadata.capHeight),a("/StemV "+n.metadata.stemV),a("/Type /FontDescriptor"),a("/FontFile2 "+u+" 0 R"),a("/Flags 96"),a("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),a("/FontName /"+Gg(n.fontName)),a("/ItalicAngle "+n.metadata.italicAngle),a("/Ascent "+n.metadata.ascender),a(">>"),a("endobj"),n.objectNumber=s();for(var f=0;f<n.metadata.hmtx.widths.length;f++)n.metadata.hmtx.widths[f]=parseInt(n.metadata.hmtx.widths[f]*(1e3/n.metadata.head.unitsPerEm));a("<</Subtype/TrueType/Type/Font/ToUnicode "+d+" 0 R/BaseFont/"+Gg(n.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),a("endobj"),n.isAlreadyPutted=!0}}(t)}]);var a=function(e){var t,r=e.text||"",a=e.x,s=e.y,i=e.options||{},o=e.mutex||{},l=o.pdfEscape,c=o.activeFontKey,u=o.fonts,d=c,h="",f=0,p="",m=u[d].encoding;if("Identity-H"!==u[d].encoding)return{text:r,x:a,y:s,options:i,mutex:o};for(p=r,d=c,Array.isArray(r)&&(p=r[0]),f=0;f<p.length;f+=1)u[d].metadata.hasOwnProperty("cmap")&&(t=u[d].metadata.cmap.unicode.codeMap[p[f].charCodeAt(0)]),t||p[f].charCodeAt(0)<256&&u[d].metadata.hasOwnProperty("Unicode")?h+=p[f]:h+="";var g="";return parseInt(d.slice(1))<14||"WinAnsiEncoding"===m?g=l(h,d).split("").map((function(e){return e.charCodeAt(0).toString(16)})).join(""):"Identity-H"===m&&(g=n(h,u[d])),o.isHex=!0,{text:g,x:a,y:s,options:i,mutex:o}};t.events.push(["postProcessText",function(e){var t=e.text||"",n=[],r={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var s=0;for(s=0;s<t.length;s+=1)Array.isArray(t[s])&&3===t[s].length?n.push([a(Object.assign({},r,{text:t[s][0]})).text,t[s][1],t[s][2]]):n.push(a(Object.assign({},r,{text:t[s]})).text);e.text=n}else e.text=a(Object.assign({},r,{text:t})).text}])}(Qg),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(Qg.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var n,r,a,s,i,o,l,c=t,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,v=0;this.__bidiEngine__={};var b=function(e){var t=e.charCodeAt(),n=t>>8,r=f[n];return void 0!==r?c[256*r+(255&t)]:252===n||253===n?"AL":m.test(n)?"L":8===n?"R":"N"},x=function(e){for(var t,n=0;n<e.length;n++){if("L"===(t=b(e.charAt(n))))return!1;if("R"===t)return!0}return!1},y=function(e,t,i,o){var l,c,u,d,h=t[o];switch(h){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(h="AN");break;case"AL":g=!0,h="R";break;case"WS":case"BN":h="N";break;case"CS":o<1||o+1>=t.length||"EN"!==(l=i[o-1])&&"AN"!==l||"EN"!==(c=t[o+1])&&"AN"!==c?h="N":g&&(c="AN"),h=c===l?c:"N";break;case"ES":h="EN"===(l=o>0?i[o-1]:"B")&&o+1<t.length&&"EN"===t[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===i[o-1]){h="EN";break}if(g){h="N";break}for(u=o+1,d=t.length;u<d&&"ET"===t[u];)u++;h=u<d&&"EN"===t[u]?"EN":"N";break;case"NSM":if(a&&!s){for(d=t.length,u=o+1;u<d&&"NSM"===t[u];)u++;if(u<d){var f=e[o],p=f>=1425&&f<=2303||64286===f;if(l=t[u],p&&("R"===l||"AL"===l)){h="R";break}}}h=o<1||"B"===(l=t[o-1])?"N":i[o-1];break;case"B":g=!1,n=!0,h=v;break;case"S":r=!0,h="N"}return h},w=function(e,t,n){var r=e.split("");return n&&j(r,n,{hiLevel:v}),r.reverse(),t&&t.reverse(),r.join("")},j=function(e,t,a){var s,i,o,l,c,f=-1,p=e.length,m=0,x=[],w=v?d:u,j=[];for(g=!1,n=!1,r=!1,i=0;i<p;i++)j[i]=b(e[i]);for(o=0;o<p;o++){if(c=m,x[o]=y(e,j,x,o),s=240&(m=w[c][h[x[o]]]),m&=15,t[o]=l=w[m][5],s>0)if(16===s){for(i=f;i<o;i++)t[i]=1;f=-1}else f=-1;if(w[m][6])-1===f&&(f=o);else if(f>-1){for(i=f;i<o;i++)t[i]=l;f=-1}"B"===j[o]&&(t[o]=0),a.hiLevel|=l}r&&function(e,t,n){for(var r=0;r<n;r++)if("S"===e[r]){t[r]=v;for(var a=r-1;a>=0&&"WS"===e[a];a--)t[a]=v}}(j,t,p)},N=function(e,t,r,a,s){if(!(s.hiLevel<e)){if(1===e&&1===v&&!n)return t.reverse(),void(r&&r.reverse());for(var i,o,l,c,u=t.length,d=0;d<u;){if(a[d]>=e){for(l=d+1;l<u&&a[l]>=e;)l++;for(c=d,o=l-1;c<o;c++,o--)i=t[c],t[c]=t[o],t[o]=i,r&&(i=r[c],r[c]=r[o],r[o]=i);d=l}d++}}},S=function(e,t,n){var r=e.split(""),a={hiLevel:v};return n||(n=[]),j(r,n,a),function(e,t,n){if(0!==n.hiLevel&&l)for(var r,a=0;a<e.length;a++)1===t[a]&&(r=p.indexOf(e[a]))>=0&&(e[a]=p[r+1])}(r,n,a),N(2,r,t,n,a),N(1,r,t,n,a),r.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,n){if(function(e,t){if(t)for(var n=0;n<e.length;n++)t[n]=n;void 0===s&&(s=x(e)),void 0===o&&(o=x(e))}(e,t),a||!i||o)if(a&&i&&s^o)v=s?1:0,e=w(e,t,n);else if(!a&&i&&o)v=s?1:0,e=S(e,t,n),e=w(e,t);else if(!a||s||i||o){if(a&&!i&&s^o)e=w(e,t),s?(v=0,e=S(e,t,n)):(v=1,e=S(e,t,n),e=w(e,t));else if(a&&s&&!i&&o)v=1,e=S(e,t,n),e=w(e,t);else if(!a&&!i&&s^o){var r=l;s?(v=1,e=S(e,t,n),v=0,l=!1,e=S(e,t,n),l=r):(v=0,e=S(e,t,n),e=w(e,t),v=1,l=!1,e=S(e,t,n),l=r,e=w(e,t))}}else v=0,e=S(e,t,n);else v=s?1:0,e=S(e,t,n);return e},this.__bidiEngine__.setOptions=function(e){e&&(a=e.isInputVisual,i=e.isOutputVisual,s=e.isInputRtl,o=e.isOutputRtl,l=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var r=e.options||{};e.mutex,r.lang;var a=[];if(r.isInputVisual="boolean"!=typeof r.isInputVisual||r.isInputVisual,n.setOptions(r),"[object Array]"===Object.prototype.toString.call(t)){var s=0;for(a=[],s=0;s<t.length;s+=1)"[object Array]"===Object.prototype.toString.call(t[s])?a.push([n.doBidiReorder(t[s][0]),t[s][1],t[s][2]]):a.push([n.doBidiReorder(t[s])]);e.text=a}else e.text=n.doBidiReorder(t);n.setOptions({isInputVisual:!0})}])}(Qg),Qg.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new vb(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Ob(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new bb(this.contents),this.head=new wb(this),this.name=new Ab(this),this.cmap=new Nb(this),this.toUnicode={},this.hhea=new Sb(this),this.maxp=new Tb(this),this.hmtx=new Pb(this),this.post=new kb(this),this.os2=new Cb(this),this.loca=new Ib(this),this.glyf=new Lb(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,n,r,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,n,r,a;for(a=[],t=0,n=(r=this.bbox).length;t<n;t++)e=r[t],a.push(Math.round(e*this.scaleFactor));return a}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),0!=(32768&(t=r>>16))&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,n){var r,a,s,i;for(s=0,a=0,i=(e=""+e).length;0<=i?a<i:a>i;a=0<=i?++a:--a)r=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return s*(t/1e3)},e.prototype.lineHeight=function(e,t){var n;return null==t&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},e}();var gb,vb=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,n,r,a,s,i,o;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^a)+65536*(255^s)+256*(255^i)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*a+65536*s+256*i+o},e.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(e){var t,n,r,a;for(a=[],n=0,r=e.length;n<r;n++)t=e[n],a.push(this.writeByte(t));return a},e}(),bb=function(){var e;function t(e){var t,n,r;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var n,r,a,s,i,o,l,c,u,d,h,f,p;for(p in h=Object.keys(t).length,o=Math.log(2),u=16*Math.floor(Math.log(h)/o),s=Math.floor(u/o),c=16*h-u,(r=new vb).writeInt(this.scalarType),r.writeShort(h),r.writeShort(u),r.writeShort(s),r.writeShort(c),a=16*h,l=r.pos+a,i=null,f=[],t)for(d=t[p],r.writeString(p),r.writeInt(e(d)),r.writeInt(l),r.writeInt(d.length),f=f.concat(d),"head"===p&&(i=l),l+=d.length;l%4;)f.push(0),l++;return r.write(f),n=2981146554-e(r.data),r.pos=i+8,r.writeUInt32(n),r.data},e=function(e){var t,n,r,a;for(e=_b.call(e);e.length%4;)e.push(0);for(r=new vb(e),n=0,t=0,a=e.length;t<a;t=t+=4)n+=r.readUInt32();return 4294967295&n},t}(),xb={}.hasOwnProperty,yb=function(e,t){for(var n in t)xb.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};gb=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var wb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new vb).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),jb=function(){function e(e,t){var n,r,a,s,i,o,l,c,u,d,h,f,p,m,g,v,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),u=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=e.readByte();break;case 4:for(h=e.readUInt16(),d=h/2,e.pos+=6,a=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),e.pos+=2,p=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),l=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),c=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),r=(this.length-e.pos+this.offset)/2,i=function(){var t,n;for(n=[],o=t=0;0<=r?t<r:t>r;o=0<=r?++t:--t)n.push(e.readUInt16());return n}(),o=g=0,b=a.length;g<b;o=++g)for(m=a[o],n=v=f=p[o];f<=m?v<=m:v>=m;n=f<=m?++v:--v)0===c[o]?s=n+l[o]:0!==(s=i[c[o]/2+(n-f)-(d-o)]||0)&&(s+=l[o]),this.codeMap[n]=65535&s}e.pos=u}return e.encode=function(e,t){var n,r,a,s,i,o,l,c,u,d,h,f,p,m,g,v,b,x,y,w,j,N,S,C,k,E,A,T,P,_,L,R,D,I,O,F,M,B,z,U,q,V,W,H,G,Y;switch(T=new vb,s=Object.keys(e).sort((function(e,t){return e-t})),t){case"macroman":for(p=0,m=function(){var e=[];for(f=0;f<256;++f)e.push(0);return e}(),v={0:0},a={},P=0,D=s.length;P<D;P++)null==v[W=e[r=s[P]]]&&(v[W]=++p),a[r]={old:e[r],new:v[e[r]]},m[r]=v[e[r]];return T.writeUInt16(1),T.writeUInt16(0),T.writeUInt32(12),T.writeUInt16(0),T.writeUInt16(262),T.writeUInt16(0),T.write(m),{charMap:a,subtable:T.data,maxGlyphID:p+1};case"unicode":for(E=[],u=[],b=0,v={},n={},g=l=null,_=0,I=s.length;_<I;_++)null==v[y=e[r=s[_]]]&&(v[y]=++b),n[r]={old:y,new:v[y]},i=v[y]-r,null!=g&&i===l||(g&&u.push(g),E.push(r),l=i),g=r;for(g&&u.push(g),u.push(65535),E.push(65535),C=2*(S=E.length),N=2*Math.pow(Math.log(S)/Math.LN2,2),d=Math.log(N/2)/Math.LN2,j=2*S-N,o=[],w=[],h=[],f=L=0,O=E.length;L<O;f=++L){if(k=E[f],c=u[f],65535===k){o.push(0),w.push(0);break}if(k-(A=n[k].new)>=32768)for(o.push(0),w.push(2*(h.length+S-f)),r=R=k;k<=c?R<=c:R>=c;r=k<=c?++R:--R)h.push(n[r].new);else o.push(A-k),w.push(0)}for(T.writeUInt16(3),T.writeUInt16(1),T.writeUInt32(12),T.writeUInt16(4),T.writeUInt16(16+8*S+2*h.length),T.writeUInt16(0),T.writeUInt16(C),T.writeUInt16(N),T.writeUInt16(d),T.writeUInt16(j),q=0,F=u.length;q<F;q++)r=u[q],T.writeUInt16(r);for(T.writeUInt16(0),V=0,M=E.length;V<M;V++)r=E[V],T.writeUInt16(r);for(H=0,B=o.length;H<B;H++)i=o[H],T.writeUInt16(i);for(G=0,z=w.length;G<z;G++)x=w[G],T.writeUInt16(x);for(Y=0,U=h.length;Y<U;Y++)p=h[Y],T.writeUInt16(p);return{charMap:n,subtable:T.data,maxGlyphID:b+1}}},e}(),Nb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,n,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t=new jb(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var n,r;return null==t&&(t="macroman"),n=jb.encode(e,t),(r=new vb).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},e}(),Sb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),Cb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n}(),this.charRange=function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),kb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="post",e.prototype.parse=function(e){var t,n,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=function(){var t,n,r;for(r=[],a=t=0,n=this.file.maxp.numGlyphs;0<=n?t<n:t>n;a=0<=n?++t:--t)r.push(e.readUInt32());return r}.call(this)}},e}(),Eb=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Ab=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="name",e.prototype.parse=function(e){var t,n,r,a,s,i,o,l,c,u,d;for(e.pos=this.offset,e.readShort(),t=e.readShort(),i=e.readShort(),n=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+i+e.readShort()});for(o={},a=c=0,u=n.length;c<u;a=++c)r=n[a],e.pos=r.offset,l=e.readString(r.length),s=new Eb(l,r),null==o[d=r.nameID]&&(o[d]=[]),o[r.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(e){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},e}(),Tb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),Pb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,n,r,a,s,i,o;for(e.pos=this.offset,this.metrics=[],t=0,i=this.file.hhea.numberOfMetrics;0<=i?t<i:t>i;t=0<=i?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,a;for(a=[],t=n=0;0<=r?n<r:n>r;t=0<=r?++n:--n)a.push(e.readInt16());return a}(),this.widths=function(){var e,t,n,r;for(r=[],e=0,t=(n=this.metrics).length;e<t;e++)a=n[e],r.push(a.advance);return r}.call(this),n=this.widths[this.widths.length-1],o=[],t=s=0;0<=r?s<r:s>r;t=0<=r?++s:--s)o.push(this.widths.push(n));return o},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),_b=[].slice,Lb=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,n,r,a,s,i,o,l,c,u;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,n=a.indexOf(e),0===(r=a.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+n,s=(i=new vb(t.read(r))).readShort(),l=i.readShort(),u=i.readShort(),o=i.readShort(),c=i.readShort(),this.cache[e]=-1===s?new Db(i,l,u,o,c):new Rb(i,s,l,u,o,c),this.cache[e]))},e.prototype.encode=function(e,t,n){var r,a,s,i,o;for(s=[],a=[],i=0,o=t.length;i<o;i++)r=e[t[i]],a.push(s.length),r&&(s=s.concat(r.encode(n)));return a.push(s.length),{table:s,offsets:a}},e}(),Rb=function(){function e(e,t,n,r,a,s){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=a,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Db=function(){function e(e,t,n,r,a){var s,i;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;i=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&i;)s.pos+=1&i?4:2,128&i?s.pos+=8:64&i?s.pos+=4:8&i&&(s.pos+=2)}return e.prototype.encode=function(){var e,t,n;for(t=new vb(_b.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),Ib=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return yb(e,gb),e.prototype.tag="loca",e.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=2)r.push(2*e.readUInt16());return r}.call(this):function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=4)r.push(e.readUInt32());return r}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),r=0,a=0,s=0;s<n.length;++s)if(n[s]=r,a<t.length&&t[a]==s){++a,n[s]=r;var i=this.offsets[s],o=this.offsets[s+1]-i;o>0&&(r+=o)}for(var l=new Array(4*n.length),c=0;c<n.length;++c)l[4*c+3]=255&n[c],l[4*c+2]=(65280&n[c])>>8,l[4*c+1]=(16711680&n[c])>>16,l[4*c]=(4278190080&n[c])>>24;return l},e}(),Ob=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,n,r,a;for(t in r=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[t],e[t]=r[n];return e},e.prototype.glyphsFor=function(e){var t,n,r,a,s,i,o;for(r={},s=0,i=e.length;s<i;s++)r[a=e[s]]=this.font.glyf.glyphFor(a);for(a in t=[],r)(null!=(n=r[a])?n.compound:void 0)&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(a in o=this.glyphsFor(t))n=o[a],r[a]=n;return r},e.prototype.encode=function(e,t){var n,r,a,s,i,o,l,c,u,d,h,f,p,m,g;for(r in n=Nb.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),h={0:0},g=n.charMap)h[(o=g[r]).old]=o.new;for(f in d=n.maxGlyphID,s)f in h||(h[f]=d++);return c=function(e){var t,n;for(t in n={},e)n[e[t]]=t;return n}(h),u=Object.keys(c).sort((function(e,t){return e-t})),p=function(){var e,t,n;for(n=[],e=0,t=u.length;e<t;e++)i=u[e],n.push(c[i]);return n}(),a=this.font.glyf.encode(s,p,h),l=this.font.loca.encode(a.offsets,p),m={cmap:this.font.cmap.raw(),glyf:a.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},e}();function Fb(e,t,n,r,a){r=r||{};var s=a.internal.scaleFactor,i=a.internal.getFontSize()/s,o=i*(a.getLineHeightFactor?a.getLineHeightFactor():1.15),l="",c=1;if("middle"!==r.valign&&"bottom"!==r.valign&&"center"!==r.halign&&"right"!==r.halign||(c=(l="string"===typeof e?e.split(/\r\n|\r|\n/g):e).length||1),n+=i*(2-1.15),"middle"===r.valign?n-=c/2*o:"bottom"===r.valign&&(n-=c*o),"center"===r.halign||"right"===r.halign){var u=i;if("center"===r.halign&&(u*=.5),l&&c>=1){for(var d=0;d<l.length;d++)a.text(l[d],t-a.getStringUnitWidth(l[d])*u,n),n+=o;return a}t-=a.getStringUnitWidth(e)*u}return"justify"===r.halign?a.text(e,t,n,{maxWidth:r.maxWidth||100,align:"justify"}):a.text(e,t,n),a}Qg.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(n){var r,a,s,i;if(Array.isArray(n))return"["+function(){var e,a,s;for(s=[],e=0,a=n.length;e<a;e++)r=n[e],s.push(t.convert(r));return s}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(a in s=["<<"],n)i=n[a],s.push("/"+a+" "+t.convert(i));return s.push(">>"),s.join("\n")}return""+n},t}();var Mb={},Bb=function(){function e(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(e,t){void 0===t&&(t=null),t?t.__autoTableDocumentDefaults=e:Mb=e},e.unifyColor=function(e){return Array.isArray(e)?e:"number"===typeof e?[e,e,e]:"string"===typeof e?[e]:null},e.prototype.applyStyles=function(t,n){var r,a,s;void 0===n&&(n=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,l=i.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[l];c&&-1===c.indexOf(o)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!n){var u=e.unifyColor(t.fillColor);u&&(r=this.jsPDFDocument).setFillColor.apply(r,u),(u=e.unifyColor(t.textColor))&&(a=this.jsPDFDocument).setTextColor.apply(a,u),(u=e.unifyColor(t.lineColor))&&(s=this.jsPDFDocument).setDrawColor.apply(s,u),"number"===typeof t.lineWidth&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(e,t,n){return this.jsPDFDocument.splitTextToSize(e,t,n)},e.prototype.rect=function(e,t,n,r,a){return this.jsPDFDocument.rect(e,t,n,r,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return Mb||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return null==e.width&&(e={width:e.getWidth(),height:e.getHeight()}),e},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),zb=function(e,t){return zb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},zb(e,t)};function Ub(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}zb(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}"function"===typeof SuppressedError&&SuppressedError;var qb=function(e){function t(t){var n=e.call(this)||this;return n._element=t,n}return Ub(t,e),t}(Array);function Vb(e,t,n){n.applyStyles(t,!0);var r=(Array.isArray(e)?e:[e]).map((function(e){return n.getTextWidth(e)})).reduce((function(e,t){return Math.max(e,t)}),0);return r}function Wb(e,t,n,r){var a=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:s});var i=Hb(a,!1);i&&e.rect(n.x,n.y,t.getWidth(e.pageSize().width),r.y-n.y,i)}function Hb(e,t){var n=e>0,r=t||0===t;return n&&r?"DF":n?"S":r?"F":null}function Gb(e,t){var n,r,a,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:t}return"object"===typeof e?("number"===typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"===typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(n=e.left)&&void 0!==n?n:t,top:null!==(r=e.top)&&void 0!==r?r:t,right:null!==(a=e.right)&&void 0!==a?a:t,bottom:null!==(s=e.bottom)&&void 0!==s?s:t}):("number"!==typeof e&&(e=t),{top:e,right:e,bottom:e,left:e})}function Yb(e,t){var n=Gb(t.settings.margin,0);return e.pageSize().width-(n.left+n.right)}function $b(e,t,n,r,a){var s={},i=96/72,o=Kb(t,(function(e){return a.getComputedStyle(e).backgroundColor}));null!=o&&(s.fillColor=o);var l=Kb(t,(function(e){return a.getComputedStyle(e).color}));null!=l&&(s.textColor=l);var c=function(e,t){var n=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],r=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=n.map((function(e){return parseInt(e||"0")/r})),i=Gb(s,0);a>i.top&&(i.top=a);a>i.bottom&&(i.bottom=a);return i}(r,n);c&&(s.cellPadding=c);var u="borderTopColor",d=i*n,h=r.borderTopWidth;if(r.borderBottomWidth===h&&r.borderRightWidth===h&&r.borderLeftWidth===h){var f=(parseFloat(h)||0)/d;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/d,right:(parseFloat(r.borderRightWidth)||0)/d,bottom:(parseFloat(r.borderBottomWidth)||0)/d,left:(parseFloat(r.borderLeftWidth)||0)/d},s.lineWidth.top||(s.lineWidth.right?u="borderRightColor":s.lineWidth.bottom?u="borderBottomColor":s.lineWidth.left&&(u="borderLeftColor"));var p=Kb(t,(function(e){return a.getComputedStyle(e)[u]}));null!=p&&(s.lineColor=p);var m=["left","right","center","justify"];-1!==m.indexOf(r.textAlign)&&(s.halign=r.textAlign),-1!==(m=["middle","bottom","top"]).indexOf(r.verticalAlign)&&(s.valign=r.verticalAlign);var g=parseInt(r.fontSize||"");isNaN(g)||(s.fontSize=g/i);var v=function(e){var t="";("bold"===e.fontWeight||"bolder"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(t="bold");"italic"!==e.fontStyle&&"oblique"!==e.fontStyle||(t+="italic");return t}(r);v&&(s.fontStyle=v);var b=(r.fontFamily||"").toLowerCase();return-1!==e.indexOf(b)&&(s.font=b),s}function Kb(e,t){var n=Jb(e,t);if(!n)return null;var r=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var a=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return 0===parseInt(r[4])||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function Jb(e,t){var n=t(e);return"rgba(0, 0, 0, 0)"===n||"transparent"===n||"initial"===n||"inherit"===n?null==e.parentElement?null:Jb(e.parentElement,t):n}function Xb(e,t,n,r,a){var s,i,o;void 0===r&&(r=!1),void 0===a&&(a=!1),o="string"===typeof t?n.document.querySelector(t):t;var l=Object.keys(e.getFontList()),c=e.scaleFactor(),u=[],d=[],h=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:u,body:d,foot:h};for(var f=0;f<o.rows.length;f++){var p=o.rows[f],m=null===(i=null===(s=null===p||void 0===p?void 0:p.parentElement)||void 0===s?void 0:s.tagName)||void 0===i?void 0:i.toLowerCase(),g=Qb(l,c,n,p,r,a);g&&("thead"===m?u.push(g):"tfoot"===m?h.push(g):d.push(g))}return{head:u,body:d,foot:h}}function Qb(e,t,n,r,a,s){for(var i=new qb(r),o=0;o<r.cells.length;o++){var l=r.cells[o],c=n.getComputedStyle(l);if(a||"none"!==c.display){var u=void 0;s&&(u=$b(e,l,t,c,n)),i.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:u,_element:l,content:Zb(l)})}}var d=n.getComputedStyle(r);if(i.length>0&&(a||"none"!==d.display))return i}function Zb(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map((function(e){return e.trim()})).join("\n"),t.innerText||t.textContent||""}function ex(e,t,n,r,a){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(s[l]=o[l])}return s}function tx(e,t){var n=new Bb(e),r=n.getDocumentOptions(),a=n.getGlobalOptions();!function(e,t,n){for(var r=0,a=[e,t,n];r<a.length;r++){var s=a[r];s&&"object"!==typeof s&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&"number"!==typeof s.startY&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}(a,r,t);var s,i=ex({},a,r,t);"undefined"!==typeof window&&(s=window);var o=function(e,t,n){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(a){if("columnStyles"===a){var s=e[a],i=t[a],o=n[a];r.columnStyles=ex({},s,i,o)}else{var l=[e,t,n].map((function(e){return e[a]||{}}));r[a]=ex({},l[0],l[1],l[2])}},s=0,i=Object.keys(r);s<i.length;s++){a(i[s])}return r}(a,r,t),l=function(e,t,n){for(var r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,s=[e,t,n];a<s.length;a++){var i=s[a];i.didParseCell&&r.didParseCell.push(i.didParseCell),i.willDrawCell&&r.willDrawCell.push(i.willDrawCell),i.didDrawCell&&r.didDrawCell.push(i.didDrawCell),i.willDrawPage&&r.willDrawPage.push(i.willDrawPage),i.didDrawPage&&r.didDrawPage.push(i.didDrawPage)}return r}(a,r,t),c=function(e,t){var n,r,a,s,i,o,l,c,u,d,h,f,p,m,g=Gb(t.margin,40/e.scaleFactor()),v=null!==(n=function(e,t){var n=e.getLastAutoTable(),r=e.scaleFactor(),a=e.pageNumber(),s=!1;if(n&&n.startPageNumber){s=n.startPageNumber+n.pageNumber-1===a}if("number"===typeof t)return t;if((null==t||!1===t)&&s&&null!=(null===n||void 0===n?void 0:n.finalY))return n.finalY+20/r;return null}(e,t.startY))&&void 0!==n?n:g.top;p=!0===t.showFoot?"everyPage":!1===t.showFoot?"never":null!==(r=t.showFoot)&&void 0!==r?r:"everyPage";m=!0===t.showHead?"everyPage":!1===t.showHead?"never":null!==(a=t.showHead)&&void 0!==a?a:"everyPage";var b=null!==(s=t.useCss)&&void 0!==s&&s,x=t.theme||(b?"plain":"striped"),y=!!t.horizontalPageBreak,w=null!==(i=t.horizontalPageBreakRepeat)&&void 0!==i?i:null;return{includeHiddenHtml:null!==(o=t.includeHiddenHtml)&&void 0!==o&&o,useCss:b,theme:x,startY:v,margin:g,pageBreak:null!==(l=t.pageBreak)&&void 0!==l?l:"auto",rowPageBreak:null!==(c=t.rowPageBreak)&&void 0!==c?c:"auto",tableWidth:null!==(u=t.tableWidth)&&void 0!==u?u:"auto",showHead:m,showFoot:p,tableLineWidth:null!==(d=t.tableLineWidth)&&void 0!==d?d:0,tableLineColor:null!==(h=t.tableLineColor)&&void 0!==h?h:200,horizontalPageBreak:y,horizontalPageBreakRepeat:w,horizontalPageBreakBehaviour:null!==(f=t.horizontalPageBreakBehaviour)&&void 0!==f?f:"afterAllRows"}}(n,i),u=function(e,t,n){var r=t.head||[],a=t.body||[],s=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(n){var o=Xb(e,t.html,n,i,t.useCss)||{};r=o.head||r,a=o.body||r,s=o.foot||r}else console.error("Cannot parse html in non browser environment")}var l=t.columns||function(e,t,n){var r=e[0]||t[0]||n[0]||[],a=[];return Object.keys(r).filter((function(e){return"_element"!==e})).forEach((function(e){var t,n=1;"object"!==typeof(t=Array.isArray(r)?r[parseInt(e)]:r[e])||Array.isArray(t)||(n=(null===t||void 0===t?void 0:t.colSpan)||1);for(var s=0;s<n;s++){var i={dataKey:Array.isArray(r)?a.length:e+(s>0?"_".concat(s):"")};a.push(i)}})),a}(r,a,s);return{columns:l,head:r,body:a,foot:s}}(n,i,s);return{id:t.tableId,content:u,hooks:l,styles:o,settings:c}}var nx,rx=function(e,t,n){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=e.getDocument()},ax=function(e){function t(t,n,r,a,s,i){var o=e.call(this,t,n,i)||this;return o.cell=r,o.row=a,o.column=s,o.section=a.section,o}return Ub(t,e),t}(rx),sx=function(){function e(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(e){return this.head.reduce((function(t,n){return t+n.getMaxCellHeight(e)}),0)},e.prototype.getFootHeight=function(e){return this.foot.reduce((function(t,n){return t+n.getMaxCellHeight(e)}),0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(e,t,n,r,a,s){for(var i=0,o=t;i<o.length;i++){var l=!1===(0,o[i])(new ax(e,this,n,r,a,s));if(n.text=Array.isArray(n.text)?n.text:[n.text],l)return!1}return!0},e.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++){(0,r[n])(new rx(e,this,t))}},e.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++){(0,r[n])(new rx(e,this,t))}},e.prototype.getWidth=function(e){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce((function(e,t){return e+t.wrappedWidth}),0);var t=this.settings.margin;return e-t.left-t.right},e}(),ix=function(){function e(e,t,n,r,a){void 0===a&&(a=!1),this.height=0,this.raw=e,e instanceof qb&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=r,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce((function(e,n){var r;return Math.max(e,(null===(r=t.cells[n.index])||void 0===r?void 0:r.height)||0)}),0)},e.prototype.hasRowSpan=function(e){var t=this;return e.filter((function(e){var n=t.cells[e.index];return!!n&&n.rowSpan>1})).length>0},e.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},e.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce((function(e,r){var a=n.cells[r.index];if(!a)return 0;var s=t.getLineHeight(a.styles.fontSize),i=a.padding("vertical")+s;return i>e?i:e}),0)},e}(),ox=function(){function e(e,t,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var a=e;null==e||"object"!==typeof e||Array.isArray(e)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=null!==(r=e.content)&&void 0!==r?r:e,e._element&&(this.raw=e._element));var s=null!=a?""+a:"";this.text=s.split(/\r\n|\r|\n/g)}return e.prototype.getTextPos=function(){var e,t;if("top"===this.styles.valign)e=this.y+this.padding("top");else if("bottom"===this.styles.valign)e=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");e=this.y+n/2+this.padding("top")}if("right"===this.styles.halign)t=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var r=this.width-this.padding("horizontal");t=this.x+r/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},e.prototype.getContentHeight=function(e,t){void 0===t&&(t=1.15);var n=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/e*t)+this.padding("vertical");return Math.max(n,this.styles.minCellHeight)},e.prototype.padding=function(e){var t=Gb(this.styles.cellPadding,0);return"vertical"===e?t.top+t.bottom:"horizontal"===e?t.left+t.right:t[e]},e}(),lx=function(){function e(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return e.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,r=e.allRows();n<r.length;n++){var a=r[n].cells[this.index];a&&"number"===typeof a.styles.cellWidth&&(t=Math.max(t,a.styles.cellWidth))}return t},e}();function cx(e,t){!function(e,t){var n=e.scaleFactor(),r=t.settings.horizontalPageBreak,a=Yb(e,t);t.allRows().forEach((function(s){for(var i=0,o=t.columns;i<o.length;i++){var l=o[i],c=s.cells[l.index];if(c){var u=t.hooks.didParseCell;t.callCellHooks(e,u,c,s,l,null);var d=c.padding("horizontal");c.contentWidth=Vb(c.text,c.styles,e)+d;var h=Vb(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,e);if(c.minReadableWidth=h+c.padding("horizontal"),"number"===typeof c.styles.cellWidth)c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if("wrap"===c.styles.cellWidth||!0===r)c.contentWidth>a?(c.minWidth=a,c.wrappedWidth=a):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var f=10/n;c.minWidth=c.styles.minCellWidth||f,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}})),t.allRows().forEach((function(e){for(var n=0,r=t.columns;n<r.length;n++){var a=r[n],s=e.cells[a.index];if(s&&1===s.colSpan)a.wrappedWidth=Math.max(a.wrappedWidth,s.wrappedWidth),a.minWidth=Math.max(a.minWidth,s.minWidth),a.minReadableWidth=Math.max(a.minReadableWidth,s.minReadableWidth);else{var i=t.styles.columnStyles[a.dataKey]||t.styles.columnStyles[a.index]||{},o=i.cellWidth||i.minCellWidth;o&&"number"===typeof o&&(a.minWidth=o,a.wrappedWidth=o)}s&&(s.colSpan>1&&!a.minWidth&&(a.minWidth=s.minWidth),s.colSpan>1&&!a.wrappedWidth&&(a.wrappedWidth=s.minWidth))}}))}(e,t);var n=[],r=0;t.columns.forEach((function(e){var a=e.getMaxCustomCellWidth(t);a?e.width=a:(e.width=e.wrappedWidth,n.push(e)),r+=e.width}));var a=t.getWidth(e.pageSize().width)-r;a&&(a=ux(n,a,(function(e){return Math.max(e.minReadableWidth,e.minWidth)}))),a&&(a=ux(n,a,(function(e){return e.minWidth}))),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),function(e){for(var t=e.allRows(),n=0;n<t.length;n++)for(var r=t[n],a=null,s=0,i=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if((i-=1)>1&&e.columns[o+1])s+=l.width,delete r.cells[l.index];else if(a){var c=a;delete r.cells[l.index],a=null,c.width=l.width+s}else{if(!(c=r.cells[l.index]))continue;if(i=c.colSpan,s=0,c.colSpan>1){a=c,s+=l.width;continue}c.width=l.width+s}}}(t),function(e,t){for(var n={count:0,height:0},r=0,a=e.allRows();r<a.length;r++){for(var s=a[r],i=0,o=e.columns;i<o.length;i++){var l=o[i],c=s.cells[l.index];if(c){t.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if("linebreak"===c.styles.overflow)c.text=t.splitTextToSize(c.text,u+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if("ellipsize"===c.styles.overflow)c.text=dx(c.text,u,c.styles,t,"...");else if("hidden"===c.styles.overflow)c.text=dx(c.text,u,c.styles,t,"");else if("function"===typeof c.styles.overflow){var d=c.styles.overflow(c.text,u);c.text="string"===typeof d?[d]:d}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=c.contentHeight/c.rowSpan;c.rowSpan>1&&n.count*n.height<h*c.rowSpan?n={height:h,count:c.rowSpan}:n&&n.count>0&&n.height>h&&(h=n.height),h>s.height&&(s.height=h)}}n.count--}}(t,e),function(e){for(var t={},n=1,r=e.allRows(),a=0;a<r.length;a++)for(var s=r[a],i=0,o=e.columns;i<o.length;i++){var l=o[i],c=t[l.index];if(n>1)n--,delete s.cells[l.index];else if(c)c.cell.height+=s.height,n=c.cell.colSpan,delete s.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var u=s.cells[l.index];if(!u)continue;if(u.height=s.height,u.rowSpan>1){var d=r.length-a,h=u.rowSpan>d?d:u.rowSpan;t[l.index]={cell:u,left:h,row:s}}}}}(t)}function ux(e,t,n){for(var r=t,a=e.reduce((function(e,t){return e+t.wrappedWidth}),0),s=0;s<e.length;s++){var i=e[s],o=r*(i.wrappedWidth/a),l=i.width+o,c=n(i),u=l<c?c:l;t-=u-i.width,i.width=u}if(t=Math.round(1e10*t)/1e10){var d=e.filter((function(e){return!(t<0)||e.width>n(e)}));d.length&&(t=ux(d,t,n))}return t}function dx(e,t,n,r,a){return e.map((function(e){return function(e,t,n,r,a){var s=1e4*r.scaleFactor();if(t=Math.ceil(t*s)/s,t>=Vb(e,n,r))return e;for(;t<Vb(e+a,n,r)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}(e,t,n,r,a)}))}function hx(e,t){var n=new Bb(e),r=function(e,t){var n=e.content,r=function(e){return e.map((function(e,t){var n,r;return r="object"===typeof e&&null!==(n=e.dataKey)&&void 0!==n?n:t,new lx(r,e,t)}))}(n.columns);if(0===n.head.length){(a=px(r,"head"))&&n.head.push(a)}if(0===n.foot.length){var a;(a=px(r,"foot"))&&n.foot.push(a)}var s=e.settings.theme,i=e.styles;return{columns:r,head:fx("head",n.head,r,i,s,t),body:fx("body",n.body,r,i,s,t),foot:fx("foot",n.foot,r,i,s,t)}}(t,n.scaleFactor()),a=new sx(t,r);return cx(n,a),n.applyStyles(n.userStyles),a}function fx(e,t,n,r,a,s){var i={};return t.map((function(t,o){for(var l=0,c={},u=0,d=0,h=0,f=n;h<f.length;h++){var p=f[h];if(null==i[p.index]||0===i[p.index].left)if(0===d){var m=void 0,g={};"object"!==typeof(m=Array.isArray(t)?t[p.index-u-l]:t[p.dataKey])||Array.isArray(m)||(g=(null===m||void 0===m?void 0:m.styles)||{});var v=mx(e,p,o,a,r,s,g),b=new ox(m,v,e);c[p.dataKey]=b,c[p.index]=b,d=b.colSpan-1,i[p.index]={left:b.rowSpan-1,times:d}}else d--,u++;else i[p.index].left--,d=i[p.index].times,l++}return new ix(t,o,e,c)}))}function px(e,t){var n={};return e.forEach((function(e){if(null!=e.raw){var r=function(e,t){if("head"===e){if("object"===typeof t)return t.header||null;if("string"===typeof t||"number"===typeof t)return t}else if("foot"===e&&"object"===typeof t)return t.footer;return null}(t,e.raw);null!=r&&(n[e.dataKey]=r)}})),Object.keys(n).length>0?n:null}function mx(e,t,n,r,a,s,i){var o,l={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[r];"head"===e?o=a.headStyles:"body"===e?o=a.bodyStyles:"foot"===e&&(o=a.footStyles);var c=ex({},l.table,l[e],a.styles,o),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},d="body"===e?u:{},h="body"===e&&n%2===0?ex({},l.alternateRow,a.alternateRowStyles):{},f=function(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(s),p=ex({},f,c,h,d);return ex(p,i)}function gx(e,t,n){var r;void 0===n&&(n={});var a=Yb(e,t),s=new Map,i=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:"string"!==typeof t.settings.horizontalPageBreakRepeat&&"number"!==typeof t.settings.horizontalPageBreakRepeat||(l=[t.settings.horizontalPageBreakRepeat]),l.forEach((function(e){var n=t.columns.find((function(t){return t.dataKey===e||t.index===e}));n&&!s.has(n.index)&&(s.set(n.index,!0),i.push(n.index),o.push(t.columns[n.index]),a-=n.wrappedWidth)}));for(var c=!0,u=null!==(r=null===n||void 0===n?void 0:n.start)&&void 0!==r?r:0;u<t.columns.length;)if(s.has(u))u++;else{var d=t.columns[u].wrappedWidth;if(!(c||a>=d))break;c=!1,i.push(u),o.push(t.columns[u]),a-=d,u++}return{colIndexes:i,columns:o,lastIndex:u-1}}function vx(e,t){var n=t.settings,r=n.startY,a=n.margin,s={x:a.left,y:r},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=r+a.bottom+i;"avoid"===n.pageBreak&&(o+=t.body.reduce((function(e,t){return e+t.height}),0));var l=new Bb(e);("always"===n.pageBreak||null!=n.startY&&o>l.pageSize().height)&&(Ex(l),s.y=a.top),t.callWillDrawPageHooks(l,s);var c=ex({},s);t.startPageNumber=l.pageNumber(),n.horizontalPageBreak?function(e,t,n,r){var a=function(e,t){for(var n=[],r=0;r<t.columns.length;r++){var a=gx(e,t,{start:r});a.columns.length&&(n.push(a),r=a.lastIndex)}return n}(e,t),s=t.settings;if("afterAllRows"===s.horizontalPageBreakBehaviour)a.forEach((function(a,s){e.applyStyles(e.userStyles),s>0?kx(e,t,n,r,a.columns,!0):bx(e,t,r,a.columns),function(e,t,n,r,a){e.applyStyles(e.userStyles),t.body.forEach((function(s,i){var o=i===t.body.length-1;jx(e,t,s,o,n,r,a)}))}(e,t,n,r,a.columns),yx(e,t,r,a.columns)}));else for(var i=-1,o=a[0],l=function(){var s=i;if(o){e.applyStyles(e.userStyles);var l=o.columns;i>=0?kx(e,t,n,r,l,!0):bx(e,t,r,l),s=xx(e,t,i+1,r,l),yx(e,t,r,l)}var c=s-i;a.slice(1).forEach((function(a){e.applyStyles(e.userStyles),kx(e,t,n,r,a.columns,!0),xx(e,t,i+1,r,a.columns,c),yx(e,t,r,a.columns)})),i=s};i<t.body.length-1;)l()}(l,t,c,s):(l.applyStyles(l.userStyles),"firstPage"!==n.showHead&&"everyPage"!==n.showHead||t.head.forEach((function(e){return Nx(l,t,e,s,t.columns)})),l.applyStyles(l.userStyles),t.body.forEach((function(e,n){var r=n===t.body.length-1;jx(l,t,e,r,c,s,t.columns)})),l.applyStyles(l.userStyles),"lastPage"!==n.showFoot&&"everyPage"!==n.showFoot||t.foot.forEach((function(e){return Nx(l,t,e,s,t.columns)}))),Wb(l,t,c,s),t.callEndPageHooks(l,s),t.finalY=s.y,e.lastAutoTable=t,l.applyStyles(l.userStyles)}function bx(e,t,n,r){var a=t.settings;e.applyStyles(e.userStyles),"firstPage"!==a.showHead&&"everyPage"!==a.showHead||t.head.forEach((function(a){return Nx(e,t,a,n,r)}))}function xx(e,t,n,r,a,s){e.applyStyles(e.userStyles),s=null!==s&&void 0!==s?s:t.body.length;var i=Math.min(n+s,t.body.length),o=-1;return t.body.slice(n,i).forEach((function(s,i){var l=n+i===t.body.length-1,c=Cx(e,t,l,r);s.canEntireRowFit(c,a)&&(Nx(e,t,s,r,a),o=n+i)})),o}function yx(e,t,n,r){var a=t.settings;e.applyStyles(e.userStyles),"lastPage"!==a.showFoot&&"everyPage"!==a.showFoot||t.foot.forEach((function(a){return Nx(e,t,a,n,r)}))}function wx(e,t,n){var r=n.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),s=Math.floor((t-a)/r);return Math.max(0,s)}function jx(e,t,n,r,a,s,i){var o=Cx(e,t,r,s);if(n.canEntireRowFit(o,i))Nx(e,t,n,s,i);else if(function(e,t,n,r){var a=e.pageSize().height,s=r.settings.margin,i=a-(s.top+s.bottom);"body"===t.section&&(i-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var o=t.getMinimumRowHeight(r.columns,e),l=o<n;if(o>i)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!l)return!1;var c=t.hasRowSpan(r.columns);return t.getMaxCellHeight(r.columns)>i?(c&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!c&&"avoid"!==r.settings.rowPageBreak}(e,n,o,t)){var l=function(e,t,n,r){var a={};e.spansMultiplePages=!0,e.height=0;for(var s=0,i=0,o=n.columns;i<o.length;i++){var l=o[i];if(g=e.cells[l.index]){Array.isArray(g.text)||(g.text=[g.text]),(m=ex(m=new ox(g.raw,g.styles,g.section),g)).text=[];var c=wx(g,t,r);g.text.length>c&&(m.text=g.text.splice(c,g.text.length));var u=r.scaleFactor(),d=r.getLineHeightFactor();g.contentHeight=g.getContentHeight(u,d),g.contentHeight>=t&&(g.contentHeight=t,m.styles.minCellHeight-=t),g.contentHeight>e.height&&(e.height=g.contentHeight),m.contentHeight=m.getContentHeight(u,d),m.contentHeight>s&&(s=m.contentHeight),a[l.index]=m}}var h=new ix(e.raw,-1,e.section,a,!0);h.height=s;for(var f=0,p=n.columns;f<p.length;f++){var m,g;l=p[f],(m=h.cells[l.index])&&(m.height=h.height),(g=e.cells[l.index])&&(g.height=e.height)}return h}(n,o,t,e);Nx(e,t,n,s,i),kx(e,t,a,s,i),jx(e,t,l,r,a,s,i)}else kx(e,t,a,s,i),jx(e,t,n,r,a,s,i)}function Nx(e,t,n,r,a){r.x=t.settings.margin.left;for(var s=0,i=a;s<i.length;s++){var o=i[s],l=n.cells[o.index];if(l)if(e.applyStyles(l.styles),l.x=r.x,l.y=r.y,!1!==t.callCellHooks(e,t.hooks.willDrawCell,l,n,o,r)){Sx(e,l,r);var c=l.getTextPos();Fb(l.text,c.x,c.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,n,o,r),r.x+=o.width}else r.x+=o.width;else r.x+=o.width}r.y+=n.height}function Sx(e,t,n){var r=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),"number"===typeof r.lineWidth){var a=Hb(r.lineWidth,r.fillColor);a&&e.rect(t.x,n.y,t.width,t.height,a)}else"object"===typeof r.lineWidth&&(r.fillColor&&e.rect(t.x,n.y,t.width,t.height,"F"),function(e,t,n,r){var a,s,i,o;r.top&&(a=n.x,s=n.y,i=n.x+t.width,o=n.y,r.right&&(i+=.5*r.right),r.left&&(a-=.5*r.left),l(r.top,a,s,i,o));r.bottom&&(a=n.x,s=n.y+t.height,i=n.x+t.width,o=n.y+t.height,r.right&&(i+=.5*r.right),r.left&&(a-=.5*r.left),l(r.bottom,a,s,i,o));r.left&&(a=n.x,s=n.y,i=n.x,o=n.y+t.height,r.top&&(s-=.5*r.top),r.bottom&&(o+=.5*r.bottom),l(r.left,a,s,i,o));r.right&&(a=n.x+t.width,s=n.y,i=n.x+t.width,o=n.y+t.height,r.top&&(s-=.5*r.top),r.bottom&&(o+=.5*r.bottom),l(r.right,a,s,i,o));function l(t,n,r,a,s){e.getDocument().setLineWidth(t),e.getDocument().line(n,r,a,s,"S")}}(e,t,n,r.lineWidth))}function Cx(e,t,n,r){var a=t.settings.margin.bottom,s=t.settings.showFoot;return("everyPage"===s||"lastPage"===s&&n)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-r.y-a}function kx(e,t,n,r,a,s){void 0===a&&(a=[]),void 0===s&&(s=!1),e.applyStyles(e.userStyles),"everyPage"!==t.settings.showFoot||s||t.foot.forEach((function(n){return Nx(e,t,n,r,a)})),t.callEndPageHooks(e,r);var i=t.settings.margin;Wb(e,t,n,r),Ex(e),t.pageNumber++,r.x=i.left,r.y=i.top,n.y=i.top,t.callWillDrawPageHooks(e,r),"everyPage"===t.settings.showHead&&(t.head.forEach((function(n){return Nx(e,t,n,r,a)})),e.applyStyles(e.userStyles))}function Ex(e){var t=e.pageNumber();return e.setPage(t+1),e.pageNumber()===t&&(e.addPage(),!0)}try{if("undefined"!==typeof window&&window){var Ax=window,Tx=Ax.jsPDF||(null===(nx=Ax.jspdf)||void 0===nx?void 0:nx.jsPDF);Tx&&function(e){e.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return vx(this,hx(this,tx(this,e[0]))),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(e,t,n,r){Fb(e,t,n,r,this)},e.API.autoTableSetDefaults=function(e){return Bb.setDefaults(e,this),this},e.autoTableSetDefaults=function(e,t){Bb.setDefaults(e,t)},e.API.autoTableHtmlToJson=function(e,t){var n;if(void 0===t&&(t=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=Xb(new Bb(this),e,window,t,!1),a=r.head,s=r.body,i=(null===(n=a[0])||void 0===n?void 0:n.map((function(e){return e.content})))||[];return{columns:i,rows:s,data:s}}}(Tx)}}catch(uw){console.error("Could not apply autoTable plugin",uw)}const Px=function(e){let{client:t,userRole:n,onSave:r,onCancel:a,existingContrat:i=null}=e;const[o,l]=(0,s.useState)(i||{id:Date.now(),clientId:t.id,numero:"C-".concat((new Date).getFullYear(),"-").concat(String(Math.floor(1e3*Math.random())).padStart(3,"0")),date:(new Date).toISOString().split("T")[0],typeProcedure:t.typeProcedure||"",description:"",montant:0,statut:"non_signe",dateSignature:null,fichierContrat:null,fichierSigne:null}),[c,d]=(0,s.useState)(null),[h,f]=(0,s.useState)(!1),p=(0,s.useRef)(null),m=e=>{const{name:t,value:n}=e.target;l(u(u({},o),{},{[t]:n}))};return(0,$r.jsx)("div",{className:"contrat-form-container",children:h?(0,$r.jsxs)("div",{className:"contrat-preview-container",children:[(0,$r.jsx)("h2",{children:"Contrat g\xe9n\xe9r\xe9"}),(0,$r.jsxs)("div",{className:"preview-actions",children:[(0,$r.jsxs)("button",{type:"button",className:"btn-primary",onClick:()=>{const e=new Qg;e.setFontSize(16),e.text("Contrat de services : Programme des Travailleurs Autonomes du Gouvernement du Qu\xe9bec",15,20,{maxWidth:180}),e.setFontSize(10),e.text("No de membre du CRIC : 123456",15,30),e.text("No de dossier Client : ".concat(t.numeroDossier||"_________"),120,30),e.text("Ce contrat de services est \xe9tabli le ".concat((new Date).toLocaleDateString("fr-CA")),15,40),e.setFontSize(12),e.text("Entre",15,50),e.text("(le \xab Client \xbb) ".concat(t.prenom," ").concat(t.nom),15,60),e.setFontSize(10),e.text("Adresse : ".concat(t.adresse||"___________________"),15,70),e.text("T\xe9l\xe9phone : ".concat(t.telephone),15,75),e.text("Courriel : ".concat(t.email),15,80),e.setFontSize(12),e.text("Et",15,90),e.text("(le \xab CRIC \xbb) YassineImmigration Inc.",15,100),e.setFontSize(10),e.text("No de membre du CRIC : 123456",15,110),e.text("Adresse : 1234 Avenue des Consultants, Montr\xe9al, QC, Canada",15,115),e.text("T\xe9l\xe9phone : +1 (514) 123-4567",15,120),e.text("Courriel : contact@yassineimmigration.ca",15,125),e.text("Agissant par l'entremise de son repr\xe9sentant d\xfbment autoris\xe9, Yassine El jamali (le \xab CRIC \xbb),",15,135),e.setFontSize(10),e.text("ATTENDU QUE le CRIC et le Client souhaitent conclure une entente par \xe9crit qui contient les conditions convenues en vertu desquelles le CRIC fournira ses services au Client;",15,145,{maxWidth:180}),e.text("ATTENDU QUE le CRIC est un membre du Conseil de r\xe9glementation des consultants en immigration du Canada (le \xab Conseil \xbb), l'organisme de r\xe9glementation canadien des consultants en immigration;",15,155,{maxWidth:180}),e.setFontSize(12),e.text("LES PARTIES CONVIENNENT DE CE QUI SUIT :",15,170),e.addPage(),e.setFontSize(12),e.text("1. D\xe9finitions",15,20),e.setFontSize(10),e.text("En plus des termes d\xe9finis aux pr\xe9sentes, les termes \xab Client \xbb, \xab Conseil \xbb, \xab D\xe9bours \xbb et \xab CRIC \xbb ont \xe9galement le sens d\xe9finit dans le R\xe8glement r\xe9gissant le contrat de service professionnel du Conseil.",15,30,{maxWidth:180}),e.setFontSize(12),e.text("Objet :",15,45),e.setFontSize(10),e.text("Ce contrat de services a pour objet de d\xe9finir les modalit\xe9s et conditions dans lesquelles YassineImmigration Inc. s'engage \xe0 fournir \xe0 ".concat(t.prenom," ").concat(t.nom," des services de consultation en immigration dans le cadre du Programme des Travailleurs Autonomes du Qu\xe9bec."),15,55,{maxWidth:180}),e.setFontSize(12),e.text("2. Services fournis",15,70),e.setFontSize(10),e.text("YassineImmigration Inc. repr\xe9sentera ".concat(t.prenom," ").concat(t.nom," aupr\xe8s des autorit\xe9s qu\xe9b\xe9coises pour le Programme des Travailleurs Autonomes."),15,80,{maxWidth:180}),e.text("Les services incluent :",15,90),e.text("\u2022 La pr\xe9paration et la soumission des formulaires requis.",20,100),e.text("\u2022 La repr\xe9sentation aupr\xe8s des autorit\xe9s comp\xe9tentes.",20,105),e.text("\u2022 Les conseils li\xe9s \xe0 ce type de dossier.",20,110),e.text("\u2022 Tous les autres services usuels associ\xe9s \xe0 ce type de dossier.",20,115),e.text("Les services du CRIC seront fournis en Fran\xe7ais.",15,125),e.addPage(),e.setFontSize(12),e.text("Signatures :",15,200),e.text("EN FOI DE QUOI ce contrat de services a \xe9t\xe9 d\xfbment sign\xe9 par les parties (le CRIC et le client) \xe0 la date indiqu\xe9e au d\xe9but du pr\xe9sent contrat.",15,210,{maxWidth:180}),e.text("___________________",30,230),e.text("Nom complet et signature",30,240),e.text("Client",30,250),e.text("___________________",130,230),e.text("Nom complet et signature",130,240),e.text("CRIC",130,250),e.text("___________________",30,270),e.text("Date de la signature",30,280),e.text("___________________",130,270),e.text("Date de la signature",130,280),e.save("contrat_".concat(t.prenom,"_").concat(t.nom,".pdf"))},children:[(0,$r.jsx)("i",{className:"fas fa-download"})," T\xe9l\xe9charger en PDF"]}),(0,$r.jsxs)("button",{type:"button",className:"btn-secondary",onClick:()=>window.print(),children:[(0,$r.jsx)("i",{className:"fas fa-print"})," Imprimer"]}),(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:a,children:"Fermer"})]}),(0,$r.jsx)("div",{className:"preview-content",children:(0,$r.jsxs)("div",{className:"contrat-preview",ref:p,children:[(0,$r.jsx)("h2",{children:"Contrat de services : Programme des Travailleurs Autonomes du Gouvernement du Qu\xe9bec"}),(0,$r.jsxs)("div",{className:"contrat-header-info",children:[(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"No de membre du CRIC :"})," 123456"]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"No de dossier Client :"})," ",t.numeroDossier||"_________"]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Ce contrat de services est \xe9tabli le"})," ",(new Date).toLocaleDateString("fr-CA")]})]}),(0,$r.jsxs)("div",{className:"contrat-parties",children:[(0,$r.jsx)("h3",{children:"Entre"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"(le \xab Client \xbb)"})," ",t.prenom," ",t.nom]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Adresse :"})," ",t.adresse||"___________________"]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"T\xe9l\xe9phone :"})," ",t.telephone]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Courriel :"})," ",t.email]}),(0,$r.jsx)("h3",{children:"Et"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"(le \xab CRIC \xbb)"})," YassineImmigration Inc."]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"No de membre du CRIC :"})," 123456"]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Adresse :"})," 1234 Avenue des Consultants, Montr\xe9al, QC, Canada"]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"T\xe9l\xe9phone :"})," +1 (514) 123-4567"]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Courriel :"})," contact@yassineimmigration.ca"]})]}),(0,$r.jsx)("p",{children:"Agissant par l'entremise de son repr\xe9sentant d\xfbment autoris\xe9, Yassine El jamali (le \xab CRIC \xbb),"}),(0,$r.jsxs)("div",{className:"contrat-attendus",children:[(0,$r.jsx)("p",{children:"ATTENDU QUE le CRIC et le Client souhaitent conclure une entente par \xe9crit qui contient les conditions convenues en vertu desquelles le CRIC fournira ses services au Client;"}),(0,$r.jsx)("p",{children:"ATTENDU QUE le CRIC est un membre du Conseil de r\xe9glementation des consultants en immigration du Canada (le \xab Conseil \xbb), l'organisme de r\xe9glementation canadien des consultants en immigration;"})]}),(0,$r.jsx)("h3",{children:"LES PARTIES CONVIENNENT DE CE QUI SUIT :"}),(0,$r.jsxs)("div",{className:"contrat-section",children:[(0,$r.jsx)("h4",{children:"1. D\xe9finitions"}),(0,$r.jsx)("p",{children:"En plus des termes d\xe9finis aux pr\xe9sentes, les termes \xab Client \xbb, \xab Conseil \xbb, \xab D\xe9bours \xbb et \xab CRIC \xbb ont \xe9galement le sens d\xe9finit dans le R\xe8glement r\xe9gissant le contrat de service professionnel du Conseil."})]}),(0,$r.jsxs)("div",{className:"contrat-section",children:[(0,$r.jsx)("h4",{children:"Objet :"}),(0,$r.jsxs)("p",{children:["Ce contrat de services a pour objet de d\xe9finir les modalit\xe9s et conditions dans lesquelles YassineImmigration Inc. s'engage \xe0 fournir \xe0 ",t.prenom," ",t.nom," des services de consultation en immigration dans le cadre du Programme des Travailleurs Autonomes du Qu\xe9bec."]})]}),(0,$r.jsxs)("div",{className:"contrat-section",children:[(0,$r.jsx)("h4",{children:"2. Services fournis"}),(0,$r.jsxs)("p",{children:["YassineImmigration Inc. repr\xe9sentera ",t.prenom," ",t.nom," aupr\xe8s des autorit\xe9s qu\xe9b\xe9coises pour le Programme des Travailleurs Autonomes."]}),(0,$r.jsx)("p",{children:"Les services incluent :"}),(0,$r.jsxs)("ul",{children:[(0,$r.jsx)("li",{children:"La pr\xe9paration et la soumission des formulaires requis."}),(0,$r.jsx)("li",{children:"La repr\xe9sentation aupr\xe8s des autorit\xe9s comp\xe9tentes."}),(0,$r.jsx)("li",{children:"Les conseils li\xe9s \xe0 ce type de dossier."}),(0,$r.jsx)("li",{children:"Tous les autres services usuels associ\xe9s \xe0 ce type de dossier."})]}),(0,$r.jsx)("p",{children:"Les services du CRIC seront fournis en Fran\xe7ais."})]}),(0,$r.jsxs)("div",{className:"contrat-signatures",children:[(0,$r.jsx)("h4",{children:"Signatures :"}),(0,$r.jsx)("p",{children:"EN FOI DE QUOI ce contrat de services a \xe9t\xe9 d\xfbment sign\xe9 par les parties (le CRIC et le client) \xe0 la date indiqu\xe9e au d\xe9but du pr\xe9sent contrat."}),(0,$r.jsxs)("div",{className:"signature-block",children:[(0,$r.jsxs)("div",{className:"signature-line",children:[(0,$r.jsx)("p",{children:"___________________"}),(0,$r.jsx)("p",{children:"Nom complet et signature"}),(0,$r.jsx)("p",{children:"Client"})]}),(0,$r.jsxs)("div",{className:"signature-line",children:[(0,$r.jsx)("p",{children:"___________________"}),(0,$r.jsx)("p",{children:"Nom complet et signature"}),(0,$r.jsx)("p",{children:"CRIC"})]})]}),(0,$r.jsxs)("div",{className:"signature-block",children:[(0,$r.jsxs)("div",{className:"signature-line",children:[(0,$r.jsx)("p",{children:"___________________"}),(0,$r.jsx)("p",{children:"Date de la signature"})]}),(0,$r.jsxs)("div",{className:"signature-line",children:[(0,$r.jsx)("p",{children:"___________________"}),(0,$r.jsx)("p",{children:"Date de la signature"})]})]})]})]})}),(0,$r.jsxs)("div",{className:"upload-section",children:[(0,$r.jsx)("h3",{children:"T\xe9l\xe9verser le contrat sign\xe9"}),(0,$r.jsx)("p",{children:"Apr\xe8s impression et signature du contrat, veuillez scanner le document sign\xe9 et le t\xe9l\xe9verser ci-dessous :"}),(0,$r.jsxs)("div",{className:"upload-controls",children:[(0,$r.jsx)("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{d(e.target.files[0])}}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>{if(!c)return void alert("Veuillez s\xe9lectionner un fichier");const e=u(u({},o),{},{fichierSigne:c.name,statut:"signe",dateSignature:(new Date).toISOString()});l(e),r(e)},disabled:!c,children:"T\xe9l\xe9verser le contrat sign\xe9"})]})]})]}):(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("h2",{children:i?"D\xe9tails du contrat":"Nouveau contrat"}),(0,$r.jsxs)("div",{className:"contrat-header",children:[(0,$r.jsxs)("div",{className:"contrat-info",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Num\xe9ro de contrat"}),(0,$r.jsx)("input",{type:"text",name:"numero",value:o.numero,readOnly:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date"}),(0,$r.jsx)("input",{type:"date",name:"date",value:o.date,onChange:m,disabled:"signe"===o.statut})]})]}),(0,$r.jsxs)("div",{className:"client-info",children:[(0,$r.jsx)("h3",{children:"Client"}),(0,$r.jsxs)("p",{children:[t.prenom," ",t.nom]}),(0,$r.jsx)("p",{children:t.email}),(0,$r.jsx)("p",{children:t.telephone}),(0,$r.jsxs)("p",{children:["Dossier: ",t.numeroDossier]})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Type de proc\xe9dure"}),(0,$r.jsxs)("select",{name:"typeProcedure",value:o.typeProcedure,onChange:m,disabled:"signe"===o.statut,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),(0,$r.jsx)("option",{value:"Permis d'\xe9tudes",children:"Permis d'\xe9tudes"}),(0,$r.jsx)("option",{value:"Permis de travail",children:"Permis de travail"}),(0,$r.jsx)("option",{value:"R\xe9sidence permanente",children:"R\xe9sidence permanente"}),(0,$r.jsx)("option",{value:"Visa visiteur",children:"Visa visiteur"}),(0,$r.jsx)("option",{value:"Citoyennet\xe9",children:"Citoyennet\xe9"}),(0,$r.jsx)("option",{value:"Programme des Travailleurs Autonomes",children:"Programme des Travailleurs Autonomes"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Montant total"}),(0,$r.jsx)("input",{type:"number",name:"montant",value:o.montant,onChange:m,disabled:"signe"===o.statut})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Description / D\xe9tails"}),(0,$r.jsx)("textarea",{name:"description",value:o.description,onChange:m,disabled:"signe"===o.statut})]}),(0,$r.jsxs)("div",{className:"contrat-status",children:[(0,$r.jsxs)("div",{className:"status-badge",children:["Statut: ",(0,$r.jsx)("span",{className:"status-".concat(o.statut),children:"non_signe"===o.statut?"Non sign\xe9":"signe"===o.statut?"Sign\xe9":"Archiv\xe9"})]}),o.dateSignature&&(0,$r.jsxs)("div",{className:"signature-info",children:["Sign\xe9 le ",new Date(o.dateSignature).toLocaleDateString()]})]}),(0,$r.jsx)("div",{className:"form-actions",children:"non_signe"===o.statut?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:a,children:"Annuler"}),!o.fichierContrat&&(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>{const e=document.createElement("div");e.className="generating-message",e.innerHTML='<i class="fas fa-spinner fa-spin"></i> G\xe9n\xe9ration du contrat en cours...',document.body.appendChild(e),setTimeout((()=>{document.body.removeChild(e);const t=u(u({},o),{},{fichierContrat:"contrat_genere.pdf",statut:"non_signe"});l(t),f(!0)}),1500)},children:"G\xe9n\xe9rer le contrat"})]}):(0,$r.jsx)($r.Fragment,{children:(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:a,children:"Fermer"})})})]})})};console.log("AFFICHAGE : ClientDetailModal.js");const _x=function(e){var t,n;let{client:r,lead:a,modalType:i="client",isOpen:o=!0,onClose:l,readOnly:c=!1,onEdit:u,showAll:d=!1}=e;const[h,f]=(0,s.useState)("general"),p="lead"===i?a:r,m="lead"===i?"\ud83c\udfaf":"\ud83d\udc64";if(!o||!p)return null;const g=e=>{if(!e)return"Non renseign\xe9";try{return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}catch(uw){return"Date invalide"}};function v(e){const t=document.createElement("a");t.href=e.chemin_fichier,t.download=e.nom_fichier,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),console.log("\ud83d\udce5 T\xe9l\xe9chargement initi\xe9 : ".concat(e.nom_fichier))}const b=()=>{let e=[];if(r.notes)if(Array.isArray(r.notes))e=r.notes.filter((e=>e&&(e.contenu||e.texte)));else if("string"===typeof r.notes)try{const t=JSON.parse(r.notes);e=Array.isArray(t)?t.filter((e=>e&&(e.contenu||e.texte))):[]}catch(cw){e=[{id:1,date:r.date_creation||(new Date).toISOString(),type:"G\xe9n\xe9ral",auteur:r.conseillere||"Syst\xe8me",contenu:r.notes}]}return'\n      <div class="print-container">\n        \x3c!-- En-t\xeate --\x3e\n        <div class="print-header">\n          <h1>DOSSIER CLIENT</h1>\n          <div class="client-title">\n            '.concat(r.prenom," ").concat(r.nom,"\n            ").concat(r.urgence?'<span class="urgent-badge">URGENT</span>':"",'\n          </div>\n          <div class="meta-info">\n            <span class="procedure">').concat(r.type_procedure,'</span>\n            <span class="statut">').concat(r.statut,'</span>\n            <span class="dossier">Dossier: ').concat(r.numero_dossier,'</span>\n          </div>\n          <div class="print-date">Document g\xe9n\xe9r\xe9 le ').concat((new Date).toLocaleDateString("fr-FR")," \xe0 ").concat((new Date).toLocaleTimeString("fr-FR"),'</div>\n        </div>\n\n        \x3c!-- Informations personnelles --\x3e\n        <div class="print-section">\n          <h2>\ud83d\udccb INFORMATIONS PERSONNELLES</h2>\n          <div class="info-grid">\n            <div class="info-group">\n              <h3>Identit\xe9</h3>\n              <div class="info-item"><strong>Nom complet:</strong> ').concat(r.prenom," ").concat(r.nom,'</div>\n              <div class="info-item"><strong>Date de naissance:</strong> ').concat(g(r.date_naissance),'</div>\n              <div class="info-item"><strong>Nationalit\xe9:</strong> ').concat(r.nationalite||"Non renseign\xe9e",'</div>\n            </div>\n            <div class="info-group">\n              <h3>Contact principal</h3>\n              <div class="info-item"><strong>Email:</strong> ').concat(r.email,'</div>\n              <div class="info-item"><strong>T\xe9l\xe9phone:</strong> ').concat(r.telephone,'</div>\n              <div class="info-item"><strong>Adresse:</strong> ').concat(r.adresse||"Non renseign\xe9e",'</div>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Contact alternatif --\x3e\n        <div class="print-section">\n          <h2>\ud83d\udcde CONTACT ALTERNATIF</h2>\n          <div class="info-grid">\n            <div class="info-item"><strong>Nom:</strong> ').concat(r.contact_nom||"Non renseign\xe9",'</div>\n            <div class="info-item"><strong>Pr\xe9nom:</strong> ').concat(r.contact_prenom||"Non renseign\xe9",'</div>\n            <div class="info-item"><strong>Relation:</strong> ').concat(r.contact_relation||"Non renseign\xe9e",'</div>\n            <div class="info-item"><strong>T\xe9l\xe9phone:</strong> ').concat(r.contact_telephone||"Non renseign\xe9",'</div>\n            <div class="info-item"><strong>Email:</strong> ').concat(r.contact_email||"Non renseign\xe9",'</div>\n          </div>\n        </div>\n\n        \x3c!-- Informations sur la proc\xe9dure --\x3e\n        <div class="print-section">\n          <h2>\u2696\ufe0f INFORMATIONS SUR LA PROC\xc9DURE</h2>\n          <div class="info-grid">\n            <div class="info-item"><strong>Type de proc\xe9dure:</strong> ').concat(r.type_procedure,'</div>\n            <div class="info-item"><strong>Statut actuel:</strong> ').concat(r.statut,'</div>\n            <div class="info-item"><strong>Priorit\xe9:</strong> ').concat(r.urgence?"URGENT":"Normal",'</div>\n            <div class="info-item"><strong>Conseill\xe8re assign\xe9e:</strong> ').concat(r.conseillere||"Non assign\xe9e",'</div>\n            <div class="info-item"><strong>Num\xe9ro de dossier:</strong> ').concat(r.numero_dossier,'</div>\n            <div class="info-item"><strong>Date de cr\xe9ation:</strong> ').concat(g(r.date_creation),'</div>\n            <div class="info-item"><strong>Derni\xe8re modification:</strong> ').concat(g(r.date_modification),"</div>\n          </div>\n        </div>\n\n        \x3c!-- Informations sp\xe9cifiques --\x3e\n        ").concat(r.informations_specifiques?'\n          <div class="print-section">\n            <h2>\ud83d\udcdd INFORMATIONS SP\xc9CIFIQUES</h2>\n            <div class="specific-info">\n              '.concat(x(r.informations_specifiques),"\n            </div>\n          </div>\n        "):"",'\n\n        \x3c!-- Documents --\x3e\n        <div class="print-section">\n          <h2>\ud83d\udcc1 Documents du dossier</h2>\n          ').concat(r.documents&&r.documents.length>0?'\n            <table class="documents-table">\n              <thead>\n                <tr>\n                  <th>Type de document</th>\n                  <th>Nom du fichier</th>\n                  <th>Date de t\xe9l\xe9versement</th>\n                </tr>\n              </thead>\n              <tbody>\n                '.concat(r.documents.map((e=>"\n                  <tr>\n                    <td>".concat(e.type_document,"</td>\n                    <td>").concat(e.nom_fichier,"</td>\n                    <td>").concat(g(e.date_televersement),"</td>\n                  </tr>\n                "))).join(""),"\n              </tbody>\n            </table>\n          "):'\n            <p style="text-align: center; color: #666; font-style: italic; padding: 20px;">\n              Aucun document t\xe9l\xe9vers\xe9 pour ce client\n            </p>\n          ',"\n        </div>\n\n        \x3c!-- Notes --\x3e\n        ").concat(e.length>0?'\n          <div class="print-section">\n            <h2>\ud83d\udcdd NOTES DU DOSSIER</h2>\n            <div class="notes-list">\n              '.concat(e.sort(((e,t)=>new Date(t.date)-new Date(e.date))).map((e=>'\n                <div class="note-item">\n                  <div class="note-header">\n                    <span class="note-date">'.concat(g(e.date),'</span>\n                    <span class="note-author">').concat(e.auteur||"Syst\xe8me",'</span>\n                    <span class="note-type">').concat(e.type||"G\xe9n\xe9ral",'</span>\n                  </div>\n                  <div class="note-content">').concat(e.contenu||e.texte||"Aucun contenu","</div>\n                </div>\n              "))).join(""),"\n            </div>\n          </div>\n        "):"",'\n\n        \x3c!-- Pied de page --\x3e\n        <div class="print-footer">\n          <p>Document confidentiel - Usage interne uniquement</p>\n          <p>G\xe9n\xe9r\xe9 automatiquement depuis le syst\xe8me de gestion des clients</p>\n        </div>\n      </div>\n    ')},x=e=>{if(!e)return"";try{const t="string"===typeof e?JSON.parse(e):e;if(0===Object.keys(t).length)return"";const n={fondsDisponibles:"Fonds disponibles",situationFamiliale:"Situation familiale",dateVoyage:"Date de voyage pr\xe9vue",emploi:"Situation d'emploi",invitation:"Lettre d'invitation",lienParenteInvitant:"Lien de parent\xe9 avec l'invitant",niveauEtudes:"Niveau d'\xe9tudes",institutionProposee:"Institution propos\xe9e",programmeEtudes:"Programme d'\xe9tudes",dureeEtudes:"Dur\xe9e des \xe9tudes",coutEtudes:"Co\xfbt des \xe9tudes",preuvesFinancieres:"Preuves financi\xe8res",offreEmploi:"Offre d'emploi",employeur:"Employeur",posteOffert:"Poste offert",salaireOffert:"Salaire offert",lieuTravail:"Lieu de travail",experienceProfessionnelle:"Exp\xe9rience professionnelle",competencesLinguistiques:"Comp\xe9tences linguistiques",familleCanada:"Famille au Canada",parentsCanada:"Parents au Canada",relationFamiliale:"Relation familiale",documentsSoutien:"Documents de soutien"},r=(e,t)=>null===t||void 0===t?"Non renseign\xe9":"object"===typeof t&&null!==t?Array.isArray(t)?t.join(", ")||"Non renseign\xe9":Object.entries(t).map((e=>{let[t,n]=e;return"".concat(t,": ").concat(n)})).join(", ")||"Non renseign\xe9":!0===t||"oui"===t||"yes"===t?"Oui":!1===t||"non"===t||"no"===t?"Non":"dateVoyage"===e&&t?g(t):"fondsDisponibles"===e&&t?"".concat(t," CAD"):String(t)||"Non renseign\xe9";return Object.entries(t).filter((e=>{let[t]=e;return!1===!isNaN(t)})).map((e=>{let[t,a]=e;return'\n          <div class="info-item">\n            <strong>'.concat(n[t]||t,":</strong> ").concat(r(t,a),"\n          </div>\n        ")})).join("")}catch(uw){return'<div class="info-item">'.concat(String(e),"</div>")}},y=()=>"\n      @page {\n        margin: 2cm;\n        size: A4;\n      }\n      \n      body {\n        font-family: Arial, sans-serif;\n        font-size: 12px;\n        line-height: 1.4;\n        color: #000;\n        margin: 0;\n        padding: 0;\n      }\n      \n      .print-container {\n        max-width: 100%;\n        margin: 0;\n        padding: 0;\n      }\n      \n      .print-header {\n        text-align: center;\n        margin-bottom: 30px;\n        border-bottom: 2px solid #000;\n        padding-bottom: 15px;\n      }\n      \n      .print-header h1 {\n        margin: 0 0 10px 0;\n        font-size: 24px;\n        font-weight: bold;\n      }\n      \n      .client-title {\n        font-size: 18px;\n        font-weight: bold;\n        margin: 10px 0;\n      }\n      \n      .urgent-badge {\n        background: #dc3545;\n        color: white;\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 12px;\n        margin-left: 10px;\n      }\n      \n      .meta-info {\n        margin: 10px 0;\n        font-size: 14px;\n      }\n      \n      .meta-info span {\n        margin: 0 10px;\n        padding: 4px 8px;\n        background: #f8f9fa;\n        border-radius: 4px;\n      }\n      \n      .print-date {\n        font-size: 10px;\n        color: #666;\n        margin-top: 10px;\n      }\n      \n      .print-section {\n        margin-bottom: 25px;\n        page-break-inside: avoid;\n      }\n      \n      .print-section h2 {\n        font-size: 16px;\n        font-weight: bold;\n        margin: 0 0 15px 0;\n        padding: 8px 0;\n        border-bottom: 1px solid #ccc;\n      }\n      \n      .print-section h3 {\n        font-size: 14px;\n        font-weight: bold;\n        margin: 0 0 10px 0;\n        color: #333;\n      }\n      \n      .info-grid {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 20px;\n        margin-bottom: 15px;\n      }\n      \n      .info-group {\n        margin-bottom: 15px;\n      }\n      \n      .info-item {\n        margin-bottom: 5px;\n        padding: 3px 0;\n      }\n      \n      .info-item strong {\n        font-weight: bold;\n        color: #000;\n      }\n      \n      .documents-table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-top: 10px;\n      }\n      \n      .documents-table th,\n      .documents-table td {\n        border: 1px solid #ccc;\n        padding: 8px;\n        text-align: left;\n      }\n      \n      .documents-table th {\n        background-color: #f8f9fa;\n        font-weight: bold;\n      }\n      \n      .status-fourni {\n        background-color: #d4edda;\n        color: #155724;\n        font-weight: bold;\n      }\n      \n      .status-manquant {\n        background-color: #f8d7da;\n        color: #721c24;\n        font-weight: bold;\n      }\n      \n      .notes-list {\n        margin-top: 10px;\n      }\n      \n      .note-item {\n        margin-bottom: 15px;\n        padding: 10px;\n        border: 1px solid #ddd;\n        border-radius: 4px;\n        page-break-inside: avoid;\n      }\n      \n      .note-header {\n        margin-bottom: 8px;\n        padding-bottom: 5px;\n        border-bottom: 1px solid #eee;\n        font-size: 11px;\n      }\n      \n      .note-date,\n      .note-author,\n      .note-type {\n        margin-right: 15px;\n        font-weight: bold;\n      }\n      \n      .note-content {\n        font-size: 12px;\n        line-height: 1.5;\n      }\n      \n      .print-footer {\n        margin-top: 30px;\n        padding-top: 15px;\n        border-top: 1px solid #ccc;\n        text-align: center;\n        font-size: 10px;\n        color: #666;\n      }\n      \n      .specific-info .info-item {\n        display: block;\n        margin-bottom: 5px;\n      }\n      \n      @media print {\n        body {\n          -webkit-print-color-adjust: exact;\n          print-color-adjust: exact;\n        }\n        \n        .print-section {\n          page-break-inside: avoid;\n        }\n        \n        .note-item {\n          page-break-inside: avoid;\n        }\n      }\n    ";return(0,$r.jsx)("div",{className:"modal-overlay",onClick:l,children:(0,$r.jsxs)("div",{className:"modal-content client-detail-modal-large",style:{width:"95vw"},onClick:e=>e.stopPropagation(),children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsxs)("div",{className:"client-identity",children:[(0,$r.jsxs)("h2",{children:[m," ",p.prenom," ",p.nom,p.urgence&&(0,$r.jsx)("span",{className:"urgent-badge",children:"\ud83d\udd34 URGENT"})]}),(0,$r.jsxs)("div",{className:"client-meta",children:[(0,$r.jsx)("span",{className:"badge type-badge",children:"lead"===i?"Lead":"Client"}),p.type_procedure&&(0,$r.jsx)("span",{className:"badge procedure-badge",children:p.type_procedure}),p.statut&&(0,$r.jsx)("span",{className:"badge statut-badge statut-".concat(null===(t=p.statut)||void 0===t?void 0:t.toLowerCase().replace(/\s+/g,"-")),children:p.statut}),p.numero_dossier&&(0,$r.jsxs)("span",{className:"dossier-number",children:["\ud83d\udcc2 ",p.numero_dossier]})]})]}),(0,$r.jsx)("button",{className:"close-button",onClick:l,children:(0,$r.jsx)("i",{className:"fas fa-times"})})]}),!d&&(0,$r.jsxs)("div",{className:"tab-navigation",children:[(0,$r.jsxs)("button",{className:"tab-btn ".concat("general"===h?"active":""),onClick:()=>f("general"),children:[(0,$r.jsx)("i",{className:"fas fa-user"})," Informations g\xe9n\xe9rales"]}),(0,$r.jsxs)("button",{className:"tab-btn ".concat("contact"===h?"active":""),onClick:()=>f("contact"),children:[(0,$r.jsx)("i",{className:"fas fa-address-book"})," Contact"]}),(0,$r.jsxs)("button",{className:"tab-btn ".concat("procedure"===h?"active":""),onClick:()=>f("procedure"),children:[(0,$r.jsx)("i",{className:"fas fa-file-alt"})," Proc\xe9dure"]}),(0,$r.jsxs)("button",{className:"tab-btn ".concat("specifiques"===h?"active":""),onClick:()=>f("specifiques"),children:[(0,$r.jsx)("i",{className:"fas fa-list-ul"})," D\xe9tails sp\xe9cifiques"]}),(0,$r.jsxs)("button",{className:"tab-btn ".concat("documents"===h?"active":""),onClick:()=>f("documents"),children:[(0,$r.jsx)("i",{className:"fas fa-folder"})," Documents"]}),(0,$r.jsxs)("button",{className:"tab-btn ".concat("notes"===h?"active":""),onClick:()=>f("notes"),children:[(0,$r.jsx)("i",{className:"fas fa-sticky-note"})," Notes"]})]}),(0,$r.jsxs)("div",{className:"modal-body",children:[(d||"general"===h)&&(0,$r.jsxs)("div",{className:"tab-content",children:[(0,$r.jsx)("h3",{children:"\ud83d\udccb Informations personnelles"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-id-card"}),(0,$r.jsx)("span",{children:"Identit\xe9"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Nom complet:"}),(0,$r.jsxs)("span",{className:"info-value",children:[p.prenom," ",p.nom]})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Date de naissance:"}),(0,$r.jsx)("span",{className:"info-value",children:g(p.date_naissance)})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Nationalit\xe9:"}),(0,$r.jsx)("span",{className:"info-value",children:p.nationalite||"Non renseign\xe9e"})]})]})]}),(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-envelope"}),(0,$r.jsx)("span",{children:"Contact principal"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Email:"}),(0,$r.jsx)("span",{className:"info-value",children:p.email})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{className:"info-value",children:p.telephone})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Adresse:"}),(0,$r.jsx)("span",{className:"info-value address-text",children:p.adresse||"Non renseign\xe9e"})]})]})]}),(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-cog"}),(0,$r.jsx)("span",{children:"Gestion du dossier"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[p.numero_dossier&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Num\xe9ro de dossier:"}),(0,$r.jsx)("span",{className:"info-value dossier-highlight",children:p.numero_dossier})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Conseill\xe8re assign\xe9e:"}),(0,$r.jsx)("span",{className:"info-value",children:p.conseillere||"Non assign\xe9e"})]}),"client"===i&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Login client:"}),(0,$r.jsx)("span",{className:"info-value",children:p.login_client||"Non cr\xe9\xe9"})]}),"lead"===i&&p.source&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Source du lead:"}),(0,$r.jsx)("span",{className:"info-value",children:p.source})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Date de cr\xe9ation:"}),(0,$r.jsx)("span",{className:"info-value",children:g(p.date_creation||p.createdAt)})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Derni\xe8re modification:"}),(0,$r.jsx)("span",{className:"info-value",children:g(p.date_modification||p.updatedAt)})]})]})]})]})]}),(d||"contact"===h)&&(0,$r.jsxs)("div",{className:"tab-content",children:[(0,$r.jsx)("h3",{children:"\ud83d\udcde Informations de contact"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-user"}),(0,$r.jsx)("span",{children:"Contact principal"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Nom complet:"}),(0,$r.jsxs)("span",{className:"info-value",children:[p.prenom," ",p.nom]})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Email:"}),(0,$r.jsx)("span",{className:"info-value",children:p.email})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{className:"info-value",children:p.telephone})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Adresse compl\xe8te:"}),(0,$r.jsx)("span",{className:"info-value address-text",children:p.adresse||"Non renseign\xe9e"})]})]})]}),(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-users"}),(0,$r.jsx)("span",{children:"Contact alternatif / R\xe9f\xe9rence"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Nom:"}),(0,$r.jsx)("span",{className:"info-value",children:p.contact_nom||"Non renseign\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Pr\xe9nom:"}),(0,$r.jsx)("span",{className:"info-value",children:p.contact_prenom||"Non renseign\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Relation:"}),(0,$r.jsx)("span",{className:"info-value",children:p.contact_relation||"Non renseign\xe9e"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{className:"info-value",children:p.contact_telephone||"Non renseign\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Email:"}),(0,$r.jsx)("span",{className:"info-value",children:p.contact_email||"Non renseign\xe9"})]})]})]})]})]}),(d||"procedure"===h)&&(0,$r.jsxs)("div",{className:"tab-content",children:[(0,$r.jsx)("h3",{children:"\u2696\ufe0f Informations sur la proc\xe9dure"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-file-contract"}),(0,$r.jsx)("span",{children:"Type et statut"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[p.type_procedure&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Type de proc\xe9dure:"}),(0,$r.jsx)("span",{className:"info-value procedure-highlight",children:p.type_procedure})]}),p.statut&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Statut actuel:"}),(0,$r.jsx)("span",{className:"info-value statut-highlight statut-".concat(null===(n=p.statut)||void 0===n?void 0:n.toLowerCase().replace(/\s+/g,"-")),children:p.statut})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Priorit\xe9:"}),(0,$r.jsx)("span",{className:"info-value ".concat(p.urgence?"urgent":"normal"),children:p.urgence?"\ud83d\udd34 URGENT":"\ud83d\udfe2 Normal"})]})]})]}),(0,$r.jsxs)("div",{className:"info-card",children:[(0,$r.jsxs)("div",{className:"info-header",children:[(0,$r.jsx)("i",{className:"fas fa-user-tie"}),(0,$r.jsx)("span",{children:"Gestion"})]}),(0,$r.jsxs)("div",{className:"info-items",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Conseill\xe8re assign\xe9e:"}),(0,$r.jsx)("span",{className:"info-value",children:p.conseillere||"Non assign\xe9e"})]}),p.numero_dossier&&(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Num\xe9ro de dossier:"}),(0,$r.jsx)("span",{className:"info-value dossier-highlight",children:p.numero_dossier})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Date de cr\xe9ation:"}),(0,$r.jsx)("span",{className:"info-value",children:g(p.date_creation||p.createdAt)})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("span",{className:"info-label",children:"Derni\xe8re modification:"}),(0,$r.jsx)("span",{className:"info-value",children:g(p.date_modification||p.updatedAt)})]})]})]})]})]}),(d||"specifiques"===h)&&(0,$r.jsxs)("div",{className:"tab-content",children:[(0,$r.jsx)("h3",{children:"\ud83d\udcdd Informations sp\xe9cifiques \xe0 la proc\xe9dure"}),(e=>{if(!e)return null;try{const t="string"===typeof e?JSON.parse(e):e;if(0===Object.keys(t).length)return null;const n={fondsDisponibles:"Fonds disponibles",situationFamiliale:"Situation familiale",dateVoyage:"Date de voyage pr\xe9vue",emploi:"Situation d'emploi",invitation:"Lettre d'invitation",lienParenteInvitant:"Lien de parent\xe9 avec l'invitant",niveauEtudes:"Niveau d'\xe9tudes",institutionProposee:"Institution propos\xe9e",programmeEtudes:"Programme d'\xe9tudes",dureeEtudes:"Dur\xe9e des \xe9tudes",coutEtudes:"Co\xfbt des \xe9tudes",preuvesFinancieres:"Preuves financi\xe8res",offreEmploi:"Offre d'emploi",employeur:"Employeur",posteOffert:"Poste offert",salaireOffert:"Salaire offert",lieuTravail:"Lieu de travail",experienceProfessionnelle:"Exp\xe9rience professionnelle",competencesLinguistiques:"Comp\xe9tences linguistiques",familleCanada:"Famille au Canada",parentsCanada:"Parents au Canada",relationFamiliale:"Relation familiale",documentsSoutien:"Documents de soutien"},r=(e,t)=>null===t||void 0===t?"Non renseign\xe9":"object"===typeof t&&null!==t?Array.isArray(t)?t.join(", ")||"Non renseign\xe9":Object.entries(t).map((e=>{let[t,n]=e;return"".concat(t,": ").concat(n)})).join(", ")||"Non renseign\xe9":!0===t||"oui"===t||"yes"===t?"\u2705 Oui":!1===t||"non"===t||"no"===t?"\u274c Non":"dateVoyage"===e&&t?g(t):"fondsDisponibles"===e&&t?"".concat(t," CAD"):String(t)||"Non renseign\xe9";return(0,$r.jsxs)("div",{className:"info-specifiques",children:[(0,$r.jsx)("h4",{children:"\ud83d\udccb Informations sp\xe9cifiques \xe0 la proc\xe9dure"}),(0,$r.jsx)("div",{className:"info-grid",children:Object.entries(t).map((e=>{let[t,a]=e;return isNaN(t)?(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsxs)("span",{className:"info-label",children:[n[t]||t,":"]}),(0,$r.jsx)("span",{className:"info-value",children:r(t,a)})]},t):null}))})]})}catch(uw){return console.error("Erreur lors du parsing des informations sp\xe9cifiques:",uw),(0,$r.jsxs)("div",{className:"info-specifiques",children:[(0,$r.jsx)("h4",{children:"\ud83d\udccb Informations sp\xe9cifiques"}),(0,$r.jsx)("div",{className:"info-raw",children:(0,$r.jsx)("pre",{children:e})})]})}})(p.informations_specifiques)]}),(d||"documents"===h)&&(0,$r.jsxs)("div",{className:"tab-content",children:[(0,$r.jsx)("h3",{children:"\ud83d\udcc1 Documents du dossier"}),(0,$r.jsx)("div",{className:"documents-table-container",children:p.documents&&p.documents.length>0?(0,$r.jsxs)("table",{className:"documents-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Type de document"}),(0,$r.jsx)("th",{children:"Nom du fichier"}),(0,$r.jsx)("th",{children:"Date de t\xe9l\xe9versement"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:p.documents.map((e=>(0,$r.jsxs)("tr",{className:"document-provided",children:[(0,$r.jsx)("td",{className:"document-name-cell",children:(0,$r.jsx)("span",{className:"document-name",children:e.type_document})}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"file-info",children:[(0,$r.jsx)("i",{className:"fas fa-file-pdf text-success"}),(0,$r.jsx)("span",{className:"file-name",children:e.nom_fichier})]})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"upload-date",children:g(e.date_televersement)})}),(0,$r.jsxs)("td",{className:"actions-cell",children:[(0,$r.jsx)("button",{className:"btn-icon",onClick:()=>function(e){const t=window.open("","_blank","width=900,height=700"),n=e.nom_fichier.toLowerCase(),a=n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".png")||n.endsWith(".gif"),s=n.endsWith(".pdf");let i=e.chemin_fichier;if(i.includes("uploads")){const e=i.indexOf("uploads"),t=i.substring(e).replace(/\\/g,"/");i="http://localhost:5000/".concat(t)}else i="http://localhost:5000/uploads/clients/".concat(r.id||"undefined","/").concat(e.nom_fichier);t.document.write("\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Aper\xe7u - ".concat(e.nom_fichier,'</title>\n          <style>\n            body {\n              font-family: Arial, sans-serif;\n              margin: 0;\n              padding: 20px;\n              background: #f5f5f5;\n            }\n            .document-preview {\n              max-width: 100%;\n              margin: 0 auto;\n              background: white;\n              padding: 20px;\n              border-radius: 8px;\n              box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n            }\n            .document-header {\n              border-bottom: 2px solid #3498db;\n              padding-bottom: 15px;\n              margin-bottom: 20px;\n              text-align: center;\n            }\n            .document-title {\n              font-size: 24px;\n              color: #2c3e50;\n              margin: 0 0 10px 0;\n            }\n            .document-info {\n              color: #666;\n              font-size: 14px;\n            }\n            .document-content {\n              text-align: center;\n              margin: 20px 0;\n              max-height: 500px;\n              overflow: auto;\n            }\n            .document-image {\n              max-width: 100%;\n              max-height: 500px;\n              border: 2px solid #ddd;\n              border-radius: 8px;\n              box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n            }\n            .pdf-frame {\n              width: 100%;\n              height: 500px;\n              border: 2px solid #ddd;\n              border-radius: 8px;\n            }\n            .document-actions {\n              margin-top: 20px;\n              text-align: center;\n            }\n            .btn {\n              background: #3498db;\n              color: white;\n              padding: 10px 20px;\n              border: none;\n              border-radius: 5px;\n              cursor: pointer;\n              margin: 0 10px;\n              text-decoration: none;\n              display: inline-block;\n              font-size: 14px;\n            }\n            .btn:hover {\n              background: #2980b9;\n            }\n            .error-message {\n              color: #e74c3c;\n              background: #fdf2f2;\n              padding: 15px;\n              border-radius: 8px;\n              border-left: 4px solid #e74c3c;\n              margin: 20px 0;\n            }\n\n          </style>\n        </head>\n        <body>\n          <div class="document-preview">\n            <div class="document-header">\n              <h1 class="document-title">\ud83d\udcc4 ').concat(e.nom_fichier,'</h1>\n              <div class="document-info">\n                <strong>Type :</strong> ').concat(e.type_document," | \n                <strong>Date :</strong> ").concat(new Date(e.date_televersement).toLocaleDateString("fr-FR"),'\n              </div>\n            </div>\n            \n            <div class="document-content">\n              ').concat(a?'\n                <img src="'.concat(i,'" alt="').concat(e.nom_fichier,'" class="document-image" \n                     onerror="this.style.display=\'none\'; document.getElementById(\'error-msg\').style.display=\'block\';" />\n                <div id="error-msg" class="error-message" style="display:none;">\n                  <strong>Impossible d\'afficher l\'image</strong><br>\n                  Le fichier pourrait ne pas \xeatre accessible ou le chemin est incorrect.<br>\n                  <strong>URL test\xe9e :</strong> ').concat(i,"<br>\n                  <strong>Chemin original :</strong> ").concat(e.chemin_fichier,"\n                </div>\n              "):s?'\n                <iframe src="'.concat(i,'" class="pdf-frame" \n                        onerror="document.getElementById(\'pdf-error\').style.display=\'block\';">\n                </iframe>\n                <div id="pdf-error" class="error-message" style="display:none;">\n                  <strong>Impossible d\'afficher le PDF</strong><br>\n                  <a href="').concat(i,'" target="_blank">Cliquer ici pour ouvrir le PDF dans un nouvel onglet</a>\n                </div>\n              '):'\n                <div class="error-message">\n                  <strong>Aper\xe7u non disponible pour ce type de fichier</strong><br>\n                  Type : '.concat(e.nom_fichier.split(".").pop().toUpperCase(),'<br>\n                  Utilisez le bouton "T\xe9l\xe9charger" pour acc\xe9der au fichier.\n                </div>\n              '),'\n            </div>\n            \n            <div class="document-actions">\n              <button class="btn" onclick="window.close()">Fermer</button>\n              <a href="').concat(i,'" class="btn" download="').concat(e.nom_fichier,'" target="_blank">T\xe9l\xe9charger</a>\n              <a href="').concat(i,'" class="btn" target="_blank">Ouvrir dans un nouvel onglet</a>\n            </div>\n          </div>\n        </body>\n      </html>\n    ')),t.document.close()}(e),title:"Voir",children:(0,$r.jsx)("i",{className:"fas fa-eye"})}),(0,$r.jsx)("button",{className:"btn-icon",onClick:()=>v(e),title:"T\xe9l\xe9charger",children:(0,$r.jsx)("i",{className:"fas fa-download"})}),!c&&(0,$r.jsx)("button",{className:"btn-icon btn-danger",onClick:()=>(e.id,void(c||window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce document ?")&&alert("Document supprim\xe9 (simulation)"))),title:"Supprimer",children:(0,$r.jsx)("i",{className:"fas fa-trash"})})]})]},e.id)))})]}):(0,$r.jsxs)("div",{className:"documents-placeholder",children:[(0,$r.jsx)("i",{className:"fas fa-folder-open"}),(0,$r.jsxs)("p",{children:["Aucun document t\xe9l\xe9vers\xe9 pour ce ","lead"===i?"lead":"client"]}),(0,$r.jsx)("p",{className:"text-muted",children:"Les documents appara\xeetront ici une fois qu'ils seront t\xe9l\xe9vers\xe9s via le syst\xe8me."})]})})]}),(d||"notes"===h)&&(0,$r.jsxs)("div",{className:"tab-content",children:[(0,$r.jsx)("h3",{children:"\ud83d\udcdd Notes du dossier"}),(0,$r.jsx)("div",{className:"notes-section",children:(()=>{let e=[];if(p.notes)if(Array.isArray(p.notes))e=p.notes.filter((e=>e&&(e.contenu||e.texte)));else if("string"===typeof p.notes)try{const t=JSON.parse(p.notes);e=Array.isArray(t)?t.filter((e=>e&&(e.contenu||e.texte))):[]}catch(cw){e=[{id:1,date:p.date_creation||p.createdAt||(new Date).toISOString(),type:"G\xe9n\xe9ral",auteur:p.conseillere||"Syst\xe8me",contenu:String(p.notes)}]}else e=[{id:1,date:p.date_creation||p.createdAt||(new Date).toISOString(),type:"G\xe9n\xe9ral",auteur:p.conseillere||"Syst\xe8me",contenu:JSON.stringify(p.notes,null,2)}];return e.length>0?(0,$r.jsx)("div",{className:"notes-list",children:e.sort(((e,t)=>new Date(t.date)-new Date(e.date))).map(((e,t)=>{return(0,$r.jsxs)("div",{className:"note-item",children:[(0,$r.jsxs)("div",{className:"note-header",children:[(0,$r.jsxs)("div",{className:"note-meta",children:[(0,$r.jsx)("i",{className:"fas fa-sticky-note"}),(0,$r.jsx)("span",{className:"note-date",children:g(e.date)}),(0,$r.jsx)("span",{className:"note-author",children:String(e.auteur||"Syst\xe8me")})]}),(0,$r.jsx)("span",{className:"note-type ".concat(String(e.type||"general").toLowerCase()),children:String(e.type||"G\xe9n\xe9ral")})]}),(0,$r.jsx)("div",{className:"note-content",children:(0,$r.jsx)("p",{children:(n=e.contenu||e.texte,n?"object"===typeof n?JSON.stringify(n,null,2):String(n):"Aucun contenu")})})]},e.id||t);var n}))}):(0,$r.jsxs)("div",{className:"notes-placeholder",children:[(0,$r.jsx)("i",{className:"fas fa-sticky-note"}),(0,$r.jsxs)("p",{children:["Aucune note pour ce ","lead"===i?"lead":"client"]}),(0,$r.jsx)("p",{className:"text-muted",children:"Les notes appara\xeetront ici au fur et \xe0 mesure de l'\xe9volution du dossier."})]})})()})]})]}),(0,$r.jsxs)("div",{className:"modal-footer",children:[(0,$r.jsxs)("button",{className:"btn-secondary",onClick:l,children:[(0,$r.jsx)("i",{className:"fas fa-times"})," Fermer"]}),!c&&(0,$r.jsxs)("button",{className:"btn-primary",onClick:()=>u&&u(p),children:[(0,$r.jsx)("i",{className:"fas fa-edit"})," Modifier ","lead"===i?"le lead":"le client"]}),(0,$r.jsxs)("button",{className:"btn-primary",onClick:()=>{const e=b(),t=window.open("","_blank","width=800,height=600");t.document.write("\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>D\xe9tails Client - ".concat(r.prenom," ").concat(r.nom,"</title>\n          <style>\n            ").concat(y(),"\n          </style>\n        </head>\n        <body>\n          ").concat(e,"\n        </body>\n      </html>\n    ")),t.document.close(),t.onload=function(){t.print(),t.close()}},children:[(0,$r.jsx)("i",{className:"fas fa-print"})," Imprimer"]})]})]})})},Lx="http://localhost:5000/api",Rx=()=>{const e=localStorage.getItem("token"),t={};return e&&(t.Authorization="Bearer ".concat(e)),t},Dx={getAllClients:async()=>{try{return(await Yr.get("".concat(Lx,"/clients"),{headers:Rx()})).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des clients:",uw),uw}},getClientById:async e=>{try{return(await Yr.get("".concat(Lx,"/clients/").concat(e),{headers:Rx()})).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration du client ".concat(e,":"),uw),uw}},createClient:async e=>{try{return(await Yr.post("".concat(Lx,"/clients"),e,{headers:Rx()})).data}catch(uw){throw uw.response?console.error("Erreur lors de la cr\xe9ation du client:",uw.response.data):console.error("Erreur lors de la cr\xe9ation du client:",uw),uw}},updateClient:async(e,t)=>{try{return(await Yr.put("".concat(Lx,"/clients/").concat(e),t,{headers:Rx()})).data}catch(uw){throw console.error("Erreur lors de la mise \xe0 jour du client ".concat(e,":"),uw),uw}},searchClients:async e=>{try{return(await Yr.get("".concat(Lx,"/clients"),{headers:Rx(),params:{search:e}})).data}catch(uw){throw console.error("Erreur lors de la recherche de clients:",uw),uw}},deleteClient:async e=>{try{return(await Yr.delete("".concat(Lx,"/clients/").concat(e),{headers:Rx()})).data}catch(uw){throw console.error("Erreur lors de la suppression du client ".concat(e,":"),uw),uw}}};var Ix=n(945);const Ox=function(e){let{userRole:t="conseillere",onEditClient:n}=e;const r=me();console.log("\ud83c\udfaf [CLIENTS DEBUG] Composant Clients initialis\xe9 avec userRole:",t);const[a,i]=(0,s.useState)([]),[o,l]=(0,s.useState)([]),[c,d]=(0,s.useState)(!0),[h,f]=(0,s.useState)(null),[p,m]=(0,s.useState)(""),[g,v]=(0,s.useState)({procedure:"",statut:"",conseillere:""}),[b,x]=(0,s.useState)("date_creation"),[y,w]=(0,s.useState)("desc"),[j,N]=(0,s.useState)(!1),[S,C]=(0,s.useState)(!1),[k,E]=(0,s.useState)(!1),[A,T]=(0,s.useState)(null),[P,_]=(0,s.useState)(null),[L,R]=(0,s.useState)(null),[D,I]=(0,s.useState)(null),[O,F]=(0,s.useState)([]),[M,B]=(0,s.useState)(""),z=e=>{b===e?w("asc"===y?"desc":"asc"):(x(e),w("asc"))},U=e=>b!==e?"\u2195\ufe0f":"asc"===y?"\u2191":"\u2193",q=async()=>{try{d(!0),f(null),console.log("\ud83d\udd04 Chargement des clients depuis l'API...");const e=await Dx.getAllClients();if(console.log("\u2705 Clients r\xe9cup\xe9r\xe9s:",e),e.success&&e.data&&e.data.clients){const t=e.data.clients;console.log("\ud83d\udcca [CLIENTS DEBUG] Clients re\xe7us du backend:",t.length),console.log("\ud83d\udd0d [CLIENTS DEBUG] Premier client exemple:",t[0]),console.log("\ufffd [CLIENTS DEBUG] Conseill\xe8res uniques dans les clients:",[...new Set(t.map((e=>e.conseillere)))]),i(t),l(t),console.log("\ud83d\udcca ".concat(t.length," clients charg\xe9s avec succ\xe8s"))}else console.log("\u26a0\ufe0f Aucun client trouv\xe9 ou format de r\xe9ponse inattendu"),i([]),l([])}catch(h){console.error("\u274c Erreur lors du chargement des clients:",h),f("Erreur lors du chargement des clients. V\xe9rifiez que le serveur backend est d\xe9marr\xe9."),i([]),l([])}finally{d(!1)}};(0,s.useEffect)((()=>{q(),(async()=>{if("conseillere"===t)return console.log("\ud83d\udc64 Utilisateur conseill\xe8re - pas de chargement des autres conseill\xe8res"),void F([]);try{console.log("\ud83d\udd04 Chargement des conseill\xe8res depuis l'API...");const e=await(0,Ix.o3)();if(console.log("\u2705 Conseill\xe8res r\xe9cup\xe9r\xe9es:",e),Array.isArray(e)){const t=e.map((e=>e.nomComplet));F(t),console.log("\ud83d\udcca ".concat(t.length," conseill\xe8res ajout\xe9es au filtre:"),t)}}catch(h){console.error("\u274c Erreur lors du chargement des conseill\xe8res:",h),F([])}})();const e=mm();return e.on("clientCreated",(()=>{console.log("\ud83d\udd14 Nouveau client cr\xe9\xe9 - rechargement de la liste"),q()})),e.on("clientUpdated",(()=>{console.log("\ud83d\udd14 Client mis \xe0 jour - rechargement de la liste"),q()})),e.on("clientDeleted",(()=>{console.log("\ud83d\udd14 Client supprim\xe9 - rechargement de la liste"),q()})),()=>{e.off("clientCreated"),e.off("clientUpdated"),e.off("clientDeleted")}}),[]),(0,s.useEffect)((()=>{const e=localStorage.getItem("userName"),n=localStorage.getItem("userRole");console.log("\ud83d\udd0d [CLIENTS DEBUG] localStorage userName:",e),console.log("\ud83d\udd0d [CLIENTS DEBUG] localStorage userRole:",n),console.log("\ud83d\udd0d [CLIENTS DEBUG] Props userRole:",t),e&&"conseillere"===t?(B(e),console.log("\ud83d\udc64 Nom de la conseill\xe8re connect\xe9e captur\xe9:",e)):(console.log("\u26a0\ufe0f [CLIENTS DEBUG] Condition non remplie pour capturer le nom conseill\xe8re"),console.log("\u26a0\ufe0f [CLIENTS DEBUG] userName:",e,"userRole === conseillere:","conseillere"===t))}),[t]),(0,s.useEffect)((()=>{console.log("\ud83d\udd0d [CLIENTS DEBUG] D\xe9but du filtrage"),console.log("\ud83d\udcca [CLIENTS DEBUG] Total clients:",a.length),console.log("\ud83d\udc64 [CLIENTS DEBUG] UserRole:",t),console.log("\ud83d\udcbe [CLIENTS DEBUG] LocalStorage userName:",localStorage.getItem("userName"));const e=a.filter((e=>{const n=""===p||"".concat(e.prenom," ").concat(e.nom).toLowerCase().includes(p.toLowerCase())||e.email.toLowerCase().includes(p.toLowerCase())||e.telephone.includes(p)||e.numero_dossier.toLowerCase().includes(p.toLowerCase()),r=""===g.procedure||e.type_procedure===g.procedure,a=""===g.statut||e.statut===g.statut;let s=!0;if("conseillere"===t){const t=localStorage.getItem("userName");if(t){if(!0)console.log("\ud83d\udc1b [DEBUG MODE ACTIF] Affichage de tous les clients pour la conseill\xe8re ".concat(t)),s=!0;else if(e.conseillere&&""!==e.conseillere){const n=e.conseillere.trim().toLowerCase(),r=t.trim().toLowerCase();s=n===r||n.includes(r)||r.includes(n),console.log("\ud83d\udd0d [CLIENTS DEBUG] Client ".concat(e.prenom," ").concat(e.nom,': conseillere="').concat(e.conseillere,'" vs userName="').concat(t,'" => match=').concat(s))}else console.log("\u26a0\ufe0f [CLIENTS DEBUG] Client ".concat(e.prenom," ").concat(e.nom," n'a pas de conseill\xe8re assign\xe9e")),s=!1}else console.log("\u26a0\ufe0f [CLIENTS DEBUG] Aucun userName trouv\xe9 dans localStorage"),s=!1}else s=""===g.conseillere||e.conseillere===g.conseillere;const i=n&&r&&a&&s;return i||console.log("\u274c [CLIENTS DEBUG] Client ".concat(e.prenom," ").concat(e.nom," filtr\xe9: search=").concat(n,", procedure=").concat(r,", statut=").concat(a,", conseillere=").concat(s)),i}));console.log("\u2705 [CLIENTS DEBUG] Clients filtr\xe9s:",e.length),l(e)}),[a,p,g,t]);const V=e=>{const{name:t,value:n}=e.target;v(u(u({},g),{},{[t]:n}))},W=e=>{switch(e){case"En cours":return"status-en-cours";case"En attente":return"status-en-attente";case"Termin\xe9":return"status-termine";case"Refus\xe9":return"status-refuse";default:return""}},H=e=>{switch(e){case"En cours":return"fa-spinner";case"En attente":return"fa-clock";case"Termin\xe9":return"fa-check-circle";case"Refus\xe9":return"fa-times-circle";default:return"fa-circle"}};(0,s.useEffect)((()=>{const e=e=>{e.target.closest(".actions-dropdown")||I(null)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[]);const G=(()=>{const e=[...o].sort(((e,t)=>{let n,r;switch(b){case"nom":n="".concat(e.prenom," ").concat(e.nom).toLowerCase(),r="".concat(t.prenom," ").concat(t.nom).toLowerCase();break;case"email":n=e.email.toLowerCase(),r=t.email.toLowerCase();break;case"telephone":n=e.telephone,r=t.telephone;break;case"type_procedure":n=e.type_procedure.toLowerCase(),r=t.type_procedure.toLowerCase();break;case"date_creation":n=new Date(e.date_creation).getTime(),r=new Date(t.date_creation).getTime();break;case"statut":n=e.statut.toLowerCase(),r=t.statut.toLowerCase();break;case"conseillere":n=(e.conseillere||"").toLowerCase(),r=(t.conseillere||"").toLowerCase();break;case"numero_dossier":n=e.numero_dossier.toLowerCase(),r=t.numero_dossier.toLowerCase();break;default:return 0}return n<r?"asc"===y?-1:1:n>r?"asc"===y?1:-1:0}));return e})();return(0,$r.jsxs)("div",{className:"clients-container",children:[c&&(0,$r.jsxs)("div",{className:"loading-container",children:[(0,$r.jsx)("div",{className:"loading-spinner"}),(0,$r.jsx)("p",{children:"Chargement des clients..."})]}),h&&(0,$r.jsxs)("div",{className:"error-container",children:[(0,$r.jsx)("p",{className:"error-message",children:h}),(0,$r.jsx)("button",{onClick:q,className:"retry-button",children:"R\xe9essayer"})]}),!c&&!h&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"clients-header",children:[(0,$r.jsxs)("div",{className:"header-left",children:[(0,$r.jsxs)(vt,{to:"/",className:"btn btn-secondary btn-back",children:[(0,$r.jsx)("i",{className:"fas fa-home"})," Accueil"]}),(0,$r.jsx)("h2",{children:"Gestion des Clients"})]}),(0,$r.jsx)("div",{className:"header-right",children:"secretaire"!==t&&(0,$r.jsxs)(vt,{to:"/client/nouveau",className:"btn btn-primary",children:[(0,$r.jsx)("i",{className:"fas fa-plus"})," Nouveau Client"]})})]}),(0,$r.jsxs)("div",{className:"search-filter-container",style:{display:"flex",alignItems:"center",gap:"24px",marginBottom:"24px",background:"white",borderRadius:"12px",boxShadow:"var(--shadow-sm)",padding:"24px",flexWrap:"wrap"},children:[(0,$r.jsxs)("div",{style:{display:"flex",flex:1,alignItems:"center",minWidth:300,height:40,background:"#f8f9fa",borderRadius:8,padding:"0 16px",marginRight:16,marginBottom:8},children:[(0,$r.jsx)("i",{className:"fas fa-search",style:{marginRight:8,color:"var(--text-secondary)"}}),(0,$r.jsx)("input",{type:"text",placeholder:"Rechercher par nom, email, t\xe9l\xe9phone ou num\xe9ro de dossier...",value:p,onChange:e=>m(e.target.value),style:{border:"none",background:"transparent",outline:"none",width:"100%",fontSize:"1rem",height:40,lineHeight:"40px"}})]}),(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap",marginBottom:8},children:[(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,height:40},children:[(0,$r.jsx)("label",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:500,lineHeight:"40px",marginRight:4},children:"Proc\xe9dure:"}),(0,$r.jsxs)("select",{name:"procedure",value:g.procedure,onChange:V,style:{padding:"8px 12px",border:"1px solid var(--color-neutral-medium)",borderRadius:6,fontSize:"1rem",minWidth:120,height:40,boxSizing:"border-box"},children:[(0,$r.jsx)("option",{value:"",children:"Toutes"}),["Permis d'\xe9tudes","Permis de travail","R\xe9sidence permanente","Visa visiteur","Investisseur","Regroupement familial"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,height:40},children:[(0,$r.jsx)("label",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:500,lineHeight:"40px",marginRight:4},children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:g.statut,onChange:V,style:{padding:"8px 12px",border:"1px solid var(--color-neutral-medium)",borderRadius:6,fontSize:"1rem",minWidth:120,height:40,boxSizing:"border-box"},children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),["En cours","En attente","Termin\xe9","Refus\xe9"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),"secretaire"!==t&&(0,$r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,height:40},children:[(0,$r.jsx)("label",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:500,lineHeight:"40px",marginRight:4},children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:g.conseillere,onChange:V,disabled:"conseillere"===t,style:{backgroundColor:"conseillere"===t?"#f5f5f5":"white",color:"conseillere"===t?"#999":"black",cursor:"conseillere"===t?"not-allowed":"pointer",padding:"8px 12px",border:"1px solid var(--color-neutral-medium)",borderRadius:6,fontSize:"1rem",minWidth:120,height:40,boxSizing:"border-box"},children:[(0,$r.jsx)("option",{value:"",children:"conseillere"===t?M||"Mes clients":"Toutes"}),"conseillere"!==t&&O.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("button",{className:"btn-text",onClick:()=>{v({procedure:"",statut:"",conseillere:""}),m("")},style:{height:40,boxSizing:"border-box",display:"flex",alignItems:"center",gap:4,fontSize:"1rem",padding:"8px 12px",borderRadius:6,marginLeft:8,whiteSpace:"nowrap"},children:[(0,$r.jsx)("i",{className:"fas fa-times"})," R\xe9initialiser"]})]})]}),(0,$r.jsx)("div",{className:"clients-table-container",children:(0,$r.jsxs)("table",{className:"clients-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsxs)("th",{onClick:()=>z("numero_dossier"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["N\xb0 Dossier ",U("numero_dossier")]}),(0,$r.jsxs)("th",{onClick:()=>z("nom"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["Nom complet ",U("nom")]}),(0,$r.jsxs)("th",{onClick:()=>z("email"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["Email ",U("email")]}),(0,$r.jsxs)("th",{onClick:()=>z("telephone"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["T\xe9l\xe9phone ",U("telephone")]}),(0,$r.jsxs)("th",{onClick:()=>z("type_procedure"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["Type de proc\xe9dure ",U("type_procedure")]}),(0,$r.jsxs)("th",{onClick:()=>z("date_creation"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["Date de cr\xe9ation ",U("date_creation")]}),(0,$r.jsxs)("th",{onClick:()=>z("statut"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["Statut ",U("statut")]}),(0,$r.jsxs)("th",{onClick:()=>z("conseillere"),style:{cursor:"pointer",userSelect:"none"},title:"Cliquer pour trier",children:["Conseill\xe8re ",U("conseillere")]}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:G.length>0?G.map((e=>(console.log("Client ".concat(e.prenom," ").concat(e.nom,": urgence=").concat(e.urgence,", urgent=").concat(e.urgent)),(0,$r.jsxs)("tr",{className:e.urgence?"urgent-row":"",children:[(0,$r.jsx)("td",{children:e.numero_dossier}),(0,$r.jsxs)("td",{className:"client-name",children:[e.urgence&&(0,$r.jsx)("i",{className:"fas fa-exclamation-circle urgent-icon",title:"Dossier urgent"}),e.prenom," ",e.nom]}),(0,$r.jsx)("td",{children:e.email}),(0,$r.jsx)("td",{children:e.telephone}),(0,$r.jsx)("td",{children:e.type_procedure}),(0,$r.jsx)("td",{children:new Date(e.date_creation).toLocaleDateString("fr-FR")}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("span",{className:"status-badge ".concat(W(e.statut)),children:[(0,$r.jsx)("i",{className:"fas ".concat(H(e.statut))}),e.statut]})}),(0,$r.jsx)("td",{children:e.conseillere}),(0,$r.jsx)("td",{children:(0,$r.jsx)("div",{className:"actions-dropdown",children:(0,$r.jsxs)("div",{style:{position:"relative"},children:[(0,$r.jsx)("button",{onClick:()=>I(D===e.id?null:e.id),style:{background:"transparent",border:"none",cursor:"pointer",padding:"8px",borderRadius:"4px"},children:(0,$r.jsx)("i",{className:"fas fa-ellipsis-v"})}),D===e.id&&(0,$r.jsx)("div",{style:{position:"absolute",right:"0",top:"100%",backgroundColor:"white",minWidth:"200px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",borderRadius:"8px",border:"1px solid #e0e0e0",zIndex:1e3,overflow:"hidden"},children:(0,$r.jsxs)("div",{style:{padding:"8px 0"},children:[(0,$r.jsxs)("button",{onClick:()=>{(e=>{T(e),E(!0)})(e),I(null)},style:{width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:e=>e.target.style.backgroundColor="#f5f5f5",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:[(0,$r.jsx)("i",{className:"fas fa-eye"})," Voir d\xe9tails"]}),(0,$r.jsxs)("button",{onClick:()=>{(e=>{localStorage.setItem("editingClient",JSON.stringify(e)),r("/client/modifier/".concat(e.id))})(e),I(null)},style:{width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:e=>e.target.style.backgroundColor="#f5f5f5",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:[(0,$r.jsx)("i",{className:"fas fa-edit"})," Modifier"]}),(0,$r.jsx)("hr",{style:{margin:"8px 0",border:"none",borderTop:"1px solid #e0e0e0"}}),(0,$r.jsxs)("button",{onClick:()=>{(async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce client ? Cette action est irr\xe9versible."))try{console.log("\ud83d\uddd1\ufe0f Suppression du client ".concat(e,"..."));const t=await Dx.deleteClient(e);t.success?(console.log("\u2705 Client supprim\xe9 avec succ\xe8s"),await q()):(console.error("\u274c Erreur lors de la suppression:",t.message),alert("Erreur lors de la suppression du client: "+t.message))}catch(h){console.error("\u274c Erreur lors de la suppression du client:",h),alert("Erreur lors de la suppression du client. V\xe9rifiez que le serveur backend est d\xe9marr\xe9.")}})(e.id),I(null)},style:{width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",color:"#dc3545"},onMouseEnter:e=>e.target.style.backgroundColor="#fff5f5",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:[(0,$r.jsx)("i",{className:"fas fa-trash"})," Supprimer"]})]})})]})})})]},e.id)))):(0,$r.jsx)("tr",{children:(0,$r.jsx)("td",{colSpan:"9",style:{textAlign:"center",padding:"20px"},children:0===o.length&&a.length>0?"Aucun client trouv\xe9 avec les crit\xe8res de recherche.":"Aucun client trouv\xe9."})})})]})}),j&&(0,$r.jsx)(wm,{client:A,facture:P,onClose:()=>N(!1),onSave:()=>{N(!1)}}),S&&(0,$r.jsx)(Px,{client:A,contrat:L,onClose:()=>C(!1),onSave:()=>{C(!1)}}),k&&A&&(0,$r.jsx)(_x,{client:A,isOpen:k,onClose:()=>E(!1),readOnly:!0,showAll:!0})]})]})};const Fx=function(){const[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)({statut:"",type:"",conseillere:""}),[a,i]=(0,s.useState)({reference:"",client:"",type:"",statut:"En cours",conseillere:"",progression:0}),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),p=["En cours","En attente","Compl\xe9t\xe9","Refus\xe9","Annul\xe9"],m=["Permis d'\xe9tudes","Permis de travail","R\xe9sidence permanente","Visa visiteur","Citoyennet\xe9"],g=["Marie Tremblay","Sophie Martin","Julie Lefebvre"],v=e.filter((e=>(""===n.statut||e.statut===n.statut)&&(""===n.type||e.type===n.type)&&(""===n.conseillere||e.conseillere===n.conseillere))),b=e=>{const{name:t,value:a}=e.target;r(u(u({},n),{},{[t]:a}))},x=e=>{const{name:t,value:n}=e.target;i(u(u({},a),{},{[t]:n}))},y=(n,r)=>{const a=e.map((e=>e.id===n?u(u({},e),{},{statut:r,dateMiseAJour:(new Date).toISOString().split("T")[0],progression:"Compl\xe9t\xe9"===r?100:e.progression}):e));t(a)};return(0,$r.jsxs)("div",{className:"dossiers-container",children:[(0,$r.jsxs)("div",{className:"dossiers-header",children:[(0,$r.jsx)("h2",{children:"Gestion des Dossiers"}),(0,$r.jsxs)("button",{className:"btn-primary",onClick:()=>{(()=>{const t=(new Date).getFullYear(),n=e.length+1,r="DOS-".concat(t,"-").concat(String(n).padStart(3,"0"));i(u(u({},a),{},{reference:r}))})(),l(!0)},children:[(0,$r.jsx)("span",{children:"+"})," Nouveau Dossier"]})]}),(0,$r.jsxs)("div",{className:"filtres-container",children:[(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:n.statut,onChange:b,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),p.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Type:"}),(0,$r.jsxs)("select",{name:"type",value:n.type,onChange:b,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),m.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:n.conseillere,onChange:b,children:[(0,$r.jsx)("option",{value:"",children:"Toutes"}),g.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{r({statut:"",type:"",conseillere:""})},children:"R\xe9initialiser"})]}),(0,$r.jsx)("div",{className:"dossiers-table-container",children:(0,$r.jsxs)("table",{className:"dossiers-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"R\xe9f\xe9rence"}),(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Type"}),(0,$r.jsx)("th",{children:"Statut"}),(0,$r.jsx)("th",{children:"Progression"}),(0,$r.jsx)("th",{children:"Date cr\xe9ation"}),(0,$r.jsx)("th",{children:"Derni\xe8re MAJ"}),(0,$r.jsx)("th",{children:"Conseill\xe8re"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:v.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.reference}),(0,$r.jsx)("td",{children:e.client}),(0,$r.jsx)("td",{children:e.type}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-".concat(e.statut.toLowerCase().replace(/\s+/g,"-")),children:e.statut})}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"progression-bar-container",children:[(0,$r.jsx)("div",{className:"progression-bar",style:{width:"".concat(e.progression,"%")}}),(0,$r.jsxs)("span",{className:"progression-text",children:[e.progression,"%"]})]})}),(0,$r.jsx)("td",{children:e.dateCreation}),(0,$r.jsx)("td",{children:e.dateMiseAJour}),(0,$r.jsx)("td",{children:e.conseillere}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"actions-dropdown",children:[(0,$r.jsx)("button",{className:"btn-action",children:"Actions"}),(0,$r.jsxs)("div",{className:"dropdown-content",children:[(0,$r.jsx)("button",{onClick:()=>(e=>{f(e),d(!0)})(e),children:"Voir d\xe9tails"}),(0,$r.jsx)("button",{onClick:()=>y(e.id,"En cours"),children:"Marquer en cours"}),(0,$r.jsx)("button",{onClick:()=>y(e.id,"En attente"),children:"Marquer en attente"}),(0,$r.jsx)("button",{onClick:()=>y(e.id,"Compl\xe9t\xe9"),children:"Marquer compl\xe9t\xe9"})]})]})})]},e.id)))})]})}),o&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Ajouter un nouveau dossier"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>l(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:n=>{n.preventDefault();const r=u(u({id:e.length+1},a),{},{dateCreation:(new Date).toISOString().split("T")[0],dateMiseAJour:(new Date).toISOString().split("T")[0]});t([...e,r]),i({reference:"",client:"",type:"",statut:"En cours",conseillere:"",progression:0}),l(!1)},children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"R\xe9f\xe9rence:"}),(0,$r.jsx)("input",{type:"text",name:"reference",value:a.reference,onChange:x,required:!0,readOnly:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Client:"}),(0,$r.jsxs)("select",{name:"client",value:a.client,onChange:x,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),[].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Type:"}),(0,$r.jsxs)("select",{name:"type",value:a.type,onChange:x,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),m.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:a.conseillere,onChange:x,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),g.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Statut initial:"}),(0,$r.jsx)("select",{name:"statut",value:a.statut,onChange:x,children:p.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Progression initiale (%):"}),(0,$r.jsx)("input",{type:"number",name:"progression",value:a.progression,onChange:x,min:"0",max:"100"})]})]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>l(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Ajouter"})]})]})]})}),c&&h&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"D\xe9tails du dossier"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>d(!1),children:"\xd7"})]}),(0,$r.jsxs)("div",{className:"dossier-details",children:[(0,$r.jsxs)("div",{className:"dossier-info",children:[(0,$r.jsx)("h4",{children:"Informations g\xe9n\xe9rales"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"R\xe9f\xe9rence:"})," ",h.reference]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Client:"})," ",h.client]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Type:"})," ",h.type]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"}),(0,$r.jsx)("span",{className:"statut-badge statut-".concat(h.statut.toLowerCase().replace(/\s+/g,"-")),children:h.statut})]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date de cr\xe9ation:"})," ",h.dateCreation]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Derni\xe8re mise \xe0 jour:"})," ",h.dateMiseAJour]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Conseill\xe8re assign\xe9e:"})," ",h.conseillere]}),(0,$r.jsx)("h4",{children:"Progression"}),(0,$r.jsxs)("div",{className:"progression-bar-container large",children:[(0,$r.jsx)("div",{className:"progression-bar",style:{width:"".concat(h.progression,"%")}}),(0,$r.jsxs)("span",{className:"progression-text",children:[h.progression,"%"]})]}),(0,$r.jsxs)("div",{className:"progression-update",children:[(0,$r.jsx)("label",{children:"Mettre \xe0 jour la progression:"}),(0,$r.jsxs)("div",{className:"progression-slider",children:[(0,$r.jsx)("input",{type:"range",min:"0",max:"100",value:h.progression,onChange:e=>{const t=parseInt(e.target.value);f(u(u({},h),{},{progression:t}))}}),(0,$r.jsxs)("span",{children:[h.progression,"%"]})]}),(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>{((n,r)=>{const a=e.map((e=>e.id===n?u(u({},e),{},{progression:r,dateMiseAJour:(new Date).toISOString().split("T")[0],statut:100===r?"Compl\xe9t\xe9":e.statut}):e));t(a)})(h.id,h.progression),d(!1)},children:"Enregistrer la progression"})]})]}),(0,$r.jsxs)("div",{className:"dossier-actions",children:[(0,$r.jsx)("h4",{children:"Actions rapides"}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{y(h.id,"En cours"),f(u(u({},h),{},{statut:"En cours"}))},children:"Marquer en cours"}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{y(h.id,"En attente"),f(u(u({},h),{},{statut:"En attente"}))},children:"Marquer en attente"}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{y(h.id,"Compl\xe9t\xe9"),f(u(u({},h),{},{statut:"Compl\xe9t\xe9",progression:100}))},children:"Marquer compl\xe9t\xe9"}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{y(h.id,"Refus\xe9"),f(u(u({},h),{},{statut:"Refus\xe9"}))},children:"Marquer refus\xe9"})]})]}),(0,$r.jsx)("div",{className:"modal-footer",children:(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>d(!1),children:"Fermer"})})]})})]})},Mx=()=>{const e=localStorage.getItem("token");console.log("\ud83d\udd11 Token trouv\xe9 dans localStorage:",e?"OUI":"NON");const t={};return e?(t.Authorization="Bearer ".concat(e),console.log("\u2705 Header Authorization ajout\xe9")):console.warn("\u26a0\ufe0f Aucun token trouv\xe9 - l'utilisateur n'est peut-\xeatre pas connect\xe9"),t},Bx=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const n=await fetch("".concat("http://localhost:5000/api").concat(e),u({headers:u(u({"Content-Type":"application/json"},Mx()),t.headers)},t));if(!n.ok){const e=await n.json().catch((()=>({message:"Erreur r\xe9seau"})));throw new Error(e.message||"Erreur HTTP: ".concat(n.status))}return await n.json()}catch(uw){throw console.error("Erreur API:",uw),uw}},zx=async()=>{try{const e=await Bx("/factures");return{success:!0,data:e.data||[],message:e.message}}catch(uw){return console.error("Erreur lors de la r\xe9cup\xe9ration des factures:",uw),{success:!1,data:[],error:uw.message}}},Ux=async e=>{try{console.log("\ud83d\udcdd Cr\xe9ation d'une nouvelle facture:",e);const t=await Bx("/factures",{method:"POST",body:JSON.stringify(e)});return console.log("\u2705 Facture cr\xe9\xe9e avec succ\xe8s:",t),t}catch(uw){throw console.error("\u274c Erreur lors de la cr\xe9ation de la facture:",uw),uw}},qx=async(e,t)=>{try{const n=await Bx("/factures/".concat(e),{method:"PUT",body:JSON.stringify(t)});return{success:!0,data:n.data,message:n.message}}catch(uw){return console.error("Erreur lors de la mise \xe0 jour de la facture ".concat(e,":"),uw),{success:!1,error:uw.message}}},Vx=function(e){return"CAD"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MAD")?new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD"}).format(e||0):new Intl.NumberFormat("fr-MA",{style:"currency",currency:"MAD"}).format(e||0)},Wx=e=>"MAD"===e?"DH":"$",Hx=e=>({brouillon:"statut-brouillon",payable:"statut-payable",payee:"statut-payee",en_retard:"statut-en-retard",annulee:"statut-annulee"}[null===e||void 0===e?void 0:e.toLowerCase()]||"statut-default"),Gx=e=>({brouillon:"Brouillon",payable:"Payable",payee:"Pay\xe9e",en_retard:"En retard",annulee:"Annul\xe9e"}[null===e||void 0===e?void 0:e.toLowerCase()]||e),Yx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"conseillere";return"administrateur"===t||("conseillere"===t?"brouillon"===(null===e||void 0===e?void 0:e.toLowerCase()):["brouillon","payable"].includes(null===e||void 0===e?void 0:e.toLowerCase()))},$x=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(uw){return console.error("Erreur lors du formatage de la date:",uw),e}};const Kx=function(e){let{value:t,onSelect:n,placeholder:r="Rechercher un client...",className:a="",required:i=!1}=e;const[o,l]=(0,s.useState)(t||""),[c,u]=(0,s.useState)([]),[d,h]=(0,s.useState)(!1),[f,p]=(0,s.useState)(!1),[m,g]=(0,s.useState)(null),v=(0,s.useRef)(null),b=(0,s.useRef)(null),[x,y]=(0,s.useState)(null);return(0,s.useEffect)((()=>{if(o.trim().length>=2){x&&clearTimeout(x);const e=setTimeout((async()=>{h(!0);try{let e=o.trim();const t=e.indexOf("(");-1!==t&&(e=e.substring(0,t).trim());const n=await Dx.searchClients(e);n.success&&(u(n.data.clients||[]),p(!0))}catch(uw){console.error("Erreur lors de la recherche de clients:",uw),u([])}finally{h(!1)}}),300);y(e)}else u([]),p(!1),g(null);return()=>{x&&clearTimeout(x)}}),[o]),(0,s.useEffect)((()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&b.current&&!b.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,$r.jsxs)("div",{className:"client-autocomplete-container",style:{position:"relative"},children:[(0,$r.jsx)("input",{ref:v,type:"text",value:o,onChange:e=>{const t=e.target.value;l(t),t.trim()?m&&(g(null),n&&n({clientId:null,displayText:t,client:null})):(g(null),u([]),p(!1),n&&n({clientId:null,displayText:"",client:null}))},onKeyDown:e=>{"Escape"===e.key&&p(!1)},placeholder:r,className:"form-control ".concat(a),required:i,autoComplete:"off"}),d&&(0,$r.jsx)("div",{className:"autocomplete-loading",style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",fontSize:"12px",color:"#666"},children:"Recherche..."}),f&&c.length>0&&(0,$r.jsx)("div",{ref:b,className:"autocomplete-suggestions",style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:c.map((e=>(0,$r.jsxs)("div",{className:"autocomplete-suggestion-item",style:{padding:"10px",borderBottom:"1px solid #eee",cursor:"pointer",transition:"background-color 0.2s"},onClick:()=>(e=>{const t="".concat(e.prenom," ").concat(e.nom," (").concat(e.telephone,")");l(t),g(e.id),p(!1),u([]),n&&n({clientId:e.id,displayText:t,client:e})})(e),onMouseEnter:e=>e.target.style.backgroundColor="#f5f5f5",onMouseLeave:e=>e.target.style.backgroundColor="white",children:[(0,$r.jsxs)("div",{style:{fontWeight:"bold",fontSize:"14px"},children:[e.prenom," ",e.nom]}),(0,$r.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:["\ud83d\udcde ",e.telephone]}),e.email&&(0,$r.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:["\u2709\ufe0f ",e.email]})]},e.id)))}),f&&!d&&0===c.length&&o.trim().length>=2&&(0,$r.jsxs)("div",{className:"autocomplete-no-results",style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px",padding:"10px",textAlign:"center",color:"#666",fontSize:"14px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:['Aucun client trouv\xe9 pour "',-1!==o.indexOf("(")?o.substring(0,o.indexOf("(")).trim():o,'"']})]})},Jx=["id","numero","date","prestations"],Xx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MAD";const n=parseFloat(e)||0;let r;return r="CAD"===t?n/1.14975:n/1.2,Math.round(100*r)/100},Qx=e=>{var t,n;if("boolean"===typeof e.en_retard)return e.en_retard;if("payee"===(null===(t=e.statut)||void 0===t?void 0:t.toLowerCase())||"annulee"===(null===(n=e.statut)||void 0===n?void 0:n.toLowerCase()))return!1;if(!e.dateEcheance)return!1;const r=new Date(e.dateEcheance),a=new Date;return Math.floor((a-r)/864e5)>30},Zx=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MAD";const n=parseFloat(e)||0;return Vx(n,t)},ey=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MAD";const n=parseFloat(e)||0,r=Xx(e,t),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MAD";const n=(parseFloat(e)||0)-Xx(e,t);return Math.round(100*n)/100}(e,t),s=Wx(t),i="CAD"===t?"14,975%":"20%";return"".concat(n.toFixed(2)," ").concat(s," TTC (HT: ").concat(r.toFixed(2)," ").concat(s," + TVA ").concat(i,": ").concat(a.toFixed(2)," ").concat(s,")")};const ty=function(e){let{userRole:t="conseillere"}=e;const[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null),[d,h]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[m,g]=(0,s.useState)({key:null,direction:"asc"}),[v,b]=(0,s.useState)({statut:"",client:"",periode:""}),[x,y]=(0,s.useState)({client:"",selectedClientId:null,montant:"",monnaie:"MAD",dateEmission:(new Date).toISOString().split("T")[0],dateEcheance:"",description:""}),[w,j]=(0,s.useState)(!1),[N,S]=(0,s.useState)(!1),[C,k]=(0,s.useState)(null),[E,A]=(0,s.useState)(!1),[T,P]=(0,s.useState)(null),[_,L]=(0,s.useState)(null),R=e=>{let t="asc";m.key===e&&"asc"===m.direction&&(t="desc"),g({key:e,direction:t}),console.log("\ud83d\udd04 Tri par ".concat(e," en ordre ").concat(t))},D=e=>m.key!==e?(0,$r.jsx)("span",{className:"sort-icon",title:"Cliquer pour trier",children:"\u21f5"}):(0,$r.jsx)("span",{className:"sort-icon active",title:"Tri\xe9 par ".concat(e," (").concat("asc"===m.direction?"croissant":"d\xe9croissant",")"),children:"asc"===m.direction?"\u25b4":"\u25be"}),I=async()=>{try{i(!0),c(null);const e=await zx();e.success?(r(e.data),p(e.filteredBy||"Toutes"),console.log("\u2705 Factures charg\xe9es:",e.data.length,"factures"),console.log("\ud83d\udd0d Filtr\xe9es par:",e.filteredBy||"Toutes"),console.log("\ud83d\udc64 Utilisateur connect\xe9:",d,"- R\xf4le:",t),"conseillere"===t&&(console.log("\ud83d\udd0d D\xe9tail des factures pour d\xe9bogage:"),e.data.forEach((e=>{console.log("   Facture ".concat(e.numero,': validePar="').concat(e.validePar,'"'))}))),"conseillere"===t&&e.filteredBy&&"Toutes"!==e.filteredBy&&console.log("\ud83d\udd12 Affichage limit\xe9 aux factures de la conseill\xe8re connect\xe9e")):(c(e.error||"Erreur lors du chargement des factures"),console.error("\u274c Erreur:",e.error))}catch(l){c("Erreur de connexion \xe0 l'API"),console.error("\u274c Erreur de connexion:",l)}finally{i(!1)}};(0,s.useEffect)((()=>{const e=localStorage.getItem("userName")||"",t=localStorage.getItem("role")||"";h(e),console.log("\ud83d\udc64 Utilisateur connect\xe9:",e,"- R\xf4le:",t)}),[]),(0,s.useEffect)((()=>{I()}),[]);const O=Array.from(new Set(n.map((e=>e.client)).filter(Boolean))).sort(),F=n.filter((e=>(""===v.statut||e.statut===v.statut)&&(""===v.client||e.client===v.client)&&(""===v.periode||M(e.dateEmission,v.periode)))),M=(e,t)=>{const n=new Date(e),r=new Date;switch(t){case"Ce mois":return n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear();case"Mois pr\xe9c\xe9dent":const e=new Date(r.getFullYear(),r.getMonth()-1);return n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear();case"Ce trimestre":const t=Math.floor(r.getMonth()/3);return Math.floor(n.getMonth()/3)===t&&n.getFullYear()===r.getFullYear();case"Cette ann\xe9e":return n.getFullYear()===r.getFullYear();default:return!0}},B=e=>{const{name:t,value:n}=e.target;b(u(u({},v),{},{[t]:n}))},z=e=>{const{name:t,value:n}=e.target;y(u(u({},x),{},{[t]:n}))},U=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{console.log("\ud83d\udd04 === DEBUT CHANGEMENT STATUT ==="),console.log("\ud83d\udd04 ID facture:",e),console.log("\ud83d\udd04 Nouveau statut:",t),console.log("\ud83d\udd04 M\xe9thode de paiement:",n);const r={Brouillon:"brouillon",Payable:"payable","Pay\xe9e":"payee","En retard":"en_retard","Annul\xe9e":"annulee"}[t]||t.toLowerCase();console.log("\ud83d\udd04 Statut normalis\xe9 pour l'API:",r);const a={statut:r,datePaiement:"Pay\xe9e"===t?(new Date).toISOString().split("T")[0]:null,methodePaiement:"Pay\xe9e"===t?n:null};console.log("\ud83d\udce4 Donn\xe9es \xe0 envoyer \xe0 l'API:",a);const s=await qx(e,a);if(console.log("\ud83d\udce5 R\xe9ponse de l'API:",s),s.success){await I(),N&&(S(!1),k(null)),console.log("\u2705 Statut de facture mis \xe0 jour:",t);const e=document.createElement("div");e.textContent="\u2705 Facture ".concat(t.toLowerCase()," avec succ\xe8s ").concat(n?"(".concat(n,")"):""),e.style.cssText="\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: #4caf50;\n          color: white;\n          padding: 10px 20px;\n          border-radius: 5px;\n          z-index: 9999;\n          font-size: 14px;\n          font-weight: 500;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n        ",document.body.appendChild(e),setTimeout((()=>{document.body.removeChild(e)}),4e3)}else{console.error("\u274c Erreur mise \xe0 jour:",s.error);const e=s.error||"Erreur lors de la mise \xe0 jour du statut";c(e),alert("\u274c Erreur: ".concat(e))}}catch(l){console.error("\u274c === ERREUR CHANGEMENT STATUT ==="),console.error("\u274c Erreur compl\xe8te:",l),console.error("\u274c Message d'erreur:",l.message),console.error("\u274c Stack trace:",l.stack);const t=l.message||"Erreur lors du changement de statut";c(t),alert("\u274c Erreur technique: ".concat(t))}},q=(()=>{const e=n.length,t=n.reduce(((e,t)=>e+parseFloat(t.montant||0)),0),r=n.filter((e=>{var t;return"payee"===(null===(t=e.statut)||void 0===t?void 0:t.toLowerCase())})).length,a=n.filter((e=>{var t;return["brouillon","payable"].includes(null===(t=e.statut)||void 0===t?void 0:t.toLowerCase())})).length,s=n.filter((e=>Qx(e))).length;return{totalFactures:e,totalMontant:Zx(t),totalPayees:r,totalEnAttente:a,totalEnRetard:s}})(),V=()=>new Promise((e=>{const t=new Image;t.crossOrigin="anonymous",t.onload=function(){const n=document.createElement("canvas"),r=n.getContext("2d");n.width=100,n.height=50,r.drawImage(t,0,0,100,50);const a=n.toDataURL("image/png");e(a)},t.onerror=function(){console.warn("Logo non trouv\xe9, utilisation du placeholder"),e(null)},t.src="/assets/logo.png"}));return a?(0,$r.jsx)("div",{className:"facturation-container",children:(0,$r.jsxs)("div",{className:"loading-container",children:[(0,$r.jsx)("h2",{children:"Chargement des factures..."}),(0,$r.jsx)("div",{className:"loading-spinner",children:"\u23f3"})]})}):(0,$r.jsxs)("div",{className:"facturation-container",children:[(0,$r.jsxs)("div",{className:"facturation-header",children:[(0,$r.jsx)("h2",{children:"Gestion de la Facturation"}),"conseillere"===t&&(0,$r.jsx)("div",{className:"filtrage-info",children:(0,$r.jsxs)("span",{className:"filtrage-badge",title:'Vous ne voyez que les factures o\xf9 validePar = "'.concat(d,'" pour des raisons de confidentialit\xe9'),children:["\ud83d\udd12 Mes factures ",f&&"Toutes"!==f?"(".concat(f,")"):""]})}),(0,$r.jsxs)("div",{className:"header-actions",children:[(0,$r.jsx)("button",{className:"btn-secondary",onClick:I,disabled:a,children:"\ud83d\udd04 Actualiser"}),(0,$r.jsxs)("button",{className:"btn-primary",onClick:()=>j(!0),children:[(0,$r.jsx)("span",{children:"+"})," Nouvelle Facture"]})]})]}),l&&(0,$r.jsxs)("div",{className:"error-container",children:[(0,$r.jsxs)("p",{className:"error-message",children:["\u274c ",l]}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>c(null),children:"Fermer"})]}),(0,$r.jsxs)("div",{className:"stats-container",children:[(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"conseillere"===t?"Mes factures":"Total des factures"}),(0,$r.jsx)("p",{className:"stat-value",children:q.totalFactures})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Montant total"}),(0,$r.jsx)("p",{className:"stat-value",children:q.totalMontant})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Factures pay\xe9es"}),(0,$r.jsx)("p",{className:"stat-value",children:q.totalPayees})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"En attente"}),(0,$r.jsx)("p",{className:"stat-value",children:q.totalEnAttente})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"En retard"}),(0,$r.jsx)("p",{className:"stat-value stat-alert",children:q.totalEnRetard})]})]}),(0,$r.jsxs)("div",{className:"filtres-container",children:[(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:v.statut,onChange:B,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),["Brouillon","Payable","Pay\xe9e","En retard","Annul\xe9e"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Client:"}),(0,$r.jsxs)("select",{name:"client",value:v.client,onChange:B,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),O.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"P\xe9riode:"}),(0,$r.jsxs)("select",{name:"periode",value:v.periode,onChange:B,children:[(0,$r.jsx)("option",{value:"",children:"Toutes"}),["Tous","Ce mois","Mois pr\xe9c\xe9dent","Ce trimestre","Cette ann\xe9e"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{b({statut:"",client:"",periode:""})},children:"R\xe9initialiser"})]}),(0,$r.jsx)("div",{className:"factures-table-container",children:(0,$r.jsxs)("table",{className:"factures-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsxs)("th",{onClick:()=>R("numero"),className:"numero"===m.key?"sorted":"",children:["Num\xe9ro ",D("numero")]}),(0,$r.jsxs)("th",{onClick:()=>R("client"),className:"client"===m.key?"sorted":"",children:["Client ",D("client")]}),(0,$r.jsxs)("th",{onClick:()=>R("montant"),className:"montant"===m.key?"sorted":"",children:["Montant ",D("montant")]}),(0,$r.jsxs)("th",{onClick:()=>R("statut"),className:"statut"===m.key?"sorted":"",children:["Statut ",D("statut")]}),(0,$r.jsxs)("th",{onClick:()=>R("dateEmission"),className:"dateEmission"===m.key?"sorted":"",children:["Date \xe9mission ",D("dateEmission")]}),(0,$r.jsxs)("th",{onClick:()=>R("dateEcheance"),className:"dateEcheance"===m.key?"sorted":"",children:["Date \xe9ch\xe9ance ",D("dateEcheance")]}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:0===F.length?(0,$r.jsx)("tr",{children:(0,$r.jsx)("td",{colSpan:"7",className:"no-data",children:a?"Chargement...":"Aucune facture trouv\xe9e"})}):(e=>m.key?[...e].sort(((e,t)=>{var n,r,a,s;let i=e[m.key],o=t[m.key];switch(m.key){case"numero":i=i||"",o=o||"";break;case"montant":i=parseFloat(i)||0,o=parseFloat(o)||0;break;case"dateEmission":case"dateEcheance":i=new Date(i||"1900-01-01"),o=new Date(o||"1900-01-01");break;case"statut":const e={brouillon:0,payable:1,en_retard:2,payee:3,annulee:4};i=null!==(n=e[null===(r=i)||void 0===r?void 0:r.toLowerCase()])&&void 0!==n?n:999,o=null!==(a=e[null===(s=o)||void 0===s?void 0:s.toLowerCase()])&&void 0!==a?a:999;break;default:i=(i||"").toString().toLowerCase(),o=(o||"").toString().toLowerCase()}return i<o?"asc"===m.direction?-1:1:i>o?"asc"===m.direction?1:-1:0})):e)(F).map((e=>{var n,r,a,s,i,o;return(0,$r.jsxs)("tr",{className:"".concat(Qx(e)?"facture-en-retard":""," ").concat("brouillon"===(null===(n=e.statut)||void 0===n?void 0:n.toLowerCase())?"facture-brouillon":""),children:[(0,$r.jsxs)("td",{children:[e.numero,"brouillon"===(null===(r=e.statut)||void 0===r?void 0:r.toLowerCase())&&(0,$r.jsx)("span",{style:{marginLeft:"8px",fontSize:"12px",backgroundColor:"#ffc107",color:"#000",padding:"2px 6px",borderRadius:"3px"},children:"BROUILLON"})]}),(0,$r.jsx)("td",{children:e.client}),(0,$r.jsx)("td",{children:Zx(e.montant,e.monnaie)}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge ".concat(Hx(e.statut)),children:Gx(e.statut)})}),(0,$r.jsx)("td",{children:$x(e.dateEmission)}),(0,$r.jsx)("td",{children:$x(e.dateEcheance)}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"actions-dropdown",children:[(0,$r.jsx)("button",{className:"btn-action",onClick:()=>{return t=e.id,void L((e=>e===t?null:t));var t},children:"Actions \u25be"}),(0,$r.jsxs)("div",{className:"dropdown-content ".concat(_===e.id?"show":""),children:[(0,$r.jsx)("button",{onClick:()=>(e=>{k(e),S(!0)})(e),children:"Voir d\xe9tails"}),(0,$r.jsx)("button",{onClick:async()=>await(async e=>{const t=new Qg,n=await V(),r=t.internal.pageSize.width,a=t.internal.pageSize.height,s=20;if(n)try{t.addImage(n,"PNG",s,10,40,20)}catch(l){console.error("Erreur lors de l'ajout du logo:",l),t.setFillColor(240,240,240),t.rect(s,10,40,20,"F"),t.setFontSize(8),t.setTextColor(100,100,100),t.text("LOGO",35,22)}else t.setFillColor(240,240,240),t.rect(s,10,40,20,"F"),t.setFontSize(8),t.setTextColor(100,100,100),t.text("LOGO",35,22);t.setFontSize(16),t.setTextColor(0,0,0),t.setFont("helvetica","bold"),t.text("SERVICES D'IMMIGRATION EXPERT",70,20),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("123 Rue Principale, Montr\xe9al, QC H1A 1A1",70,28),t.text("T\xe9l: (514) 123-4567 | Email: info@immigration-expert.ca",70,34),t.text("Num\xe9ro TPS: 123456789RT0001 | Num\xe9ro TVQ: 1234567890TQ0001",70,40),t.setLineWidth(.5),t.line(s,50,r-s,50),t.setFontSize(24),t.setFont("helvetica","bold"),t.setTextColor(41,128,185),t.text("FACTURE",r-s-50,70);let i=90;t.setFontSize(12),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("Num\xe9ro de facture:",r-s-80,i),t.setFont("helvetica","normal"),t.text(e.numero,r-s-20,i),i+=8,t.setFont("helvetica","bold"),t.text("Date d'\xe9mission:",r-s-80,i),t.setFont("helvetica","normal"),t.text($x(e.dateEmission),r-s-20,i),i+=8,t.setFont("helvetica","bold"),t.text("Date d'\xe9ch\xe9ance:",r-s-80,i),t.setFont("helvetica","normal"),t.text($x(e.dateEcheance),r-s-20,i),e.datePaiement&&(i+=8,t.setFont("helvetica","bold"),t.text("Date de paiement:",r-s-80,i),t.setFont("helvetica","normal"),t.text($x(e.datePaiement),r-s-20,i)),i=90,t.setFontSize(12),t.setFont("helvetica","bold"),t.text("FACTUR\xc9 \xc0:",s,i),i+=8,t.setFont("helvetica","normal"),t.setFontSize(11),t.text(e.client,s,i),i+=30,t.setFillColor(41,128,185),t.rect(s,i,r-40,10,"F"),t.setTextColor(255,255,255),t.setFont("helvetica","bold"),t.setFontSize(10),t.text("DESCRIPTION DU SERVICE",25,i+7),t.text("MONTANT (CAD)",r-s-40,i+7),i+=15,t.setTextColor(0,0,0),t.setFont("helvetica","normal"),t.text(e.description||"Service de consultation en immigration",25,i);const o=parseFloat(e.montant)||0;t.text("".concat(o.toFixed(2)," $"),r-s-40,i),i+=10,t.setLineWidth(.3),t.line(s,i,r-s,i),i+=15;const c=.15*o,u=o+c;t.setFont("helvetica","normal"),t.text("Sous-total (HT):",r-s-80,i),t.text("".concat(o.toFixed(2)," $"),r-s-25,i),i+=8,t.text("TVA (15%):",r-s-80,i),t.text("".concat(c.toFixed(2)," $"),r-s-25,i),i+=8,t.setFont("helvetica","bold"),t.setFontSize(12),t.text("TOTAL \xc0 PAYER:",r-s-80,i),t.text("".concat(u.toFixed(2)," $ CAD"),r-s-35,i),t.setLineWidth(1),t.rect(r-s-90,i-5,85,12),i+=25,e.methodePaiement&&(t.setFont("helvetica","bold"),t.setFontSize(10),t.text("M\xe9thode de paiement:",s,i),t.setFont("helvetica","normal"),t.text(e.methodePaiement,70,i),i+=8),t.setFont("helvetica","bold"),t.text("Statut de paiement:",s,i),t.setFont("helvetica","normal");const d=Gx(e.statut);t.text(d,70,i),i+=20,t.setFont("helvetica","bold"),t.setFontSize(10),t.text("CONDITIONS DE PAIEMENT:",s,i),i+=8,t.setFont("helvetica","normal"),t.setFontSize(9),t.text("\u2022 Paiement exigible dans les 30 jours suivant la date d'\xe9mission",s,i),i+=6,t.text("\u2022 Des frais de retard de 1,5% par mois s'appliquent aux paiements en retard",s,i),i+=6,t.text("\u2022 En cas de litige, les tribunaux de Montr\xe9al seront seuls comp\xe9tents",s,i);const h=a-30;t.setLineWidth(.5),t.line(s,h-5,r-s,h-5),t.setFont("helvetica","italic"),t.setFontSize(8),t.setTextColor(100,100,100),t.text("Merci de votre confiance | Services d'Immigration Expert",s,h),t.text("Facture g\xe9n\xe9r\xe9e le ".concat((new Date).toLocaleDateString("fr-CA")),r-s-60,h),t.save("Facture-Officielle-".concat(e.numero,".pdf"))})(e),children:"T\xe9l\xe9charger"}),(0,$r.jsx)("button",{onClick:async()=>await(async e=>{const t=new Qg,n=await V(),r=t.internal.pageSize.width,a=t.internal.pageSize.height,s=20;if(n)try{t.addImage(n,"PNG",s,10,40,20)}catch(l){console.error("Erreur lors de l'ajout du logo:",l),t.setFillColor(240,240,240),t.rect(s,10,40,20,"F"),t.setFontSize(8),t.setTextColor(100,100,100),t.text("LOGO",35,22)}else t.setFillColor(240,240,240),t.rect(s,10,40,20,"F"),t.setFontSize(8),t.setTextColor(100,100,100),t.text("LOGO",35,22);t.setFontSize(16),t.setTextColor(0,0,0),t.setFont("helvetica","bold"),t.text("SERVICES D'IMMIGRATION EXPERT",70,20),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("123 Rue Principale, Montr\xe9al, QC H1A 1A1",70,28),t.text("T\xe9l: (514) 123-4567 | Email: info@immigration-expert.ca",70,34),t.text("Num\xe9ro TPS: 123456789RT0001 | Num\xe9ro TVQ: 1234567890TQ0001",70,40),t.setLineWidth(.5),t.line(s,50,r-s,50),t.setFontSize(24),t.setFont("helvetica","bold"),t.setTextColor(41,128,185),t.text("FACTURE",r-s-50,70);let i=90;t.setFontSize(12),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("Num\xe9ro de facture:",r-s-80,i),t.setFont("helvetica","normal"),t.text(e.numero,r-s-20,i),i+=8,t.setFont("helvetica","bold"),t.text("Date d'\xe9mission:",r-s-80,i),t.setFont("helvetica","normal"),t.text($x(e.dateEmission),r-s-20,i),i+=8,t.setFont("helvetica","bold"),t.text("Date d'\xe9ch\xe9ance:",r-s-80,i),t.setFont("helvetica","normal"),t.text($x(e.dateEcheance),r-s-20,i),e.datePaiement&&(i+=8,t.setFont("helvetica","bold"),t.text("Date de paiement:",r-s-80,i),t.setFont("helvetica","normal"),t.text($x(e.datePaiement),r-s-20,i)),i=90,t.setFontSize(12),t.setFont("helvetica","bold"),t.text("FACTUR\xc9 \xc0:",s,i),i+=8,t.setFont("helvetica","normal"),t.setFontSize(11),t.text(e.client,s,i),i+=30,t.setFillColor(41,128,185),t.rect(s,i,r-40,10,"F"),t.setTextColor(255,255,255),t.setFont("helvetica","bold"),t.setFontSize(10),t.text("DESCRIPTION DU SERVICE",25,i+7),t.text("MONTANT (CAD)",r-s-40,i+7),i+=15,t.setTextColor(0,0,0),t.setFont("helvetica","normal"),t.text(e.description||"Service de consultation en immigration",25,i);const o=parseFloat(e.montant)||0;t.text("".concat(o.toFixed(2)," $"),r-s-40,i),i+=10,t.setLineWidth(.3),t.line(s,i,r-s,i),i+=15;const c=.15*o,u=o+c;t.setFont("helvetica","normal"),t.text("Sous-total (HT):",r-s-80,i),t.text("".concat(o.toFixed(2)," $"),r-s-25,i),i+=8,t.text("TVA (15%):",r-s-80,i),t.text("".concat(c.toFixed(2)," $"),r-s-25,i),i+=8,t.setFont("helvetica","bold"),t.setFontSize(12),t.text("TOTAL \xc0 PAYER:",r-s-80,i),t.text("".concat(u.toFixed(2)," $ CAD"),r-s-35,i),t.setLineWidth(1),t.rect(r-s-90,i-5,85,12),i+=25,e.methodePaiement&&(t.setFont("helvetica","bold"),t.setFontSize(10),t.text("M\xe9thode de paiement:",s,i),t.setFont("helvetica","normal"),t.text(e.methodePaiement,70,i),i+=8),t.setFont("helvetica","bold"),t.text("Statut de paiement:",s,i),t.setFont("helvetica","normal");const d=Gx(e.statut);t.text(d,70,i),i+=20,t.setFont("helvetica","bold"),t.setFontSize(10),t.text("CONDITIONS DE PAIEMENT:",s,i),i+=8,t.setFont("helvetica","normal"),t.setFontSize(9),t.text("\u2022 Paiement exigible dans les 30 jours suivant la date d'\xe9mission",s,i),i+=6,t.text("\u2022 Des frais de retard de 1,5% par mois s'appliquent aux paiements en retard",s,i),i+=6,t.text("\u2022 En cas de litige, les tribunaux de Montr\xe9al seront seuls comp\xe9tents",s,i);const h=a-30;t.setLineWidth(.5),t.line(s,h-5,r-s,h-5),t.setFont("helvetica","italic"),t.setFontSize(8),t.setTextColor(100,100,100),t.text("Merci de votre confiance | Services d'Immigration Expert",s,h),t.text("Facture g\xe9n\xe9r\xe9e le ".concat((new Date).toLocaleDateString("fr-CA")),r-s-60,h),window.open(t.output("bloburl"),"_blank")})(e),children:"Imprimer"}),Yx(e.statut,t)&&(0,$r.jsx)("button",{onClick:()=>(e=>{var t;console.log("\ud83d\udd27 Ouverture \xe9dition pour facture:",e);let n=[];if(e.prestations_details)try{n=JSON.parse(e.prestations_details),console.log("\ud83d\udccb Prestations extraites:",n),n=n.map((e=>({description:e.description||"",montant:parseFloat(e.montant)||0})))}catch(l){console.error("Erreur parsing prestations_details:",l),n=[{description:e.description||"",montant:parseFloat(e.montant)||0}]}else n=e.prestations&&Array.isArray(e.prestations)?e.prestations.map((e=>({description:e.description||"",montant:parseFloat(e.montant)||0}))):[{description:e.description||"",montant:parseFloat(e.montant)||0}];const r=n.reduce(((e,t)=>e+(parseFloat(t.montant)||0)),0),a=.15*r,s=r+a;console.log("\ud83d\udcb0 Montants calcul\xe9s:",{montantHT:r,tva:a,montantTTC:s});const i=u(u({},e),{},{prestations:n,montantHT:r,tva:a,montantTTC:s,date:e.dateEmission||(null===(t=e.date_creation)||void 0===t?void 0:t.split("T")[0])||(new Date).toISOString().split("T")[0]});console.log("\ud83d\udcdd Facture compl\xe8te pour \xe9dition:",i),P(i),A(!0),L(null)})(e),children:"\u270f\ufe0f Modifier"}),"brouillon"===(null===(a=e.statut)||void 0===a?void 0:a.toLowerCase())&&(0,$r.jsx)("button",{onClick:()=>U(e.id,"Payable"),style:{backgroundColor:"#2196f3",color:"white"},children:"\ud83d\udcdd Rendre payable"}),Yx(e.statut,t)&&"payee"!==(null===(s=e.statut)||void 0===s?void 0:s.toLowerCase())&&(0,$r.jsx)("button",{onClick:()=>U(e.id,"Pay\xe9e","Carte de cr\xe9dit"),children:"Marquer comme pay\xe9e"}),Yx(e.statut,t)&&"en_retard"!==(null===(i=e.statut)||void 0===i?void 0:i.toLowerCase())&&(0,$r.jsx)("button",{onClick:()=>U(e.id,"En retard"),children:"Marquer en retard"}),"annulee"!==(null===(o=e.statut)||void 0===o?void 0:o.toLowerCase())&&(0,$r.jsx)("button",{onClick:()=>U(e.id,"Annul\xe9e"),children:"Annuler la facture"})]})]})})]},e.id)}))})]})}),w&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Cr\xe9er une nouvelle facture"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>j(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),x.selectedClientId&&x.montant&&x.description)try{console.log("\ud83d\udcdd Envoi des donn\xe9es de cr\xe9ation de facture:",{client_id:x.selectedClientId,montant:x.montant,monnaie:x.monnaie,description:x.description,dateEmission:x.dateEmission,dateEcheance:x.dateEcheance});const e=await Ux({client_id:x.selectedClientId,montant:parseFloat(x.montant),monnaie:x.monnaie,description:x.description,dateEmission:x.dateEmission,dateEcheance:x.dateEcheance,statut:"brouillon"});if(!e.success)throw new Error(e.message||"Erreur lors de la cr\xe9ation de la facture");console.log("\u2705 Facture cr\xe9\xe9e avec succ\xe8s:",e.data),await I(),y({client:"",selectedClientId:null,montant:"",monnaie:"MAD",dateEmission:(new Date).toISOString().split("T")[0],dateEcheance:"",description:""}),j(!1),alert("Facture cr\xe9\xe9e avec succ\xe8s !")}catch(l){console.error("\u274c Erreur lors de la cr\xe9ation de la facture:",l),alert("Erreur lors de la cr\xe9ation de la facture: "+l.message)}else alert("Veuillez remplir tous les champs requis (client, montant, description)")},children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Client:"}),(0,$r.jsx)(Kx,{value:x.client,onSelect:e=>{y(u(u({},x),{},{client:e.displayText||"",selectedClientId:e.clientId||null}))},placeholder:"Rechercher un client par nom ou t\xe9l\xe9phone...",required:!0}),x.selectedClientId&&(0,$r.jsxs)("small",{style:{color:"#666",fontSize:"12px",marginTop:"4px",display:"block"},children:["\u2705 Client s\xe9lectionn\xe9 (ID: ",x.selectedClientId,")"]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Montant TTC:"}),(0,$r.jsx)("input",{type:"number",name:"montant",value:x.montant,onChange:z,step:"0.01",min:"0",required:!0}),x.montant&&(0,$r.jsx)("small",{style:{color:"#666",fontSize:"12px",display:"block",marginTop:"4px"},children:ey(x.montant,x.monnaie)})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Monnaie:"}),(0,$r.jsxs)("select",{name:"monnaie",value:x.monnaie,onChange:z,required:!0,children:[(0,$r.jsx)("option",{value:"MAD",children:"MAD (Dirham Marocain)"}),(0,$r.jsx)("option",{value:"CAD",children:"CAD (Dollar Canadien)"})]})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date d'\xe9mission:"}),(0,$r.jsx)("input",{type:"date",name:"dateEmission",value:x.dateEmission,onChange:e=>{const t=e.target.value,n=(e=>{const t=new Date(e);return t.setDate(t.getDate()+30),t.toISOString().split("T")[0]})(t);y(u(u({},x),{},{dateEmission:t,dateEcheance:n}))},required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date d'\xe9ch\xe9ance:"}),(0,$r.jsx)("input",{type:"date",name:"dateEcheance",value:x.dateEcheance,onChange:z,required:!0,readOnly:!0})]})]}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Description:"}),(0,$r.jsx)("textarea",{name:"description",value:x.description,onChange:z,required:!0})]})}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>j(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Cr\xe9er"})]})]})]})}),N&&C&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"D\xe9tails de la facture"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>S(!1),children:"\xd7"})]}),(0,$r.jsxs)("div",{className:"facture-details",children:[(0,$r.jsxs)("div",{className:"facture-info",children:[(0,$r.jsx)("h4",{children:"Informations g\xe9n\xe9rales"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Num\xe9ro:"})," ",C.numero]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Client:"})," ",C.client]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Montant:"})," ",ey(C.montant,C.monnaie)]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"}),(0,$r.jsx)("span",{className:"statut-badge statut-".concat(C.statut.toLowerCase().replace(/\s+/g,"-")),children:C.statut})]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date d'\xe9mission:"})," ",C.dateEmission]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date d'\xe9ch\xe9ance:"})," ",C.dateEcheance]}),C.datePaiement&&(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date de paiement:"})," ",C.datePaiement]}),C.methodePaiement&&(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"M\xe9thode de paiement:"})," ",C.methodePaiement]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Description:"})," ",C.description]})]}),"Pay\xe9e"!==C.statut&&"Annul\xe9e"!==C.statut&&(0,$r.jsxs)("div",{className:"facture-actions",children:[(0,$r.jsx)("h4",{children:"Actions"}),(0,$r.jsxs)("div",{className:"paiement-form",children:[(0,$r.jsx)("h5",{children:"Marquer comme pay\xe9e"}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"M\xe9thode de paiement:"}),(0,$r.jsxs)("select",{id:"methodePaiement",defaultValue:"",onChange:e=>{e.target.value&&(console.log("\ud83d\udd04 Tentative de changement de statut avec m\xe9thode:",e.target.value),U(C.id,"Pay\xe9e",e.target.value))},children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner une m\xe9thode"}),["Carte de cr\xe9dit","Virement bancaire","Ch\xe8que","Esp\xe8ces","PayPal"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsx)("div",{className:"paiement-actions",children:(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>{S(!1),k(null)},style:{marginTop:"10px"},children:"FERMER"})}),(0,$r.jsxs)("div",{className:"other-actions",children:["En retard"!==C.statut&&(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>U(C.id,"En retard"),children:"Marquer en retard"}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>U(C.id,"Annul\xe9e"),children:"Annuler la facture"})]})]})]})]}),(0,$r.jsx)("div",{className:"modal-footer",children:(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>S(!1),children:"Fermer"})})]})}),E&&T&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsx)("div",{className:"modal-content",children:(0,$r.jsx)(wm,{client:{nom:T.client,prenom:"",email:"",telephone:"",numeroDossier:T.numero},userRole:t,existingFacture:T,onCancel:()=>{A(!1),P(null)},onSave:async e=>{try{var t;console.log("\ud83d\udcdd === DEBUT SAUVEGARDE FACTURE ==="),console.log("\ud83d\udcdd Facture re\xe7ue pour sauvegarde:",e);const{id:n,numero:r,date:a,prestations:s}=e,i=o(e,Jx);let l=[];Array.isArray(s)&&s.length>0&&(l=s.filter((e=>e&&(e.description||e.montant))).map((e=>({description:(e.description||"").trim()||"Service de consultation",montant:parseFloat(e.montant)||0})))),0===l.length&&(l=[{description:"Service de consultation",montant:0}]),console.log("\ud83d\udccb Prestations valid\xe9es:",l);const c=l.reduce(((e,t)=>e+(parseFloat(t.montant)||0)),0),u=Math.round(100*c)/100;console.log("\ud83d\udcb0 === CALCULS MONTANTS ==="),console.log("\ud83d\udcb0 Montant HT calcul\xe9:",c),console.log("\ud83d\udcb0 Montant final (arrondi):",u),console.log("\ud83d\udcb0 TVA (15%):",Math.round(.15*u*100)/100),console.log("\ud83d\udcb0 TTC:",Math.round(1.15*u*100)/100);const h=l.reduce(((e,t)=>e+t.montant),0);Math.abs(h-u)>.01&&(console.log("\u26a0\ufe0f Correction automatique des prestations"),console.log("\u26a0\ufe0f Somme prestations: ".concat(h,", Montant attendu: ").concat(u)),l.length>0&&(l[0].montant=u,l[0].description="Service de consultation - ".concat(u," CAD"))),console.log("\ud83d\udccb Prestations finales:",l);const f={numero:r||"F-".concat((new Date).getFullYear(),"-").concat(String(Date.now()).slice(-3)),montant:u,dateEmission:a||(new Date).toISOString().split("T")[0],description:(null===(t=l[0])||void 0===t?void 0:t.description)||"Service de consultation",statut:e.statut||"brouillon",prestations_details:JSON.stringify(l),dateValidation:(new Date).toISOString(),validePar:d||"utilisateur",client:i.client,client_id:i.client_id,dateEcheance:i.dateEcheance,datePaiement:i.datePaiement,methodePaiement:i.methodePaiement};console.log("\ud83d\udce4 === PAYLOAD FINAL ==="),console.log("\ud83d\udce4 Payload \xe0 envoyer:",f),console.log("\ud83d\udce4 Montant final dans payload:",f.montant),console.log("\ud83d\udce4 Prestations_details:",f.prestations_details);const p=await qx(n,f);p.success?(console.log("\u2705 === SAUVEGARDE REUSSIE ==="),console.log("\u2705 Facture mise \xe0 jour avec succ\xe8s"),console.log("\u2705 Montant sauvegard\xe9:",f.montant),await I(),A(!1),P(null),alert("\u2705 Facture ".concat(f.numero," mise \xe0 jour avec succ\xe8s!\nMontant: ").concat(f.montant," $ (HT)"))):(console.error("\u274c Erreur API:",p.error),alert("\u274c Erreur lors de la mise \xe0 jour: ".concat(p.error||"Erreur inconnue")))}catch(Qm){console.error("\u274c === ERREUR SAUVEGARDE ==="),console.error("\u274c Erreur lors de la sauvegarde:",Qm),alert("\u274c Erreur lors de la mise \xe0 jour de la facture")}}})})})]})},ny="http://localhost:5000/api",ry=()=>{const e=localStorage.getItem("token");console.log("\ud83d\udd11 Token trouv\xe9 dans localStorage:",e?"OUI":"NON");const t={};return e?(t.Authorization="Bearer ".concat(e),console.log("\u2705 Header Authorization ajout\xe9")):console.warn("\u26a0\ufe0f Aucun token trouv\xe9 - l'utilisateur n'est peut-\xeatre pas connect\xe9"),t},ay={getAllRendezVous:async()=>{try{return(await Yr.get("".concat(ny,"/rendez-vous"),{headers:ry()})).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des rendez-vous:",uw),uw}},getRendezVousByConseillere:async e=>{try{return(await Yr.get("".concat(ny,"/rendez-vous"),{headers:ry(),params:{conseiller:e}})).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des rendez-vous pour ".concat(e,":"),uw),uw}},getRendezVousById:async e=>{try{return(await Yr.get("".concat(ny,"/rendez-vous/").concat(e),{headers:ry()})).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration du rendez-vous ".concat(e,":"),uw),uw}},createRendezVous:async e=>{try{return(await Yr.post("".concat(ny,"/rendez-vous"),e,{headers:ry()})).data}catch(uw){throw uw.response?console.error("Erreur lors de la cr\xe9ation du rendez-vous:",uw.response.data):console.error("Erreur lors de la cr\xe9ation du rendez-vous:",uw),uw}},updateRendezVous:async(e,t)=>{try{return(await Yr.put("".concat(ny,"/rendez-vous/").concat(e),t,{headers:ry()})).data}catch(uw){throw console.error("Erreur lors de la mise \xe0 jour du rendez-vous ".concat(e,":"),uw),uw}},deleteRendezVous:async e=>{try{return(await Yr.delete("".concat(ny,"/rendez-vous/").concat(e),{headers:ry()})).data}catch(uw){throw console.error("Erreur lors de la suppression du rendez-vous ".concat(e,":"),uw),uw}},checkConflicts:async e=>{try{return(await Yr.post("".concat(ny,"/rendez-vous/check-conflicts"),e,{headers:ry()})).data}catch(uw){throw console.error("Erreur lors de la v\xe9rification des conflits:",uw),uw}}};const sy=function(){const[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)(!0),[a,i]=(0,s.useState)({key:null,direction:"asc"}),[o,l]=(0,s.useState)({conseillere:"",statut:"",date:"",type:""}),[c,d]=(0,s.useState)({client:"",conseillere:"",date:"",heureDebut:"",heureFin:"",type:"",notes:""}),[h,f]=(0,s.useState)(!1),[p,m]=(0,s.useState)(!1),[g,v]=(0,s.useState)(null),[b,x]=(0,s.useState)("liste"),[y,w]=(0,s.useState)([]),[j,N]=(0,s.useState)([]),[S,C]=(0,s.useState)([]),[k,E]=(0,s.useState)(!0),[A,T]=(0,s.useState)(!0),[P,_]=(0,s.useState)(!0),[L,R]=(0,s.useState)(""),[D,I]=(0,s.useState)([]),[O,F]=(0,s.useState)(!1),M=["Confirm\xe9","En attente","Annul\xe9","Termin\xe9"],B=["Consultation initiale","Suivi de dossier","Consultation finale","Autre"],z=e=>{let t="asc";a.key===e&&"asc"===a.direction&&(t="desc"),i({key:e,direction:t}),console.log("\ud83d\udd04 Tri des rendez-vous par ".concat(e," en ordre ").concat(t))},U=e=>a.key!==e?(0,$r.jsx)("span",{className:"sort-icon",title:"Cliquer pour trier",children:"\u21f5"}):(0,$r.jsx)("span",{className:"sort-icon active",title:"Tri\xe9 par ".concat(e," (").concat("asc"===a.direction?"croissant":"d\xe9croissant",")"),children:"asc"===a.direction?"\u25b4":"\u25be"});(0,s.useEffect)((()=>{(async()=>{try{r(!0),console.log("\ud83d\udd04 Chargement des rendez-vous...");const e=await ay.getAllRendezVous();if(e.success&&e.data&&e.data.rendezVous){console.log("\ud83d\udce5 Donn\xe9es brutes re\xe7ues de l'API:",e.data);const n=e.data.rendezVous.map((e=>({id:e.id,client:e.client_nom,conseillere:e.conseillere_nom,date:e.date_rdv,heureDebut:e.heure_debut?e.heure_debut.substring(0,5):"",heureFin:e.heure_fin?e.heure_fin.substring(0,5):"",type:e.type_rdv,statut:e.statut,notes:e.notes||""})));t(n),console.log("\u2705 Rendez-vous charg\xe9s et transform\xe9s:",n),console.log("\ud83d\udccb Total: ".concat(n.length," rendez-vous charg\xe9s"))}else t([]),console.warn("\u26a0\ufe0f Aucun rendez-vous trouv\xe9 dans la r\xe9ponse:",e)}catch(uw){console.error("\u274c Erreur lors du chargement des rendez-vous:",uw),t([])}finally{r(!1)}})()}),[]),(0,s.useEffect)((()=>{(async()=>{try{E(!0),console.log("\ud83d\udd04 Chargement des conseill\xe8res dans RendezVous...");const e=await Zr();if(e.success&&e.data){const t=e.data.map((e=>e.nomComplet));w(t),console.log("\u2705 Conseill\xe8res charg\xe9es dans RendezVous:",t)}else w(["Marie Tremblay","Sophie Martin","Julie Lefebvre"]),console.warn("\u26a0\ufe0f Utilisation de la liste par d\xe9faut des conseill\xe8res")}catch(uw){console.error("\u274c Erreur lors du chargement des conseill\xe8res dans RendezVous:",uw),w(["Marie Tremblay","Sophie Martin","Julie Lefebvre"])}finally{E(!1)}})()}),[]),(0,s.useEffect)((()=>{if(!k&&y.length>0&&!c.conseillere){const e=localStorage.getItem("userName");if(console.log("\ud83d\udc64 Utilisateur connect\xe9 r\xe9cup\xe9r\xe9:",e),console.log("\ud83d\udccb Liste des conseill\xe8res disponibles:",y),e){const t=y.find((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())));t?(console.log("\u2705 Pr\xe9remplissage du champ conseill\xe8re avec:",t),d((e=>u(u({},e),{},{conseillere:t})))):console.log("\u26a0\ufe0f Utilisateur connect\xe9 non trouv\xe9 dans la liste des conseill\xe8res:",{userName:e,conseilleresOptions:y,recherchePartielle:y.filter((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())))})}else console.log("\u26a0\ufe0f Aucun utilisateur connect\xe9 trouv\xe9 dans localStorage")}}),[k,y,c.conseillere]),(0,s.useEffect)((()=>{(async()=>{try{T(!0),console.log("\ud83d\udd04 Chargement des clients dans RendezVous...");const e=await Dx.getAllClients();e.success&&e.data&&e.data.clients?(N(e.data.clients),console.log("\u2705 Clients charg\xe9s dans RendezVous:",e.data.clients.length,"clients")):(N([]),console.warn("\u26a0\ufe0f Aucun client charg\xe9"))}catch(uw){console.error("\u274c Erreur lors du chargement des clients dans RendezVous:",uw),N([])}finally{T(!1)}})()}),[]),(0,s.useEffect)((()=>{(async()=>{try{_(!0),console.log("\ud83d\udd04 Chargement des leads dans RendezVous...");const e=await aa();e.success&&e.data&&e.data.leads?(C(e.data.leads),console.log("\u2705 Leads charg\xe9s dans RendezVous:",e.data.leads.length,"leads")):(C([]),console.warn("\u26a0\ufe0f Aucun lead charg\xe9"))}catch(uw){console.error("\u274c Erreur lors du chargement des leads dans RendezVous:",uw),C([])}finally{_(!1)}})()}),[]),(0,s.useEffect)((()=>{const e=e=>{O&&!e.target.closest(".client-search-container")&&F(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[O]);const q=e.filter((e=>{const t=""===o.conseillere||e.conseillere===o.conseillere,n=""===o.statut||e.statut===o.statut,r=""===o.date||e.date===o.date,a=""===o.type||e.type===o.type,s=t&&n&&r&&a;return s||console.log("\ud83d\udd0d RDV ".concat(e.id," filtr\xe9:"),{rdv:"".concat(e.client," - ").concat(e.date," ").concat(e.heureDebut),conseillerMatch:"".concat(e.conseillere," vs ").concat(o.conseillere," = ").concat(t),statutMatch:"".concat(e.statut," vs ").concat(o.statut," = ").concat(n),dateMatch:"".concat(e.date," vs ").concat(o.date," = ").concat(r),typeMatch:"".concat(e.type," vs ").concat(o.type," = ").concat(a)}),s}));console.log("\ud83d\udcca Filtrage: ".concat(e.length," total \u2192 ").concat(q.length," affich\xe9s"),{filtres:o,totalRendezVous:e.length,rendezVousAffiches:q.length});const V=e=>{const{name:t,value:n}=e.target;l(u(u({},o),{},{[t]:n}))},W=e=>{const{name:t,value:n}=e.target;d(u(u({},c),{},{[t]:n}))},H=()=>{R(""),I([]),F(!1),d(u(u({},c),{},{client:"",client_type:"",client_id:""}))},G=()=>{const e=localStorage.getItem("userName");let t="";if(e&&y.length>0){const n=y.find((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())));n&&(t=n)}d({client:"",conseillere:t,date:"",heureDebut:"",heureFin:"",type:"",notes:"",client_type:"",client_id:""}),R(""),I([]),F(!1),console.log("\ud83d\udd04 Formulaire r\xe9initialis\xe9 avec conseill\xe8re pr\xe9remplie:",t)},Y=()=>{f(!1),G()},$=e=>{v(e),m(!0)},K=async(n,r)=>{try{console.log("\ud83d\udd04 Mise \xe0 jour du statut du rendez-vous ".concat(n," vers ").concat(r,"..."));const a=e.find((e=>e.id===n));if(!a)return void console.error("Rendez-vous non trouv\xe9:",n);const s={client_nom:a.client,conseillere_nom:a.conseillere,date_rdv:a.date,heure_debut:a.heureDebut,heure_fin:a.heureFin,type_rdv:a.type,statut:r,notes:a.notes||""},i=await ay.updateRendezVous(n,s);if(i.success&&i.data){const a=e.map((e=>e.id===n?u(u({},e),{},{statut:r}):e));t(a),g&&g.id===n&&v(u(u({},g),{},{statut:r})),console.log("\u2705 Statut mis \xe0 jour avec succ\xe8s");const s={"En attente":"Rendez-vous mis en attente","Confirm\xe9":"Rendez-vous confirm\xe9","Termin\xe9":"Rendez-vous marqu\xe9 comme termin\xe9","Annul\xe9":"Rendez-vous annul\xe9"},i=document.createElement("div");i.textContent="\u2705 ".concat(s[r]||"Statut mis \xe0 jour"),i.style.cssText="\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: #4caf50;\n          color: white;\n          padding: 10px 20px;\n          border-radius: 5px;\n          z-index: 9999;\n          font-size: 14px;\n          font-weight: 500;\n        ",document.body.appendChild(i),setTimeout((()=>{document.body.removeChild(i)}),3e3)}else console.error("\u274c Erreur lors de la mise \xe0 jour:",i.message),alert("Erreur lors de la mise \xe0 jour: ".concat(i.message||"Erreur inconnue"))}catch(uw){console.error("\u274c Erreur lors de la mise \xe0 jour du statut:",uw),alert("Erreur lors de la mise \xe0 jour du statut")}},J=()=>{if(c.date&&c.heureDebut&&c.heureFin&&c.conseillere){const t=function(t,n,r,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return e.some((e=>{if(e.id===s||"Annul\xe9"===e.statut)return!1;if(e.date===t&&e.conseillere===a){const a=new Date("".concat(t,"T").concat(n)),s=new Date("".concat(t,"T").concat(r)),i=new Date("".concat(t,"T").concat(e.heureDebut));return a<new Date("".concat(t,"T").concat(e.heureFin))&&s>i}return!1}))}(c.date,c.heureDebut,c.heureFin,c.conseillere);return!t}return!0},X=e=>new Date(e).toLocaleDateString("fr-CA",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Q=(()=>{const e=[];for(let t=9;t<=17;t++)for(let n=0;n<60;n+=30){const r="".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"));e.push(r)}return e})(),Z=e=>{switch(e){case"Confirm\xe9":return"statut-confirme";case"En attente":return"statut-en-attente";case"Annul\xe9":return"statut-annule";case"Termin\xe9":return"statut-termine";default:return""}};return(0,$r.jsxs)("div",{className:"rendez-vous-container",children:[(0,$r.jsxs)("div",{className:"rendez-vous-header",children:[(0,$r.jsx)("h2",{children:"Gestion des Rendez-vous"}),(0,$r.jsxs)("div",{className:"header-actions",children:[(0,$r.jsxs)("div",{className:"vue-toggle",children:[(0,$r.jsx)("button",{className:"btn-toggle ".concat("liste"===b?"active":""),onClick:()=>x("liste"),children:"Liste"}),(0,$r.jsx)("button",{className:"btn-toggle ".concat("calendrier"===b?"active":""),onClick:()=>x("calendrier"),children:"Calendrier"})]}),(0,$r.jsxs)("button",{className:"btn-primary",onClick:()=>{f(!0),setTimeout((()=>{if(!k&&y.length>0){const e=localStorage.getItem("userName");if(e){const t=y.find((t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())));t&&!c.conseillere&&(console.log("\u2705 Pr\xe9remplissage manuel du champ conseill\xe8re:",t),d((e=>u(u({},e),{},{conseillere:t}))))}}}),100),H()},children:[(0,$r.jsx)("span",{children:"+"})," Nouveau Rendez-vous"]})]})]}),(0,$r.jsxs)("div",{className:"filtres-container",children:[(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:o.conseillere,onChange:V,disabled:k,children:[(0,$r.jsx)("option",{value:"",children:k?"Chargement...":"Toutes"}),y.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:o.statut,onChange:V,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),M.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Date:"}),(0,$r.jsx)("input",{type:"date",name:"date",value:o.date,onChange:V})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Type:"}),(0,$r.jsxs)("select",{name:"type",value:o.type,onChange:V,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),B.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{l({conseillere:"",statut:"",date:"",type:""})},children:"R\xe9initialiser"})]}),"liste"===b?(0,$r.jsx)("div",{className:"rdv-table-container",children:(0,$r.jsxs)("table",{className:"rdv-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsxs)("th",{onClick:()=>z("client"),className:"client"===a.key?"sorted":"",children:["Client ",U("client")]}),(0,$r.jsxs)("th",{onClick:()=>z("conseillere"),className:"conseillere"===a.key?"sorted":"",children:["Conseill\xe8re ",U("conseillere")]}),(0,$r.jsxs)("th",{onClick:()=>z("date"),className:"date"===a.key?"sorted":"",children:["Date ",U("date")]}),(0,$r.jsxs)("th",{onClick:()=>z("heureDebut"),className:"heureDebut"===a.key?"sorted":"",children:["Heure ",U("heureDebut")]}),(0,$r.jsxs)("th",{onClick:()=>z("type"),className:"type"===a.key?"sorted":"",children:["Type ",U("type")]}),(0,$r.jsxs)("th",{onClick:()=>z("statut"),className:"statut"===a.key?"sorted":"",children:["Statut ",U("statut")]}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:n?(0,$r.jsx)("tr",{children:(0,$r.jsx)("td",{colSpan:"7",className:"loading-cell",children:"\ud83d\udd04 Chargement des rendez-vous..."})}):0===q.length?(0,$r.jsx)("tr",{children:(0,$r.jsx)("td",{colSpan:"7",className:"empty-cell",children:"Aucun rendez-vous trouv\xe9"})}):(ee=q,a.key?[...ee].sort(((e,t)=>{var n,r,s,i;let o=e[a.key],l=t[a.key];switch(a.key){case"client":case"conseillere":case"type":default:o=(o||"").toString().toLowerCase(),l=(l||"").toString().toLowerCase();break;case"date":o=new Date(o||"1900-01-01"),l=new Date(l||"1900-01-01");break;case"heureDebut":o=o?"".concat(e.date," ").concat(e.heureDebut):"1900-01-01 00:00",l=l?"".concat(t.date," ").concat(t.heureDebut):"1900-01-01 00:00",o=new Date(o),l=new Date(l);break;case"statut":const a={"en attente":0,"confirm\xe9":1,"termin\xe9":2,"annul\xe9":3};o=null!==(n=a[null===(r=o)||void 0===r?void 0:r.toLowerCase()])&&void 0!==n?n:999,l=null!==(s=a[null===(i=l)||void 0===i?void 0:i.toLowerCase()])&&void 0!==s?s:999}return o<l?"asc"===a.direction?-1:1:o>l?"asc"===a.direction?1:-1:0})):ee).map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.client}),(0,$r.jsx)("td",{children:e.conseillere}),(0,$r.jsx)("td",{children:X(e.date)}),(0,$r.jsxs)("td",{children:[e.heureDebut," - ",e.heureFin]}),(0,$r.jsx)("td",{children:e.type}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"statut-container",children:[(0,$r.jsx)("select",{className:"statut-select ".concat(Z(e.statut)),value:e.statut,onChange:t=>{const n=t.target.value;if(e.statut!==n){if("Annul\xe9"===n&&"Confirm\xe9"===e.statut||"Termin\xe9"===n){const r="Annul\xe9"===n?"\xcates-vous s\xfbr de vouloir annuler le rendez-vous avec ".concat(e.client," ?"):"\xcates-vous s\xfbr de marquer ce rendez-vous avec ".concat(e.client," comme termin\xe9 ?");window.confirm(r)?K(e.id,n):t.target.value=e.statut}else K(e.id,n)}},title:"Cliquez pour changer le statut",children:M.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))}),(0,$r.jsx)("span",{className:"statut-badge ".concat(Z(e.statut)),children:e.statut})]})}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"actions-dropdown",children:[(0,$r.jsx)("button",{className:"btn-action",children:"Actions"}),(0,$r.jsxs)("div",{className:"dropdown-content",children:[(0,$r.jsx)("button",{onClick:()=>$(e),children:"Voir d\xe9tails"}),(0,$r.jsx)("button",{onClick:()=>K(e.id,"En attente"),children:"\u2192 En attente"}),(0,$r.jsx)("button",{onClick:()=>K(e.id,"Confirm\xe9"),children:"\u2192 Confirm\xe9"}),(0,$r.jsx)("button",{onClick:()=>{window.confirm("\xcates-vous s\xfbr de marquer ce rendez-vous avec ".concat(e.client," comme termin\xe9 ?"))&&K(e.id,"Termin\xe9")},children:"\u2192 Termin\xe9"}),(0,$r.jsx)("button",{onClick:()=>{window.confirm("\xcates-vous s\xfbr de vouloir annuler le rendez-vous avec ".concat(e.client," ?"))&&K(e.id,"Annul\xe9")},children:"\u2192 Annul\xe9"})]})]})}),"                  "]},e.id)))})]})}):(()=>{const e=new Date,t=new Date(e);t.setDate(e.getDate()-e.getDay()+1);const n=[];for(let r=0;r<5;r++){const e=new Date(t);e.setDate(t.getDate()+r),n.push(e)}return(0,$r.jsxs)("div",{className:"calendrier-container",children:[(0,$r.jsxs)("div",{className:"calendrier-header",children:[(0,$r.jsx)("div",{className:"calendrier-heure-col"}),n.map(((e,t)=>(0,$r.jsx)("div",{className:"calendrier-jour-col",children:(0,$r.jsxs)("div",{className:"calendrier-jour-header",children:[e.toLocaleDateString("fr-CA",{weekday:"long"}),(0,$r.jsx)("div",{className:"calendrier-jour-date",children:e.toLocaleDateString("fr-CA",{day:"numeric",month:"numeric"})})]})},t)))]}),(0,$r.jsx)("div",{className:"calendrier-body",children:Q.map(((e,t)=>(0,$r.jsxs)("div",{className:"calendrier-row",children:[(0,$r.jsx)("div",{className:"calendrier-heure-col",children:e}),n.map(((t,n)=>{const r=t.toISOString().split("T")[0],a=q.filter((t=>t.date===r&&t.heureDebut<=e&&t.heureFin>e));return(0,$r.jsx)("div",{className:"calendrier-jour-col",children:a.map((t=>{if(!(t.heureDebut===e))return null;const n=Q.indexOf(t.heureDebut),r=Q.indexOf(t.heureFin)-n;return(0,$r.jsxs)("div",{className:"calendrier-event ".concat(Z(t.statut)),style:{height:"".concat(30*r,"px")},onClick:()=>$(t),children:[(0,$r.jsxs)("div",{className:"calendrier-event-header",children:[t.heureDebut," - ",t.heureFin]}),(0,$r.jsx)("div",{className:"calendrier-event-client",children:t.client}),(0,$r.jsx)("div",{className:"calendrier-event-type",children:t.type})]},t.id)}))},n)}))]},t)))})]})})(),h&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Ajouter un nouveau rendez-vous"}),(0,$r.jsx)("button",{className:"close-btn",onClick:Y,children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async n=>{n.preventDefault();try{if(!c.client||!c.conseillere||!c.date||!c.heureDebut||!c.heureFin||!c.type)return alert("Veuillez remplir tous les champs obligatoires."),void console.log("\u274c Champs manquants:",{client:!c.client,conseillere:!c.conseillere,date:!c.date,heureDebut:!c.heureDebut,heureFin:!c.heureFin,type:!c.type});if(!J())return void alert("Conflit d'horaire d\xe9tect\xe9 ! La conseill\xe8re a d\xe9j\xe0 un rendez-vous \xe0 cette heure.");console.log("\ud83d\udd04 Cr\xe9ation du rendez-vous..."),console.log("\ud83d\udccb Donn\xe9es du formulaire:",c);const n={client_nom:c.client,client_id:c.client_id||null,client_type:c.client_type||"client",conseillere_nom:c.conseillere,date_rdv:c.date,heure_debut:c.heureDebut,heure_fin:c.heureFin,type_rdv:c.type,statut:"Confirm\xe9",notes:c.notes||""};console.log("\ud83d\udce4 Donn\xe9es \xe0 envoyer \xe0 l'API:",n);const r=await ay.createRendezVous(n);if(r.success&&r.data){console.log("\ud83d\udce5 R\xe9ponse compl\xe8te de l'API cr\xe9ation:",r),console.log("\ud83d\udce5 Donn\xe9es de creation dans result.data:",r.data);const n=r.data.rendezVous||r.data;console.log("\ud83d\udccb Donn\xe9es RDV extraites:",n);const s={id:n.id,client:n.client_nom,conseillere:n.conseillere_nom,date:n.date_rdv,heureDebut:n.heure_debut?n.heure_debut.substring(0,5):c.heureDebut,heureFin:n.heure_fin?n.heure_fin.substring(0,5):c.heureFin,type:n.type_rdv,statut:n.statut,notes:n.notes||""};t([...e,s]),G(),f(!1),console.log("\u2705 Rendez-vous cr\xe9\xe9 avec succ\xe8s:",s),alert("Rendez-vous cr\xe9\xe9 avec succ\xe8s !");try{console.log("\ud83d\udd04 Rechargement de la liste des rendez-vous...");const e=await ay.getAllRendezVous();if(e.success&&e.data&&e.data.rendezVous){const n=e.data.rendezVous.map((e=>({id:e.id,client:e.client_nom,conseillere:e.conseillere_nom,date:e.date_rdv,heureDebut:e.heure_debut?e.heure_debut.substring(0,5):"",heureFin:e.heure_fin?e.heure_fin.substring(0,5):"",type:e.type_rdv,statut:e.statut,notes:e.notes||""})));t(n),console.log("\u2705 Liste des rendez-vous recharg\xe9e:",n.length,"\xe9l\xe9ments")}}catch(a){console.warn("\u26a0\ufe0f Erreur lors du rechargement des rendez-vous:",a)}}else console.error("\u274c Erreur lors de la cr\xe9ation:",r.message),alert("Erreur lors de la cr\xe9ation: ".concat(r.message||"Erreur inconnue"))}catch(uw){var r;console.error("\u274c Erreur lors de la cr\xe9ation du rendez-vous:",uw),console.error("\u274c Error response:",uw.response),console.error("\u274c Error data:",null===(r=uw.response)||void 0===r?void 0:r.data),console.error("\u274c Error message:",uw.message),uw.response&&uw.response.data?(console.error("\u274c D\xe9tails de l'erreur serveur:",uw.response.data),alert("Erreur: ".concat(uw.response.data.message||JSON.stringify(uw.response.data)))):uw.message?alert("Erreur r\xe9seau: ".concat(uw.message)):alert("Erreur lors de la cr\xe9ation du rendez-vous - voir console pour d\xe9tails")}},children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Client:"}),(0,$r.jsxs)("div",{className:"client-search-container",children:[(0,$r.jsxs)("div",{className:"search-input-wrapper",children:[(0,$r.jsx)("input",{type:"text",name:"client-search",placeholder:A||P?"Chargement des donn\xe9es...":"Rechercher un client ou lead (nom ou t\xe9l\xe9phone)...",value:L,onChange:e=>{const t=e.target.value;if(R(t),""===t.trim())return I([]),void F(!1);const n=t.toLowerCase(),r=[];j.forEach((e=>{const t="".concat(e.prenom," ").concat(e.nom),a=e.telephone||"";(t.toLowerCase().includes(n)||a.includes(n))&&r.push({type:"client",id:e.id,nom:t,telephone:e.telephone,email:e.email,data:e})})),S.forEach((e=>{const t="".concat(e.prenom," ").concat(e.nom),a=e.telephone||"";(t.toLowerCase().includes(n)||a.includes(n))&&r.push({type:"lead",id:e.id,nom:t,telephone:e.telephone,email:e.email,data:e})})),r.sort(((e,t)=>"client"===e.type&&"lead"===t.type?-1:"lead"===e.type&&"client"===t.type?1:e.nom.localeCompare(t.nom))),I(r),F(!0),console.log("\ud83d\udd0d Recherche:",n,"- R\xe9sultats:",r.length,"(",r.filter((e=>"client"===e.type)).length,"clients,",r.filter((e=>"lead"===e.type)).length,"leads)")},disabled:A||P,required:!0,autoComplete:"off"}),(0,$r.jsx)("input",{type:"hidden",name:"client",value:c.client,required:!0}),L&&(0,$r.jsx)("button",{type:"button",className:"clear-search-btn",onClick:H,title:"Effacer la recherche",children:"\xd7"})]}),O&&D.length>0&&(0,$r.jsxs)("div",{className:"clients-dropdown",children:[D.slice(0,10).map(((e,t)=>(0,$r.jsxs)("div",{className:"client-dropdown-item ".concat(e.type),onClick:()=>(e=>{const t=e.nom;d(u(u({},c),{},{client:t,client_type:e.type,client_id:e.id})),R(t),F(!1),I([]),console.log("\u2705 S\xe9lectionn\xe9:",e.type,"-",t,"(ID:",e.id,")")})(e),children:[(0,$r.jsxs)("div",{className:"result-info",children:[(0,$r.jsxs)("div",{className:"result-name",children:[(0,$r.jsx)("span",{className:"type-badge ".concat(e.type),children:"client"===e.type?"\ud83d\udc64":"\ud83c\udfaf"}),e.nom]}),(0,$r.jsxs)("div",{className:"result-details",children:[e.telephone&&(0,$r.jsxs)("span",{className:"result-phone",children:["\ud83d\udcde ",e.telephone]}),e.email&&(0,$r.jsxs)("span",{className:"result-email",children:["\u2709\ufe0f ",e.email]})]})]}),(0,$r.jsx)("div",{className:"result-type",children:"client"===e.type?"Client":"Lead"})]},t))),D.length>10&&(0,$r.jsxs)("div",{className:"client-dropdown-info",children:["+",D.length-10," autres r\xe9sultats..."]})]}),O&&0===D.length&&""!==L.trim()&&!A&&!P&&(0,$r.jsx)("div",{className:"clients-dropdown",children:(0,$r.jsx)("div",{className:"client-dropdown-no-results",children:"Aucun client ou lead trouv\xe9"})})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re:"}),(0,$r.jsxs)("select",{name:"conseillere",value:c.conseillere,onChange:W,required:!0,disabled:k,children:[(0,$r.jsx)("option",{value:"",children:k?"Chargement des conseill\xe8res...":"S\xe9lectionner une conseill\xe8re"}),y.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date:"}),(0,$r.jsx)("input",{type:"date",name:"date",value:c.date,onChange:W,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Type:"}),(0,$r.jsxs)("select",{name:"type",value:c.type,onChange:W,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),B.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Heure de d\xe9but:"}),(0,$r.jsxs)("select",{name:"heureDebut",value:c.heureDebut,onChange:W,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),Q.slice(0,-1).map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Heure de fin:"}),(0,$r.jsxs)("select",{name:"heureFin",value:c.heureFin,onChange:W,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),Q.slice(1).map((e=>(0,$r.jsx)("option",{value:e,disabled:c.heureDebut&&e<=c.heureDebut,children:e},e)))]})]})]}),!J()&&(0,$r.jsx)("div",{className:"alert alert-danger",children:"Attention : Cette conseill\xe8re a d\xe9j\xe0 un rendez-vous \xe0 ce cr\xe9neau horaire."}),(0,$r.jsx)("div",{className:"form-row",children:(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Notes:"}),(0,$r.jsx)("textarea",{name:"notes",value:c.notes,onChange:W})]})}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:Y,children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",disabled:!J(),children:"Ajouter"})]})]})]})}),p&&g&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"D\xe9tails du rendez-vous"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>m(!1),children:"\xd7"})]}),(0,$r.jsxs)("div",{className:"rdv-details",children:[(0,$r.jsxs)("div",{className:"rdv-info",children:[(0,$r.jsx)("h4",{children:"Informations g\xe9n\xe9rales"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Client:"})," ",g.client]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Conseill\xe8re:"})," ",g.conseillere]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date:"})," ",X(g.date)]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Heure:"})," ",g.heureDebut," - ",g.heureFin]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Type:"})," ",g.type]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"}),(0,$r.jsx)("span",{className:"statut-badge ".concat(Z(g.statut)),children:g.statut})]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Notes:"})," ",g.notes||"Aucune note"]})]}),(0,$r.jsxs)("div",{className:"rdv-actions",children:[(0,$r.jsx)("h4",{children:"Changer le statut"}),(0,$r.jsxs)("div",{className:"statut-buttons",children:[(0,$r.jsx)("button",{className:"btn-statut ".concat("En attente"===g.statut?"active":""),onClick:()=>{"En attente"!==g.statut&&K(g.id,"En attente")},disabled:"En attente"===g.statut,children:"En attente"}),(0,$r.jsx)("button",{className:"btn-statut ".concat("Confirm\xe9"===g.statut?"active":""),onClick:()=>{"Confirm\xe9"!==g.statut&&K(g.id,"Confirm\xe9")},disabled:"Confirm\xe9"===g.statut,children:"Confirm\xe9"}),(0,$r.jsx)("button",{className:"btn-statut ".concat("Termin\xe9"===g.statut?"active":""),onClick:()=>{"Termin\xe9"!==g.statut&&window.confirm("\xcates-vous s\xfbr de marquer ce rendez-vous avec ".concat(g.client," comme termin\xe9 ?"))&&K(g.id,"Termin\xe9")},disabled:"Termin\xe9"===g.statut,children:"Termin\xe9"}),(0,$r.jsx)("button",{className:"btn-statut btn-danger ".concat("Annul\xe9"===g.statut?"active":""),onClick:()=>{"Annul\xe9"!==g.statut&&window.confirm("\xcates-vous s\xfbr de vouloir annuler le rendez-vous avec ".concat(g.client," ?"))&&K(g.id,"Annul\xe9")},disabled:"Annul\xe9"===g.statut,children:"Annul\xe9"})]})]})]}),(0,$r.jsx)("div",{className:"modal-footer",children:(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>m(!1),children:"Fermer"})})]})})]});var ee};const iy=function(){const[e,t]=(0,s.useState)([{id:1,description:"Loyer bureau principal",montant:2500,categorie:"Loyer",frequence:"Mensuel",dateEcheance:"2025-05-01",statut:"Pay\xe9e",datePaiement:"2025-04-28",methodePaiement:"Virement bancaire"},{id:2,description:"\xc9lectricit\xe9",montant:350,categorie:"Services",frequence:"Mensuel",dateEcheance:"2025-05-15",statut:"En attente",datePaiement:null,methodePaiement:null},{id:3,description:"Internet et t\xe9l\xe9phonie",montant:180,categorie:"Services",frequence:"Mensuel",dateEcheance:"2025-05-10",statut:"Pay\xe9e",datePaiement:"2025-05-08",methodePaiement:"Carte de cr\xe9dit"},{id:4,description:"Assurance professionnelle",montant:1200,categorie:"Assurance",frequence:"Trimestriel",dateEcheance:"2025-06-30",statut:"En attente",datePaiement:null,methodePaiement:null},{id:5,description:"Fournitures de bureau",montant:450,categorie:"Fournitures",frequence:"Ponctuel",dateEcheance:"2025-05-05",statut:"Pay\xe9e",datePaiement:"2025-05-05",methodePaiement:"Carte de cr\xe9dit"}]),[n,r]=(0,s.useState)({categorie:"",statut:"",periode:""}),[a,i]=(0,s.useState)({description:"",montant:"",categorie:"",frequence:"Mensuel",dateEcheance:"",notes:""}),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),p=["Loyer","Services","Assurance","Fournitures","Salaires","Marketing","Autre"],m=e.filter((e=>(""===n.categorie||e.categorie===n.categorie)&&(""===n.statut||e.statut===n.statut)&&(""===n.periode||g(e.dateEcheance,n.periode)))),g=(e,t)=>{const n=new Date(e),r=new Date;switch(t){case"Ce mois":return n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear();case"Mois pr\xe9c\xe9dent":const e=new Date(r.getFullYear(),r.getMonth()-1);return n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear();case"Ce trimestre":const t=Math.floor(r.getMonth()/3);return Math.floor(n.getMonth()/3)===t&&n.getFullYear()===r.getFullYear();case"Cette ann\xe9e":return n.getFullYear()===r.getFullYear();default:return!0}},v=e=>{const{name:t,value:a}=e.target;r(u(u({},n),{},{[t]:a}))},b=e=>{const{name:t,value:n}=e.target;i(u(u({},a),{},{[t]:n}))},x=e=>{f(e),d(!0)},y=function(n,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=e.map((e=>e.id===n?u(u({},e),{},{statut:r,datePaiement:"Pay\xe9e"===r?(new Date).toISOString().split("T")[0]:e.datePaiement,methodePaiement:"Pay\xe9e"===r?a:e.methodePaiement}):e));t(s),h&&h.id===n&&f(u(u({},h),{},{statut:r,datePaiement:"Pay\xe9e"===r?(new Date).toISOString().split("T")[0]:h.datePaiement,methodePaiement:"Pay\xe9e"===r?a:h.methodePaiement}))},w=e=>new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD"}).format(e),j=(()=>{const t=e.length,n=e.reduce(((e,t)=>e+parseFloat(t.montant)),0),r=e.filter((e=>"Pay\xe9e"===e.statut)).length,a=e.filter((e=>"Pay\xe9e"===e.statut)).reduce(((e,t)=>e+parseFloat(t.montant)),0),s=e.filter((e=>"En attente"===e.statut)).reduce(((e,t)=>e+parseFloat(t.montant)),0);return{totalCharges:t,totalMontant:w(n),totalPayees:r,montantPaye:w(a),montantEnAttente:w(s)}})(),N=(()=>{const t={};return e.forEach((e=>{t[e.categorie]||(t[e.categorie]=0),t[e.categorie]+=parseFloat(e.montant)})),Object.entries(t).map((e=>{let[t,n]=e;return{categorie:t,montant:n,montantFormate:w(n)}}))})();return(0,$r.jsxs)("div",{className:"charges-container",children:[(0,$r.jsxs)("div",{className:"charges-header",children:[(0,$r.jsx)("h2",{children:"Gestion des Charges"}),(0,$r.jsxs)("button",{className:"btn-primary",onClick:()=>l(!0),children:[(0,$r.jsx)("span",{children:"+"})," Nouvelle Charge"]})]}),(0,$r.jsxs)("div",{className:"stats-container",children:[(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Total des charges"}),(0,$r.jsx)("p",{className:"stat-value",children:j.totalCharges})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Montant total"}),(0,$r.jsx)("p",{className:"stat-value",children:j.totalMontant})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Charges pay\xe9es"}),(0,$r.jsx)("p",{className:"stat-value",children:j.totalPayees})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Montant pay\xe9"}),(0,$r.jsx)("p",{className:"stat-value",children:j.montantPaye})]}),(0,$r.jsxs)("div",{className:"stat-card",children:[(0,$r.jsx)("h3",{children:"Montant en attente"}),(0,$r.jsx)("p",{className:"stat-value stat-alert",children:j.montantEnAttente})]})]}),(0,$r.jsxs)("div",{className:"repartition-container",children:[(0,$r.jsx)("h3",{children:"R\xe9partition des charges par cat\xe9gorie"}),(0,$r.jsx)("div",{className:"categories-grid",children:N.map(((e,t)=>(0,$r.jsxs)("div",{className:"categorie-card",children:[(0,$r.jsxs)("div",{className:"categorie-icon",children:["Loyer"===e.categorie&&"\ud83c\udfe2","Services"===e.categorie&&"\u26a1","Assurance"===e.categorie&&"\ud83d\udee1\ufe0f","Fournitures"===e.categorie&&"\ud83d\udce6","Salaires"===e.categorie&&"\ud83d\udc65","Marketing"===e.categorie&&"\ud83d\udce3","Autre"===e.categorie&&"\ud83d\udccb"]}),(0,$r.jsxs)("div",{className:"categorie-info",children:[(0,$r.jsx)("h4",{children:e.categorie}),(0,$r.jsx)("p",{children:e.montantFormate})]})]},t)))})]}),(0,$r.jsxs)("div",{className:"filtres-container",children:[(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Cat\xe9gorie:"}),(0,$r.jsxs)("select",{name:"categorie",value:n.categorie,onChange:v,children:[(0,$r.jsx)("option",{value:"",children:"Toutes"}),p.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:n.statut,onChange:v,children:[(0,$r.jsx)("option",{value:"",children:"Tous"}),["Pay\xe9e","En attente","En retard"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filtre-group",children:[(0,$r.jsx)("label",{children:"P\xe9riode:"}),(0,$r.jsxs)("select",{name:"periode",value:n.periode,onChange:v,children:[(0,$r.jsx)("option",{value:"",children:"Toutes"}),["Tous","Ce mois","Mois pr\xe9c\xe9dent","Ce trimestre","Cette ann\xe9e"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>{r({categorie:"",statut:"",periode:""})},children:"R\xe9initialiser"})]}),(0,$r.jsx)("div",{className:"charges-table-container",children:(0,$r.jsxs)("table",{className:"charges-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Description"}),(0,$r.jsx)("th",{children:"Montant"}),(0,$r.jsx)("th",{children:"Cat\xe9gorie"}),(0,$r.jsx)("th",{children:"Fr\xe9quence"}),(0,$r.jsx)("th",{children:"Date d'\xe9ch\xe9ance"}),(0,$r.jsx)("th",{children:"Statut"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:m.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.description}),(0,$r.jsx)("td",{children:w(e.montant)}),(0,$r.jsx)("td",{children:e.categorie}),(0,$r.jsx)("td",{children:e.frequence}),(0,$r.jsx)("td",{children:e.dateEcheance}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-".concat(e.statut.toLowerCase().replace(/\s+/g,"-")),children:e.statut})}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"actions-dropdown",children:[(0,$r.jsx)("button",{className:"btn-action",children:"Actions"}),(0,$r.jsxs)("div",{className:"dropdown-content",children:[(0,$r.jsx)("button",{onClick:()=>x(e),children:"Voir d\xe9tails"}),"Pay\xe9e"!==e.statut&&(0,$r.jsx)("button",{onClick:()=>x(e),children:"Marquer comme pay\xe9e"}),"En retard"!==e.statut&&"Pay\xe9e"!==e.statut&&(0,$r.jsx)("button",{onClick:()=>y(e.id,"En retard"),children:"Marquer en retard"})]})]})})]},e.id)))})]})}),o&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Ajouter une nouvelle charge"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>l(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:n=>{n.preventDefault();const r=u(u({id:e.length+1},a),{},{statut:"En attente",datePaiement:null,methodePaiement:null});t([...e,r]),i({description:"",montant:"",categorie:"",frequence:"Mensuel",dateEcheance:"",notes:""}),l(!1)},children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Description:"}),(0,$r.jsx)("input",{type:"text",name:"description",value:a.description,onChange:b,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Montant (CAD):"}),(0,$r.jsx)("input",{type:"number",name:"montant",value:a.montant,onChange:b,step:"0.01",min:"0",required:!0})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Cat\xe9gorie:"}),(0,$r.jsxs)("select",{name:"categorie",value:a.categorie,onChange:b,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),p.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Fr\xe9quence:"}),(0,$r.jsx)("select",{name:"frequence",value:a.frequence,onChange:b,required:!0,children:["Mensuel","Trimestriel","Annuel","Ponctuel"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date d'\xe9ch\xe9ance:"}),(0,$r.jsx)("input",{type:"date",name:"dateEcheance",value:a.dateEcheance,onChange:b,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Notes (optionnel):"}),(0,$r.jsx)("input",{type:"text",name:"notes",value:a.notes,onChange:b})]})]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>l(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Ajouter"})]})]})]})}),c&&h&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"D\xe9tails de la charge"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>d(!1),children:"\xd7"})]}),(0,$r.jsxs)("div",{className:"charge-details",children:[(0,$r.jsxs)("div",{className:"charge-info",children:[(0,$r.jsx)("h4",{children:"Informations g\xe9n\xe9rales"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Description:"})," ",h.description]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Montant:"})," ",w(h.montant)]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Cat\xe9gorie:"})," ",h.categorie]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Fr\xe9quence:"})," ",h.frequence]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date d'\xe9ch\xe9ance:"})," ",h.dateEcheance]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"}),(0,$r.jsx)("span",{className:"statut-badge statut-".concat(h.statut.toLowerCase().replace(/\s+/g,"-")),children:h.statut})]}),h.datePaiement&&(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date de paiement:"})," ",h.datePaiement]}),h.methodePaiement&&(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"M\xe9thode de paiement:"})," ",h.methodePaiement]}),h.notes&&(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Notes:"})," ",h.notes]})]}),"Pay\xe9e"!==h.statut&&(0,$r.jsxs)("div",{className:"charge-actions",children:[(0,$r.jsx)("h4",{children:"Actions"}),(0,$r.jsxs)("div",{className:"paiement-form",children:[(0,$r.jsx)("h5",{children:"Marquer comme pay\xe9e"}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"M\xe9thode de paiement:"}),(0,$r.jsxs)("select",{id:"methodePaiement",defaultValue:"",onChange:e=>{e.target.value&&y(h.id,"Pay\xe9e",e.target.value)},children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner"}),["Carte de cr\xe9dit","Virement bancaire","Ch\xe8que","Esp\xe8ces","Pr\xe9l\xe8vement automatique"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsx)("div",{className:"other-actions",children:"En retard"!==h.statut&&(0,$r.jsx)("button",{className:"btn-secondary",onClick:()=>y(h.id,"En retard"),children:"Marquer en retard"})})]})]})]}),(0,$r.jsx)("div",{className:"modal-footer",children:(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>d(!1),children:"Fermer"})})]})})]})},oy=e=>{let{user:t,permissions:n,onSave:r,onClose:a}=e;const[i,o]=(0,s.useState)(t.permissions||{});return(0,$r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,$r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"2rem",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[(0,$r.jsxs)("h3",{children:["Permissions pour ",t.prenom," ",t.nom]}),(0,$r.jsxs)("p",{style:{color:"var(--admin-gray-600)",marginBottom:"1.5rem"},children:["R\xf4le: ",t.role," | Email: ",t.email]}),(0,$r.jsx)("div",{style:{marginBottom:"2rem"},children:Object.entries(n).map((e=>{let[t,n]=e;return(0,$r.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,$r.jsx)("h4",{style:{textTransform:"capitalize",color:"var(--admin-primary)",marginBottom:"0.5rem"},children:t}),(0,$r.jsx)("div",{style:{paddingLeft:"1rem"},children:n.map((e=>(0,$r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem",cursor:"pointer"},children:[(0,$r.jsx)("input",{type:"checkbox",checked:i[e]||!1,onChange:t=>((e,t)=>{o((n=>u(u({},n),{},{[e]:t})))})(e,t.target.checked)}),(0,$r.jsx)("span",{style:{fontSize:"0.9rem"},children:e})]},e)))})]},t)}))}),(0,$r.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,$r.jsx)("button",{onClick:a,style:{padding:"0.5rem 1rem",border:"1px solid var(--admin-gray-300)",backgroundColor:"white",borderRadius:"4px",cursor:"pointer"},children:"Annuler"}),(0,$r.jsx)("button",{onClick:()=>{r(i)},style:{padding:"0.5rem 1rem",backgroundColor:"var(--admin-primary)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Enregistrer"})]})]})})},ly=e=>{let{user:t,onSave:n,onClose:r,formatRole:a,roles:i}=e;const[o,l]=(0,s.useState)({nom:t.nom,prenom:t.prenom,email:t.email,telephone:t.telephone||"",role:t.role}),[c,d]=(0,s.useState)(null),[h,f]=(0,s.useState)(null),p=(e,t)=>{l((n=>u(u({},n),{},{[e]:t})))};return(0,$r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,$r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"2rem",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[(0,$r.jsx)("h3",{children:"Modifier l'utilisateur"}),(0,$r.jsxs)("p",{style:{color:"var(--admin-gray-600)",marginBottom:"1.5rem"},children:["ID: ",t.id," | Statut: ",t.actif?"Actif":"Inactif"]}),(0,$r.jsxs)("div",{style:{marginBottom:"1.5rem",textAlign:"center"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Photo de profil"}),(0,$r.jsx)("div",{style:{display:"inline-block",position:"relative",marginBottom:"0.5rem"},children:(0,$r.jsx)("img",{src:h||t.photo||"/default-avatar.png",alt:"Photo de profil",style:{width:"80px",height:"80px",borderRadius:"50%",objectFit:"cover",border:"3px solid var(--admin-gray-300)"}})}),(0,$r.jsxs)("div",{children:[(0,$r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){d(n);const e=new FileReader;e.onload=e=>{var t;f(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(n)}},style:{display:"none"},id:"photo-input"}),(0,$r.jsx)("label",{htmlFor:"photo-input",style:{display:"inline-block",padding:"0.5rem 1rem",backgroundColor:"#17a2b8",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"\ud83d\udcf8 Changer la photo"}),c&&(0,$r.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.8rem",color:"var(--admin-gray-600)"},children:"\u2705 Nouvelle photo s\xe9lectionn\xe9e"})]})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{var r,a,s;if(e.preventDefault(),console.log("\ud83d\udd0d DEBUG - D\xe9but handleSubmit"),console.log("\ud83d\udd0d DEBUG - FormData:",o),console.log("\ud83d\udd0d DEBUG - SelectedPhoto:",c),console.log("\ud83d\udd0d DEBUG - User ID:",t.id),null===(r=o.nom)||void 0===r||!r.trim()||null===(a=o.prenom)||void 0===a||!a.trim()||null===(s=o.email)||void 0===s||!s.trim())return void alert("\u274c Veuillez remplir tous les champs obligatoires (nom, pr\xe9nom, email)");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email))try{let e=u({},o);if(console.log("\ud83d\udd0d DEBUG - UpdatedData avant photo:",e),c)try{var i;const n=localStorage.getItem("token");if(!n)throw new Error("Token manquant");console.log("\ud83d\udcf8 Upload de la photo pour l'utilisateur...",t.id);const r=await(0,Ix.F6)(t.id,c,n);e.photo=r.photoUrl||(null===(i=r.data)||void 0===i?void 0:i.photoUrl),console.log("\u2705 Photo t\xe9l\xe9charg\xe9e:",e.photo)}catch(l){console.error("\u274c Erreur upload photo:",l);const e=l instanceof Error?l.message:String(l);alert("\u26a0\ufe0f Erreur lors du t\xe9l\xe9chargement de la photo: ".concat(e,"\n\nLes autres modifications seront quand m\xeame sauvegard\xe9es."))}console.log("\ud83d\udd0d DEBUG - UpdatedData final:",e),console.log("\ud83d\udd0d DEBUG - Appel onSave avec:",e),n(e)}catch(uw){console.error("\u274c Erreur lors de la soumission:",uw);const t=uw instanceof Error?uw.message:String(uw);alert("\u274c Erreur: ".concat(t))}else alert("\u274c Veuillez saisir une adresse email valide")},children:[(0,$r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Nom *"}),(0,$r.jsx)("input",{type:"text",value:o.nom||"",onChange:e=>p("nom",e.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid var(--admin-gray-300)",borderRadius:"4px",boxSizing:"border-box"},required:!0})]}),(0,$r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Pr\xe9nom *"}),(0,$r.jsx)("input",{type:"text",value:o.prenom||"",onChange:e=>p("prenom",e.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid var(--admin-gray-300)",borderRadius:"4px",boxSizing:"border-box"},required:!0})]}),(0,$r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Email *"}),(0,$r.jsx)("input",{type:"email",value:o.email||"",onChange:e=>p("email",e.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid var(--admin-gray-300)",borderRadius:"4px",boxSizing:"border-box"},required:!0})]}),(0,$r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"T\xe9l\xe9phone"}),(0,$r.jsx)("input",{type:"tel",value:o.telephone||"",onChange:e=>p("telephone",e.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid var(--admin-gray-300)",borderRadius:"4px",boxSizing:"border-box"}})]}),(0,$r.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,$r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"R\xf4le"}),(0,$r.jsx)("select",{value:o.role||"",onChange:e=>p("role",e.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid var(--admin-gray-300)",borderRadius:"4px",boxSizing:"border-box"},children:i.map((e=>(0,$r.jsx)("option",{value:e,children:a(e)},e)))})]}),(0,$r.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,$r.jsx)("button",{type:"button",onClick:r,style:{padding:"0.5rem 1rem",border:"1px solid var(--admin-gray-300)",backgroundColor:"white",borderRadius:"4px",cursor:"pointer"},children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",style:{padding:"0.5rem 1rem",backgroundColor:"#17a2b8",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Enregistrer"})]})]})]})})},cy=()=>{var e,t,n,r;const[a,i]=(0,s.useState)([]),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(""),[h,f]=(0,s.useState)("nom"),[p,m]=(0,s.useState)(!0),[g,v]=(0,s.useState)({}),[b,x]=(0,s.useState)(null),[y,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),[S,C]=(0,s.useState)(null),[k,E]=(0,s.useState)({nom:"",prenom:"",email:"",telephone:"",role:"conseillere",motDePasse:"",permissions:{}}),[A,T]=(0,s.useState)(!1),[P,_]=(0,s.useState)(null),[L,R]=(0,s.useState)(null),D=["admin","conseillere","comptable","secretaire"],I=async()=>{try{l(!0);const e=localStorage.getItem("token"),[t,n]=await Promise.all([(0,Ix.lo)(e||""),(0,Ix.VE)(e||"")]);i(t),v(n)}catch(Qm){console.error(Qm)}finally{l(!1)}};(0,s.useEffect)((()=>{I()}),[]);const O=e=>{e===h?m(!p):(f(e),m(!0))},F=[...a].filter((e=>{const t=c.toLowerCase();return e.nom.toLowerCase().includes(t)||e.prenom.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.role.toLowerCase().includes(t)})).sort(((e,t)=>{var n,r;const a=null!==(n=e[h])&&void 0!==n?n:"",s=null!==(r=t[h])&&void 0!==r?r:"";return a<s?p?-1:1:a>s?p?1:-1:0})),M=e=>h===e?p?" \u25b2":" \u25bc":"",B=e=>{if(!e)return null;let t=0;return e.length>=8&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^a-zA-Z0-9]/.test(e)&&t++,t<=2?{level:"weak",text:"Faible",color:"var(--admin-danger)"}:t<=3?{level:"medium",text:"Moyen",color:"var(--admin-warning)"}:{level:"strong",text:"Fort",color:"var(--admin-success)"}},z=e=>({admin:"Administrateur",conseillere:"Conseill\xe8re",comptable:"Comptable",secretaire:"Secr\xe9taire"}[e]||e);return(0,$r.jsxs)("div",{className:"users-module",children:[(0,$r.jsx)("h3",{children:"Gestion des utilisateurs"}),(0,$r.jsx)("div",{className:"search-container",children:(0,$r.jsx)("input",{className:"search-input",placeholder:"\ud83d\udd0d Rechercher un utilisateur par nom, pr\xe9nom, email ou r\xf4le...",value:c,onChange:e=>d(e.target.value)})}),o?(0,$r.jsx)("div",{className:"loading-container",children:(0,$r.jsx)("p",{children:"Chargement des utilisateurs..."})}):(0,$r.jsx)("div",{className:"utilisateurs-table-container",children:(0,$r.jsxs)("table",{className:"utilisateurs-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsxs)("th",{onClick:()=>O("nom"),children:["Nom",M("nom")]}),(0,$r.jsxs)("th",{onClick:()=>O("prenom"),children:["Pr\xe9nom",M("prenom")]}),(0,$r.jsxs)("th",{onClick:()=>O("email"),children:["Email",M("email")]}),(0,$r.jsxs)("th",{onClick:()=>O("role"),children:["R\xf4le",M("role")]}),(0,$r.jsx)("th",{children:"Statut"}),(0,$r.jsx)("th",{children:"Derni\xe8re connexion"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:0===F.length?(0,$r.jsx)("tr",{children:(0,$r.jsx)("td",{colSpan:7,style:{textAlign:"center",padding:"2rem",color:"var(--admin-gray-500)"},children:c?"Aucun utilisateur trouv\xe9 pour cette recherche.":"Aucun utilisateur disponible."})}):F.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{style:{fontWeight:"600"},children:e.nom}),(0,$r.jsx)("td",{children:e.prenom}),(0,$r.jsx)("td",{children:e.email}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",backgroundColor:"var(--admin-gray-100)",color:"var(--admin-gray-700)",fontSize:"0.75rem",fontWeight:"600"},children:z(e.role)})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"status-badge ".concat(e.actif?"active":"inactive"),children:e.actif?"Actif":"Inactif"})}),(0,$r.jsx)("td",{children:e.derniere_connexion?new Date(e.derniere_connexion).toLocaleString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais connect\xe9"}),(0,$r.jsx)("td",{children:(0,$r.jsxs)("div",{className:"action-buttons",children:[(0,$r.jsx)("button",{className:"btn-toggle-status ".concat(e.actif?"":"inactive"),onClick:()=>(async(e,t)=>{try{const n=localStorage.getItem("token");await(0,Ix.g9)(e,!t,n||""),I()}catch(Qm){console.error(Qm)}})(e.id,e.actif),title:e.actif?"D\xe9sactiver l'utilisateur":"R\xe9activer l'utilisateur",children:e.actif?"\ud83d\udd12 D\xe9sactiver":"\ud83d\udd13 R\xe9activer"}),(0,$r.jsx)("button",{className:"btn-edit",onClick:()=>(C(u({},e)),void N(!0)),title:"Modifier les informations de l'utilisateur",style:{backgroundColor:"#17a2b8",color:"white",border:"none",padding:"0.375rem 0.75rem",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:"600",marginLeft:"0.25rem"},children:"\u270f\ufe0f \xc9diter"}),(0,$r.jsx)("button",{className:"btn-edit",onClick:()=>(x(e),void w(!0)),title:"G\xe9rer les permissions",children:"\ud83d\udd10 Permissions"}),(0,$r.jsx)("button",{className:"btn-reset",onClick:async()=>{const t=localStorage.getItem("token");if(!t)return alert("Pas de token");try{const n=await(0,Ix.cw)(e.id,t);alert("Nouveau mot de passe: ".concat(n.newPassword))}catch(cw){alert("Erreur reset MDP")}},title:"R\xe9initialiser le mot de passe",children:"\ud83d\udd04 Reset MDP"}),(0,$r.jsx)("button",{className:"btn-delete",onClick:()=>(async e=>{const t=localStorage.getItem("userId");if(e.id===t)return void alert("\u274c Vous ne pouvez pas supprimer votre propre compte.");if(window.confirm("\u26a0\ufe0f ATTENTION - Suppression d\xe9finitive\n\n\xcates-vous s\xfbr de vouloir supprimer l'utilisateur ?\n\n"+"\u2022 Nom: ".concat(e.prenom," ").concat(e.nom,"\n")+"\u2022 Email: ".concat(e.email,"\n")+"\u2022 R\xf4le: ".concat(z(e.role),"\n\n")+"Cette action est IRR\xc9VERSIBLE !"))try{const t=localStorage.getItem("token");if(!t)return void alert("\u274c Token d'authentification manquant. Veuillez vous reconnecter.");await(0,Ix.hG)(e.id,t),alert('\u2705 Utilisateur "'.concat(e.prenom," ").concat(e.nom,'" supprim\xe9 avec succ\xe8s.')),I()}catch(uw){console.error("Erreur lors de la suppression:",uw);let t="Erreur lors de la suppression de l'utilisateur";uw instanceof Error&&(t=uw.message.includes("403")?"\ud83d\udeab Vous n'avez pas les permissions pour supprimer cet utilisateur.":uw.message.includes("404")?"\u2753 Utilisateur introuvable (peut-\xeatre d\xe9j\xe0 supprim\xe9).":uw.message.includes("400")?"\u26a0\ufe0f Impossible de supprimer cet utilisateur (contraintes syst\xe8me).":"\u274c ".concat(uw.message)),alert(t)}})(e),title:"Supprimer d\xe9finitivement l'utilisateur",style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"0.375rem 0.75rem",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:"600",marginLeft:"0.25rem"},children:"\ud83d\uddd1\ufe0f Supprimer"})]})})]},e.id)))})]})}),(0,$r.jsxs)("div",{className:"add-user-form",children:[(0,$r.jsx)("h4",{children:"Ajouter un nouvel utilisateur"}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsx)("input",{className:"form-input",placeholder:"Nom *",value:k.nom,onChange:e=>E(u(u({},k),{},{nom:e.target.value}))}),(0,$r.jsx)("input",{className:"form-input",placeholder:"Pr\xe9nom *",value:k.prenom,onChange:e=>E(u(u({},k),{},{prenom:e.target.value}))}),(0,$r.jsx)("input",{className:"form-input",placeholder:"Email *",type:"email",value:k.email,onChange:e=>E(u(u({},k),{},{email:e.target.value}))}),(0,$r.jsx)("input",{className:"form-input",placeholder:"T\xe9l\xe9phone",type:"tel",value:k.telephone,onChange:e=>E(u(u({},k),{},{telephone:e.target.value}))}),(0,$r.jsxs)("div",{className:"password-field-container",children:[(0,$r.jsx)("input",{className:"form-input",placeholder:"Mot de passe (optionnel)",type:A?"text":"password",value:k.motDePasse,onChange:e=>E(u(u({},k),{},{motDePasse:e.target.value})),style:{paddingRight:"3rem"}}),(0,$r.jsx)("button",{type:"button",className:"password-toggle-btn",onClick:()=>T(!A),title:A?"Masquer le mot de passe":"Afficher le mot de passe",children:A?"\ud83d\ude48":"\ud83d\udc41\ufe0f"})]})]}),(0,$r.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"1rem",marginBottom:"1rem"},children:(0,$r.jsx)("select",{className:"form-select",value:k.role,onChange:e=>E(u(u({},k),{},{role:e.target.value})),style:{width:"auto",minWidth:"200px",textAlign:"center"},children:D.map((e=>(0,$r.jsx)("option",{value:e,children:z(e)},e)))})}),(0,$r.jsxs)("div",{style:{marginTop:"1rem"},children:[k.motDePasse&&(0,$r.jsxs)("div",{className:"password-strength",style:{color:null===(e=B(k.motDePasse))||void 0===e?void 0:e.color,marginBottom:"0.5rem",padding:"0.75rem",backgroundColor:"var(--admin-gray-50)",borderRadius:"0.5rem",border:"2px solid ".concat(null===(t=B(k.motDePasse))||void 0===t?void 0:t.color),display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,$r.jsx)("span",{style:{fontSize:"1rem"},children:"\ud83d\udd12"}),(0,$r.jsxs)("span",{style:{fontWeight:"600"},children:["Force du mot de passe: ",null===(n=B(k.motDePasse))||void 0===n?void 0:n.text]}),"weak"===(null===(r=B(k.motDePasse))||void 0===r?void 0:r.level)&&(0,$r.jsx)("span",{style:{color:"var(--admin-gray-600)",fontSize:"0.8rem",fontStyle:"italic"},children:"\u2192 Recommand\xe9: 8+ caract\xe8res, majuscules, chiffres, symboles"})]}),(0,$r.jsxs)("small",{style:{color:"var(--admin-gray-500)",display:"block",fontSize:"0.75rem"},children:["\ud83d\udca1 ",k.motDePasse.trim()?"Le mot de passe saisi sera utilis\xe9 pour cet utilisateur.":"Si aucun mot de passe n'est fourni, un mot de passe temporaire sera g\xe9n\xe9r\xe9 et envoy\xe9 par email."]}),(0,$r.jsx)("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center"},children:(0,$r.jsx)("button",{className:"btn-add-user",onClick:async()=>{if(k.nom.trim()&&k.prenom.trim()&&k.email.trim())try{var e;const n=localStorage.getItem("token");if(!n)return void alert("\u274c Erreur d'authentification: Vous devez \xeatre connect\xe9 pour cr\xe9er un utilisateur.\n\nVeuillez vous connecter d'abord.");console.log("\ud83d\udcdd Cr\xe9ation utilisateur..."),console.log("\ud83d\udd11 Token pr\xe9sent:",n?"Oui":"Non");const r=u(u({},k),{},{motDePasse:k.motDePasse.trim()||"temp123"});console.log("\ud83d\udcc4 Donn\xe9es utilisateur:",r);const a=await(0,Ix.kg)(r,n);if(console.log("\u2705 Utilisateur cr\xe9\xe9:",a),P&&null!==(e=a.user)&&void 0!==e&&e.id)try{console.log("\ud83d\udcf8 Upload de la photo pour le nouvel utilisateur..."),await(0,Ix.DK)(P,n),console.log("\u2705 Photo t\xe9l\xe9charg\xe9e avec succ\xe8s")}catch(t){console.error("\u274c Erreur upload photo:",t);const e=t instanceof Error?t.message:String(t);alert("\u26a0\ufe0f Utilisateur cr\xe9\xe9 avec succ\xe8s, mais erreur lors du t\xe9l\xe9chargement de la photo: ".concat(e))}alert("\u2705 Utilisateur cr\xe9\xe9 avec succ\xe8s !"),E({nom:"",prenom:"",email:"",telephone:"",role:"conseillere",motDePasse:"",permissions:{}}),_(null),R(null),I()}catch(Qm){console.error("\u274c Erreur d\xe9taill\xe9e:",Qm);let t="Erreur inconnue lors de la cr\xe9ation de l'utilisateur";t=Qm instanceof Error?Qm.message.includes("401")?"\ud83d\udd10 Erreur d'authentification: Token invalide ou expir\xe9.\n\nVeuillez vous reconnecter.":Qm.message.includes("403")?"\ud83d\udeab Erreur de permissions: Vous n'avez pas les droits pour cr\xe9er des utilisateurs.":Qm.message.includes("400")?"\ud83d\udcdd Erreur de donn\xe9es: V\xe9rifiez que tous les champs sont correctement remplis.":Qm.message.includes("Cette adresse email est d\xe9j\xe0 utilis\xe9e")?"\ud83d\udce7 Cette adresse email est d\xe9j\xe0 utilis\xe9e par un autre utilisateur.":"\u274c Erreur: ".concat(Qm.message):"\u274c Erreur: ".concat(String(Qm)),alert(t)}else alert("Veuillez remplir tous les champs obligatoires (nom, pr\xe9nom, email)")},disabled:!k.nom.trim()||!k.prenom.trim()||!k.email.trim(),style:{fontSize:"1rem",padding:"0.875rem 2rem",minWidth:"200px"},children:"\u2795 Ajouter l'utilisateur"})})]})]}),y&&b&&(0,$r.jsx)(oy,{user:b,permissions:g,onSave:async e=>{if(b)try{const t=localStorage.getItem("token");await(0,Ix.N6)(b.id,e,t||""),w(!1),x(null),I()}catch(Qm){console.error(Qm)}},onClose:()=>{w(!1),x(null)}}),j&&S&&(0,$r.jsx)(ly,{user:S,onSave:async e=>{if(S){console.log("\ud83d\udd0d DEBUG - handleUpdateUser appel\xe9"),console.log("\ud83d\udd0d DEBUG - editingUser:",S),console.log("\ud83d\udd0d DEBUG - userData re\xe7u:",e);try{const t=localStorage.getItem("token");if(!t)return void alert("\u274c Token d'authentification manquant. Veuillez vous reconnecter.");console.log("\ud83d\udd04 Mise \xe0 jour utilisateur:",S.id,e),console.log("\ud83d\udd0d DEBUG - Token pr\xe9sent:",t?"Oui":"Non"),console.log("\ud83d\udd0d DEBUG - Appel updateUser avec:",{id:S.id,data:e,token:t?"Pr\xe9sent":"Absent"}),await(0,Ix.TK)(S.id,e,t),alert('\u2705 Utilisateur "'.concat(e.prenom," ").concat(e.nom,'" mis \xe0 jour avec succ\xe8s.')),N(!1),C(null),I()}catch(uw){console.error("\u274c Erreur lors de la mise \xe0 jour:",uw),console.error("\u274c Erreur compl\xe8te:",JSON.stringify(uw,null,2));let t="Erreur lors de la mise \xe0 jour de l'utilisateur";uw instanceof Error&&(console.error("\u274c Message d'erreur:",uw.message),console.error("\u274c Stack d'erreur:",uw.stack),t=uw.message.includes("403")?"\ud83d\udeab Vous n'avez pas les permissions pour modifier cet utilisateur.":uw.message.includes("404")?"\u2753 Utilisateur introuvable.":uw.message.includes("400")?"\ud83d\udcdd Donn\xe9es invalides. V\xe9rifiez les informations saisies.":"\u274c ".concat(uw.message)),alert(t)}}},onClose:()=>{N(!1),C(null)},formatRole:z,roles:D})]})},uy=["leads","clients","dossiers","facturation","rendez-vous","charges","administration","tableau-de-bord"],dy=["view","create","update","delete","export","validate","sign"],hy=[{id:"administrateur",name:"Administrateur",perms:uy.reduce(((e,t)=>u(u({},e),{},{[t]:[...dy]})),{})},{id:"directeur",name:"Directeur",perms:uy.reduce(((e,t)=>u(u({},e),{},{[t]:dy.filter((e=>"delete"!==e))})),{})},{id:"conseillere",name:"Conseill\xe8re",perms:{leads:["view","create","update"],clients:["view","update"],dossiers:["view","update"],"tableau-de-bord":["view"]}}],fy=()=>{const[e,t]=(0,s.useState)(hy),[n,r]=(0,s.useState)(""),a=()=>{if(!n.trim())return;if(e.some((e=>e.name.toLowerCase()===n.toLowerCase())))return;const a={id:n.toLowerCase().replace(/\s+/g,"-"),name:n,perms:{}};t([...e,a]),r("")};return(0,$r.jsxs)("div",{className:"users-module",children:[(0,$r.jsx)("h3",{children:"R\xf4les & Permissions"}),(0,$r.jsxs)("div",{className:"add-user-form",style:{marginBottom:"2rem"},children:[(0,$r.jsx)("h4",{children:"Cr\xe9er un nouveau r\xf4le"}),(0,$r.jsxs)("div",{className:"form-row",style:{gridTemplateColumns:"1fr auto"},children:[(0,$r.jsx)("input",{className:"form-input",placeholder:"Nom du nouveau r\xf4le *",value:n,onChange:e=>r(e.target.value),onKeyPress:e=>"Enter"===e.key&&a()}),(0,$r.jsx)("button",{className:"btn-add-user",onClick:a,disabled:!n.trim()||e.some((e=>e.name.toLowerCase()===n.toLowerCase())),children:"\u2795 Cr\xe9er le r\xf4le"})]}),(0,$r.jsx)("small",{style:{color:"var(--admin-gray-500)",marginTop:"0.5rem",display:"block",fontSize:"0.75rem"},children:"\ud83d\udca1 Apr\xe8s cr\xe9ation, vous pourrez configurer les permissions sp\xe9cifiques pour ce r\xf4le."})]}),(0,$r.jsx)("div",{style:{display:"grid",gap:"1.5rem"},children:e.map((e=>(0,$r.jsxs)("div",{className:"role-card",children:[(0,$r.jsxs)("div",{style:{background:"linear-gradient(135deg, var(--admin-primary) 0%, var(--admin-primary-hover) 100%)",color:"white",padding:"1rem",borderRadius:"8px 8px 0 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,$r.jsx)("span",{style:{fontSize:"1.25rem"},children:"administrateur"===e.id?"\ud83d\udc51":"directeur"===e.id?"\ud83d\udc54":"conseillere"===e.id?"\ud83d\udcbc":"\ud83d\udc64"}),(0,$r.jsx)("h4",{style:{margin:0,fontSize:"1.1rem",fontWeight:"700"},children:e.name})]}),(0,$r.jsx)("div",{style:{padding:"1rem",overflow:"auto"},children:(0,$r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.875rem"},children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{style:{border:"2px solid var(--admin-gray-200)",padding:"0.75rem",backgroundColor:"var(--admin-gray-100)",color:"var(--admin-gray-700)",fontWeight:"600",textAlign:"left"},children:"\ud83d\udcc2 Module"}),dy.map((e=>{return(0,$r.jsx)("th",{style:{border:"2px solid var(--admin-gray-200)",padding:"0.75rem",backgroundColor:"var(--admin-gray-100)",color:"var(--admin-gray-700)",fontWeight:"600",textAlign:"center",minWidth:"80px"},children:(t=e,{view:"\ud83d\udc40 Voir",create:"\u2795 Cr\xe9er",update:"\u270f\ufe0f Modifier",delete:"\ud83d\uddd1\ufe0f Supprimer",export:"\ud83d\udce5 Exporter",validate:"\u2705 Valider",sign:"\u270d\ufe0f Signer"}[t]||t)},e);var t}))]})}),(0,$r.jsx)("tbody",{children:uy.map((n=>{return(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{style:{border:"1px solid var(--admin-gray-200)",padding:"0.75rem",fontWeight:"600",backgroundColor:"var(--admin-gray-50)"},children:(r=n,{leads:"\ud83c\udfaf Leads",clients:"\ud83d\udc65 Clients",dossiers:"\ud83d\udcc1 Dossiers",facturation:"\ud83d\udcb0 Facturation","rendez-vous":"\ud83d\udcc5 Rendez-vous",charges:"\ud83d\udcb8 Charges",administration:"\u2699\ufe0f Administration","tableau-de-bord":"\ud83d\udcca Tableau de bord"}[r]||r)}),dy.map((r=>(0,$r.jsx)("td",{style:{border:"1px solid var(--admin-gray-200)",padding:"0.75rem",textAlign:"center",backgroundColor:(e.perms[n]||[]).includes(r)?"rgb(16 185 129 / 0.1)":"var(--admin-white)",transition:"background-color 0.2s ease"},children:(0,$r.jsx)("input",{type:"checkbox",checked:(e.perms[n]||[]).includes(r),onChange:()=>((e,n,r)=>{t((t=>t.map((t=>{if(t.id!==e)return t;const a=t.perms[n]||[],s=a.includes(r)?a.filter((e=>e!==r)):[...a,r];return u(u({},t),{},{perms:u(u({},t.perms),{},{[n]:s})})}))))})(e.id,n,r),style:{transform:"scale(1.3)",cursor:"pointer",accentColor:"var(--admin-primary)"}})},r)))]},n);var r}))})]})})]},e.id)))})]})},py=()=>{const[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)(!0),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)({page:1,limit:50,total:0,pages:0}),[c,d]=(0,s.useState)({action:"",entite:"",date_debut:"",date_fin:""}),[h,f]=(0,s.useState)([]),[p,m]=(0,s.useState)([]),[g,v]=(0,s.useState)(new Set),[b,x]=(0,s.useState)(!1),[y,w]=(0,s.useState)(null),[j,N]=(0,s.useState)(new Date),S=()=>{const e=localStorage.getItem("token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t},C=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;r(!0),i(null);try{const n=new URLSearchParams(u({page:e.toString(),limit:o.limit.toString()},Object.fromEntries(Object.entries(c).filter((e=>{let[t,n]=e;return n}))))),r=await fetch("http://localhost:5000/api/logs?".concat(n),{headers:S()});if(!r.ok){if(403===r.status)throw new Error("Acc\xe8s refus\xe9. Seuls les administrateurs peuvent acc\xe9der aux journaux d'activit\xe9.");throw new Error("Erreur ".concat(r.status,": ").concat(r.statusText))}const a=await r.json();t(a.data),l(a.pagination)}catch(Qm){i(Qm.message),console.error("Erreur lors du chargement des logs:",Qm)}finally{r(!1)}};(0,s.useEffect)((()=>{C(),(async()=>{try{const e=await fetch("http://localhost:5000/api/logs/actions",{headers:S()});if(e.ok){const t=await e.json();f(t.data)}}catch(Qm){console.error("Erreur lors du chargement des actions:",Qm)}})(),(async()=>{try{const e=await fetch("http://localhost:5000/api/logs/entites",{headers:S()});if(e.ok){const t=await e.json();m(t.data)}}catch(Qm){console.error("Erreur lors du chargement des entit\xe9s:",Qm)}})();const e=hm("http://localhost:5000");return w(e),e.on("newActivity",(e=>{console.log("\ud83d\udce1 Nouvelle activit\xe9 re\xe7ue:",e),N(new Date),C(1)})),e.on("activityLogUpdate",(e=>{console.log("\ud83d\udccb Mise \xe0 jour des journaux d'activit\xe9:",e),N(new Date),C(1)})),()=>{e.disconnect()}}),[]),(0,s.useEffect)((()=>{C(1)}),[c]);const k=(e,t)=>{d((n=>u(u({},n),{},{[e]:t})))},E=e=>({create_client:"Cr\xe9ation client",update_client:"Modification client",delete_client:"Suppression client",create_lead:"Cr\xe9ation lead",update_lead:"Modification lead",delete_lead:"Suppression lead",create_user:"Cr\xe9ation utilisateur",update_user:"Modification utilisateur",delete_user:"Suppression utilisateur",login:"Connexion",logout:"D\xe9connexion",auto_logout:"\ud83d\udd12 D\xe9connexion automatique (inactivit\xe9)"}[e]||e),A=e=>e&&"object"===typeof e?(0,$r.jsx)("div",{className:"json-values",children:Object.entries(e).map((e=>{let[t,n]=e;return(0,$r.jsxs)("div",{className:"json-item",children:[(0,$r.jsxs)("span",{className:"json-key",children:[t,":"]}),(0,$r.jsx)("span",{className:"json-value",children:"object"===typeof n?JSON.stringify(n):String(n)})]},t)}))}):(0,$r.jsx)("span",{className:"no-data",children:"Aucune donn\xe9e"});return n&&0===e.length?(0,$r.jsx)("div",{className:"journal-activite",children:(0,$r.jsxs)("div",{className:"loading-container",children:[(0,$r.jsx)("div",{className:"loading-spinner"}),(0,$r.jsx)("p",{children:"Chargement des journaux d'activit\xe9..."})]})}):a?(0,$r.jsx)("div",{className:"journal-activite",children:(0,$r.jsxs)("div",{className:"error-container",children:[(0,$r.jsx)("h2",{children:"\ud83d\udccb Journaux d'activit\xe9"}),(0,$r.jsxs)("div",{className:"error-message",children:[(0,$r.jsxs)("p",{children:["\u274c ",a]}),(0,$r.jsx)("button",{onClick:()=>C(),className:"retry-btn",children:"R\xe9essayer"})]})]})}):(0,$r.jsxs)("div",{className:"journal-activite",children:[(0,$r.jsxs)("div",{className:"journal-header",children:[(0,$r.jsx)("h1",{children:"\ud83d\udccb Journaux d'activit\xe9"}),(0,$r.jsx)("p",{className:"journal-description",children:"Consultez l'historique complet des actions effectu\xe9es dans le syst\xe8me."}),(0,$r.jsxs)("div",{className:"journal-status",children:[(0,$r.jsxs)("span",{className:"last-update",children:["\ud83d\udd52 Derni\xe8re mise \xe0 jour : ",j.toLocaleTimeString("fr-FR")]}),(0,$r.jsx)("span",{className:"realtime-indicator",children:y&&y.connected?"\ud83d\udfe2 Temps r\xe9el activ\xe9":"\ud83d\udd34 Temps r\xe9el d\xe9sactiv\xe9"})]})]}),(0,$r.jsxs)("div",{className:"filters-section",children:[(0,$r.jsx)("h3",{children:"\ud83d\udd0d Filtres"}),(0,$r.jsxs)("div",{className:"filters-grid",children:[(0,$r.jsxs)("div",{className:"filter-group",children:[(0,$r.jsx)("label",{children:"Action:"}),(0,$r.jsxs)("select",{value:c.action,onChange:e=>k("action",e.target.value),children:[(0,$r.jsx)("option",{value:"",children:"Toutes les actions"}),h.map((e=>(0,$r.jsx)("option",{value:e,children:E(e)},e)))]})]}),(0,$r.jsxs)("div",{className:"filter-group",children:[(0,$r.jsx)("label",{children:"Entit\xe9:"}),(0,$r.jsxs)("select",{value:c.entite,onChange:e=>k("entite",e.target.value),children:[(0,$r.jsx)("option",{value:"",children:"Toutes les entit\xe9s"}),p.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]}),(0,$r.jsxs)("div",{className:"filter-group",children:[(0,$r.jsx)("label",{children:"Date d\xe9but:"}),(0,$r.jsx)("input",{type:"date",value:c.date_debut,onChange:e=>k("date_debut",e.target.value)})]}),(0,$r.jsxs)("div",{className:"filter-group",children:[(0,$r.jsx)("label",{children:"Date fin:"}),(0,$r.jsx)("input",{type:"date",value:c.date_fin,onChange:e=>k("date_fin",e.target.value)})]})]}),(0,$r.jsxs)("div",{className:"filters-actions",children:[(0,$r.jsx)("button",{onClick:()=>{d({action:"",entite:"",date_debut:"",date_fin:""})},className:"reset-filters-btn",children:"R\xe9initialiser les filtres"}),(0,$r.jsx)("button",{onClick:async()=>{x(!0);try{const e=await fetch("http://localhost:5000/api/logs/export",{headers:S()});if(!e.ok)throw new Error("Erreur ".concat(e.status,": ").concat(e.statusText));const t=await e.blob(),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="logs_activite_".concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}catch(Qm){i("Erreur lors de l'export: "+Qm.message)}finally{x(!1)}},disabled:b,className:"export-btn",children:b?"Export en cours...":"\ud83d\udce5 Exporter CSV"})]})]}),(0,$r.jsxs)("div",{className:"logs-section",children:[(0,$r.jsxs)("div",{className:"logs-header",children:[(0,$r.jsxs)("h3",{children:["\ud83d\udcca Journaux (",o.total," entr\xe9es)"]}),(0,$r.jsxs)("div",{className:"pagination-info",children:["Page ",o.page," sur ",o.pages]})]}),(0,$r.jsx)("div",{className:"logs-table-container",children:(0,$r.jsxs)("table",{className:"logs-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Utilisateur"}),(0,$r.jsx)("th",{children:"Action"}),(0,$r.jsx)("th",{children:"Entit\xe9"}),(0,$r.jsx)("th",{children:"ID"}),(0,$r.jsx)("th",{children:"IP"}),(0,$r.jsx)("th",{children:"D\xe9tails"})]})}),(0,$r.jsx)("tbody",{children:e.map((e=>{return(0,$r.jsxs)(s.Fragment,{children:[(0,$r.jsxs)("tr",{className:"log-row",children:[(0,$r.jsx)("td",{className:"date-cell",children:(t=e.date_action,new Date(t).toLocaleString("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),(0,$r.jsx)("td",{className:"user-cell",children:(0,$r.jsxs)("div",{className:"user-info",children:[(0,$r.jsxs)("span",{className:"user-name",children:[e.utilisateur.prenom," ",e.utilisateur.nom]}),(0,$r.jsxs)("span",{className:"user-role",children:["(",e.utilisateur.role,")"]})]})}),(0,$r.jsx)("td",{className:"action-cell",children:(0,$r.jsx)("span",{className:"action-badge action-".concat(e.action.split("_")[0]),children:E(e.action)})}),(0,$r.jsx)("td",{className:"entite-cell",children:e.entite}),(0,$r.jsxs)("td",{className:"id-cell",children:["#",e.entite_id]}),(0,$r.jsx)("td",{className:"ip-cell",children:e.adresse_ip||"N/A"}),(0,$r.jsx)("td",{className:"details-cell",children:(0,$r.jsxs)("button",{onClick:()=>{return t=e.id,void v((e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n}));var t},className:"details-btn",children:[g.has(e.id)?"\u25bc":"\u25b6"," D\xe9tails"]})})]}),g.has(e.id)&&(0,$r.jsx)("tr",{className:"expanded-row",children:(0,$r.jsx)("td",{colSpan:"7",children:(0,$r.jsx)("div",{className:"expanded-content",children:(0,$r.jsxs)("div",{className:"values-container",children:[(0,$r.jsxs)("div",{className:"old-values",children:[(0,$r.jsx)("h4",{children:"Anciennes valeurs:"}),A(e.anciennes_valeurs)]}),(0,$r.jsxs)("div",{className:"new-values",children:[(0,$r.jsx)("h4",{children:"Nouvelles valeurs:"}),A(e.nouvelles_valeurs)]})]})})})})]},e.id);var t}))})]})}),(0,$r.jsxs)("div",{className:"pagination",children:[(0,$r.jsx)("button",{onClick:()=>C(o.page-1),disabled:o.page<=1||n,className:"pagination-btn",children:"\u2190 Pr\xe9c\xe9dent"}),(0,$r.jsx)("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,o.pages)},((e,t)=>{const r=t+Math.max(1,o.page-2);return(0,$r.jsx)("button",{onClick:()=>C(r),className:"pagination-number ".concat(r===o.page?"active":""),disabled:n,children:r},r)}))}),(0,$r.jsx)("button",{onClick:()=>C(o.page+1),disabled:o.page>=o.pages||n,className:"pagination-btn",children:"Suivant \u2192"})]})]})]})};const my=new class{constructor(){this.notifications=[],this.listeners=[],this.userRole=null,this.userName=null,this.userId=null,this.checkInterval=null,this.lastNotificationCheck=new Date,this.checkedFactures=new Set,this.checkedRendezVous=new Set,this.lastLeadCount=0,this.cache=new Map,this.isRunning=!1,"undefined"!==typeof window&&(window.notificationService=this,window.notificationState={isAuthenticated:!1,userInfo:null}),this.loadUserData(),this.restoreState(),this.cleanInvalidNotifications()}loadUserData(){this.userRole=localStorage.getItem("userRole")||localStorage.getItem("role")||"conseillere",this.userName=localStorage.getItem("userName")||localStorage.getItem("userEmail")||"current_user",this.userId=localStorage.getItem("userId")||localStorage.getItem("id");localStorage.getItem("token")&&"undefined"!==typeof window&&(window.notificationState.isAuthenticated=!0,window.notificationState.userInfo={role:this.userRole,name:this.userName,id:this.userId}),console.log("\ud83d\udd14 Service de notifications charg\xe9 pour ".concat(this.userName," (").concat(this.userRole,")"))}addNotification(e){const t=(new Date).toISOString(),n=u(u({id:e.id||"notif-".concat(Date.now(),"-").concat(Math.random())},e),{},{timestamp:e.timestamp||e.date||t,date:e.date||e.timestamp||t,read:!1});this.notifications.unshift(n),this.saveNotifications(),this.notifyListeners(),console.log("\ud83d\udd14 Nouvelle notification ajout\xe9e:",e.message)}saveNotifications(){try{const e=new Date(Date.now()-6048e5);this.notifications=this.notifications.filter((t=>new Date(t.timestamp)>e)),localStorage.setItem("notifications",JSON.stringify(this.notifications))}catch(uw){console.error("Erreur lors de la sauvegarde des notifications:",uw)}}restoreNotifications(){try{const e=localStorage.getItem("notifications");if(e){const t=JSON.parse(e);this.notifications=t.filter((e=>e.message&&e.type?(e.timestamp&&!isNaN(new Date(e.timestamp).getTime())||(e.timestamp=(new Date).toISOString()),e.date&&!isNaN(new Date(e.date).getTime())||(e.date=e.timestamp),!0):(console.warn("Notification invalide ignor\xe9e:",e),!1))),console.log("\ud83d\udd04 ".concat(this.notifications.length," notifications valides restaur\xe9es"))}}catch(uw){console.error("Erreur lors de la restauration des notifications:",uw),this.notifications=[],localStorage.removeItem("notifications")}}markExistingNotificationsAsViewed(){this.notifications.forEach((e=>{e.read||(e.read=!0)})),this.saveNotifications()}saveState(){try{const e={checkedFactures:Array.from(this.checkedFactures),checkedRendezVous:Array.from(this.checkedRendezVous),lastLeadCount:this.lastLeadCount,lastNotificationCheck:this.lastNotificationCheck.toISOString(),cache:Array.from(this.cache.entries()),lastSave:(new Date).toISOString()};localStorage.setItem("notificationServiceState",JSON.stringify(e))}catch(uw){console.error("Erreur lors de la sauvegarde de l'\xe9tat:",uw)}}restoreState(){try{const e=localStorage.getItem("notificationServiceState");if(e){const t=JSON.parse(e);this.checkedFactures=new Set(t.checkedFactures||[]),this.checkedRendezVous=new Set(t.checkedRendezVous||[]),this.lastLeadCount=t.lastLeadCount||0,this.lastNotificationCheck=new Date(t.lastNotificationCheck||new Date),this.cache=new Map(t.cache||[]),console.log("\ud83d\udd04 \xc9tat du service restaur\xe9 depuis localStorage")}this.restoreNotifications()}catch(uw){console.error("Erreur lors de la restauration de l'\xe9tat:",uw)}}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}get subscribers(){return this.listeners}notifyListeners(){this.listeners.forEach((e=>{try{e(this.notifications)}catch(uw){console.error("Erreur lors de la notification des listeners:",uw)}}))}getNotifications(){return this.notifications}markAsRead(e){const t=this.notifications.find((t=>t.id===e));t&&(t.read=!0,this.saveNotifications(),this.notifyListeners())}markAllAsRead(){this.notifications.forEach((e=>{e.read=!0})),this.saveNotifications(),this.notifyListeners()}removeNotification(e){this.notifications=this.notifications.filter((t=>t.id!==e)),this.saveNotifications(),this.notifyListeners()}async checkAll(){if(this.userRole&&this.userName){this.lastNotificationCheck=new Date;try{await Promise.all([this.checkNewLeads(),this.checkUpcomingRendezVous(),this.checkFactureUpdates()]),this.saveState()}catch(uw){console.error("Erreur lors de la v\xe9rification des notifications:",uw)}}else console.log("Service de notifications pas encore initialis\xe9")}async checkNewLeads(){try{const e=await aa();if(!e.success||!e.leads)return void console.log("Aucune donn\xe9e de leads disponible");const t=e.leads,n=(new Date).toDateString(),r=t.filter((e=>new Date(e.dateCreation||e.date_creation||e.createdAt).toDateString()===n)),a=new Date(Date.now()-72e5),s=(t.filter((e=>new Date(e.dateCreation||e.date_creation||e.createdAt)>a)),t.filter((e=>new Date(e.dateCreation||e.date_creation||e.createdAt)>this.lastNotificationCheck)));if(s.length>0&&(["administrateur","directeur"].includes(this.userRole)&&this.notify({type:"nouveau_lead",message:"".concat(s.length," nouveau").concat(s.length>1?"x":""," lead").concat(s.length>1?"s":""," ").concat(s.length>1?"ont \xe9t\xe9 ajout\xe9s":"a \xe9t\xe9 ajout\xe9","."),date:(new Date).toISOString(),lienRedirection:"/leads"}),s.forEach((e=>{var t,n;(e.conseillere===this.userName||(null===(t=e.conseillere)||void 0===t?void 0:t.toLowerCase())===(null===(n=this.userName)||void 0===n?void 0:n.toLowerCase())||this.userId&&e.conseiller_id&&parseInt(e.conseiller_id)===parseInt(this.userId))&&this.notify({type:"nouveau_lead",message:"Un nouveau lead vous a \xe9t\xe9 assign\xe9 : ".concat(e.nom||e.prenom||"Lead"," ").concat(e.prenom||"","."),date:(new Date).toISOString(),nomClient:"".concat(e.nom||""," ").concat(e.prenom||"").trim(),lienRedirection:"/leads"})}))),r.length>0&&this.shouldSendDailySummary()&&["administrateur","directeur","conseillere"].includes(this.userRole)){const e="conseillere"===this.userRole?r.filter((e=>{var t,n;return e.conseillere===this.userName||(null===(t=e.conseillere)||void 0===t?void 0:t.toLowerCase())===(null===(n=this.userName)||void 0===n?void 0:n.toLowerCase())||this.userId&&e.conseiller_id&&parseInt(e.conseiller_id)===parseInt(this.userId)})):r;e.length>0&&this.notify({type:"resume_leads",message:"conseillere"===this.userRole?"Vous avez re\xe7u ".concat(e.length," lead").concat(e.length>1?"s":""," aujourd'hui."):"".concat(r.length," lead").concat(r.length>1?"s ont \xe9t\xe9 ajout\xe9s":" a \xe9t\xe9 ajout\xe9"," aujourd'hui."),date:(new Date).toISOString(),lienRedirection:"/leads"})}}catch(uw){console.error("Erreur lors de la v\xe9rification des leads:",uw)}}async checkUpcomingRendezVous(){try{const e=await ay.getAllRendezVous();if(!e.success||!e.rendezVous)return void console.log("Aucune donn\xe9e de rendez-vous disponible");const t=e.rendezVous,n=new Date,r=t.filter((e=>{const t=new Date(e.date||e.dateRendezVous).getTime()-n.getTime();return t>0&&t<=9e7&&t>828e5&&"termine"!==e.statut&&"annule"!==e.statut&&!this.checkedRendezVous.has("".concat(e.id,"_24h"))})),a=t.filter((e=>{const t=new Date(e.date||e.dateRendezVous).getTime()-n.getTime();return t>0&&t<=9e6&&t>54e5&&"termine"!==e.statut&&"annule"!==e.statut&&!this.checkedRendezVous.has("".concat(e.id,"_2h"))})),s=t.filter((e=>{const t=new Date(e.date||e.dateRendezVous),r=n.getTime()-t.getTime();return r>0&&r<=36e5&&"termine"!==e.statut&&"annule"!==e.statut&&!this.checkedRendezVous.has("".concat(e.id,"_missed"))}));r.forEach((e=>{if("administrateur"===this.userRole||"directeur"===this.userRole||"conseillere"===this.userRole&&(e.conseillere===this.userName||e.assignee===this.userName)){const t=new Date(e.date||e.dateRendezVous).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});this.notify({type:"rappel_rendez_vous",message:"Rappel : Rendez-vous demain \xe0 ".concat(t," avec ").concat(e.nomClient||e.client||"un client","."),date:(new Date).toISOString(),nomClient:e.nomClient||e.client,lienRedirection:"/rendez-vous"}),this.checkedRendezVous.add("".concat(e.id,"_24h"))}})),a.forEach((e=>{if("administrateur"===this.userRole||"directeur"===this.userRole||"conseillere"===this.userRole&&(e.conseillere===this.userName||e.assignee===this.userName)){const t=new Date(e.date||e.dateRendezVous).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});this.notify({type:"rappel_rendez_vous",message:"Rendez-vous dans 2 heures \xe0 ".concat(t," avec ").concat(e.nomClient||e.client||"un client","."),date:(new Date).toISOString(),nomClient:e.nomClient||e.client,lienRedirection:"/rendez-vous"}),this.checkedRendezVous.add("".concat(e.id,"_2h"))}})),s.forEach((e=>{if("administrateur"===this.userRole||"directeur"===this.userRole||"conseillere"===this.userRole&&(e.conseillere===this.userName||e.assignee===this.userName)){const t=new Date(e.date||e.dateRendezVous).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});this.notify({type:"rdv_manque",message:"Rendez-vous manqu\xe9 avec ".concat(e.nomClient||e.client||"un client"," \xe0 ").concat(t,"."),date:(new Date).toISOString(),nomClient:e.nomClient||e.client,lienRedirection:"/rendez-vous"}),this.checkedRendezVous.add("".concat(e.id,"_missed"))}})),this.cleanOldCheckedItems(this.checkedRendezVous)}catch(uw){console.error("Erreur lors de la v\xe9rification des rendez-vous:",uw)}}async checkFactureUpdates(){try{var e;console.log("\ud83d\udd04 D\xe9but v\xe9rification des factures...");const t=await zx();if(console.log("\ud83d\udcca R\xe9ponse API factures:",{success:t.success,nombreFactures:(null===(e=t.factures)||void 0===e?void 0:e.length)||0}),!t.success||!t.factures)return void console.log("\u274c Aucune donn\xe9e de factures disponible");const n=t.factures;console.log("\ud83d\udccb Analyse de ".concat(n.length," factures..."));const r=new Date(Date.now()-864e5),a=n.filter((e=>{const t="paiement_".concat(e.id);if(this.checkedFactures.has(t))return!1;const n=this.isPaymentRecent(e,r);return console.log("\ud83d\udd0d Facture ".concat(e.id,":"),{statut:e.statut,datePaiement:e.datePaiement,dateModification:e.dateModification,isPaid:"payee"===e.statut||"paid"===e.statut,isRecentPayment:n}),n}));console.log("\ud83d\udcb0 ".concat(a.length," paiements r\xe9cents d\xe9tect\xe9s")),a.forEach((e=>{const t="conseillere"!==this.userRole||e.conseillere===this.userName||e.assignee===this.userName||e.validePar===this.userName||this.userId&&e.conseiller_id&&parseInt(e.conseiller_id)===parseInt(this.userId);if(console.log("\ud83d\udd14 Notification paiement facture ".concat(e.id,": shouldNotify=").concat(t,", userRole=").concat(this.userRole,", userName=").concat(this.userName)),t){const t=e.montant||e.total||e.montantTotal;this.notify({type:"paiement_recu",message:"\ud83d\udcb0 Paiement re\xe7u : ".concat(t,"\u20ac de ").concat(e.nomClient||e.client||"Client","."),date:(new Date).toISOString(),nomClient:e.nomClient||e.client,lienRedirection:"/facturation"}),this.checkedFactures.add("paiement_".concat(e.id))}}));const s=new Date(Date.now()-2592e6),i=n.filter((e=>{const t="retard_".concat(e.id);if(this.checkedFactures.has(t))return!1;const n=new Date(e.dateFacture||e.dateCreation||e.createdAt)<s&&("en_attente"===e.statut||"pending"===e.statut||"impayee"===e.statut);return n&&this.checkedFactures.add(t),n}));i.length>0&&["administrateur","directeur"].includes(this.userRole)&&i.forEach((e=>{const t=Math.floor((Date.now()-new Date(e.dateFacture||e.dateCreation).getTime())/864e5);this.notify({type:"facture_retard",message:"\u26a0\ufe0f Facture en retard : ".concat(e.numeroFacture||e.id," depuis ").concat(t," jours."),date:(new Date).toISOString(),nomClient:e.nomClient||e.client,lienRedirection:"/facturation"})})),this.cleanOldCheckedItems(this.checkedFactures)}catch(uw){console.error("\u274c Erreur lors de la v\xe9rification des factures:",uw)}}isPaymentRecent(e,t){if(!("payee"===e.statut||"paid"===e.statut))return!1;if(e.datePaiement){const n=new Date(e.datePaiement)>t;return console.log("\ud83d\udcb0 Facture ".concat(e.id," - Date paiement: ").concat(e.datePaiement,", R\xe9cent: ").concat(n)),n}if(e.dateModification||e.updatedAt){const n=new Date(e.dateModification||e.updatedAt)>t;return console.log("\ud83d\udcdd Facture ".concat(e.id," - Date modification: ").concat(e.dateModification||e.updatedAt,", R\xe9cent: ").concat(n)),n}return console.log("\u26a1 Facture ".concat(e.id," - Pas de date, consid\xe9r\xe9 comme r\xe9cent car pay\xe9")),!0}notify(e){this.addNotification(e)}shouldSendDailySummary(){const e=(new Date).toDateString(),t=localStorage.getItem("lastDailySummary");return(!t||t!==e)&&(localStorage.setItem("lastDailySummary",e),!0)}cleanOldCheckedItems(e){if(e.size>1e3){Array.from(e);e.clear()}}async initializeWithUserInfo(){try{const e=this.getCurrentUserInfo();e?(this.userRole=e.role||e.type||"conseillere",this.userName=e.nom||e.username||e.name,this.userId=e.id,console.log("Service de notifications initialis\xe9 pour ".concat(this.userName," (").concat(this.userRole,")")),this.startChecking()):console.warn("Informations utilisateur non disponibles pour les notifications")}catch(uw){console.error("Erreur lors de l'initialisation du service de notifications:",uw)}}getCurrentUserInfo(){try{const e=localStorage.getItem("user")||localStorage.getItem("currentUser");if(e)return JSON.parse(e);const t=sessionStorage.getItem("user")||sessionStorage.getItem("currentUser");if(t)return JSON.parse(t);if(window.currentUser)return window.currentUser;const n=localStorage.getItem("token")||localStorage.getItem("authToken");if(n)try{const e=JSON.parse(atob(n.split(".")[1]));return{id:e.id||e.userId,nom:e.nom||e.name||e.username,role:e.role||e.type}}catch(cw){console.log("Impossible de d\xe9coder le token JWT")}return console.warn("Aucune information utilisateur trouv\xe9e"),null}catch(uw){return console.error("Erreur lors de la r\xe9cup\xe9ration des informations utilisateur:",uw),null}}startChecking(){this.stopChecking(),this.isRunning=!0,this.checkAll(),this.checkInterval=setInterval((()=>{this.checkAll()}),3e4)}stopChecking(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.isRunning=!1}start(){this.startChecking()}stop(){this.stopChecking()}async forceCheck(){console.log("\ud83d\udd04 V\xe9rification forc\xe9e des notifications..."),await this.checkAll()}resetChecked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";"all"!==e&&"factures"!==e||(this.checkedFactures.clear(),console.log("\u267b\ufe0f Cache des factures r\xe9initialis\xe9")),"all"!==e&&"rendezVous"!==e||(this.checkedRendezVous.clear(),console.log("\u267b\ufe0f Cache des rendez-vous r\xe9initialis\xe9")),"all"===e&&(this.lastLeadCount=0,console.log("\u267b\ufe0f Cache des leads r\xe9initialis\xe9")),this.saveState()}clearAllNotifications(){console.log("\ud83d\uddd1\ufe0f Suppression de toutes les notifications..."),this.notifications=[],this.saveNotifications(),this.notifyListeners(),console.log("\u2705 Toutes les notifications ont \xe9t\xe9 supprim\xe9es")}generateDebugNotifications(){console.log("\ud83e\uddea G\xe9n\xe9ration de notifications de test...");const e=[{type:"nouveau_lead",message:"Nouveau lead assign\xe9 : Marie Dupont",nomClient:"Marie Dupont"},{type:"paiement_recu",message:"\ud83d\udcb0 Paiement re\xe7u : 500\u20ac de Jean Martin",nomClient:"Jean Martin"},{type:"rappel_rendez_vous",message:"Rappel : RDV demain \xe0 14h30 avec Sophie Leblanc",nomClient:"Sophie Leblanc"}];e.forEach((e=>{this.notify(u(u({},e),{},{date:(new Date).toISOString(),lienRedirection:"/dashboard"}))})),console.log("\u2705 ".concat(e.length," notifications de test g\xe9n\xe9r\xe9es"))}generateTestNotifications(){[{type:"nouveau_lead",message:"Vous avez re\xe7u 3 nouveaux leads aujourd'hui.",date:(new Date).toISOString(),lienRedirection:"/leads"},{type:"rappel_rendez_vous",message:"Rendez-vous pr\xe9vu avec Marie Dubois \xe0 14:30 aujourd'hui.",date:(new Date).toISOString(),nomClient:"Marie Dubois",lienRedirection:"/clients"},{type:"paiement_recu",message:"Paiement re\xe7u de 4000$ de Jean Martin.",date:(new Date).toISOString(),nomClient:"Jean Martin",lienRedirection:"/clients"},{type:"facture_retard",message:"Attention : facture F2025-075 en attente depuis 7 jours.",date:(new Date).toISOString(),lienRedirection:"/clients"}].forEach(((e,t)=>{setTimeout((()=>{this.notify(e)}),2e3*t)}))}testPaymentNotification(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1000",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Client Test";console.log("\ud83e\uddea Test notification paiement forc\xe9e"),this.notify({type:"paiement_recu",message:"\ud83d\udcb0 TEST - Paiement re\xe7u : ".concat(e,"\u20ac de ").concat(t,"."),date:(new Date).toISOString(),nomClient:t,lienRedirection:"/facturation"})}testLeadAssignmentNotification(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Test Lead";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||this.userName;console.log("\ud83e\uddea Test notification lead assign\xe9 forc\xe9e"),this.notify({type:"nouveau_lead",message:"Un nouveau lead vous a \xe9t\xe9 assign\xe9 : ".concat(e,"."),date:(new Date).toISOString(),nomClient:e,lienRedirection:"/leads"})}async diagnoseLeadAssignments(){try{console.log("\ud83d\udd0d === DIAGNOSTIC ASSIGNATION LEADS ===");const e=await fetch("http://localhost:5000/api/leads",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!e.ok)return void console.log("\u274c Impossible de r\xe9cup\xe9rer les leads");const t=await e.json(),n=t.data||t,r=localStorage.getItem("userName"),a=localStorage.getItem("userId");if(console.log("\ud83d\udc64 Utilisateur actuel:",r,"(ID:",a,")"),console.log("\ud83d\udccb Total leads r\xe9cup\xe9r\xe9s:",n.length),!Array.isArray(n))return void console.log("\u274c Format de leads invalide");const s=n.filter((e=>{var t;const n=a&&e.conseiller_id&&parseInt(e.conseiller_id)===parseInt(a),s=e.conseillere===r||(null===(t=e.conseillere)||void 0===t?void 0:t.toLowerCase())===(null===r||void 0===r?void 0:r.toLowerCase());return n||s}));console.log("\ud83c\udfaf Leads assign\xe9s \xe0 l'utilisateur actuel:",s.length),s.length>0&&(console.log("\ud83d\udcca D\xe9tail des leads assign\xe9s:"),s.forEach(((e,t)=>{console.log("  ".concat(t+1,". Lead ").concat(e.id,": ").concat(e.prenom," ").concat(e.nom)),console.log("     conseiller_id:",e.conseiller_id||"NULL"),console.log("     conseillere:",e.conseillere||"NULL"),console.log("     date_creation:",e.date_creation||e.createdAt),console.log("     date_mise_a_jour:",e.date_mise_a_jour||e.updatedAt)})));const i=new Date(Date.now()-36e5),o=n.filter((e=>new Date(e.date_mise_a_jour||e.updatedAt)>i));console.log("\ud83d\udd50 Leads mis \xe0 jour dans la derni\xe8re heure:",o.length),o.length>0&&(console.log("\ud83d\udcc8 D\xe9tail des leads r\xe9cemment mis \xe0 jour:"),o.forEach(((e,t)=>{var n;const s=a&&e.conseiller_id&&parseInt(e.conseiller_id)===parseInt(a)||e.conseillere===r||(null===(n=e.conseillere)||void 0===n?void 0:n.toLowerCase())===(null===r||void 0===r?void 0:r.toLowerCase());console.log("  ".concat(t+1,". Lead ").concat(e.id,": ").concat(e.prenom," ").concat(e.nom)),console.log("     Assign\xe9 \xe0 l'utilisateur actuel: ".concat(s?"\u2705 OUI":"\u274c NON")),console.log("     conseiller_id:",e.conseiller_id||"NULL"),console.log("     conseillere:",e.conseillere||"NULL"),console.log("     date_mise_a_jour:",e.date_mise_a_jour||e.updatedAt)}))),console.log("\ud83d\udcbe Cache notifications:"),console.log("  Leads notifi\xe9s:",Array.from(this.cache.keys()).filter((e=>e.startsWith("lead_assigned_")))),console.log("\u2705 Diagnostic termin\xe9")}catch(uw){console.error("\u274c Erreur lors du diagnostic des leads:",uw)}}async diagnoseFactures(){try{console.log("\ud83d\udd0d === DIAGNOSTIC FACTURES ===");const e=await zx();if(!e.success||!e.factures)return void console.log("\u274c Impossible de r\xe9cup\xe9rer les factures");const t=e.factures;console.log("\ud83d\udccb Total factures:",t.length);const n=t.filter((e=>"payee"===e.statut||"paid"===e.statut)),r=t.filter((e=>"en_attente"===e.statut||"pending"===e.statut));console.log("\ud83d\udcb0 Factures pay\xe9es:",n.length),console.log("\u23f3 Factures en attente:",r.length);const a=new Date(Date.now()-864e5),s=t.filter((e=>this.isPaymentRecent(e,a)));console.log("\ud83d\udd25 Paiements r\xe9cents (24h):",s.length),s.length>0&&(console.log("\ud83d\udcca D\xe9tail des paiements r\xe9cents:"),s.forEach(((e,t)=>{console.log("  ".concat(t+1,". Facture ").concat(e.id)),console.log("     Client:",e.nomClient||e.client),console.log("     Montant:",e.montant||e.total),console.log("     Statut:",e.statut),console.log("     Date paiement:",e.datePaiement||"Non d\xe9finie"),console.log("     Date modification:",e.dateModification||e.updatedAt)}))),console.log("\ud83d\udcbe Cache paiements notifi\xe9s:",Array.from(this.checkedFactures).filter((e=>e.startsWith("paiement_")))),console.log("\u2705 Diagnostic factures termin\xe9")}catch(uw){console.error("\u274c Erreur lors du diagnostic des factures:",uw)}}clearShownToasts(){"undefined"!==typeof window&&(localStorage.removeItem("shownToasts"),console.log("\ud83e\uddf9 Cache des toasts affich\xe9s nettoy\xe9"))}diagnoseNotificationDisplay(){if(console.log("\ud83d\udd0d === DIAGNOSTIC AFFICHAGE NOTIFICATIONS ==="),console.log("\ud83d\udcf1 Notifications actuelles:",this.notifications.length),console.log("\ud83d\udcf1 Notifications non lues:",this.notifications.filter((e=>!e.read)).length),console.log("\ud83d\udc65 Listeners actifs:",this.listeners.length),"undefined"!==typeof window){var e,t;const n=JSON.parse(localStorage.getItem("shownToasts")||"[]");console.log("\ud83c\udf5e Toasts affich\xe9s:",n.length),console.log("\ud83d\udd14 \xc9tat global:"),console.log("  - isAuthenticated:",null===(e=window.notificationState)||void 0===e?void 0:e.isAuthenticated),console.log("  - userInfo:",null===(t=window.notificationState)||void 0===t?void 0:t.userInfo)}console.log("\u2699\ufe0f Service \xe9tat:"),console.log("  - userRole:",this.userRole),console.log("  - userName:",this.userName),console.log("  - userId:",this.userId),console.log("  - checkInterval actif:",!!this.checkInterval),console.log("\u2705 Diagnostic affichage termin\xe9")}cleanInvalidNotifications(){const e=this.notifications.length;this.notifications=this.notifications.filter((e=>{if(!e.message||!e.type)return console.warn("\ud83d\uddd1\ufe0f Notification supprim\xe9e (champs manquants):",e),!1;let t=!0;return e.timestamp&&!isNaN(new Date(e.timestamp).getTime())||(console.warn("\ud83d\udcc5 Correction timestamp pour notification:",e.id),e.timestamp=(new Date).toISOString(),t=!1),e.date&&!isNaN(new Date(e.date).getTime())||(console.warn("\ud83d\udcc5 Correction date pour notification:",e.id),e.date=e.timestamp,t=!1),!0}));const t=e-this.notifications.length;t>0&&(console.log("\ud83e\uddf9 ".concat(t," notifications nettoy\xe9es/corrig\xe9es")),this.saveNotifications())}};"undefined"!==typeof window&&(window.notificationService=my);const gy=my,vy=()=>{const[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)(null),[a,i]=(0,s.useState)({totalNotifications:0,notificationsToday:0,lastLeadCount:0});(0,s.useEffect)((()=>{const e=()=>{t(gy.isRunning),r((new Date).toLocaleTimeString()),i({totalNotifications:gy.subscribers.length,notificationsToday:0,lastLeadCount:gy.lastLeadCount})};e();const n=setInterval(e,5e3);return()=>clearInterval(n)}),[]);const o=e=>{gy.resetChecked(e),alert("Cache ".concat(e," r\xe9initialis\xe9"))};return(0,$r.jsxs)("div",{className:"notification-panel",children:[(0,$r.jsx)("h3",{children:"\ud83d\udd14 Panneau de Contr\xf4le des Notifications"}),(0,$r.jsxs)("div",{className:"panel-section",children:[(0,$r.jsx)("h4",{children:"\xc9tat du Service"}),(0,$r.jsxs)("div",{className:"status-indicator",children:[(0,$r.jsx)("span",{className:"status-dot ".concat(e?"active":"inactive")}),(0,$r.jsx)("span",{className:"status-text",children:e?"Service actif":"Service arr\xeat\xe9"}),n&&(0,$r.jsxs)("span",{className:"last-check",children:["(Derni\xe8re v\xe9rification: ",n,")"]})]}),(0,$r.jsxs)("div",{className:"control-buttons",children:[(0,$r.jsx)("button",{onClick:()=>{gy.start(),t(!0)},disabled:e,className:"btn btn-success",children:"\u25b6\ufe0f D\xe9marrer"}),(0,$r.jsx)("button",{onClick:()=>{gy.stop(),t(!1)},disabled:!e,className:"btn btn-danger",children:"\u23f9\ufe0f Arr\xeater"}),(0,$r.jsx)("button",{onClick:async()=>{r("V\xe9rification en cours...");try{await gy.forceCheck(),r((new Date).toLocaleTimeString())}catch(uw){console.error("Erreur lors de la v\xe9rification forc\xe9e:",uw),r("Erreur")}},disabled:!e,className:"btn btn-primary",children:"\ud83d\udd04 V\xe9rifier maintenant"})]})]}),(0,$r.jsxs)("div",{className:"panel-section",children:[(0,$r.jsx)("h4",{children:"Tests et D\xe9veloppement"}),(0,$r.jsxs)("div",{className:"control-buttons",children:[(0,$r.jsx)("button",{onClick:()=>{gy.generateTestNotifications()},className:"btn btn-warning",children:"\ud83e\uddea G\xe9n\xe9rer notifications de test"}),(0,$r.jsx)("button",{onClick:()=>o("factures"),className:"btn btn-info",children:"\u267b\ufe0f Reset Cache Factures"}),(0,$r.jsx)("button",{onClick:()=>o("all"),className:"btn btn-secondary",children:"\ud83d\uddd1\ufe0f Reset Tout Cache"})]}),(0,$r.jsx)("p",{className:"test-info",children:"Utilisez ces boutons pour tester les notifications en temps r\xe9el et r\xe9initialiser les caches."})]}),(0,$r.jsxs)("div",{className:"panel-section",children:[(0,$r.jsx)("h4",{children:"Statistiques"}),(0,$r.jsxs)("div",{className:"stats-grid",children:[(0,$r.jsxs)("div",{className:"stat-item",children:[(0,$r.jsx)("span",{className:"stat-label",children:"Abonn\xe9s actifs:"}),(0,$r.jsx)("span",{className:"stat-value",children:a.totalNotifications})]}),(0,$r.jsxs)("div",{className:"stat-item",children:[(0,$r.jsx)("span",{className:"stat-label",children:"Leads compt\xe9s:"}),(0,$r.jsx)("span",{className:"stat-value",children:a.lastLeadCount})]})]})]}),(0,$r.jsxs)("div",{className:"panel-section",children:[(0,$r.jsx)("h4",{children:"Types de Notifications Actives"}),(0,$r.jsxs)("ul",{className:"notification-types",children:[(0,$r.jsx)("li",{children:"\ud83d\udcc8 Nouveaux leads attribu\xe9s"}),(0,$r.jsx)("li",{children:"\ud83d\udcc5 Rappels de rendez-vous"}),(0,$r.jsx)("li",{children:"\ud83d\udcb0 Paiements re\xe7us"}),(0,$r.jsx)("li",{children:"\u26a0\ufe0f Factures en retard"}),(0,$r.jsx)("li",{children:"\ud83d\udcca R\xe9sum\xe9s quotidiens"})]})]}),(0,$r.jsxs)("div",{className:"panel-section",children:[(0,$r.jsx)("h4",{children:"Configuration"}),(0,$r.jsxs)("div",{className:"config-options",children:[(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",defaultChecked:!0}),"V\xe9rifier les nouveaux leads"]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",defaultChecked:!0}),"Rappels de rendez-vous"]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",defaultChecked:!0}),"Notifications de paiement"]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",defaultChecked:!0}),"Alertes factures en retard"]})]})]})]})},by=["administrateur","directeur"],xy={utilisateurs:cy,roles:fy,parametres:()=>(0,$r.jsxs)("div",{className:"users-module",children:[(0,$r.jsx)("h3",{children:"\u2699\ufe0f Param\xe8tres Syst\xe8me"}),(0,$r.jsxs)("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 100%)",border:"2px dashed #cbd5e1",borderRadius:"8px",padding:"3rem",textAlign:"center",color:"#64748b"},children:[(0,$r.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\ud83d\udea7"}),(0,$r.jsx)("h4",{style:{color:"#334155",marginBottom:"0.5rem"},children:"Module en d\xe9veloppement"}),(0,$r.jsx)("p",{children:"Param\xe8tres g\xe9n\xe9raux, configuration facturation, param\xe8tres email, etc."}),(0,$r.jsx)("small",{style:{color:"#94a3b8"},children:"Cette fonctionnalit\xe9 sera bient\xf4t disponible"})]})]}),modeles:()=>(0,$r.jsxs)("div",{className:"users-module",children:[(0,$r.jsx)("h3",{children:"\ud83d\udcc4 Mod\xe8les de documents"}),(0,$r.jsxs)("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 100%)",border:"2px dashed #cbd5e1",borderRadius:"8px",padding:"3rem",textAlign:"center",color:"#64748b"},children:[(0,$r.jsx)("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"\ud83d\udcdd"}),(0,$r.jsx)("h4",{style:{color:"#334155",marginBottom:"0.5rem"},children:"Module en d\xe9veloppement"}),(0,$r.jsx)("p",{children:"Gestion des mod\xe8les de contrats, factures, emails automatiques, etc."}),(0,$r.jsx)("small",{style:{color:"#94a3b8"},children:"Cette fonctionnalit\xe9 sera bient\xf4t disponible"})]})]}),notifications:()=>(0,$r.jsx)(vy,{}),journaux:()=>(0,$r.jsx)(py,{})},yy=e=>{let{userRole:t}=e;const[n,r]=(0,s.useState)("utilisateurs");if(t&&!by.includes(t))return(0,$r.jsxs)("div",{style:{padding:"2rem"},children:[(0,$r.jsx)("h2",{children:"Acc\xe8s refus\xe9"}),(0,$r.jsx)("p",{children:"Vous n'avez pas l'autorisation de consulter cette page."})]});const a=xy[n];return(0,$r.jsxs)("div",{className:"administration-container",children:[(0,$r.jsx)("h2",{children:"Administration"}),(0,$r.jsxs)("div",{className:"admin-tabs",children:[(0,$r.jsx)("button",{className:"utilisateurs"===n?"active":"",onClick:()=>r("utilisateurs"),children:"\ud83d\udc65 Utilisateurs"}),(0,$r.jsx)("button",{className:"roles"===n?"active":"",onClick:()=>r("roles"),children:"\ud83d\udd10 R\xf4les & Permissions"}),(0,$r.jsx)("button",{className:"parametres"===n?"active":"",onClick:()=>r("parametres"),children:"\u2699\ufe0f Param\xe8tres Syst\xe8me"}),(0,$r.jsx)("button",{className:"modeles"===n?"active":"",onClick:()=>r("modeles"),children:"\ud83d\udcc4 Mod\xe8les"}),(0,$r.jsx)("button",{className:"notifications"===n?"active":"",onClick:()=>r("notifications"),children:"\ud83d\udd14 Notifications"}),(0,$r.jsx)("button",{className:"journaux"===n?"active":"",onClick:()=>r("journaux"),children:"\ud83d\udcca Journaux d'activit\xe9"})]}),(0,$r.jsx)("div",{className:"tab-content-wrapper",children:(0,$r.jsx)(a,{})})]})},wy="http://localhost:5000/api",jy=()=>{const e=localStorage.getItem("token"),t={};return e&&(t.Authorization="Bearer ".concat(e)),t},Ny=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";console.log("\ud83d\udd11 [API] R\xe9cup\xe9ration stats avec token:",localStorage.getItem("token")?"Token pr\xe9sent":"Pas de token");const t=await Yr.get("".concat(wy,"/dashboard/stats"),{params:{periode:e},headers:jy()});return console.log("\ud83d\udcca [API] R\xe9ponse stats re\xe7ue:",t.data),t.data},Sy="http://localhost:5000/api";const Cy=new class{async getLeadsParSource(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{return(await Yr.get("".concat(Sy,"/statistics/leads-par-source/").concat(e))).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des leads par source:",uw),uw}}async getRevenusParPeriode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{return(await Yr.get("".concat(Sy,"/statistics/revenus-par-periode/").concat(e))).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des revenus:",uw),uw}}async getDossiersParType(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{return(await Yr.get("".concat(Sy,"/statistics/dossiers-par-type/").concat(e))).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des dossiers par type:",uw),uw}}async getAllStatistics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{return(await Yr.get("".concat(Sy,"/statistics/all/").concat(e))).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration de toutes les statistiques:",uw),uw}}async getAllGlobalStatistics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{return(await Yr.get("".concat(Sy,"/statistics/global/").concat(e))).data}catch(uw){throw console.error("Erreur lors de la r\xe9cup\xe9ration des statistiques globales:",uw),uw}}async getStatisticsWithFallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{const t=await this.getAllStatistics(e);return t.success?t.data:(console.warn("API retourn\xe9e avec success=false, utilisation des donn\xe9es de fallback"),this.getFallbackData(e))}catch(uw){return console.warn("API non disponible, utilisation des donn\xe9es de fallback:",uw.message),this.getFallbackData(e)}}async getGlobalStatisticsWithFallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{console.log("\ud83c\udf0d [StatisticsService] R\xe9cup\xe9ration des statistiques GLOBALES pour: ".concat(e));const t=await this.getAllGlobalStatistics(e);return t.success&&t.global?(console.log("\u2705 [StatisticsService] Statistiques globales re\xe7ues pour ".concat(e,":"),t.data),t.data):(console.warn("API globale retourn\xe9e avec success=false, tentative avec API standard"),await this.getStatisticsWithFallback(e))}catch(uw){return console.warn("API globale non disponible, utilisation de l'API standard:",uw.message),await this.getStatisticsWithFallback(e)}}getFallbackData(e){const t={jour:{leadsParSource:[{source:"Site Web",valeur:3},{source:"R\xe9f\xe9rence",valeur:1},{source:"R\xe9seaux Sociaux",valeur:2},{source:"Autre",valeur:0}],revenusParMois:[{mois:"08:00",valeur:1200},{mois:"12:00",valeur:1500},{mois:"16:00",valeur:1100},{mois:"18:00",valeur:1800}],dossiersParType:[{type:"Permis d'\xe9tudes",valeur:2},{type:"R\xe9sidence permanente",valeur:1},{type:"Visa visiteur",valeur:1},{type:"Permis de travail",valeur:0}]},semaine:{leadsParSource:[{source:"Site Web",valeur:8},{source:"R\xe9f\xe9rence",valeur:3},{source:"R\xe9seaux Sociaux",valeur:3},{source:"Autre",valeur:2}],revenusParMois:[{mois:"Lun",valeur:5500},{mois:"Mar",valeur:6200},{mois:"Mer",valeur:5800},{mois:"Jeu",valeur:7500},{mois:"Ven",valeur:8e3}],dossiersParType:[{type:"Permis d'\xe9tudes",valeur:5},{type:"R\xe9sidence permanente",valeur:3},{type:"Visa visiteur",valeur:2},{type:"Permis de travail",valeur:2}]},mois:{leadsParSource:[{source:"Site Web",valeur:12},{source:"R\xe9f\xe9rence",valeur:5},{source:"R\xe9seaux Sociaux",valeur:4},{source:"Autre",valeur:3}],revenusParMois:[{mois:"Sem 1",valeur:15e3},{mois:"Sem 2",valeur:18e3},{mois:"Sem 3",valeur:16500},{mois:"Sem 4",valeur:21e3}],dossiersParType:[{type:"Permis d'\xe9tudes",valeur:8},{type:"R\xe9sidence permanente",valeur:6},{type:"Visa visiteur",valeur:4},{type:"Permis de travail",valeur:3}]},annee:{leadsParSource:[{source:"Site Web",valeur:120},{source:"R\xe9f\xe9rence",valeur:45},{source:"R\xe9seaux Sociaux",valeur:38},{source:"Autre",valeur:27}],revenusParMois:[{mois:"Jan",valeur:18e4},{mois:"F\xe9v",valeur:234e3},{mois:"Mar",valeur:198e3},{mois:"Avr",valeur:267e3}],dossiersParType:[{type:"Permis d'\xe9tudes",valeur:45},{type:"R\xe9sidence permanente",valeur:32},{type:"Visa visiteur",valeur:28},{type:"Permis de travail",valeur:25}]}};return t[e]||t.mois}};const ky=function(e){let{userRole:t="directeur",userName:n="Utilisateur Test",onNavigate:r}=e;const[a,i]=(0,s.useState)("mois"),[o,l]=(0,s.useState)("Aper\xe7u du Mois"),c=(0,s.useRef)(a),[d,h]=(0,s.useState)([]),[f,p]=(0,s.useState)(!1),[m,g]=(0,s.useState)({mesFactures:[],monTotalTTC:0,monNombreFactures:0}),[v,b]=(0,s.useState)(!1),[x,y]=(0,s.useState)({totalConsultations:0,consultationsRecentes:[],evolution:"+0%"}),[w,j]=(0,s.useState)(!1),[N,S]=(0,s.useState)([]),[C,k]=(0,s.useState)(!1),[E,A]=(0,s.useState)([]),[T,P]=(0,s.useState)(!1),[_,L]=(0,s.useState)(null),[R,D]=(0,s.useState)(!1),[I,O]=(0,s.useState)(null),[F,M]=(0,s.useState)(null),[B,z]=(0,s.useState)("client"),[U,q]=(0,s.useState)(!1);(0,s.useEffect)((()=>{let e="Aper\xe7u ";switch(a){case"jour":e+="du Jour";break;case"semaine":e+="de la Semaine";break;case"mois":default:e+="du Mois";break;case"trimestre":e+="du Trimestre";break;case"annee":e+="de l'Ann\xe9e"}l(e)}),[a]);const[V,W]=(0,s.useState)({totalLeads:24,leadsActifs:18,tauxConversion:75,totalClients:42,clientsActifs:38,dossiersEnCours:31,dossiersCompletes:15,facturesEnAttente:8,montantFacturesEnAttente:12500,montantFacturesPaye:45e3,rendezVousAVenir:12,chargesAVenir:5,montantChargesAVenir:8500,mesClients:0,mesLeads:0,mesDossiers:0,mesFacturesImpayees:0,mesConsultations:28,mesVentes:15,totalVentes:45e3,paiementsRecents:18500,leadsATraiter:6,rendezVousJour:8,nouveauxLeads:4,ventesParConseillere:[{conseillere:"wafaa chaouby",valeur:18500},{conseillere:"hame amni",valeur:15200},{conseillere:"sanaa sami",valeur:11300}],evolutionClients:0,evolutionLeads:0}),[H,G]=(0,s.useState)({leadsParSource:{jour:[{source:"Site Web",valeur:3},{source:"R\xe9f\xe9rence",valeur:1},{source:"R\xe9seaux Sociaux",valeur:2},{source:"Autre",valeur:0}],semaine:[{source:"Site Web",valeur:8},{source:"R\xe9f\xe9rence",valeur:3},{source:"R\xe9seaux Sociaux",valeur:3},{source:"Autre",valeur:2}],mois:[{source:"Site Web",valeur:12},{source:"R\xe9f\xe9rence",valeur:5},{source:"R\xe9seaux Sociaux",valeur:4},{source:"Autre",valeur:3}],trimestre:[{source:"Site Web",valeur:35},{source:"R\xe9f\xe9rence",valeur:14},{source:"R\xe9seaux Sociaux",valeur:12},{source:"Autre",valeur:9}],annee:[{source:"Site Web",valeur:120},{source:"R\xe9f\xe9rence",valeur:45},{source:"R\xe9seaux Sociaux",valeur:38},{source:"Autre",valeur:27}]},revenusParMois:{jour:[{mois:"Lun",valeur:1200},{mois:"Mar",valeur:1500},{mois:"Mer",valeur:1100},{mois:"Jeu",valeur:1800},{mois:"Ven",valeur:2100}],semaine:[{mois:"Sem 1",valeur:5500},{mois:"Sem 2",valeur:6200},{mois:"Sem 3",valeur:5800},{mois:"Sem 4",valeur:7500},{mois:"Sem 5",valeur:8e3}],mois:[{mois:"Jan",valeur:15e3},{mois:"F\xe9v",valeur:18e3},{mois:"Mar",valeur:16500},{mois:"Avr",valeur:21e3},{mois:"Mai",valeur:24500}],trimestre:[{mois:"T1",valeur:49500},{mois:"T2",valeur:61500},{mois:"T3",valeur:55e3},{mois:"T4",valeur:68e3}],annee:[{mois:"2024",valeur:18e4},{mois:"2025",valeur:234e3}]},dossiersParType:{jour:[{type:"Permis d'\xe9tudes",valeur:2},{type:"R\xe9sidence permanente",valeur:1},{type:"Visa visiteur",valeur:1},{type:"Permis de travail",valeur:0},{type:"Citoyennet\xe9",valeur:0}],semaine:[{type:"Permis d'\xe9tudes",valeur:6},{type:"R\xe9sidence permanente",valeur:4},{type:"Visa visiteur",valeur:3},{type:"Permis de travail",valeur:2},{type:"Citoyennet\xe9",valeur:1}],mois:[{type:"Permis d'\xe9tudes",valeur:18},{type:"R\xe9sidence permanente",valeur:12},{type:"Visa visiteur",valeur:8},{type:"Permis de travail",valeur:5},{type:"Citoyennet\xe9",valeur:3}],trimestre:[{type:"Permis d'\xe9tudes",valeur:45},{type:"R\xe9sidence permanente",valeur:32},{type:"Visa visiteur",valeur:24},{type:"Permis de travail",valeur:18},{type:"Citoyennet\xe9",valeur:9}],annee:[{type:"Permis d'\xe9tudes",valeur:180},{type:"R\xe9sidence permanente",valeur:120},{type:"Visa visiteur",valeur:95},{type:"Permis de travail",valeur:65},{type:"Citoyennet\xe9",valeur:40}]},ventesParConseillere:{jour:[{conseillere:"wafaa chaouby",valeur:1500},{conseillere:"hame amni",valeur:1200},{conseillere:"sanaa sami",valeur:900}],semaine:[{conseillere:"wafaa chaouby",valeur:8500},{conseillere:"hame amni",valeur:7200},{conseillere:"sanaa sami",valeur:5300}],mois:[{conseillere:"wafaa chaouby",valeur:18500},{conseillere:"hame amni",valeur:15200},{conseillere:"sanaa sami",valeur:11300}],trimestre:[{conseillere:"wafaa chaouby",valeur:55e3},{conseillere:"hame amni",valeur:48e3},{conseillere:"sanaa sami",valeur:36e3}],annee:[{conseillere:"wafaa chaouby",valeur:22e4},{conseillere:"hame amni",valeur:185e3},{conseillere:"sanaa sami",valeur:145e3}]}}),[Y,$]=(0,s.useState)({leadsParSource:[],revenusParMois:[],dossiersParType:[],ventesParConseillere:[]}),[K,J]=(0,s.useState)([]),[X,Q]=(0,s.useState)([]),[Z,ee]=(0,s.useState)([]),[te,ne]=(0,s.useState)([]),[re,ae]=(0,s.useState)([]),[se,ie]=(0,s.useState)([]),[oe,le]=(0,s.useState)([]),[ce,ue]=(0,s.useState)([]),[de,he]=(0,s.useState)([{id:"C-2025-023",description:"Loyer bureau",montant:3500,date:"2025-05-01",statut:"Pay\xe9e"},{id:"C-2025-024",description:"Services publics",montant:850,date:"2025-05-05",statut:"Pay\xe9e"},{id:"C-2025-025",description:"Fournitures de bureau",montant:450,date:"2025-05-12",statut:"En attente"},{id:"C-2025-026",description:"Services informatiques",montant:1200,date:"2025-05-15",statut:"En attente"}]),[fe,pe]=(0,s.useState)([]),me=e=>new Intl.NumberFormat("fr-CA",{style:"currency",currency:"CAD"}).format(e),ge=e=>{switch(e){case"lead":return"\ud83d\udc64";case"client":return"\ud83d\udc65";case"dossier":return"\ud83d\udcc1";case"facture":return"\ud83d\udcb0";case"rendez-vous":return"\ud83d\udcc5";default:return"\ud83d\udcdd"}},ve=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;try{p(!0),console.log("\ud83d\udd04 [TableauBord] Chargement ventes conseill\xe8res pour p\xe9riode: ".concat(e,", userRole: ").concat(t));const n=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mois";try{const t=await Yr.get("".concat(wy,"/dashboard/ventes-conseilleres"),{params:{periode:e},headers:jy()});return{success:!0,data:t.data.data||[],summary:t.data.summary||{},periode:t.data.periode||e}}catch(uw){return console.error("\u274c Erreur r\xe9cup\xe9ration ventes conseill\xe8res:",uw),{success:!1,data:[],error:uw.message}}}(e);console.log("\ud83d\udcca [TableauBord] R\xe9sultat API ventes:",n),n.success?(console.log("\u2705 [TableauBord] ".concat(n.data.length," ventes charg\xe9es:"),n.data),h(n.data),W((e=>{var t;return u(u({},e),{},{ventesParConseillere:n.data,totalVentes:(null===(t=n.summary)||void 0===t?void 0:t.totalVentesTTC)||e.totalVentes})})),$((e=>u(u({},e),{},{ventesParConseillere:n.data})))):(console.error("\u274c [TableauBord] Erreur chargement ventes:",n.error),h([]))}catch(uw){console.error("\u274c [TableauBord] Erreur chargement ventes conseill\xe8res:",uw),h([])}finally{p(!1)}},be=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;try{var t;b(!0);let r=n;if(!r||"Utilisateur Test"===r){const e=localStorage.getItem("userName"),t=localStorage.getItem("user"),n=localStorage.getItem("fullName");if(e)r=e;else if(t)try{const e=JSON.parse(t);r=e.nom||e.prenom||e.username||r}catch(cw){console.warn("\u26a0\ufe0f Erreur parsing user data du localStorage")}else n&&(r=n)}console.log('\ud83d\udd04 Chargement MES ventes pour: "'.concat(r,'" (original: "').concat(n,'"), p\xe9riode: ').concat(e)),console.log('\ud83d\udd0d Sources test\xe9es: localStorage.userName="'.concat(localStorage.getItem("userName"),'", localStorage.user="').concat(null===(t=localStorage.getItem("user"))||void 0===t?void 0:t.substring(0,50),'..."'));const a=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mois";try{console.log("\ud83d\udd11 [API] R\xe9cup\xe9ration mes ventes avec token:",localStorage.getItem("token")?"Token pr\xe9sent":"Pas de token"),console.log("\ud83d\udd0d [API] Param\xe8tres:",{conseillere:e,periode:t});const n={periode:t};e?(n.conseillere=e,console.log("\ud83c\udfaf [API] Filtrage explicite par conseill\xe8re:",e)):console.log("\ud83d\udd10 [API] Utilisation de l'authentification automatique");const r=await Yr.get("".concat(wy,"/dashboard/mes-ventes"),{params:n,headers:jy()});return console.log("\ud83d\udcca [API] R\xe9ponse mes ventes re\xe7ue:",r.data),{success:!0,data:r.data.data||{},periode:r.data.periode||t}}catch(uw){return console.error("\u274c Erreur r\xe9cup\xe9ration mes ventes:",uw),{success:!1,data:{mesFactures:[],monTotalTTC:0,monNombreFactures:0,facturesPayees:0,facturesEnAttente:0},error:uw.message}}}(r,e);a.success?(console.log("\u2705 Mes ventes charg\xe9es:",a.data),g(a.data),W((e=>u(u({},e),{},{mesClients:a.data.monNombreFactures||0,mesFacturesImpayees:a.data.facturesEnAttente||0,mesVentes:a.data.facturesPayees||0,totalMesVentes:a.data.monTotalTTC||0})))):console.error("\u274c Erreur chargement mes ventes:",a.error)}catch(uw){console.error("\u274c Erreur chargement mes ventes:",uw)}finally{b(!1)}},xe=async()=>{try{k(!0),console.log("\ud83d\udd04 [TableauBord] Chargement rendez-vous \xe0 venir pour userRole: ".concat(t,", userName: ").concat(n));const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"directeur",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{console.log("\ud83d\udd04 [API] R\xe9cup\xe9ration rendez-vous \xe0 venir pour:",{userRole:e,userName:t,limite:n});const r={limite:n};"conseillere"===e&&t&&(r.conseillere=t);const a=await Yr.get("".concat(wy,"/dashboard/rendez-vous-a-venir"),{params:r,headers:jy()});return console.log("\ud83d\udcc5 [API] Rendez-vous \xe0 venir re\xe7us:",a.data),{success:!0,data:a.data.data||[],periode:a.data.periode||"prochains_jours"}}catch(uw){return console.error("\u274c Erreur r\xe9cup\xe9ration rendez-vous \xe0 venir:",uw),{success:!1,data:[],error:uw.message}}}(t,n,10);console.log("\ud83d\udcc5 [TableauBord] R\xe9sultat API rendez-vous:",e),e.success?(console.log("\u2705 [TableauBord] ".concat(e.data.length," rendez-vous charg\xe9s:"),e.data),S(e.data)):(console.error("\u274c [TableauBord] Erreur chargement rendez-vous:",e.error),S([]))}catch(uw){console.error("\u274c [TableauBord] Erreur chargement rendez-vous \xe0 venir:",uw),S([])}finally{k(!1)}},ye=async()=>{try{P(!0),console.log("\ud83d\udd04 [TableauBord] Chargement activit\xe9s r\xe9centes pour userRole: ".concat(t,", userName: ").concat(n)),console.log("\ud83d\udd11 [TableauBord] Token pr\xe9sent: ".concat(!!localStorage.getItem("token")));const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{console.log("\ud83d\udd04 [DashboardAPI] R\xe9cup\xe9ration des activit\xe9s r\xe9centes...");const t=await fetch("".concat(wy,"/dashboard/activites-recentes?limit=").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),n=await t.json();return n.success?(console.log("\u2705 [DashboardAPI] ".concat(n.data.activites.length," activit\xe9s r\xe9centes r\xe9cup\xe9r\xe9es")),{success:!0,data:n.data.activites,lastUpdate:n.data.lastUpdate,totalFound:n.data.totalFound}):(console.error("\u274c [DashboardAPI] Erreur API activit\xe9s r\xe9centes:",n.message),{success:!1,message:n.message,data:[]})}catch(uw){return console.error("\u274c [DashboardAPI] Erreur r\xe9seau activit\xe9s r\xe9centes:",uw),{success:!1,message:"Erreur de connexion au serveur",data:[]}}}(10);console.log("\ud83d\udcdd [TableauBord] R\xe9sultat API activit\xe9s:",e),e.success&&e.data&&e.data.length>0?(console.log("\u2705 [TableauBord] ".concat(e.data.length," activit\xe9s charg\xe9es:"),e.data),A(e.data),L(e.lastUpdate||(new Date).toISOString()),"directeur"===t||"administrateur"===t?J(e.data):"conseillere"===t&&Q(e.data)):(console.warn("\u26a0\ufe0f [TableauBord] Aucune activit\xe9 r\xe9cente ou erreur API:",e.message||"Aucune donn\xe9e"),console.log("\ud83d\udcca [TableauBord] Conservation des activit\xe9s statiques pour l'affichage"),A([]))}catch(uw){console.error("\u274c [TableauBord] Erreur chargement activit\xe9s r\xe9centes:",uw),console.error("\ud83d\udd0d [TableauBord] D\xe9tails erreur:",uw.message,uw.stack),console.warn("\u26a0\ufe0f [TableauBord] Fallback: conservation des activit\xe9s statiques"),A([])}finally{P(!1)}},we=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;try{j(!0),console.log("\ud83d\udd04 Chargement consultations pour: ".concat(n,", p\xe9riode: ").concat(e));const r={};"conseillere"===t&&(r.conseillere=n);const a=new Date;let s,i;switch(e){case"jour":s=new Date(a.getFullYear(),a.getMonth(),a.getDate()),i=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1);break;case"semaine":const e=new Date(a);e.setDate(a.getDate()-a.getDay()),s=e,i=new Date(e),i.setDate(e.getDate()+7);break;case"mois":default:s=new Date(a.getFullYear(),a.getMonth(),1),i=new Date(a.getFullYear(),a.getMonth()+1,1);break;case"trimestre":const t=Math.floor(a.getMonth()/3);s=new Date(a.getFullYear(),3*t,1),i=new Date(a.getFullYear(),3*t+3,1);break;case"annee":s=new Date(a.getFullYear(),0,1),i=new Date(a.getFullYear()+1,0,1)}r.startDate=s.toISOString(),r.endDate=i.toISOString();const o=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{console.log("\ud83d\udd04 [API] R\xe9cup\xe9ration stats consultations:",e);const t=new URLSearchParams;e.conseillere&&t.append("conseillere",e.conseillere),e.startDate&&t.append("startDate",e.startDate),e.endDate&&t.append("endDate",e.endDate);const n=await Yr.get("".concat(wy,"/stats/consultations?").concat(t),{headers:jy()});return console.log("\ud83d\udcca [API] Stats consultations re\xe7ues:",n.data),{success:!0,stats:n.data.stats||[],total:n.data.total||0}}catch(uw){return console.error("\u274c Erreur r\xe9cup\xe9ration stats consultations:",uw),{success:!1,stats:[],total:0,error:uw.message}}}(r);if(o.success){console.log("\u2705 Stats consultations charg\xe9es:",o);let e=0,r=[];if("conseillere"===t){const t=o.stats.find((e=>e.conseillerName.toLowerCase().includes(n.toLowerCase())));e=t?t.totalConsultations:0}else e=o.total,r=o.stats;y({totalConsultations:e,consultationsRecentes:r,evolution:"+0%"}),W((t=>u(u({},t),{},{mesConsultations:e})))}else{console.error("\u274c Erreur chargement stats consultations:",o.error);const r=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"directeur",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mois",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{console.log("\ud83d\udd04 [API] R\xe9cup\xe9ration consultations pour:",{userRole:e,userId:t,periode:n,userName:r});const a={periode:n};"conseillere"===e&&r&&(a.conseillere=r,console.log("\ud83d\udd12 [API] Filtrage par conseill\xe8re:",r));const s=await Yr.get("".concat(wy,"/dashboard/consultations"),{params:a,headers:jy()});return console.log("\ud83d\udcc8 [API] Consultations re\xe7ues:",s.data),{success:!0,data:s.data.data||{totalConsultations:0,consultationsRecentes:[],evolution:"+0%"},periode:s.data.periode||n}}catch(uw){return console.error("\u274c Erreur r\xe9cup\xe9ration consultations:",uw),{success:!1,data:{totalConsultations:0,consultationsRecentes:[],evolution:"+0%"},error:uw.message}}}(t,null,e,n);r.success&&(y(r.data),W((e=>u(u({},e),{},{mesConsultations:r.data.totalConsultations||0}))))}}catch(uw){console.error("\u274c Erreur chargement consultations:",uw)}finally{j(!1)}},je=async e=>{try{console.log("\ud83d\udd04 [TableauBord] Chargement des statistiques GLOBALES (tous utilisateurs) pour la p\xe9riode: ".concat(e));const t=await Cy.getGlobalStatisticsWithFallback(e);console.log("\ud83d\udcca [TableauBord] Statistiques GLOBALES re\xe7ues:",t);const n=t.leadsParSource?t.leadsParSource.reduce(((e,t)=>e+t.valeur),0):0,r=t.revenusParMois?t.revenusParMois.reduce(((e,t)=>e+t.valeur),0):0,a=t.dossiersParType?t.dossiersParType.reduce(((e,t)=>e+t.valeur),0):0;console.log("\ud83c\udfaf [TableauBord] R\xe9sum\xe9 statistiques GLOBALES ".concat(e,":")),console.log("   \ud83d\udc65 Total leads (tous utilisateurs): ".concat(n)),console.log("   \ud83d\udcb0 Total revenus (tous utilisateurs): ".concat(r.toLocaleString("fr-CA",{style:"currency",currency:"CAD"}))),console.log("   \ud83d\udcc1 Total dossiers (tous utilisateurs): ".concat(a)),$({leadsParSource:t.leadsParSource||[],revenusParMois:t.revenusParMois||[],dossiersParType:t.dossiersParType||[],ventesParConseillere:t.ventesParConseillere||[]}),console.log("\u2705 [TableauBord] Graphiques mis \xe0 jour avec les donn\xe9es GLOBALES dynamiques")}catch(uw){console.error("\u274c [TableauBord] Erreur lors du chargement des statistiques globales:",uw);const n=Cy.getFallbackData(e);$({leadsParSource:n.leadsParSource||[],revenusParMois:n.revenusParMois||[],dossiersParType:n.dossiersParType||[],ventesParConseillere:n.ventesParConseillere||[]}),console.log("\u26a1 [TableauBord] Utilisation des donn\xe9es de fallback")}},Ne=async e=>{i(e),await je(e),"conseillere"===t?(be(e),we(e)):ve(e),xe(),ye()};(0,s.useEffect)((()=>{je(a),"conseillere"===t?(be(a),we(a)):ve(a),xe(),ye()}),[t,n]),(0,s.useEffect)((()=>{c.current=a;let e=!0;return(async()=>{try{var n;console.log("\ud83d\udd0d [TableauBord] R\xe9cup\xe9ration stats pour userRole:",t,"p\xe9riode:",a);const r=await Ny(a);if(!e)return;const s=null!==(n=null===r||void 0===r?void 0:r.data)&&void 0!==n?n:{};if(console.log("\ud83d\udcca [TableauBord] Donn\xe9es re\xe7ues de l'API:",s),c.current!==a)return;console.log("\u270f\ufe0f [TableauBord] Mise \xe0 jour stats pour userRole:",t),W((e=>{var n,r,a,i,o,l,c,d,h,f,p;return u(u({},e),{},{totalLeads:null!==(n=s.totalLeads)&&void 0!==n?n:0,totalClients:null!==(r=s.totalClients)&&void 0!==r?r:0,mesLeads:"conseillere"===t?null!==(a=s.totalLeads)&&void 0!==a?a:0:e.mesLeads,mesClients:"conseillere"===t?null!==(i=s.totalClients)&&void 0!==i?i:0:e.mesClients,mesDossiers:"conseillere"===t?null!==(o=s.dossiersActifs)&&void 0!==o?o:0:e.mesDossiers,mesFacturesImpayees:"conseillere"===t?null!==(l=s.facturesEnAttente)&&void 0!==l?l:0:e.mesFacturesImpayees,dossiersEnCours:null!==(c=s.dossiersActifs)&&void 0!==c?c:0,facturesEnAttente:null!==(d=s.facturesEnAttente)&&void 0!==d?d:0,montantFacturesEnAttente:null!==(h=s.montantFacturesEnAttente)&&void 0!==h?h:0,evolutionLeads:e.totalLeads?Math.round((null!==(f=s.totalLeads)&&void 0!==f?f:0-e.totalLeads)/e.totalLeads*100):0,evolutionClients:e.totalClients?Math.round((null!==(p=s.totalClients)&&void 0!==p?p:0-e.totalClients)/e.totalClients*100):0})}))}catch(Qm){console.error("Erreur r\xe9cup\xe9ration stats:",Qm)}})(),()=>{e=!1}}),[a,t]);const Se=async()=>{try{var e;console.log("\ud83d\udd04 [TableauBord] Rechargement stats pour userRole:",t,"p\xe9riode:",a);const n=await Ny(a),r=null!==(e=null===n||void 0===n?void 0:n.data)&&void 0!==e?e:{};console.log("\ud83d\udcca [TableauBord] Donn\xe9es recharg\xe9es de l'API:",r),W((e=>{var n,a,s,i,o,l,c,d,h,f,p;return u(u({},e),{},{totalLeads:null!==(n=r.totalLeads)&&void 0!==n?n:0,totalClients:null!==(a=r.totalClients)&&void 0!==a?a:0,mesLeads:"conseillere"===t?null!==(s=r.totalLeads)&&void 0!==s?s:0:e.mesLeads,mesClients:"conseillere"===t?null!==(i=r.totalClients)&&void 0!==i?i:0:e.mesClients,mesDossiers:"conseillere"===t?null!==(o=r.dossiersActifs)&&void 0!==o?o:0:e.mesDossiers,mesFacturesImpayees:"conseillere"===t?null!==(l=r.facturesEnAttente)&&void 0!==l?l:0:e.mesFacturesImpayees,dossiersEnCours:null!==(c=r.dossiersActifs)&&void 0!==c?c:0,facturesEnAttente:null!==(d=r.facturesEnAttente)&&void 0!==d?d:0,montantFacturesEnAttente:null!==(h=r.montantFacturesEnAttente)&&void 0!==h?h:0,evolutionLeads:e.totalLeads?Math.round((null!==(f=r.totalLeads)&&void 0!==f?f:0-e.totalLeads)/e.totalLeads*100):0,evolutionClients:e.totalClients?Math.round((null!==(p=r.totalClients)&&void 0!==p?p:0-e.totalClients)/e.totalClients*100):0})})),console.log("[Dashboard] Statistiques recharg\xe9es:",r)}catch(Qm){console.error("[Dashboard] Erreur rechargement stats:",Qm)}};(0,s.useEffect)((()=>{const e=mm();return e.on("leadCreated",(()=>{console.log("[Dashboard] Lead cr\xe9\xe9 - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("leadUpdated",(()=>{console.log("[Dashboard] Lead mis \xe0 jour - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("clientCreated",(()=>{console.log("[Dashboard] Client cr\xe9\xe9 - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("clientUpdated",(()=>{console.log("[Dashboard] Client mis \xe0 jour - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("dossierCreated",(()=>{console.log("[Dashboard] Dossier cr\xe9\xe9 - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("dossierUpdated",(()=>{console.log("[Dashboard] Dossier mis \xe0 jour - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("factureCreated",(()=>{console.log("[Dashboard] Facture cr\xe9\xe9e - rechargement des activit\xe9s et ventes"),ye(),"conseillere"===t?be(a):ve(a),Se()})),e.on("factureUpdated",(()=>{console.log("[Dashboard] Facture mise \xe0 jour - rechargement des activit\xe9s et ventes"),ye(),"conseillere"===t?be(a):ve(a),Se()})),e.on("rendezVousCreated",(()=>{console.log("[Dashboard] Rendez-vous cr\xe9\xe9 - rechargement des activit\xe9s"),ye(),xe()})),e.on("leadDeleted",(()=>{console.log("[Dashboard] Lead supprim\xe9 - rechargement des stats et activit\xe9s"),Se(),ye()})),e.on("clientDeleted",(()=>{console.log("[Dashboard] Client supprim\xe9 - rechargement des stats et activit\xe9s"),Se(),ye()})),()=>{e.off("leadCreated"),e.off("leadUpdated"),e.off("clientCreated"),e.off("clientUpdated"),e.off("dossierCreated"),e.off("dossierUpdated"),e.off("factureCreated"),e.off("factureUpdated"),e.off("rendezVousCreated"),e.off("leadDeleted"),e.off("clientDeleted")}}),[a]),(0,s.useEffect)((()=>{const e=setInterval((()=>{console.log("\ud83d\udd04 [Dashboard] Rafra\xeechissement automatique des activit\xe9s r\xe9centes"),ye()}),12e4);return()=>{clearInterval(e)}}),[t,n]);const Ce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;const n=Math.max(...e.map((e=>e.valeur)));return(0,$r.jsx)("div",{className:"bar-chart",children:e.map(((e,r)=>(0,$r.jsxs)("div",{className:"bar-container",children:[(0,$r.jsx)("div",{className:"bar",style:{height:"".concat(e.valeur/n*t,"px")},children:(0,$r.jsx)("span",{className:"bar-value",children:e.valeur})}),(0,$r.jsx)("div",{className:"bar-label",children:e.source||e.mois||e.type||e.conseillere})]},r)))})},ke=e=>{console.log("Navigation vers: ".concat(e)),"function"===typeof r&&r(e)},Ee=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"client";try{if(q(!0),console.log("\ud83d\udd04 [TableauBord] R\xe9cup\xe9ration des informations du ".concat(n," ").concat(e," - ").concat(t)),O(null),M(null),z(n),"lead"===n||!e&&"client"!==n){console.log("\ud83c\udfaf [TableauBord] Recherche dans les leads...");const r=await aa();if(r.success&&r.data&&r.data.leads){const n=r.data.leads.find((n=>"".concat(n.prenom," ").concat(n.nom)===t||"".concat(n.nom," ").concat(n.prenom)===t||e&&n.id===parseInt(e)));if(n)return M(n),z("lead"),D(!0),void console.log("\u2705 [TableauBord] Lead trouv\xe9:",n)}e||(console.log("\ud83d\udd04 [TableauBord] Lead non trouv\xe9, recherche dans les clients..."),n="client")}if("client"===n)if(e){const t=await Dx.getClientById(e);if(t.success&&t.data)return O(t.data),z("client"),D(!0),void console.log("\u2705 [TableauBord] Informations client r\xe9cup\xe9r\xe9es:",t.data)}else{console.warn("\u26a0\ufe0f [TableauBord] Aucun ID fourni, tentative de recherche par nom dans les clients");const e=await Dx.getAllClients();if(e.success&&e.data&&e.data.clients){const n=e.data.clients.find((e=>"".concat(e.prenom," ").concat(e.nom)===t||"".concat(e.nom," ").concat(e.prenom)===t));if(n)return O(n),z("client"),D(!0),void console.log("\u2705 [TableauBord] Client trouv\xe9 par nom:",n)}}console.warn('\u26a0\ufe0f [TableauBord] Contact "'.concat(t,'" non trouv\xe9')),alert('Contact "'.concat(t,'" non trouv\xe9'))}catch(uw){console.error("\u274c [TableauBord] Erreur r\xe9cup\xe9ration contact:",uw),alert("Erreur lors de la r\xe9cup\xe9ration des informations du contact")}finally{q(!1)}},Ae=e=>{let{icon:t,title:n,value:r,subvalue:a,evolution:s,onClick:i,className:o=""}=e;return(0,$r.jsxs)("div",{className:"stat-card ".concat(i?"clickable":""," ").concat(o),onClick:i,children:[(0,$r.jsxs)("div",{className:"stat-card-header",children:[" ",(0,$r.jsx)("div",{className:"stat-icon ".concat(t,"-icon"),children:t}),(0,$r.jsx)("div",{className:"stat-info-title",children:(0,$r.jsx)("h4",{children:n})})," "]}),(0,$r.jsxs)("div",{className:"stat-info-details",children:[" ",(0,$r.jsx)("p",{className:"stat-value",children:r}),a&&(0,$r.jsx)("p",{className:"stat-subvalue",children:a}),s&&(0,$r.jsxs)("p",{className:"stat-evolution ".concat((()=>{if("string"===typeof s){if(s.includes("+"))return"positive";if(s.includes("-"))return"negative"}return"neutral"})()),children:[s," ",(0,$r.jsx)("span",{children:(()=>{if("string"===typeof s){if(s.includes("+"))return"\u25b2";if(s.includes("-"))return"\u25bc"}return"\u25c6"})()})]})]})]})},Te=()=>(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"stats-grid",children:[(0,$r.jsxs)("div",{className:"stats-section compteurs-principaux",children:[(0,$r.jsx)("h3",{children:"Vue d'ensemble"}),(0,$r.jsxs)("div",{className:"stats-cards",children:[(0,$r.jsx)(Ae,{icon:"\ud83d\udc65",title:"Total Clients",value:V.totalClients,evolution:"".concat(V.evolutionClients>=0?"+":"").concat(V.evolutionClients,"%"),onClick:()=>ke("clients"),className:"clickable"}),(0,$r.jsx)(Ae,{icon:"\ud83d\udc64",title:"Total Leads",value:V.totalLeads,evolution:"".concat(V.evolutionLeads>=0?"+":"").concat(V.evolutionLeads,"%"),onClick:()=>ke("leads"),className:"clickable"}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcc1",title:"Dossiers Actifs",value:V.dossiersEnCours,evolution:"+".concat(V.dossiersEnCours>0?"3%":"0%"),onClick:()=>ke("dossiers"),className:"clickable"}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcb0",title:"Factures Impay\xe9es",value:V.facturesEnAttente,subvalue:me(V.montantFacturesEnAttente),evolution:"+".concat(V.facturesEnAttente>0?"15%":"0%"),onClick:()=>ke("facturation"),className:"clickable"})]})]}),(0,$r.jsxs)("div",{className:"stats-section ventes-conseilleres",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Ventes par Conseill\xe8re"}),f&&(0,$r.jsx)("span",{className:"loading-indicator",children:"\ud83d\udd04 Chargement..."})]}),(0,$r.jsxs)("div",{className:"stats-cards",children:[d.length>0?d.map(((e,t)=>(0,$r.jsx)(Ae,{icon:"\ud83d\udcb5",title:e.conseillere,value:"".concat(e.valeur.toFixed(2)," $ TTC"),subvalue:"".concat(e.nombreFactures," facture(s)"),evolution:"".concat(e.evolution>=0?"+":"").concat(e.evolution,"%"),onClick:()=>ke("facturation")},t))):V.ventesParConseillere.map(((e,t)=>(0,$r.jsx)(Ae,{icon:"\ud83d\udcb5",title:e.conseillere,value:me(e.valeur),evolution:"+7%",onClick:()=>ke("facturation")},t))),(0,$r.jsx)(Ae,{icon:"\ud83d\udcb5",title:"Total Bureau",value:d.length>0?"".concat(d.reduce(((e,t)=>e+t.valeur),0).toFixed(2)," $ TTC"):me(V.montantFacturesPaye),subvalue:d.length>0?"".concat(d.reduce(((e,t)=>e+t.nombreFactures),0)," facture(s)"):null,evolution:"+7%",onClick:()=>ke("facturation"),className:"total-bureau"})]})]})]}),(0,$r.jsxs)("div",{className:"bottom-grid",children:[(0,$r.jsxs)("div",{className:"rendez-vous-section",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Rendez-vous \xe0 Venir"}),C&&(0,$r.jsx)("span",{className:"loading-indicator",children:"\ud83d\udd04 Chargement..."})]}),(0,$r.jsxs)("div",{className:"rendez-vous-list",children:[(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Type"}),(0,$r.jsx)("th",{children:"Conseill\xe8re"})]})}),(0,$r.jsx)("tbody",{children:(N.length>0?N:Z).map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"client-link",onClick:()=>{const t=e.client_type||(e.client_id?"client":"lead"),n=e.client_id,r=e.client||e.client_nom;Ee(n,r,t)},style:{cursor:"pointer",color:"#1a73e8",textDecoration:"underline"},title:"Cliquer pour voir les informations du ".concat("lead"===e.client_type?"lead":"client"),children:U?"\ud83d\udd04 Chargement...":(0,$r.jsxs)("span",{children:["lead"===e.client_type?"\ud83c\udfaf ":"\ud83d\udc64 ",e.client||e.client_nom]})})}),(0,$r.jsx)("td",{children:e.date||e.date_rdv}),(0,$r.jsx)("td",{children:e.type||e.type_rdv}),(0,$r.jsx)("td",{children:e.conseillere||e.conseillere_nom})]},e.id)))})]}),0===N.length&&0===Z.length&&!C&&(0,$r.jsx)("div",{className:"no-data",children:(0,$r.jsx)("p",{children:"Aucun rendez-vous \xe0 venir"})})]})]}),(0,$r.jsxs)("div",{className:"activites-section",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Activit\xe9s R\xe9centes"}),T&&(0,$r.jsx)("span",{className:"loading-indicator",children:"\ud83d\udd04 Chargement..."}),_&&!T&&(0,$r.jsxs)("span",{className:"last-update",title:"Derni\xe8re mise \xe0 jour",children:["\ud83d\udd52 ",new Date(_).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),(0,$r.jsxs)("div",{className:"activites-list",children:[(E.length>0?E:K).sort(((e,t)=>new Date(t.date)-new Date(e.date))).map((e=>(0,$r.jsxs)("div",{className:"activite-item",children:[(0,$r.jsx)("div",{className:"activite-icon",children:ge(e.type)}),(0,$r.jsxs)("div",{className:"activite-content",children:[(0,$r.jsx)("p",{className:"activite-description",children:e.description}),(0,$r.jsxs)("div",{className:"activite-meta",children:[(0,$r.jsx)("span",{className:"activite-user",children:e.utilisateur}),(0,$r.jsx)("span",{className:"activite-date",children:e.date})]})]})]},e.id))),0===E.length&&0===K.length&&!T&&(0,$r.jsx)("div",{className:"no-data",children:(0,$r.jsx)("p",{children:"Aucune activit\xe9 r\xe9cente"})})]})]})]}),(0,$r.jsxs)("div",{className:"charts-grid",children:[(0,$r.jsxs)("div",{className:"chart-section",children:[(0,$r.jsx)("h3",{children:"Leads par Source"}),(0,$r.jsxs)("div",{className:"filter-buttons",children:[(0,$r.jsx)("button",{className:"jour"===a?"active":"",onClick:()=>Ne("jour"),children:"Jour"}),(0,$r.jsx)("button",{className:"semaine"===a?"active":"",onClick:()=>Ne("semaine"),children:"Semaine"}),(0,$r.jsx)("button",{className:"mois"===a?"active":"",onClick:()=>Ne("mois"),children:"Mois"}),(0,$r.jsx)("button",{className:"annee"===a?"active":"",onClick:()=>Ne("annee"),children:"Ann\xe9e"})]}),Ce(Y.leadsParSource)]}),(0,$r.jsxs)("div",{className:"chart-section",children:[(0,$r.jsx)("h3",{children:"Revenus par Mois"}),(0,$r.jsxs)("div",{className:"filter-buttons",children:[(0,$r.jsx)("button",{className:"jour"===a?"active":"",onClick:()=>Ne("jour"),children:"Jour"}),(0,$r.jsx)("button",{className:"semaine"===a?"active":"",onClick:()=>Ne("semaine"),children:"Semaine"}),(0,$r.jsx)("button",{className:"mois"===a?"active":"",onClick:()=>Ne("mois"),children:"Mois"}),(0,$r.jsx)("button",{className:"annee"===a?"active":"",onClick:()=>Ne("annee"),children:"Ann\xe9e"})]}),Ce(Y.revenusParMois)]}),(0,$r.jsxs)("div",{className:"chart-section",children:[(0,$r.jsx)("h3",{children:"Dossiers par Type"}),(0,$r.jsxs)("div",{className:"filter-buttons",children:[(0,$r.jsx)("button",{className:"jour"===a?"active":"",onClick:()=>Ne("jour"),children:"Jour"}),(0,$r.jsx)("button",{className:"semaine"===a?"active":"",onClick:()=>Ne("semaine"),children:"Semaine"}),(0,$r.jsx)("button",{className:"mois"===a?"active":"",onClick:()=>Ne("mois"),children:"Mois"}),(0,$r.jsx)("button",{className:"annee"===a?"active":"",onClick:()=>Ne("annee"),children:"Ann\xe9e"})]}),Ce(Y.dossiersParType)]})]})]});return(0,$r.jsxs)("div",{className:"tableau-bord-container",children:[(0,$r.jsxs)("div",{className:"header-container",children:[(0,$r.jsxs)("div",{className:"title-container",children:[(0,$r.jsx)("h1",{children:o})," ",(0,$r.jsx)("span",{className:"vue-globale-badge",title:"Les statistiques affichent les donn\xe9es de tous les utilisateurs",children:"\ud83c\udf0d Vue Globale"})]}),(0,$r.jsxs)("div",{className:"periode-selector",children:[(0,$r.jsx)("button",{className:"btn-periode ".concat("jour"===a?"active":""),onClick:()=>Ne("jour"),children:"Jour"}),(0,$r.jsx)("button",{className:"btn-periode ".concat("semaine"===a?"active":""),onClick:()=>Ne("semaine"),children:"Semaine"}),(0,$r.jsx)("button",{className:"btn-periode ".concat("mois"===a?"active":""),onClick:()=>Ne("mois"),children:"Mois"}),(0,$r.jsx)("button",{className:"btn-periode ".concat("trimestre"===a?"active":""),onClick:()=>Ne("trimestre"),children:"Trimestre"}),(0,$r.jsx)("button",{className:"btn-periode ".concat("annee"===a?"active":""),onClick:()=>Ne("annee"),children:"Ann\xe9e"})]})]}),"administrateur"===t&&Te(),"directeur"===t&&Te(),"conseillere"===t&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"stats-grid",children:[(0,$r.jsxs)("div",{className:"stats-section",children:[(0,$r.jsx)("h3",{children:"Mes Statistiques"}),(0,$r.jsxs)("div",{className:"stats-cards",children:[(0,$r.jsx)(Ae,{icon:"\ud83d\udc65",title:"Mes Clients",value:V.mesClients,evolution:"+5%",onClick:()=>ke("clients")}),(0,$r.jsx)(Ae,{icon:"\ud83d\udc64",title:"Mes Leads",value:V.mesLeads,evolution:"+3%",onClick:()=>ke("leads")}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcc1",title:"Mes Dossiers",value:V.mesDossiers,evolution:"+2%",onClick:()=>ke("dossiers")}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcb0",title:"Factures Impay\xe9es",value:V.mesFacturesImpayees,evolution:"+1%",onClick:()=>ke("facturation")})]})]}),(0,$r.jsxs)("div",{className:"stats-section",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Mes Ventes"}),(v||w)&&(0,$r.jsx)("span",{className:"loading-indicator",children:"\ud83d\udd04 Chargement..."})]}),(0,$r.jsxs)("div",{className:"stats-cards",children:[(0,$r.jsx)(Ae,{icon:"\ud83d\udcb0",title:"Mon Total TTC",value:"".concat(m.monTotalTTC.toFixed(2)," $"),subvalue:"".concat(m.monNombreFactures," facture(s)"),evolution:"+12%",onClick:()=>ke("facturation")}),(0,$r.jsx)(Ae,{icon:"\u2705",title:"Factures Pay\xe9es",value:m.facturesPayees||0,evolution:"+8%",onClick:()=>ke("facturation")}),(0,$r.jsx)(Ae,{icon:"\u23f3",title:"En Attente",value:m.facturesEnAttente||0,evolution:"+5%",onClick:()=>ke("facturation")}),(0,$r.jsx)(Ae,{icon:"\ud83c\udfaf",title:"Consultations",value:x.totalConsultations||0,evolution:x.evolution||"+0%",onClick:()=>ke("leads")})]})]})]}),(0,$r.jsxs)("div",{className:"bottom-grid",children:[(0,$r.jsxs)("div",{className:"rendez-vous-section",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Mes Rendez-vous \xe0 Venir"}),C&&(0,$r.jsx)("span",{className:"loading-indicator",children:"\ud83d\udd04 Chargement..."})]}),(0,$r.jsxs)("div",{className:"rendez-vous-list",children:[(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Type"})]})}),(0,$r.jsx)("tbody",{children:(N.length>0?N:te).map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"client-link",onClick:()=>{const t=e.client_type||(e.client_id?"client":"lead"),n=e.client_id,r=e.client||e.client_nom;Ee(n,r,t)},style:{cursor:"pointer",color:"#1a73e8",textDecoration:"underline"},title:"Cliquer pour voir les informations du ".concat("lead"===e.client_type?"lead":"client"),children:U?"\ud83d\udd04 Chargement...":(0,$r.jsxs)("span",{children:["lead"===e.client_type?"\ud83c\udfaf ":"\ud83d\udc64 ",e.client||e.client_nom]})})}),(0,$r.jsx)("td",{children:e.date||e.date_rdv}),(0,$r.jsx)("td",{children:e.type||e.type_rdv})]},e.id)))})]}),0===N.length&&0===te.length&&!C&&(0,$r.jsx)("div",{className:"no-data",children:(0,$r.jsx)("p",{children:"Aucun rendez-vous \xe0 venir"})})]})]}),(0,$r.jsxs)("div",{className:"activites-section",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Mes Activit\xe9s R\xe9centes"}),T&&(0,$r.jsx)("span",{className:"loading-indicator",children:"\ud83d\udd04 Chargement..."}),_&&!T&&(0,$r.jsxs)("span",{className:"last-update",title:"Derni\xe8re mise \xe0 jour",children:["\ud83d\udd52 ",new Date(_).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),(0,$r.jsxs)("div",{className:"activites-list",children:[(E.length>0?E:X).sort(((e,t)=>new Date(t.date)-new Date(e.date))).map((e=>(0,$r.jsxs)("div",{className:"activite-item",children:[(0,$r.jsx)("div",{className:"activite-icon",children:ge(e.type)}),(0,$r.jsxs)("div",{className:"activite-content",children:[(0,$r.jsx)("p",{className:"activite-description",children:e.description}),(0,$r.jsx)("div",{className:"activite-meta",children:(0,$r.jsx)("span",{className:"activite-date",children:e.date})})]})]},e.id))),0===E.length&&0===X.length&&!T&&(0,$r.jsx)("div",{className:"no-data",children:(0,$r.jsx)("p",{children:"Aucune activit\xe9 r\xe9cente"})})]})]})]}),(0,$r.jsxs)("div",{className:"factures-section",children:[(0,$r.jsxs)("div",{className:"section-header",children:[(0,$r.jsx)("h3",{children:"Mes Factures"}),(0,$r.jsxs)("div",{className:"filter-buttons",children:[(0,$r.jsx)("button",{className:"jour"===a?"active":"",onClick:()=>Ne("jour"),children:"Jour"}),(0,$r.jsx)("button",{className:"semaine"===a?"active":"",onClick:()=>Ne("semaine"),children:"Semaine"}),(0,$r.jsx)("button",{className:"mois"===a?"active":"",onClick:()=>Ne("mois"),children:"Mois"})]})]}),(0,$r.jsx)("div",{className:"factures-list",children:m.mesFactures&&m.mesFactures.length>0?(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Num\xe9ro"}),(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Montant TTC"}),(0,$r.jsx)("th",{children:"Statut"}),(0,$r.jsx)("th",{children:"Date"})]})}),(0,$r.jsx)("tbody",{children:m.mesFactures.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.numero}),(0,$r.jsx)("td",{children:e.client}),(0,$r.jsxs)("td",{children:[e.montantTTC.toFixed(2)," $"]}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge ".concat("payee"===e.statut?"statut-success":"statut-warning"),children:"payee"===e.statut?"Pay\xe9e":"En attente"})}),(0,$r.jsx)("td",{children:new Date(e.dateEmission).toLocaleDateString()})]},e.id)))})]}):(0,$r.jsxs)("div",{className:"no-data",children:[(0,$r.jsx)("p",{children:"Aucune facture pour cette p\xe9riode"}),v&&(0,$r.jsx)("p",{children:"\ud83d\udd04 Chargement en cours..."})]})})]})]}),"comptable"===t&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("div",{className:"stats-grid",children:(0,$r.jsxs)("div",{className:"stats-section",children:[(0,$r.jsx)("h3",{children:"Aper\xe7u Financier"}),(0,$r.jsxs)("div",{className:"stats-cards",children:[(0,$r.jsx)(Ae,{icon:"\ud83d\udcb5",title:"Ventes du Mois",value:me(V.totalVentes),evolution:"+12%"}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcb0",title:"Paiements R\xe9cents",value:me(V.paiementsRecents),evolution:"+8%"}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcca",title:"Factures en Attente",value:V.facturesEnAttente,subvalue:me(V.montantFacturesEnAttente),evolution:"+15%",onClick:()=>ke("facturation")}),(0,$r.jsx)(Ae,{icon:"\ud83d\udcb8",title:"Charges \xe0 Venir",value:V.chargesAVenir,subvalue:me(V.montantChargesAVenir),evolution:"+5%",onClick:()=>ke("charges")})]})]})}),(0,$r.jsxs)("div",{className:"bottom-grid",children:[(0,$r.jsxs)("div",{className:"factures-section",children:[(0,$r.jsx)("h3",{children:"Derni\xe8res Factures"}),(0,$r.jsx)("div",{className:"factures-list",children:(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"ID"}),(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Montant"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Statut"})]})}),(0,$r.jsx)("tbody",{children:oe.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.id}),(0,$r.jsx)("td",{children:e.client}),(0,$r.jsx)("td",{children:me(e.montant)}),(0,$r.jsx)("td",{children:e.date}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge ".concat("Pay\xe9e"===e.statut?"statut-success":"statut-warning"),children:e.statut})})]},e.id)))})]})})]}),(0,$r.jsxs)("div",{className:"paiements-section",children:[(0,$r.jsx)("h3",{children:"Paiements R\xe9cents"}),(0,$r.jsx)("div",{className:"paiements-list",children:(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"ID"}),(0,$r.jsx)("th",{children:"Facture"}),(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Montant"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"M\xe9thode"})]})}),(0,$r.jsx)("tbody",{children:ce.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.id}),(0,$r.jsx)("td",{children:e.facture}),(0,$r.jsx)("td",{children:e.client}),(0,$r.jsx)("td",{children:me(e.montant)}),(0,$r.jsx)("td",{children:e.date}),(0,$r.jsx)("td",{children:e.methode})]},e.id)))})]})})]})]}),(0,$r.jsxs)("div",{className:"charges-section",children:[(0,$r.jsx)("h3",{children:"Charges"}),(0,$r.jsx)("div",{className:"charges-list",children:(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"ID"}),(0,$r.jsx)("th",{children:"Description"}),(0,$r.jsx)("th",{children:"Montant"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Statut"})]})}),(0,$r.jsx)("tbody",{children:de.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.id}),(0,$r.jsx)("td",{children:e.description}),(0,$r.jsx)("td",{children:me(e.montant)}),(0,$r.jsx)("td",{children:e.date}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge ".concat("Pay\xe9e"===e.statut?"statut-success":"statut-warning"),children:e.statut})})]},e.id)))})]})})]})]}),"secretaire"===t&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("div",{className:"stats-grid",children:(0,$r.jsxs)("div",{className:"stats-section",children:[(0,$r.jsx)("h3",{children:"Aper\xe7u du Jour"}),(0,$r.jsxs)("div",{className:"stats-cards",children:[(0,$r.jsx)(Ae,{icon:"\ud83d\udcc5",title:"Rendez-vous Aujourd'hui",value:V.rendezVousJour,evolution:"+2%",onClick:()=>ke("rendez-vous")}),(0,$r.jsx)(Ae,{icon:"\ud83d\udc64",title:"Nouveaux Leads",value:V.nouveauxLeads,evolution:"+5%",onClick:()=>ke("leads")}),(0,$r.jsx)(Ae,{icon:"\ud83d\udccb",title:"Leads \xe0 Traiter",value:V.leadsATraiter,evolution:"+3%",onClick:()=>ke("leads")})]})]})}),(0,$r.jsxs)("div",{className:"bottom-grid",children:[(0,$r.jsxs)("div",{className:"rendez-vous-section",children:[(0,$r.jsx)("h3",{children:"Rendez-vous du Jour"}),(0,$r.jsx)("div",{className:"rendez-vous-list",children:(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Client"}),(0,$r.jsx)("th",{children:"Heure"}),(0,$r.jsx)("th",{children:"Type"}),(0,$r.jsx)("th",{children:"Conseill\xe8re"}),(0,$r.jsx)("th",{children:"Statut"})]})}),(0,$r.jsx)("tbody",{children:re.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.client}),(0,$r.jsx)("td",{children:e.heure}),(0,$r.jsx)("td",{children:e.type}),(0,$r.jsx)("td",{children:e.conseillere}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge ".concat("Termin\xe9"===e.statut?"statut-success":"En cours"===e.statut?"statut-info":"statut-warning"),children:e.statut})})]},e.id)))})]})})]}),(0,$r.jsxs)("div",{className:"leads-section",children:[(0,$r.jsx)("h3",{children:"Nouveaux Leads"}),(0,$r.jsx)("div",{className:"leads-list",children:(0,$r.jsxs)("table",{className:"data-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Nom"}),(0,$r.jsx)("th",{children:"Email"}),(0,$r.jsx)("th",{children:"T\xe9l\xe9phone"}),(0,$r.jsx)("th",{children:"Source"}),(0,$r.jsx)("th",{children:"Date"})]})}),(0,$r.jsx)("tbody",{children:se.map((e=>(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:e.nom}),(0,$r.jsx)("td",{children:e.email}),(0,$r.jsx)("td",{children:e.telephone}),(0,$r.jsx)("td",{children:e.source}),(0,$r.jsx)("td",{children:e.date})]},e.id)))})]})})]})]})]}),R&&(I||F)&&(0,$r.jsx)(_x,{client:"client"===B?I:null,lead:"lead"===B?F:null,modalType:B,isOpen:R,onClose:()=>{D(!1),O(null),M(null),z("client")},readOnly:!0,showAll:!0})]})};const Ey=function(e){let{userRole:t,userName:n,onPhotoUpdate:r}=e;const[a,i]=(0,s.useState)({photo:"/default-avatar.png",nom:"",prenom:"",role:"",email:"",telephone:"",bureau:"",username:"",statut:"actif"});(0,s.useEffect)((()=>{(async()=>{try{console.log("\ud83d\udd04 Chargement du profil depuis l'API...");const e=await(0,Ix.qx)();if(console.log("\ud83d\udce5 Profil re\xe7u de l'API:",e),e.success&&e.data)i((r=>u(u(u({},r),e.data),{},{role:e.data.role||t||"N/A",username:"".concat(e.data.prenom," ").concat(e.data.nom)||n||"N/A"})));else{console.log("\u26a0\ufe0f Fallback vers donn\xe9es simul\xe9es");const e={nom:n?n.split(" ").slice(1).join(" "):"N/A",prenom:n?n.split(" ")[0]:"N/A",email:"".concat(n?n.toLowerCase().replace(" ","."):"utilisateur","@example.com")};i((r=>u(u(u({},r),e),{},{role:t||"N/A",username:n||"N/A"})))}}catch(uw){console.error("\u274c Erreur lors du chargement du profil:",uw);const r={nom:n?n.split(" ").slice(1).join(" "):"N/A",prenom:n?n.split(" ")[0]:"N/A",email:"".concat(n?n.toLowerCase().replace(" ","."):"utilisateur","@example.com")};i((e=>u(u(u({},e),r),{},{role:t||"N/A",username:n||"N/A"})))}})()}),[t,n]);const[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[h,f]=(0,s.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[p,m]=(0,s.useState)(null),[g,v]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(!p)return void v(null);const e=URL.createObjectURL(p);return v(e),()=>URL.revokeObjectURL(e)}),[p]);const b=e=>{const{name:t,value:n}=e.target;"role"!==t&&i(u(u({},a),{},{[t]:n}))},x=e=>{const{name:t,value:n}=e.target;f(u(u({},h),{},{[t]:n}))},y=e=>({administrateur:"Administrateur",directeur:"Directeur",conseillere:"Conseill\xe8re",comptable:"Comptable",secretaire:"Secr\xe9taire"}[e]||e);return(0,$r.jsxs)("div",{className:"profile-container",children:[(0,$r.jsxs)("div",{className:"profile-header",children:[(0,$r.jsx)("h2",{children:"Mon Profil"}),!o&&(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>l(!0),children:"Modifier le profil"})]}),(0,$r.jsxs)("div",{className:"profile-content",children:[(0,$r.jsxs)("div",{className:"profile-photo-section",children:[(0,$r.jsxs)("div",{className:"profile-photo-container",children:[(0,$r.jsx)("img",{src:g||(w=a.photo,w&&"/default-avatar.png"!==w?w.startsWith("/uploads")?"http://localhost:5000".concat(w):w:"/default-avatar.png"),alt:"Photo de profil",className:"profile-photo"}),o&&(0,$r.jsxs)("div",{className:"photo-upload-overlay",children:[(0,$r.jsx)("label",{htmlFor:"photo-upload",className:"photo-upload-label",children:(0,$r.jsx)("span",{children:"Changer la photo"})}),(0,$r.jsx)("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:e=>{if(!e.target.files||0===e.target.files.length)return void m(null);const t=e.target.files[0];m(t)},className:"photo-upload-input"}),"/default-avatar.png"!==a.photo&&(0,$r.jsx)("button",{type:"button",onClick:async()=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer votre photo de profil ?"))try{console.log("\ud83d\udd04 Suppression de la photo de profil...");const e=localStorage.getItem("token");if(!e)return void alert("\u274c Erreur d'authentification. Veuillez vous reconnecter.");await(0,Ix.hc)(e),i((e=>u(u({},e),{},{photo:"/default-avatar.png"}))),r&&r("/default-avatar.png"),m(null),console.log("\u2705 Photo supprim\xe9e avec succ\xe8s"),alert("\u2705 Photo de profil supprim\xe9e avec succ\xe8s !")}catch(uw){console.error("\u274c Erreur lors de la suppression de la photo:",uw);let t="Erreur lors de la suppression de la photo";t=uw.message.includes("401")?"\ud83d\udd10 Session expir\xe9e. Veuillez vous reconnecter.":uw.message.includes("403")?"\ud83d\udeab Vous n'avez pas les permissions pour supprimer cette photo.":"\u274c ".concat(uw.message),alert(t)}},className:"photo-remove-btn",title:"Supprimer la photo de profil",style:{position:"absolute",top:"5px",right:"5px",background:"#dc3545",color:"white",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",zIndex:10},children:"\ud83d\uddd1\ufe0f"})]})]}),(0,$r.jsxs)("div",{className:"profile-name-role",children:[(0,$r.jsxs)("h3",{children:[a.prenom," ",a.nom]}),(0,$r.jsx)("span",{className:"profile-role",children:y(a.role)}),(0,$r.jsx)("span",{className:"profile-status status-".concat(a.statut),children:"actif"===a.statut?"Actif":"Inactif"})]})]}),o?(0,$r.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{console.log("\ud83d\udd04 Sauvegarde du profil en cours...");const e=localStorage.getItem("token");if(!e)return void alert("\u274c Erreur d'authentification. Veuillez vous reconnecter.");let o=a.photo;if(p)try{var t;console.log("\ud83d\udcf8 Upload de la nouvelle photo...",{fileName:p.name,fileSize:p.size,fileType:p.type});const n=await(0,Ix.DK)(p,e);o=n.photoUrl||(null===(t=n.data)||void 0===t?void 0:t.photoUrl),console.log("\u2705 Photo t\xe9l\xe9charg\xe9e, URL:",o),console.log("\ud83d\udccb R\xe9ponse compl\xe8te upload:",n)}catch(n){console.error("\u274c Erreur upload photo:",n),alert("\u26a0\ufe0f Erreur lors du t\xe9l\xe9chargement de la photo: ".concat(n.message,"\n\nLes autres modifications du profil seront quand m\xeame sauvegard\xe9es."))}else console.log("\u2139\ufe0f Aucune photo s\xe9lectionn\xe9e pour l'upload");const c={nom:a.nom,prenom:a.prenom,email:a.email,telephone:a.telephone,bureau:a.bureau,photo:o||a.photo};console.log("\ud83d\udcdd Donn\xe9es \xe0 sauvegarder:",c);const d=await(0,Ix.L6)(c,e);console.log("\u2705 Profil mis \xe0 jour avec succ\xe8s:",d),m(null),alert("\u2705 Profil mis \xe0 jour avec succ\xe8s !"),l(!1),console.log("\ud83d\udd04 Rechargement des donn\xe9es du profil depuis le serveur...");try{const t=await(0,Ix.qx)(e);console.log("\ud83d\udccb Donn\xe9es recharg\xe9es:",t);const n=t.data||t;i(n),r&&n.photo&&r(n.photo)}catch(s){console.error("\u274c Erreur lors du rechargement:",s),i((e=>u(u({},e),c))),r&&c.photo&&r(c.photo)}}catch(uw){console.error("\u274c Erreur lors de la sauvegarde du profil:",uw);let t="Erreur lors de la sauvegarde du profil";t=uw.message.includes("401")?"\ud83d\udd10 Session expir\xe9e. Veuillez vous reconnecter.":uw.message.includes("403")?"\ud83d\udeab Vous n'avez pas les permissions pour modifier ce profil.":uw.message.includes("400")?"\ud83d\udcdd Donn\xe9es invalides. V\xe9rifiez les informations saisies.":"\u274c ".concat(uw.message),alert(t)}},className:"profile-form",children:[(0,$r.jsxs)("div",{className:"profile-section",children:[(0,$r.jsx)("h3",{children:"Informations de base"}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pr\xe9nom:"}),(0,$r.jsx)("input",{type:"text",name:"prenom",value:a.prenom,onChange:b,readOnly:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom:"}),(0,$r.jsx)("input",{type:"text",name:"nom",value:a.nom,onChange:b,readOnly:!0})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("input",{type:"email",name:"email",value:a.email,onChange:b,required:!0,readOnly:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"R\xf4le:"}),(0,$r.jsx)("input",{type:"text",name:"role",value:y(a.role),readOnly:!0})]})]})]}),(0,$r.jsxs)("div",{className:"profile-section",children:[(0,$r.jsx)("h3",{children:"Coordonn\xe9es"}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("input",{type:"tel",name:"telephone",value:a.telephone,onChange:b})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Bureau:"}),(0,$r.jsx)("input",{type:"text",name:"bureau",value:a.bureau,onChange:b})]})]})]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>l(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Enregistrer"})]})]}):(0,$r.jsxs)("div",{className:"profile-details",children:[(0,$r.jsxs)("div",{className:"profile-section",children:[(0,$r.jsx)("h3",{children:"Informations de base"}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Pr\xe9nom:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:a.prenom})]}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Nom:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:a.nom})]}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"R\xf4le:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:y(a.role)})]})]}),(0,$r.jsxs)("div",{className:"profile-section",children:[(0,$r.jsx)("h3",{children:"Coordonn\xe9es"}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Email professionnel:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:a.email})]}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:a.telephone})]}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Bureau:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:a.bureau})]})]}),(0,$r.jsxs)("div",{className:"profile-section",children:[(0,$r.jsx)("h3",{children:"Acc\xe8s au syst\xe8me"}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Nom d'utilisateur:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:a.username})]}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Mot de passe:"}),(0,$r.jsxs)("div",{className:"profile-info-value",children:["\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",(0,$r.jsx)("button",{className:"btn-link",onClick:()=>d(!0),children:"Changer le mot de passe"})]})]}),(0,$r.jsxs)("div",{className:"profile-info-row",children:[(0,$r.jsx)("div",{className:"profile-info-label",children:"Statut:"}),(0,$r.jsx)("div",{className:"profile-info-value",children:(0,$r.jsx)("span",{className:"status-badge status-".concat(a.statut),children:"actif"===a.statut?"Actif":"Inactif"})})]})]})]})]}),c&&(0,$r.jsx)("div",{className:"modal-overlay",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsxs)("div",{className:"modal-header",children:[(0,$r.jsx)("h3",{children:"Changer le mot de passe"}),(0,$r.jsx)("button",{className:"close-btn",onClick:()=>d(!1),children:"\xd7"})]}),(0,$r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),h.newPassword===h.confirmPassword)if(h.newPassword.length<6)alert("\u274c Le nouveau mot de passe doit contenir au moins 6 caract\xe8res.");else try{console.log("\ud83d\udd04 Changement de mot de passe en cours...");const e=localStorage.getItem("token");if(!e)return void alert("\u274c Erreur d'authentification. Veuillez vous reconnecter.");await(0,Ix.ec)(h.currentPassword,h.newPassword,e),console.log("\u2705 Mot de passe chang\xe9 avec succ\xe8s"),alert("\u2705 Mot de passe chang\xe9 avec succ\xe8s !"),f({currentPassword:"",newPassword:"",confirmPassword:""}),d(!1)}catch(uw){console.error("\u274c Erreur lors du changement de mot de passe:",uw);let t="Erreur lors du changement de mot de passe";t=uw.message.includes("401")?"\ud83d\udd10 Mot de passe actuel incorrect ou session expir\xe9e.":uw.message.includes("403")?"\ud83d\udeab Vous n'avez pas les permissions pour changer ce mot de passe.":uw.message.includes("400")?"\ud83d\udcdd Donn\xe9es invalides. V\xe9rifiez les mots de passe saisis.":"\u274c ".concat(uw.message),alert(t)}else alert("\u274c Les nouveaux mots de passe ne correspondent pas.")},children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Mot de passe actuel:"}),(0,$r.jsx)("input",{type:"password",name:"currentPassword",value:h.currentPassword,onChange:x,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nouveau mot de passe:"}),(0,$r.jsx)("input",{type:"password",name:"newPassword",value:h.newPassword,onChange:x,required:!0})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Confirmer le nouveau mot de passe:"}),(0,$r.jsx)("input",{type:"password",name:"confirmPassword",value:h.confirmPassword,onChange:x,required:!0})]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>d(!1),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",children:"Changer le mot de passe"})]})]})]})})]});var w};const Ay=function(){const[e,t]=(0,s.useState)([{id:1,titre:"Permis d'\xe9tudes",description:"Proc\xe9dure pour les demandes de permis d'\xe9tudes au Canada",etapes:["Obtention de la lettre d'acceptation d'un \xe9tablissement d'enseignement d\xe9sign\xe9","Preuve de moyens financiers suffisants","V\xe9rification de l'admissibilit\xe9","Soumission de la demande en ligne","Fourniture des donn\xe9es biom\xe9triques","Attente de la d\xe9cision"],documents:["Lettre d'acceptation","Preuve de fonds","Passeport valide","Photos conformes aux normes","Formulaires remplis"],delai:"8 \xe0 12 semaines"},{id:2,titre:"R\xe9sidence permanente - Entr\xe9e express",description:"Proc\xe9dure pour les demandes de r\xe9sidence permanente via le syst\xe8me Entr\xe9e express",etapes:["Cr\xe9ation d'un profil Entr\xe9e express","Obtention d'un score SCG","R\xe9ception d'une invitation \xe0 pr\xe9senter une demande","Soumission de la demande compl\xe8te","Examen m\xe9dical","V\xe9rification des ant\xe9c\xe9dents","D\xe9cision finale"],documents:["R\xe9sultats de tests linguistiques","\xc9valuation des dipl\xf4mes","Preuve d'exp\xe9rience professionnelle","Passeport valide","Certificat de police"],delai:"6 \xe0 8 mois"},{id:3,titre:"Visa de visiteur",description:"Proc\xe9dure pour les demandes de visa de visiteur temporaire au Canada",etapes:["V\xe9rification de l'admissibilit\xe9","Rassemblement des documents requis","Soumission de la demande en ligne","Fourniture des donn\xe9es biom\xe9triques","Entrevue (si n\xe9cessaire)","D\xe9cision"],documents:["Formulaire de demande","Passeport valide","Photos conformes aux normes","Preuve de liens avec le pays d'origine","Preuve de moyens financiers","Itin\xe9raire de voyage"],delai:"3 \xe0 5 semaines"},{id:4,titre:"Permis de travail",description:"Proc\xe9dure pour les demandes de permis de travail au Canada",etapes:["Obtention d'une offre d'emploi","Obtention de l'EIMT (si n\xe9cessaire)","V\xe9rification de l'admissibilit\xe9","Soumission de la demande en ligne","Fourniture des donn\xe9es biom\xe9triques","D\xe9cision"],documents:["Offre d'emploi","EIMT ou dispense","Preuve de qualifications","Passeport valide","Photos conformes aux normes"],delai:"4 \xe0 16 semaines"}]),[n,r]=(0,s.useState)(null),[a,i]=(0,s.useState)(""),o=e.filter((e=>e.titre.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase())));return(0,$r.jsxs)("div",{className:"procedures-container",children:[(0,$r.jsx)("div",{className:"procedures-header",children:(0,$r.jsxs)("div",{className:"search-procedures",children:[(0,$r.jsx)("i",{className:"fas fa-search"}),(0,$r.jsx)("input",{type:"text",placeholder:"Rechercher une proc\xe9dure...",value:a,onChange:e=>i(e.target.value)})]})}),(0,$r.jsx)("div",{className:"procedures-list",children:o.map((e=>(0,$r.jsxs)("div",{className:"procedure-card ".concat(n===e.id?"active":""),onClick:()=>{return t=e.id,void r(n===t?null:t);var t},children:[(0,$r.jsxs)("div",{className:"procedure-header",children:[(0,$r.jsx)("h3",{children:e.titre}),(0,$r.jsx)("span",{className:"procedure-toggle",children:(0,$r.jsx)("i",{className:"fas fa-chevron-".concat(n===e.id?"up":"down")})})]}),(0,$r.jsxs)("div",{className:"procedure-summary",children:[(0,$r.jsx)("p",{children:e.description}),(0,$r.jsxs)("span",{className:"procedure-delay",children:[(0,$r.jsx)("i",{className:"fas fa-clock"})," D\xe9lai: ",e.delai]})]}),n===e.id&&(0,$r.jsxs)("div",{className:"procedure-details",children:[(0,$r.jsxs)("div",{className:"procedure-section",children:[(0,$r.jsxs)("h4",{children:[(0,$r.jsx)("i",{className:"fas fa-tasks"})," \xc9tapes"]}),(0,$r.jsx)("ol",{className:"procedure-steps",children:e.etapes.map(((e,t)=>(0,$r.jsx)("li",{children:e},t)))})]}),(0,$r.jsxs)("div",{className:"procedure-section",children:[(0,$r.jsxs)("h4",{children:[(0,$r.jsx)("i",{className:"fas fa-file-alt"})," Documents requis"]}),(0,$r.jsx)("ul",{className:"procedure-documents",children:e.documents.map(((e,t)=>(0,$r.jsx)("li",{children:e},t)))})]}),(0,$r.jsxs)("div",{className:"procedure-actions",children:[(0,$r.jsxs)("button",{className:"btn btn-primary",children:[(0,$r.jsx)("i",{className:"fas fa-download"})," T\xe9l\xe9charger la proc\xe9dure"]}),(0,$r.jsxs)("button",{className:"btn btn-secondary",children:[(0,$r.jsx)("i",{className:"fas fa-print"})," Imprimer"]})]})]})]},e.id)))})]})};const Ty=function(){const e=me(),{id:t}=ge(),[n,r]=(0,s.useState)(!1),[a,i]=(0,s.useState)({}),[o,l]=(0,s.useState)("informations"),[c,d]=(0,s.useState)(!0),[h,f]=(0,s.useState)(!1),[p,m]=(0,s.useState)(!0),[g,v]=(0,s.useState)(!1),[b,x]=(0,s.useState)(!1),[y,w]=(0,s.useState)(null),[j,N]=(0,s.useState)({nom:"",prenom:"",dateNaissance:"",email:"",telephone:"",adresse:"",nationalite:"",contactNom:"",contactPrenom:"",contactRelation:"",contactTelephone:"",contactEmail:"",loginClient:"",motDePasseClient:"",conseillere:"",urgent:!1,statut:"En attente",typeProcedure:"",informationsSpecifiques:{},documents:[],notes:[]}),S=()=>{y&&(clearTimeout(y),w(null)),x(!0)},C=()=>{const e=setTimeout((()=>{x(!1)}),100);w(e)},k=e=>{e.preventDefault(),e.stopPropagation(),y&&(clearTimeout(y),w(null)),x(!b)};(0,s.useEffect)((()=>()=>{y&&clearTimeout(y)}),[y]),(0,s.useEffect)((()=>{const e=e=>{b&&!e.target.closest(".financial-tooltip-container")&&(x(!1),y&&(clearTimeout(y),w(null)))};return b&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[b,y]);const E=()=>{const e=j.informationsSpecifiques||{},t=j.typeProcedure;let n=[];if("Visa visiteur"===t){const t=e.emploiTypes||[];t.includes("Salari\xe9")&&n.push({title:"Salari\xe9 :",items:["Attestation de travail","Attestation de salaire","Attestation de cong\xe9","Bulletins de paie","Autres preuves de revenus (ex : contrat de bail)"]}),(t.includes("Entrepreneur")||t.includes("Investisseur"))&&n.push({title:"Entrepreneur / Investisseur :",items:["Registre de commerce","Statuts","Justificatif de paiement des imp\xf4ts","Contrat de bail ou autres preuves de revenus"]}),t.includes("Retrait\xe9")&&n.push({title:"Retrait\xe9 :",items:["Attestation de retraite","Contrat de bail ou autres preuves de revenus"]}),0===t.length&&(n=[{title:"Salari\xe9 :",items:["Attestation de travail","Attestation de salaire","Attestation de cong\xe9","Bulletins de paie","Autres preuves de revenus (ex : contrat de bail)"]},{title:"Entrepreneur / Investisseur :",items:["Registre de commerce","Statuts","Justificatif de paiement des imp\xf4ts","Contrat de bail ou autres preuves de revenus"]},{title:"Retrait\xe9 :",items:["Attestation de retraite","Contrat de bail ou autres preuves de revenus"]}])}if("Permis de travail"===t){const t=e.emploiActuelTypes||[];t.includes("Salari\xe9")&&n.push({title:"Salari\xe9 :",items:["Bulletins de paie","Attestation de travail","Relev\xe9s bancaires","Contrat de travail actuel"]}),t.includes("Entrepreneur")&&n.push({title:"Entrepreneur :",items:["Registre de commerce","Statuts","Justificatifs imp\xf4ts","Contrat de location","Relev\xe9s bancaires"]}),t.includes("Retrait\xe9")&&n.push({title:"Retrait\xe9 :",items:["Attestation de retraite","Preuves de revenus","Relev\xe9s bancaires"]}),0===t.length&&(n=[{title:"Salari\xe9 :",items:["Bulletins de paie","Attestation de travail","Relev\xe9s bancaires","Contrat de travail actuel"]},{title:"Entrepreneur :",items:["Registre de commerce","Statuts","Justificatifs imp\xf4ts","Contrat de location","Relev\xe9s bancaires"]},{title:"Retrait\xe9 :",items:["Attestation de retraite","Preuves de revenus","Relev\xe9s bancaires"]}])}if("Permis d'\xe9tudes"===t){const t=e.garants||[];t.length>0?t.forEach(((e,t)=>{const r=e.relation||"Garant";n.push({title:"".concat(r," :"),items:["Relev\xe9s bancaires (6 derniers mois)","Attestation de revenus","Certificat de travail ou d'affaires","Justificatifs de propri\xe9t\xe9s","D\xe9claration d'imp\xf4ts","Lettre de garantie financi\xe8re"]})})):n=[{title:"Documents financiers requis :",items:["Relev\xe9s bancaires du garant","Attestation de revenus du garant","Certificat de travail du garant","Justificatifs de fonds pour \xe9tudes","Lettre de garantie financi\xe8re","Preuve de fonds de subsistance"]}]}return"Investisseur"===t&&(n=[{title:"Documents financiers requis :",items:["Registre de commerce","Statuts","D\xe9clarations fiscales","Bilans financiers","Justificatifs d'origine des fonds (contrats de cession, ventes, h\xe9ritage, etc.)"]}]),0===n.length&&(n=[{title:"Documents financiers requis :",items:["Relev\xe9s bancaires","Attestations de revenus","Preuves de fonds disponibles"]}]),n};(0,s.useEffect)((()=>{(async()=>{d(!0);try{await new Promise((e=>setTimeout(e,500)));const e={id:t,numeroDossier:"CL-2025-".concat(t),nom:"Dupont",prenom:"Jean",dateNaissance:"1985-05-15",email:"jean.dupont@example.com",telephone:"+1 514-555-1234",adresse:"123 Rue Principale, Montr\xe9al, QC",nationalite:"Fran\xe7aise",contactNom:"Dupont",contactPrenom:"Marie",contactRelation:"\xc9pouse",contactTelephone:"+1 514-555-5678",contactEmail:"marie.dupont@example.com",loginClient:"jdupont",motDePasseClient:"********",conseillere:"Marie Tremblay",urgent:!1,statut:"En cours",typeProcedure:"Visa Visiteur",informationsSpecifiques:{fondsDisponibles:15e3,situationFamiliale:"Mari\xe9(e)",nombrePersonnesDemande:2,dateVoyage:"2025-08-15",emploi:"Salari\xe9",invitation:"non"},documents:[{id:"doc1",nom:"Copie de CIN",statut:"fourni",dateUpload:"2025-04-15",description:"Carte d'identit\xe9 valide"},{id:"doc2",nom:"Copie du passeport",statut:"fourni",dateUpload:"2025-04-15",description:"Passeport valide jusqu'en 2030"},{id:"doc3",nom:"Photo d'identit\xe9",statut:"fourni",dateUpload:"2025-04-15",description:"Photo r\xe9cente"}],notes:[{id:"note1",date:"2025-04-15",contenu:"Premi\xe8re consultation effectu\xe9e. Client tr\xe8s motiv\xe9.",auteur:"Marie Tremblay"},{id:"note2",date:"2025-04-20",contenu:"Documents re\xe7us et v\xe9rifi\xe9s.",auteur:"Marie Tremblay"}],dateCreation:"2025-04-15"};N(e)}catch(uw){console.error("Erreur lors du chargement des donn\xe9es du client:",uw),alert("Erreur lors du chargement des donn\xe9es du client. Veuillez r\xe9essayer."),e("/clients")}finally{d(!1)}})()}),[t,e]);const[A,T]=(0,s.useState)({type:"",description:"",fichier:null}),[P,_]=(0,s.useState)(""),[L,R]=(0,s.useState)([]),[D,I]=(0,s.useState)(!0);(0,s.useEffect)((()=>{(async()=>{try{I(!0),console.log("\ud83d\udd04 Chargement des conseillers dans ClientEdit...");const e=await Zr();if(e.success&&e.data){const t=e.data.map((e=>({id:e.id,nom:e.nomComplet})));R(t),console.log("\u2705 Conseillers charg\xe9s dans ClientEdit:",t)}else{const t=e.data.map((e=>({id:e.id||Math.random(),nom:e.nomComplet})));R(t)}}catch(uw){console.error("\u274c Erreur lors du chargement des conseillers dans ClientEdit:",uw),R([{id:1,nom:"wafaa chaouby"},{id:2,nom:"hame amni"},{id:3,nom:"sanaa sami"}])}finally{I(!1)}})()}),[]),(0,s.useEffect)((()=>{if(!D&&L.length>0&&j&&!j.conseillere&&!c){const e=localStorage.getItem("userName");if(console.log("\ud83d\udc64 Utilisateur connect\xe9 r\xe9cup\xe9r\xe9 (ClientEdit):",e),console.log("\ud83d\udccb Liste des conseillers disponibles (ClientEdit):",L),e){const t=L.find((t=>t.nom.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.nom.toLowerCase())));t?(console.log("\u2705 Pr\xe9remplissage du champ conseill\xe8re (ClientEdit) avec:",t.nom),N((e=>u(u({},e),{},{conseillere:t.nom})))):console.log("\u26a0\ufe0f Utilisateur connect\xe9 non trouv\xe9 dans la liste des conseillers (ClientEdit):",{userName:e,conseilleres:L.map((e=>e.nom)),recherchePartielle:L.filter((t=>t.nom.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.nom.toLowerCase())))})}else console.log("\u26a0\ufe0f Aucun utilisateur connect\xe9 trouv\xe9 dans localStorage (ClientEdit)")}}),[D,L,j,c]);const O=e=>Array.isArray(e)?e:Object.values(e).flat(),F=e=>{const t={"Documents d'identit\xe9":["Copie de CIN","Copie du passeport","Photo d'identit\xe9"]};switch(e){case"Visa visiteur":return(()=>{const e=j.informationsSpecifiques||{},t=e.situationFamiliale||"",n=parseInt(e.nombrePersonnes)||1,r=e.invitationCanada||"",a=(e.emploiTypes,{}),s=["Copie de CIN","Copie du passeport et des visas","Photo d'identit\xe9"];if("Oui"===r&&(s.push("Invitation"),s.push("Statut de l'invitant")),s.push("Dossier financier"),s.push("Dossier emploi"),n>1||t&&"C\xe9libataire"!==t){if(a["Repr\xe9sentant de la famille"]=s,n>1)for(let i=2;i<=n;i++){const e=[...s];i<=3&&(e.push("Prise en charge"),e.push("Attestation de scolarit\xe9")),a["Membre ".concat(i," de la famille")]=e}}else a["Documents requis"]=s;return a})();case"Permis de travail":return(()=>{const e=j.informationsSpecifiques||{},t=e.situationFamilialePermis||"",n=parseInt(e.nombrePersonnesPermis)||1,r=e.offreEmploiCanada||"",a=(e.emploiActuelTypes,{}),s=["Copie de la CIN","Copie du passeport et visas ant\xe9rieurs","Photo d'identit\xe9"];if(s.push("Dossier financier"),s.push("Dossier emploi"),"Oui"===r&&s.push("Contrat de travail"),s.push("Certificat de police (si requis)"),s.push("R\xe9sultats d'examen m\xe9dical (si requis)"),n>1||t&&"C\xe9libataire"!==t){if(a["Demandeur principal"]=s,n>1)for(let i=2;i<=n;i++){const e=["Preuve de lien","Passeport","CIN","Photo","Prise en charge"];a["Membre ".concat(i," de la famille")]=e}}else a["Documents requis"]=s;return a})();case"Permis d'\xe9tudes":return(()=>{const e=j.informationsSpecifiques||{},t=e.situationFamilialeEtudes||"",n=parseInt(e.nombrePersonnesEtudes)||1,r=e.provinceViseeEtudes||"",a={},s=["Copie de CIN","Copie du passeport et visas ant\xe9rieurs","Photo d'identit\xe9","Dossier financier","Dipl\xf4mes","Lettre d'admission de l'\xe9tablissement d'enseignement d\xe9sign\xe9 (EED)","Lettre d'acceptation de l'\xe9tablissement d'enseignement","Certificat de police"];if(r&&r.toLowerCase().includes("qu\xe9bec")?s.push("Certificat d'acceptation du Qu\xe9bec (CAQ)"):r&&s.push("Lettre d'attestation provinciale (LAP) ou lettre d'acceptation territoriale (LAT) (si applicable)"),s.push("Lettres de recommandation (si applicable)"),s.push("Plan d'\xe9tudes (si applicable)"),n>1||t&&"C\xe9libataire"!==t){if(a["Demandeur principal"]=s,n>1)for(let i=2;i<=n;i++){const e=["Preuve de lien","Passeport","CIN","Photo","Prise en charge"];a["Membre ".concat(i," de la famille")]=e}}else a["Documents requis"]=s;return a})();case"Investisseur":return(()=>{const e=j.informationsSpecifiques||{},t=e.situationFamilialeInvestisseur||"",n=parseInt(e.nombrePersonnesInvestisseur)||1,r={},a=["Copie de la CIN","Copie du passeport + visas ant\xe9rieurs","Photo d'identit\xe9","Dossier financier","Relev\xe9s bancaires","Preuves de propri\xe9t\xe9 d'actifs","D\xe9clarations fiscales","Preuves de l'origine des fonds"],s=["Registre de commerce","Statuts","Preuves de paiement des imp\xf4ts","Bilans financiers"],i=[];if("Oui"===(e.planAffairesCanada||"")&&i.push("Plan d'affaires pour le Canada"),i.push("Certificat de police (si requis)"),i.push("R\xe9sultats d'examen m\xe9dical (si requis)"),n>1||t&&"C\xe9libataire"!==t){if(r["Demandeur principal - Documents personnels"]=a,r["Demandeur principal - Documents d'entreprise"]=s,r["Demandeur principal - Documents conditionnels"]=i,n>1)for(let o=2;o<=n;o++){const e=["Preuve de lien","Passeport","CIN","Photo","Prise en charge","Document de prise en charge (pour enfants)"];r["Membre ".concat(o," de la famille")]=e}}else{const e=[...a,...s,...i];r["Documents requis"]=e}return r})();case"Regroupement familial":return(()=>{const e=j.informationsSpecifiques||{},t=e.lienParenteRepondant||"",n=parseInt(e.nombrePersonnesRegroupement)||1,r={},a=[];if("Conjoint(e)"===t?a.push("Acte de mariage"):"Enfant"===t||"Parent"===t?a.push("Acte de naissance"):t.includes("partenaire")?a.push("Preuve de relation durable"):a.push("Documents prouvant le lien familial"),r["Demandeur principal"]=["Copie de la CIN","Copie du passeport et visas ant\xe9rieurs","Photo d'identit\xe9","Certificat de police","R\xe9sultats d'examen m\xe9dical (si requis)",...a],r["R\xe9pondant au Canada"]=["Preuve de statut au Canada (carte de r\xe9sidence ou citoyennet\xe9)","Preuve de revenus","Engagement de parrainage sign\xe9"],n>1)for(let s=2;s<=n;s++){const e=["CIN","Passeport","Photo","Lien familial","Certificat m\xe9dical (si requis)","Prise en charge (si enfants \xe0 charge)"];r["Membre ".concat(s," de la famille")]=e}return r})();case"R\xe9sidence permanente":return(()=>{const e=j.informationsSpecifiques||{},t=parseInt(e.nombrePersonnesRP)||1,n=e.familleCanadaRP||"",r=e.diplomesObtenusRP||[],a=e.experiencesProfessionnellesRP||[],s=e.competencesLinguistiquesRP||[],i=e.programmesRP||[],o=(e.provinceViseeRP,{"Demandeur principal":["Copie de la CIN","Formulaire d'information client interne sign\xe9","Formulaire d'informations sur la famille sign\xe9","Copie du passeport et des visas ant\xe9rieurs","Photo d'identit\xe9","Certificat de police","Dossier financier"],"Dipl\xf4mes et \xe9ducation":["\xc9valuation des dipl\xf4mes \xe9trangers (ECA)"],"Exp\xe9rience professionnelle":[],"Tests linguistiques":[],"Documents conditionnels":[],"Membres de la famille":[]});return r.forEach(((e,t)=>{e.nom&&(o["Dipl\xf4mes et \xe9ducation"].push("Dipl\xf4me: ".concat(e.nom)),o["Dipl\xf4mes et \xe9ducation"].push("Relev\xe9 de notes: ".concat(e.nom)))})),a.forEach(((e,t)=>{e.entreprise&&(o["Exp\xe9rience professionnelle"].push("Lettre d'exp\xe9rience: ".concat(e.entreprise)),o["Exp\xe9rience professionnelle"].push("Certificat de travail: ".concat(e.entreprise)))})),s.forEach(((e,t)=>{e.typeTest&&e.langue&&o["Tests linguistiques"].push("R\xe9sultat ".concat(e.typeTest," ").concat(e.langue))})),"Oui"===n&&o["Documents conditionnels"].push("Document du membre au Canada"),(i.includes("Entr\xe9e Express")||i.includes("Programme des candidats des provinces (PCP)"))&&o["Documents conditionnels"].push("R\xe9sultats d'examen m\xe9dical (si requis)"),t>1&&(o["Membres de la famille"]=["CIN des membres de la famille","Passeport des membres de la famille","Photo des membres de la famille","Relev\xe9s et dipl\xf4mes des membres de la famille","Examens m\xe9dicaux des membres de la famille"],o["Membres de la famille"].push("Document de prise en charge pour enfants \xe0 charge")),O(o)})();default:return t}},M=e=>{const{name:t,value:n,type:r,checked:s}=e.target;N((e=>u(u({},e),{},{[t]:"checkbox"===r?s:n}))),a[t]&&i((e=>u(u({},e),{},{[t]:null})))},B=(e,t)=>{N((n=>u(u({},n),{},{informationsSpecifiques:u(u({},n.informationsSpecifiques),{},{[e]:t})})))},z=(e,t)=>{if(t){if(t.size>10485760)return void alert("Le fichier est trop volumineux. Taille maximum: 10MB");if(!["application/pdf","image/jpeg","image/png","image/jpg","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type))return void alert("Type de fichier non autoris\xe9. Formats accept\xe9s: PDF, JPG, PNG, DOC, DOCX");const n={id:Date.now(),nom:e,fichier:t.name,type:e,statut:"fourni",dateUpload:(new Date).toISOString(),taille:t.size};N((t=>u(u({},t),{},{documents:[...t.documents.filter((t=>t.nom!==e)),n]}))),console.log("Document t\xe9l\xe9vers\xe9:",n),alert('Document "'.concat(e,'" t\xe9l\xe9vers\xe9 avec succ\xe8s !'))}};return c?(0,$r.jsxs)("div",{className:"loading-container",children:[(0,$r.jsx)("div",{className:"loading-spinner"}),(0,$r.jsx)("p",{children:"Chargement des donn\xe9es du client..."})]}):(0,$r.jsxs)("div",{className:"client-form-container",children:[(0,$r.jsxs)("div",{className:"form-header",children:[(0,$r.jsx)("h2",{children:"Modifier le client"}),(0,$r.jsxs)("div",{className:"client-info",children:[(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Num\xe9ro de dossier:"})," ",j.numeroDossier]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Date de cr\xe9ation:"})," ",j.dateCreation]})]})]}),(0,$r.jsxs)("div",{className:"form-tabs",children:[(0,$r.jsx)("button",{className:"informations"===o?"active":"",onClick:()=>l("informations"),children:"Informations g\xe9n\xe9rales"}),(0,$r.jsx)("button",{className:"procedure"===o?"active":"",onClick:()=>l("procedure"),children:"Proc\xe9dure"}),(0,$r.jsx)("button",{className:"documents"===o?"active":"",onClick:()=>l("documents"),children:"Documents"}),(0,$r.jsx)("button",{className:"notes"===o?"active":"",onClick:()=>l("notes"),children:"Notes"})]}),(0,$r.jsxs)("form",{onSubmit:async n=>{n.preventDefault();try{if(!j.nom||!j.prenom||!j.email||!j.telephone)return void alert("Veuillez remplir tous les champs obligatoires (nom, pr\xe9nom, email, t\xe9l\xe9phone)");f(!0);const n=u(u({},j),{},{type_procedure:j.typeProcedure,date_naissance:j.dateNaissance,contact_nom:j.contactNom,contact_prenom:j.contactPrenom,contact_relation:j.contactRelation,contact_telephone:j.contactTelephone,contact_email:j.contactEmail,login_client:j.loginClient,mot_de_passe_client:j.motDePasseClient,urgence:j.urgent,informations_specifiques:JSON.stringify(j.informationsSpecifiques||{}),date_modification:(new Date).toISOString()});console.log("Donn\xe9es du client \xe0 envoyer:",n),console.log("Informations sp\xe9cifiques:",j.informationsSpecifiques),console.log("Type de proc\xe9dure:",j.typeProcedure);const r=()=>{const e=localStorage.getItem("token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t};let a;if(p?(console.log("Envoi de la mise \xe0 jour du client:",n),a=await fetch("http://localhost:5000/api/clients/".concat(t),{method:"PUT",headers:r(),body:JSON.stringify(n)})):(console.log("Envoi de la cr\xe9ation du client:",n),a=await fetch("http://localhost:5000/api/clients",{method:"POST",headers:r(),body:JSON.stringify(u(u({},n),{},{date_creation:(new Date).toISOString(),numero_dossier:"DOS-".concat(Date.now())}))})),console.log("R\xe9ponse du serveur:",a.status,a.statusText),a.ok){const t=await a.json();console.log("R\xe9ponse r\xe9ussie du serveur:",t),alert(p?"Client modifi\xe9 avec succ\xe8s !":"Client cr\xe9\xe9 avec succ\xe8s !"),e?e("/clients"):window.location.href="/clients"}else{const e=await a.json();console.error("Erreur du serveur:",e),console.error("Status:",a.status),console.error("Donn\xe9es envoy\xe9es:",n),alert("Erreur: ".concat(e.message||"Une erreur est survenue"))}}catch(uw){console.error("Erreur lors de la sauvegarde:",uw),alert("Erreur lors de la sauvegarde du client")}finally{f(!1)}},children:["informations"===o&&(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Informations personnelles"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Nom:"}),(0,$r.jsx)("input",{type:"text",name:"nom",value:j.nom,onChange:M}),a.nom&&(0,$r.jsx)("div",{className:"error-message",children:a.nom})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Pr\xe9nom:"}),(0,$r.jsx)("input",{type:"text",name:"prenom",value:j.prenom,onChange:M}),a.prenom&&(0,$r.jsx)("div",{className:"error-message",children:a.prenom})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de naissance:"}),(0,$r.jsx)("input",{type:"date",name:"dateNaissance",value:j.dateNaissance,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Email:"}),(0,$r.jsx)("input",{type:"email",name:"email",value:j.email,onChange:M}),a.email&&(0,$r.jsx)("div",{className:"error-message",children:a.email})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("input",{type:"tel",name:"telephone",value:j.telephone,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Adresse:"}),(0,$r.jsx)("input",{type:"text",name:"adresse",value:j.adresse,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nationalit\xe9:"}),(0,$r.jsx)("input",{type:"text",name:"nationalite",value:j.nationalite,onChange:M})]})]}),(0,$r.jsx)("h3",{children:"Contact d'urgence"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom:"}),(0,$r.jsx)("input",{type:"text",name:"contactNom",value:j.contactNom,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pr\xe9nom:"}),(0,$r.jsx)("input",{type:"text",name:"contactPrenom",value:j.contactPrenom,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Relation:"}),(0,$r.jsx)("input",{type:"text",name:"contactRelation",value:j.contactRelation,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("input",{type:"tel",name:"contactTelephone",value:j.contactTelephone,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("input",{type:"email",name:"contactEmail",value:j.contactEmail,onChange:M})]})]}),(0,$r.jsx)("h3",{children:"Informations de compte"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Login client:"}),(0,$r.jsx)("input",{type:"text",name:"loginClient",value:j.loginClient,onChange:M})]}),(0,$r.jsxs)("div",{className:"form-group password-group",children:[(0,$r.jsx)("label",{children:"Mot de passe client:"}),(0,$r.jsxs)("div",{className:"password-input-container",children:[(0,$r.jsx)("input",{type:g?"text":"password",name:"motDePasseClient",value:j.motDePasseClient,onChange:M}),(0,$r.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>{v(!g)},title:g?"Masquer le mot de passe":"Afficher le mot de passe",children:g?(0,$r.jsx)("i",{className:"fas fa-eye-slash"}):(0,$r.jsx)("i",{className:"fas fa-eye"})})]})]})]}),(0,$r.jsx)("h3",{children:"Gestion interne"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{children:["Conseill\xe8re assign\xe9e",D&&(0,$r.jsx)("span",{style:{fontSize:"12px",color:"#666",marginLeft:"8px"},children:"(Chargement...)"})]}),(0,$r.jsxs)("select",{name:"conseillere",value:j.conseillere,onChange:M,disabled:D,style:D?{backgroundColor:"#f5f5f5",cursor:"wait"}:{},children:[(0,$r.jsx)("option",{value:"",children:D?"Chargement...":"S\xe9lectionner..."}),L.map((e=>(0,$r.jsx)("option",{value:e.nom,children:e.nom},e.id)))]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsxs)("select",{name:"statut",value:j.statut,onChange:M,children:[(0,$r.jsx)("option",{value:"En attente",children:"En attente"}),(0,$r.jsx)("option",{value:"En cours",children:"En cours"}),(0,$r.jsx)("option",{value:"Compl\xe9t\xe9",children:"Compl\xe9t\xe9"}),(0,$r.jsx)("option",{value:"Annul\xe9",children:"Annul\xe9"})]})]}),(0,$r.jsx)("div",{className:"form-group checkbox-group",children:(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",name:"urgent",checked:j.urgent,onChange:M}),"Dossier urgent"]})})]})]}),"procedure"===o&&(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Informations de proc\xe9dure"}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Type de proc\xe9dure:"}),(0,$r.jsxs)("select",{name:"typeProcedure",value:j.typeProcedure,onChange:e=>{const{value:t}=e.target;N((e=>u(u({},e),{},{typeProcedure:t,informationsSpecifiques:{}})))},children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),["Visa Visiteur","Permis de travail","Permis d'\xe9tudes","Investisseur","Regroupement familial","R\xe9sidence permanente"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]}),a.typeProcedure&&(0,$r.jsx)("div",{className:"error-message",children:a.typeProcedure})]}),j.typeProcedure&&(()=>{const e=j.typeProcedure;if(!e)return null;const t=j.informationsSpecifiques||{},n=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=t[e]||"";return"select"===r&&a?(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{htmlFor:e,children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsxs)("select",{id:e,name:"informationsSpecifiques.".concat(e),value:i,onChange:t=>B(e,t.target.value),className:"form-control",required:s,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),a.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]},e):"textarea"===r?(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{htmlFor:e,children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsx)("textarea",{id:e,name:"informationsSpecifiques.".concat(e),value:i,onChange:t=>B(e,t.target.value),className:"form-control",rows:"3",required:s})]},e):"checkbox-group"===r?(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsx)("div",{className:"checkbox-group",children:a.map((t=>(0,$r.jsxs)("label",{className:"checkbox-label",children:[(0,$r.jsx)("input",{type:"checkbox",name:"informationsSpecifiques.".concat(e),value:t,checked:!!Array.isArray(i)&&i.includes(t),onChange:n=>{const r=Array.isArray(i)?i:[];n.target.checked?B(e,[...r,t]):B(e,r.filter((e=>e!==t)))}}),t]},t)))})]},e):(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{htmlFor:e,children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsx)("input",{type:r,id:e,name:"informationsSpecifiques.".concat(e),value:i,onChange:t=>B(e,t.target.value),className:"form-control",required:s})]},e)};switch(e){case"Visa visiteur":const e=t.situationFamiliale||"",r=t.invitationCanada||"",a=t.voyageEtranger||"",s=t.visaRefus||"",i=(t.emploiTypes||[]).includes("Autre");return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udccb Informations sp\xe9cifiques - Visa visiteur"}),(0,$r.jsxs)("div",{className:"form-row",children:[n("fondsDisponibles","Fonds disponibles en compte (CAD)","number",null,!0),n("situationFamiliale","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"],!0)]}),(0,$r.jsxs)("div",{className:"form-row",children:[n("nombrePersonnes","Nombre de personnes dans la demande","number"),n("dateVoyage","Date pr\xe9vue du voyage","date")]}),(0,$r.jsx)("div",{className:"form-row",children:n("emploiTypes","Emploi","checkbox-group",["Salari\xe9","Entrepreneur","Retrait\xe9","Autre"])}),i&&(0,$r.jsx)("div",{className:"form-row",children:n("autreEmploiPrecision","Pr\xe9cisez le type d'emploi","text")}),(0,$r.jsx)("div",{className:"form-row",children:n("invitationCanada","Invitation du Canada","select",["Oui","Non"])}),"Oui"===r&&(0,$r.jsx)("div",{className:"form-row",children:n("lienParenteInvitant","Lien de parent\xe9 avec l'invitant","text")}),e&&"C\xe9libataire"!==e&&(0,$r.jsx)("div",{className:"form-row",children:n("representantFamille","Qui sera le repr\xe9sentant de la famille ?","text")}),(0,$r.jsx)("div",{className:"form-row",children:n("voyageEtranger","Avez-vous d\xe9j\xe0 voyag\xe9 \xe0 l'\xe9tranger ?","select",["Oui","Non"])}),"Oui"===a&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVoyages","Pays, dates, dur\xe9es","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("visaRefus","Avez-vous d\xe9j\xe0 eu un visa ou un refus (Canada ou autre pays) ?","select",["Oui","Non"])}),"Oui"===s&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVisaRefus","Pays, type de visa, dates, accept\xe9/refus\xe9","textarea")})]});case"Permis d'\xe9tudes":t.situationFamilialeEtudes;const o=t.nombrePersonnesEtudes||"",l=(t.niveauEtudesActuel||[]).includes("Autre"),c=t.testsLanguePassesEtudes||"",d="Autre"===(t.programmeEtudesSouhaite||""),h=t.voyageEtrangerEtudes||"",f=t.visaAnterieursEtudes||"",p=t.refusVisaEtudes||"";return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udcda Informations sp\xe9cifiques - Permis d'\xe9tudes"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[n("situationFamilialeEtudes","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),n("nombrePersonnesEtudes","Nombre de personnes dans la demande","number")]}),parseInt(o)>1&&(0,$r.jsx)("div",{className:"form-row",children:n("representantFamilleEtudes","Qui sera le repr\xe9sentant ?","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations acad\xe9miques"})}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Dipl\xf4mes d\xe9j\xe0 obtenus :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.diplomesObtenusEtudes||[]).map(((e,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Dipl\xf4me :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>{const r=[...t.diplomesObtenusEtudes||[]];r[n]=u(u({},r[n]),{},{nom:e.target.value}),B("diplomesObtenusEtudes",r)},className:"form-control",placeholder:"Ex: Baccalaur\xe9at scientifique"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"\xc9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.etablissement||"",onChange:e=>{const r=[...t.diplomesObtenusEtudes||[]];r[n]=u(u({},r[n]),{},{etablissement:e.target.value}),B("diplomesObtenusEtudes",r)},className:"form-control",placeholder:"Ex: Lyc\xe9e Mohammed V"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.diplomesObtenusEtudes||[]).filter(((e,t)=>t!==n));B("diplomesObtenusEtudes",e)},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.diplomesObtenusEtudes||[],{nom:"",etablissement:""}];B("diplomesObtenusEtudes",e)},children:"Ajouter un dipl\xf4me"})]})]}),(0,$r.jsx)("div",{className:"form-row",children:n("niveauEtudesActuel","Niveau d'\xe9tudes actuel","checkbox-group",["Niveau bac","Bac","Bac+2","Bac+3","Master","Doctorat","Autre"])}),l&&(0,$r.jsx)("div",{className:"form-row",children:n("autreNiveauEtudesPrecision","Pr\xe9cisez le niveau d'\xe9tudes","text")}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"\xc9tablissements fr\xe9quent\xe9s :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.etablissementsFrequentes||[]).map(((e,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom de l'\xe9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>{const r=[...t.etablissementsFrequentes||[]];r[n]=u(u({},r[n]),{},{nom:e.target.value}),B("etablissementsFrequentes",r)},className:"form-control",placeholder:"Ex: Universit\xe9 Hassan II"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"P\xe9riode :"}),(0,$r.jsx)("input",{type:"text",value:e.periode||"",onChange:e=>{const r=[...t.etablissementsFrequentes||[]];r[n]=u(u({},r[n]),{},{periode:e.target.value}),B("etablissementsFrequentes",r)},className:"form-control",placeholder:"Ex: 2020-2023"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.etablissementsFrequentes||[]).filter(((e,t)=>t!==n));B("etablissementsFrequentes",e)},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.etablissementsFrequentes||[],{nom:"",periode:""}];B("etablissementsFrequentes",e)},children:"Ajouter un \xe9tablissement"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[n("competencesFrancaisEtudes","Comp\xe9tences en fran\xe7ais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"]),n("competencesAnglaisEtudes","Comp\xe9tences en anglais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"])]}),(0,$r.jsx)("div",{className:"form-row",children:n("testsLanguePassesEtudes","Tests de langue pass\xe9s","select",["Oui","Non"])}),"Oui"===c&&(0,$r.jsxs)("div",{className:"form-row",children:[n("typeTestLangueEtudes","Type de test","select",["IELTS","TEF","CELPIP","TCF","Autre"]),n("scoresObtenusEtudes","Scores obtenus","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:n("programmeEtudesSouhaite","Programme d'\xe9tudes souhait\xe9","select",["DEP","AEC","DEC","Bachelor","Ma\xeetrise","Doctorat","Autre"])}),d&&(0,$r.jsx)("div",{className:"form-row",children:n("autreProgrammeEtudesPrecision","Pr\xe9cisez le programme d'\xe9tudes","text")}),(0,$r.jsxs)("div",{className:"form-row",children:[n("etablissementViseCanada","\xc9tablissement(s) vis\xe9(s) au Canada","text"),n("provinceViseeEtudes","Province vis\xe9e","text")]}),(0,$r.jsx)("div",{className:"form-row",children:n("dateDebutEtudes","Date pr\xe9vue de d\xe9but des \xe9tudes","date")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Garant(s) :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.garants||[]).map(((e,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Relation :"}),(0,$r.jsxs)("select",{value:e.relation||"",onChange:e=>{const r=[...t.garants||[]];r[n]=u(u({},r[n]),{},{relation:e.target.value}),B("garants",r)},className:"form-control",children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Lui-m\xeame",children:"Lui-m\xeame"}),(0,$r.jsx)("option",{value:"P\xe8re",children:"P\xe8re"}),(0,$r.jsx)("option",{value:"M\xe8re",children:"M\xe8re"}),(0,$r.jsx)("option",{value:"Fr\xe8re",children:"Fr\xe8re"}),(0,$r.jsx)("option",{value:"S\u0153ur",children:"S\u0153ur"}),(0,$r.jsx)("option",{value:"Oncle",children:"Oncle"}),(0,$r.jsx)("option",{value:"Tante",children:"Tante"}),(0,$r.jsx)("option",{value:"Autre",children:"Autre"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Capacit\xe9 financi\xe8re (CAD) :"}),(0,$r.jsx)("input",{type:"number",value:e.capaciteFinanciere||"",onChange:e=>{const r=[...t.garants||[]];r[n]=u(u({},r[n]),{},{capaciteFinanciere:e.target.value}),B("garants",r)},className:"form-control",placeholder:"Ex: 50000"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.garants||[]).filter(((e,t)=>t!==n));B("garants",e)},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.garants||[],{relation:"",capaciteFinanciere:""}];B("garants",e)},children:"Ajouter un garant"})]})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:n("voyageEtrangerEtudes","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===h&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVoyagesEtudes","D\xe9tails des voyages (pays, dates, dur\xe9e)","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("visaAnterieursEtudes","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===f&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVisaAnterieursEtudes","D\xe9tails des visas obtenus (pays, type, dates)","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("refusVisaEtudes","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===p&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsRefusVisaEtudes","D\xe9tails des refus (pays, motifs, dates)","textarea")})]});case"Permis de travail":t.situationFamilialePermis;const m=t.nombrePersonnesPermis||"",g=(t.emploiActuelTypes||[]).includes("Autre"),v=t.testsLanguePassesPT||"",b=t.offreEmploiCanada||"",x=t.voyageEtrangerPT||"",y=t.visaAnterieursOui||"",w=t.refusVisaOui||"",j=(t.typePermisTypes||[]).includes("Autre");return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udcbc Informations sp\xe9cifiques - Permis de travail"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[n("situationFamilialePermis","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),n("nombrePersonnesPermis","Nombre de personnes dans la demande","number")]}),parseInt(m)>1&&(0,$r.jsx)("div",{className:"form-row",children:n("representantFamillePermis","Qui sera le repr\xe9sentant ?","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations professionnelles"})}),(0,$r.jsx)("div",{className:"form-row",children:n("emploiActuelTypes","Emploi actuel","checkbox-group",["Salari\xe9","Entrepreneur","Retrait\xe9","Autre"])}),g&&(0,$r.jsx)("div",{className:"form-row",children:n("autreEmploiActuelPrecision","Pr\xe9cisez le type d'emploi actuel","text")}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Postes occup\xe9s :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.postesOccupes||[]).map(((e,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom du poste :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>{const r=[...t.postesOccupes||[]];r[n]=u(u({},r[n]),{},{nom:e.target.value}),B("postesOccupes",r)},className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Mois d'exp\xe9rience :"}),(0,$r.jsx)("input",{type:"number",value:e.moisExperience||"",onChange:e=>{const r=[...t.postesOccupes||[]];r[n]=u(u({},r[n]),{},{moisExperience:e.target.value}),B("postesOccupes",r)},className:"form-control"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.postesOccupes||[]).filter(((e,t)=>t!==n));B("postesOccupes",e)},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.postesOccupes||[],{nom:"",moisExperience:""}];B("postesOccupes",e)},children:"Ajouter un poste"})]})]}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Dipl\xf4mes obtenus :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.diplomesObtenus||[]).map(((e,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Dipl\xf4me :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>{const r=[...t.diplomesObtenus||[]];r[n]=u(u({},r[n]),{},{nom:e.target.value}),B("diplomesObtenus",r)},className:"form-control",placeholder:"Ex: Licence en informatique"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"\xc9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.etablissement||"",onChange:e=>{const r=[...t.diplomesObtenus||[]];r[n]=u(u({},r[n]),{},{etablissement:e.target.value}),B("diplomesObtenus",r)},className:"form-control",placeholder:"Ex: Universit\xe9 XYZ"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.diplomesObtenus||[]).filter(((e,t)=>t!==n));B("diplomesObtenus",e)},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.diplomesObtenus||[],{nom:"",etablissement:""}];B("diplomesObtenus",e)},children:"Ajouter un dipl\xf4me"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[n("competencesFrancais","Comp\xe9tences en fran\xe7ais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"]),n("competencesAnglais","Comp\xe9tences en anglais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"])]}),(0,$r.jsx)("div",{className:"form-row",children:n("testsLanguePassesPT","Tests de langue pass\xe9s","select",["Oui","Non"])}),"Oui"===v&&(0,$r.jsxs)("div",{className:"form-row",children:[n("typeTestLangue","Type de test","select",["IELTS","TEF","CELPIP","TCF","Autre"]),n("scoresObtenus","Scores obtenus","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Offre d'emploi au Canada"})}),(0,$r.jsx)("div",{className:"form-row",children:n("offreEmploiCanada","Avez-vous une offre d'emploi au Canada ?","select",["Oui","Non"])}),"Oui"===b&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"form-row",children:[n("nomEmployeurCanadien","Nom de l'employeur canadien","text"),n("typePosteCanada","Type de poste","text")]}),(0,$r.jsxs)("div",{className:"form-row",children:[n("provinceEmploi","Province d'emploi","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"]),n("dureeContrat","Dur\xe9e pr\xe9vue du contrat","text")]}),(0,$r.jsx)("div",{className:"form-row",children:n("numeroOffreEIMT","Num\xe9ro d'offre d'emploi ou EIMT (si applicable)","text")})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:n("typePermisTypes","Type de permis de travail vis\xe9","checkbox-group",["Permis ferm\xe9","Permis ouvert","Permis post-dipl\xf4me","Autre"])}),j&&(0,$r.jsx)("div",{className:"form-row",children:n("autreTypePermisPrecision","Pr\xe9cisez le type de permis","text")}),(0,$r.jsxs)("div",{className:"form-row",children:[n("provinceViseePermis","Province vis\xe9e","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"]),n("datePrevueDepart","Date pr\xe9vue de d\xe9part","date")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Informations financi\xe8res"})}),(0,$r.jsx)("div",{className:"form-row",children:n("fondsDisponiblesPermis","Fonds disponibles en compte (CAD)","number")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:n("voyageEtrangerPT","Avez-vous voyag\xe9 \xe0 l'\xe9tranger ?","select",["Oui","Non"])}),"Oui"===x&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVoyagesPT","Pays, dates, dur\xe9e","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("visaAnterieursOui","Avez-vous d\xe9j\xe0 eu un visa ?","select",["Oui","Non"])}),"Oui"===y&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVisaAnterieurs","Visa obtenu, pays, date","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("refusVisaOui","Avez-vous d\xe9j\xe0 eu un refus de visa ?","select",["Oui","Non"])}),"Oui"===w&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsRefusVisa","Pays, type de visa, motif de refus (si connu)","textarea")})]});case"Regroupement familial":t.situationFamilialeRegroupement,t.nombrePersonnesRegroupement;const N="Autre"===(t.lienParenteRepondant||""),S=(t.statutRepondantTypes,(t.typeParrainageTypes||[]).includes("Autre membre de la famille")),C=(t.regroupementAnterieur,t.voyageEtrangerRegroupement||""),k=t.visaAnterieursRegroupement||"",E=t.refusVisaRegroupement||"";return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 Informations sp\xe9cifiques - Regroupement familial"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[n("situationFamilialeRegroupement","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),n("nombrePersonnesRegroupement","Nombre de personnes dans la demande","number")]}),(0,$r.jsx)("div",{className:"form-row",children:n("lienParenteRepondant","Lien de parent\xe9 avec le r\xe9pondant au Canada","select",["Conjoint(e)","Enfant","Parent","Grand-parent","Fr\xe8re/S\u0153ur","Autre"])}),N&&(0,$r.jsx)("div",{className:"form-row",children:n("autreParentePrecision","Pr\xe9cisez le lien de parent\xe9","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations sur le r\xe9pondant au Canada"})}),(0,$r.jsxs)("div",{className:"form-row",children:[n("nomCompletRepondant","Nom complet du r\xe9pondant","text"),n("statutRepondantTypes","Statut du r\xe9pondant au Canada","checkbox-group",["Citoyen","R\xe9sident permanent"])]}),(0,$r.jsx)("div",{className:"form-row",children:n("adresseCompleteCanada","Adresse compl\xe8te au Canada","textarea")}),(0,$r.jsxs)("div",{className:"form-row",children:[n("telephoneRepondant","T\xe9l\xe9phone du r\xe9pondant","text"),n("emailRepondant","Email du r\xe9pondant","text")]}),(0,$r.jsxs)("div",{className:"form-row",children:[n("personnesChargeRepondant","Nombre de personnes \xe0 charge du r\xe9pondant","number"),n("regroupementAnterieur","Le r\xe9pondant a-t-il d\xe9j\xe0 fait un regroupement familial ?","select",["Oui","Non"])]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:n("typeParrainageTypes","Type de parrainage","checkbox-group",["Conjoint(e) / partenaire","Enfant","Parent","Grand-parent","Autre membre de la famille"])}),S&&(0,$r.jsx)("div",{className:"form-row",children:n("autreMembrePrecision","Pr\xe9cisez le type de membre de la famille","text")}),(0,$r.jsx)("div",{className:"form-row",children:n("provinceDestinationRegroupement","Province de destination","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"])}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsx)("div",{className:"form-row",children:n("capaciteFinanciereRepondant","Capacit\xe9 financi\xe8re du r\xe9pondant","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:n("voyageEtrangerRegroupement","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===C&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVoyagesRegroupement","Pays visit\xe9s, dates","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("visaAnterieursRegroupement","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===k&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVisaAnterieursRegroupement","Pays, type de visa","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("refusVisaRegroupement","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===E&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsRefusVisaRegroupement","Pays, type de visa, motif du refus (si connu)","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Remarques"})}),(0,$r.jsx)("div",{className:"form-row",children:n("remarquesRegroupement","Remarques ou informations importantes sur le dossier","textarea")})]});case"R\xe9sidence permanente":t.situationFamilialeRP;const A=t.nombrePersonnesRP||"",T=(t.programmesRP||[]).includes("Autre"),P=t.voyageEtrangerRP||"",_=t.visaAnterieursRP||"",L=t.refusVisaRP||"",R=t.familleCanadaRP||"",D=e=>{if(!e)return!1;const t=new Date,n=new Date(e)-t,r=Math.ceil(n/864e5);return r<=90&&r>=0};return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83c\udfe0 Informations sp\xe9cifiques - R\xe9sidence permanente"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[n("situationFamilialeRP","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),n("nombrePersonnesRP","Nombre de personnes dans la demande","number")]}),parseInt(A)>1&&(0,$r.jsx)("div",{className:"form-row",children:n("representantFamilleRP","Qui sera le repr\xe9sentant de la famille ?","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations professionnelles et acad\xe9miques"})}),(0,$r.jsx)("div",{className:"form-row",children:n("niveauEtudesEleveRP","Niveau d'\xe9tudes le plus \xe9lev\xe9","select",["Secondaire","Coll\xe9gial","Universitaire - Baccalaur\xe9at","Universitaire - Ma\xeetrise","Universitaire - Doctorat"])}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Dipl\xf4mes obtenus :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.diplomesObtenusRP||[]).map(((e,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom du dipl\xf4me :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>{const r=[...t.diplomesObtenusRP||[]];r[n]=u(u({},r[n]),{},{nom:e.target.value}),B("diplomesObtenusRP",r)},className:"form-control",placeholder:"Ex: Licence en informatique"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"\xc9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.etablissement||"",onChange:e=>{const r=[...t.diplomesObtenusRP||[]];r[n]=u(u({},r[n]),{},{etablissement:e.target.value}),B("diplomesObtenusRP",r)},className:"form-control",placeholder:"Ex: Universit\xe9 XYZ"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date d'obtention :"}),(0,$r.jsx)("input",{type:"date",value:e.dateObtention||"",onChange:e=>{const r=[...t.diplomesObtenusRP||[]];r[n]=u(u({},r[n]),{},{dateObtention:e.target.value}),B("diplomesObtenusRP",r)},className:"form-control"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.diplomesObtenusRP||[]).filter(((e,t)=>t!==n));B("diplomesObtenusRP",e)},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.diplomesObtenusRP||[],{nom:"",etablissement:"",dateObtention:""}];B("diplomesObtenusRP",e)},children:"Ajouter un dipl\xf4me"})]})]}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Exp\xe9rience professionnelle d\xe9taill\xe9e :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.experiencesProfessionnellesRP||[]).map(((e,n)=>(0,$r.jsxs)("div",{className:"dynamic-item",children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom de l'entreprise :"}),(0,$r.jsx)("input",{type:"text",value:e.entreprise||"",onChange:e=>{const r=[...t.experiencesProfessionnellesRP||[]];r[n]=u(u({},r[n]),{},{entreprise:e.target.value}),B("experiencesProfessionnellesRP",r)},className:"form-control",placeholder:"Ex: ABC Corporation"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Poste occup\xe9 :"}),(0,$r.jsx)("input",{type:"text",value:e.poste||"",onChange:e=>{const r=[...t.experiencesProfessionnellesRP||[]];r[n]=u(u({},r[n]),{},{poste:e.target.value}),B("experiencesProfessionnellesRP",r)},className:"form-control",placeholder:"Ex: D\xe9veloppeur senior"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de d\xe9but :"}),(0,$r.jsx)("input",{type:"date",value:e.dateDebut||"",onChange:e=>{const r=[...t.experiencesProfessionnellesRP||[]];r[n]=u(u({},r[n]),{},{dateDebut:e.target.value}),B("experiencesProfessionnellesRP",r)},className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de fin :"}),(0,$r.jsx)("input",{type:"date",value:e.dateFin||"",onChange:e=>{const r=[...t.experiencesProfessionnellesRP||[]];r[n]=u(u({},r[n]),{},{dateFin:e.target.value}),B("experiencesProfessionnellesRP",r)},className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Code CNP :"}),(0,$r.jsx)("input",{type:"text",value:e.codeCNP||"",onChange:e=>{const r=[...t.experiencesProfessionnellesRP||[]];r[n]=u(u({},r[n]),{},{codeCNP:e.target.value}),B("experiencesProfessionnellesRP",r)},className:"form-control",placeholder:"Ex: 2174"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Mois d'exp\xe9rience :"}),(0,$r.jsx)("input",{type:"number",value:e.moisExperience||"",onChange:e=>{const r=[...t.experiencesProfessionnellesRP||[]];r[n]=u(u({},r[n]),{},{moisExperience:e.target.value}),B("experiencesProfessionnellesRP",r)},className:"form-control",placeholder:"Ex: 24"})]})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.experiencesProfessionnellesRP||[]).filter(((e,t)=>t!==n));B("experiencesProfessionnellesRP",e)},children:"Supprimer"})]},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.experiencesProfessionnellesRP||[],{entreprise:"",poste:"",dateDebut:"",dateFin:"",codeCNP:"",moisExperience:""}];B("experiencesProfessionnellesRP",e)},children:"Ajouter une exp\xe9rience"})]})]}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Comp\xe9tences linguistiques :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(t.competencesLinguistiquesRP||[]).map(((e,n)=>{const r=D(e.dateExpiration);return(0,$r.jsxs)("div",{className:"dynamic-item ".concat(r?"test-expiring":""),children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Langue :"}),(0,$r.jsxs)("select",{value:e.langue||"",onChange:e=>{const r=[...t.competencesLinguistiquesRP||[]];r[n]=u(u({},r[n]),{},{langue:e.target.value}),B("competencesLinguistiquesRP",r)},className:"form-control",children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Fran\xe7ais",children:"Fran\xe7ais"}),(0,$r.jsx)("option",{value:"Anglais",children:"Anglais"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Type de test :"}),(0,$r.jsxs)("select",{value:e.typeTest||"",onChange:e=>{const r=[...t.competencesLinguistiquesRP||[]];r[n]=u(u({},r[n]),{},{typeTest:e.target.value}),B("competencesLinguistiquesRP",r)},className:"form-control",children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"IELTS",children:"IELTS"}),(0,$r.jsx)("option",{value:"TEF",children:"TEF"}),(0,$r.jsx)("option",{value:"TCF",children:"TCF"}),(0,$r.jsx)("option",{value:"CELPIP",children:"CELPIP"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Scores par \xe9preuve :"}),(0,$r.jsx)("input",{type:"text",value:e.scores||"",onChange:e=>{const r=[...t.competencesLinguistiquesRP||[]];r[n]=u(u({},r[n]),{},{scores:e.target.value}),B("competencesLinguistiquesRP",r)},className:"form-control",placeholder:"Ex: L:8.5, R:7.0, W:7.5, S:8.0"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date du test :"}),(0,$r.jsx)("input",{type:"date",value:e.dateTest||"",onChange:e=>{const r=[...t.competencesLinguistiquesRP||[]];r[n]=u(u({},r[n]),{},{dateTest:e.target.value}),B("competencesLinguistiquesRP",r)},className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{children:["Date d'expiration :",r&&(0,$r.jsx)("span",{className:"expiring-warning",children:"\u26a0\ufe0f Expire bient\xf4t!"})]}),(0,$r.jsx)("input",{type:"date",value:e.dateExpiration||"",onChange:e=>{const r=[...t.competencesLinguistiquesRP||[]];r[n]=u(u({},r[n]),{},{dateExpiration:e.target.value}),B("competencesLinguistiquesRP",r)},className:"form-control ".concat(r?"expiring-field":"")})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const e=(t.competencesLinguistiquesRP||[]).filter(((e,t)=>t!==n));B("competencesLinguistiquesRP",e)},children:"Supprimer"})]})]},n)})),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const e=[...t.competencesLinguistiquesRP||[],{langue:"",typeTest:"",scores:"",dateTest:"",dateExpiration:""}];B("competencesLinguistiquesRP",e)},children:"Ajouter un test de langue"})]})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:n("programmesRP","Programme(s) de r\xe9sidence permanente vis\xe9(s)","checkbox-group",["Entr\xe9e Express","Programme des candidats des provinces (PCP)","Arrima","Autre"])}),T&&(0,$r.jsx)("div",{className:"form-row",children:n("autreProgrammeRPPrecision","Pr\xe9cisez le programme","text")}),(0,$r.jsx)("div",{className:"form-row",children:n("provinceViseeRP","Province vis\xe9e","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"])}),(0,$r.jsx)("div",{className:"form-row",children:n("scoreCalculeRP","Score calcul\xe9 pour les programmes s\xe9lectionn\xe9s","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsx)("div",{className:"form-row",children:n("fondsDisponiblesRP","Fonds disponibles en compte","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:n("voyageEtrangerRP","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===P&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVoyagesRP","Pays visit\xe9s, dates","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("visaAnterieursRP","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===_&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsVisaAnterieursRP","Pays, type de visa","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:n("refusVisaRP","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===L&&(0,$r.jsx)("div",{className:"form-row",children:n("detailsRefusVisaRP","Pays, type, motif du refus (si connu)","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Famille au Canada"})}),(0,$r.jsx)("div",{className:"form-row",children:n("familleCanadaRP","Vous ou votre conjoint(e) avez un membre de la famille au Canada ?","select",["Oui","Non"])}),"Oui"===R&&(0,$r.jsx)($r.Fragment,{children:(0,$r.jsxs)("div",{className:"form-row",children:[n("membreFamilleCanada","Quel membre de la famille ?","text"),n("statutMembreFamille","Quel est son statut au Canada ?","select",["Citoyen canadien","R\xe9sident permanent","Travailleur temporaire","\xc9tudiant","Autre"])]})}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 7. Remarques"})}),(0,$r.jsx)("div",{className:"form-row",children:n("remarquesRP","Remarques ou informations importantes sur le dossier","textarea")})]});default:return null}})(),(0,$r.jsx)("input",{type:"hidden",name:"informationsSpecifiques",value:JSON.stringify(j.informationsSpecifiques||{})})]}),"documents"===o&&(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsxs)("h3",{children:["Documents requis pour ",j.typeProcedure]}),(0,$r.jsx)("div",{className:"documents-table-container",children:(0,$r.jsxs)("table",{className:"documents-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Document"}),(0,$r.jsx)("th",{children:"\xc9tat"}),(0,$r.jsx)("th",{children:"Fichier"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:(e=>{const t=F(e);return O(t)})(j.typeProcedure).map(((e,t)=>{var n;const r=null===(n=j.documents)||void 0===n?void 0:n.find((t=>t.nom===e)),a=r&&"fourni"===r.statut;return(0,$r.jsxs)("tr",{className:a?"document-provided":"document-pending",children:[(0,$r.jsxs)("td",{className:"document-name-cell",children:[(0,$r.jsx)("span",{className:"document-name",children:e}),"Dossier financier"===e&&["Visa visiteur","Permis de travail","Permis d'\xe9tudes","Investisseur"].includes(j.typeProcedure)&&(0,$r.jsxs)("div",{className:"financial-tooltip-container",onMouseEnter:S,onMouseLeave:C,children:[(0,$r.jsx)("span",{className:"financial-warning-icon",onClick:k,title:"Cliquer ou survoler pour voir les d\xe9tails du dossier financier",children:"!"}),b&&(0,$r.jsx)("div",{className:"financial-tooltip",children:(0,$r.jsx)("div",{className:"tooltip-content",children:E().map(((e,t)=>(0,$r.jsxs)("div",{className:"tooltip-section",children:[(0,$r.jsx)("h4",{children:e.title}),(0,$r.jsx)("ul",{children:e.items.map(((e,t)=>(0,$r.jsx)("li",{children:e},t)))})]},t)))})})]})]}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"status-badge ".concat(a?"status-fourni":"status-a-fournir"),children:a?"FOURNI":"\xc0 FOURNIR"})}),(0,$r.jsx)("td",{className:"file-upload-cell",children:a?(0,$r.jsxs)("div",{className:"file-info",children:[(0,$r.jsx)("i",{className:"fas fa-file-pdf text-success"}),(0,$r.jsx)("span",{className:"file-name",children:r.fichier||"Document.pdf"}),r.dateUpload&&(0,$r.jsxs)("small",{className:"upload-date",children:["(",new Date(r.dateUpload).toLocaleDateString("fr-FR"),")"]})]}):(0,$r.jsxs)("div",{className:"file-upload-wrapper",children:[(0,$r.jsx)("input",{type:"file",id:"file-".concat(t),className:"file-upload-input",onChange:t=>z(e,t.target.files[0]),accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"}),(0,$r.jsxs)("label",{htmlFor:"file-".concat(t),className:"file-upload-label",children:[(0,$r.jsx)("i",{className:"fas fa-upload"})," Choisir un fichier"]})]})}),(0,$r.jsx)("td",{className:"actions-cell",children:a?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{className:"btn-icon",onClick:()=>(e=>{console.log("Visualisation du document:",e),alert("Visualisation du document: ".concat(e.nom,"\nFichier: ").concat(e.fichier,"\nStatut: ").concat(e.statut))})(r),title:"Voir",children:(0,$r.jsx)("i",{className:"fas fa-eye"})}),(0,$r.jsx)("button",{className:"btn-icon",onClick:()=>(e=>{if(console.log("T\xe9l\xe9charger le document: ".concat(e.nom)),e.url){const t=e.createElement("a");t.href=e.url,t.download=e.nom,t.click()}else alert("Le t\xe9l\xe9chargement de ce document n'est pas encore disponible.")})(r),title:"T\xe9l\xe9charger",children:(0,$r.jsx)("i",{className:"fas fa-download"})}),(0,$r.jsx)("button",{className:"btn-icon btn-danger",onClick:()=>{return e=r.id,void(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce document ?")&&(N((t=>u(u({},t),{},{documents:t.documents.filter((t=>t.id!==e))}))),console.log("Document supprim\xe9: ".concat(e))));var e},title:"Supprimer",children:(0,$r.jsx)("i",{className:"fas fa-trash"})})]}):(0,$r.jsx)("span",{className:"no-actions",children:"-"})})]},t)}))})]})})]}),"notes"===o&&(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Notes"}),(0,$r.jsx)("div",{className:"notes-list",children:j.notes.map((e=>(0,$r.jsxs)("div",{className:"note-card",children:[(0,$r.jsxs)("div",{className:"note-header",children:[(0,$r.jsx)("span",{className:"note-date",children:e.date}),(0,$r.jsx)("span",{className:"note-author",children:e.auteur})]}),(0,$r.jsx)("div",{className:"note-content",children:e.contenu})]},e.id)))}),(0,$r.jsxs)("div",{className:"add-note-form",children:[(0,$r.jsx)("h4",{children:"Ajouter une note"}),(0,$r.jsx)("div",{className:"form-group",children:(0,$r.jsx)("textarea",{name:"newNote",value:P,onChange:e=>_(e.target.value),placeholder:"Saisir une nouvelle note...",rows:"4"})}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:async()=>{if(P.trim()){const e={id:Date.now(),texte:P.trim(),auteur:"Utilisateur actuel",date:(new Date).toISOString(),type:"Note g\xe9n\xe9rale"};try{const n=()=>{const e=localStorage.getItem("token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t};N((t=>u(u({},t),{},{notes:[...t.notes||[],e]})));(await fetch("http://localhost:5000/api/clients/".concat(t,"/notes"),{method:"POST",headers:n(),body:JSON.stringify({note:e})})).ok?console.log("\u2705 Note sauvegard\xe9e avec succ\xe8s"):console.warn("\u26a0\ufe0f Erreur lors de la sauvegarde de la note"),_("")}catch(uw){console.error("Erreur lors de l'ajout de la note:",uw),_("")}}},disabled:!P.trim(),children:"Ajouter une note"})]})]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>e("/clients"),children:"Annuler"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"Enregistrement...":"Enregistrer les modifications"})]})]})]})};const Py=function(){const[e,t]=(0,s.useState)(null),[n,r]=(0,s.useState)("statut"),[a,i]=(0,s.useState)({inclureCommentairesInternes:!1,inclureLogo:!0,inclureCoordonnees:!0,niveauDetail:"standard"}),[o,l]=(0,s.useState)({informationsClient:!0,statutDossier:!0,documents:!0,calendrier:!0,finances:!0}),[c,d]=(0,s.useState)("pdf"),[h,f]=(0,s.useState)("sur_demande"),[p,m]=(0,s.useState)(!1),[g,v]=(0,s.useState)(!1),[b,x]=(0,s.useState)(!1),[y,w]=(0,s.useState)([]),[j,N]=(0,s.useState)(""),[S,C]=(0,s.useState)(!0),[k,E]=(0,s.useState)(null),A=e=>{switch(e){case"En attente":return 15;case"En cours":return 60;case"Termin\xe9":return 100;case"Suspendu":return 30;case"Annul\xe9":return 0;default:return 45}},T=e=>({id:e.id,nom:e.nom,prenom:e.prenom,email:e.email,telephone:e.telephone,dossier:e.numero_dossier||"D-".concat((new Date).getFullYear(),"-").concat(String(e.id).padStart(3,"0")),statut:e.statut,progression:A(e.statut),type_procedure:e.type_procedure,date_creation:e.date_creation});(0,s.useEffect)((()=>{(async()=>{try{C(!0),E(null);const e=await Dx.getAllClients();if(e.success&&e.data&&e.data.clients){const t=e.data.clients.map(T);w(t)}else console.error("Erreur lors du chargement des clients:",e.message),E(e.message||"Erreur lors du chargement des clients"),w([])}catch(uw){console.error("Erreur lors du chargement des clients:",uw),E("Impossible de se connecter au serveur"),w([])}finally{C(!1)}})()}),[]);const P=y.filter((e=>"".concat(e.nom," ").concat(e.prenom," ").concat(e.dossier).toLowerCase().includes(j.toLowerCase()))),_=()=>{switch(n){case"statut":return"Rapport de statut simplifi\xe9";case"detaille":return"Rapport d\xe9taill\xe9 d'avancement";case"documents":return"Rapport de documents";case"calendrier":return"Rapport de calendrier";case"financier":return"Rapport financier";default:return"Rapport"}},L=e=>{switch(e){case"En cours":return"#1a73e8";case"En attente":return"#f9a825";case"Termin\xe9":case"Compl\xe9t\xe9":return"#43a047";case"Suspendu":return"#ff9800";case"Annul\xe9":return"#f44336";default:return"#757575"}};return(0,$r.jsxs)("div",{className:"rapports-container",children:[(0,$r.jsxs)("div",{className:"rapports-header",children:[(0,$r.jsx)("h2",{children:"Rapports d'avancement pour clients"}),(0,$r.jsx)("p",{children:"G\xe9n\xe9rez des rapports personnalis\xe9s pour informer vos clients de l'\xe9tat de leur dossier."})]}),(0,$r.jsxs)("div",{className:"rapports-content",children:[(0,$r.jsxs)("div",{className:"rapports-sidebar",children:[(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h3",{children:"S\xe9lection du client"})}),(0,$r.jsxs)("div",{className:"search-box",children:[(0,$r.jsx)("i",{className:"fas fa-search"}),(0,$r.jsx)("input",{type:"text",placeholder:"Rechercher un client...",value:j,onChange:e=>N(e.target.value)})]}),(0,$r.jsx)("div",{className:"clients-list",children:S?(0,$r.jsxs)("div",{className:"loading-clients",children:[(0,$r.jsx)("i",{className:"fas fa-spinner fa-spin"}),(0,$r.jsx)("span",{children:"Chargement des clients..."})]}):k?(0,$r.jsxs)("div",{className:"error-clients",children:[(0,$r.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,$r.jsx)("span",{children:k}),(0,$r.jsx)("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"R\xe9essayer"})]}):P.length>0?P.map((n=>(0,$r.jsxs)("div",{className:"client-item ".concat(e&&e.id===n.id?"selected":""),onClick:()=>(e=>{t(e),x(!1),m(!1)})(n),children:[(0,$r.jsxs)("div",{className:"client-avatar",children:[n.prenom.charAt(0),n.nom.charAt(0)]}),(0,$r.jsxs)("div",{className:"client-info",children:[(0,$r.jsxs)("p",{className:"client-name",children:[n.prenom," ",n.nom]}),(0,$r.jsx)("p",{className:"client-dossier",children:n.dossier})]}),(0,$r.jsx)("div",{className:"client-status",children:(0,$r.jsx)("span",{className:"status-indicator",style:{backgroundColor:L(n.statut)}})})]},n.id))):(0,$r.jsx)("div",{className:"no-results",children:j?"Aucun client ne correspond \xe0 votre recherche":"Aucun client dans la base de donn\xe9es"})}),e&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h3",{children:"Type de rapport"})}),(0,$r.jsx)("div",{className:"rapport-types",children:(0,$r.jsxs)("div",{className:"radio-group",children:[(0,$r.jsxs)("label",{className:"statut"===n?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"typeRapport",value:"statut",checked:"statut"===n,onChange:()=>r("statut")}),(0,$r.jsx)("span",{children:"Rapport de statut simplifi\xe9"})]}),(0,$r.jsxs)("label",{className:"detaille"===n?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"typeRapport",value:"detaille",checked:"detaille"===n,onChange:()=>r("detaille")}),(0,$r.jsx)("span",{children:"Rapport d\xe9taill\xe9 d'avancement"})]}),(0,$r.jsxs)("label",{className:"documents"===n?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"typeRapport",value:"documents",checked:"documents"===n,onChange:()=>r("documents")}),(0,$r.jsx)("span",{children:"Rapport de documents"})]}),(0,$r.jsxs)("label",{className:"calendrier"===n?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"typeRapport",value:"calendrier",checked:"calendrier"===n,onChange:()=>r("calendrier")}),(0,$r.jsx)("span",{children:"Rapport de calendrier"})]}),(0,$r.jsxs)("label",{className:"financier"===n?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"typeRapport",value:"financier",checked:"financier"===n,onChange:()=>r("financier")}),(0,$r.jsx)("span",{children:"Rapport financier"})]})]})}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h3",{children:"Personnalisation"})}),(0,$r.jsxs)("div",{className:"personnalisation-options",children:[(0,$r.jsxs)("div",{className:"option-group",children:[(0,$r.jsx)("h4",{children:"Sections \xe0 inclure"}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:o.informationsClient,onChange:()=>l(u(u({},o),{},{informationsClient:!o.informationsClient}))}),(0,$r.jsx)("span",{children:"Informations client"})]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:o.statutDossier,onChange:()=>l(u(u({},o),{},{statutDossier:!o.statutDossier}))}),(0,$r.jsx)("span",{children:"Statut du dossier"})]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:o.documents,onChange:()=>l(u(u({},o),{},{documents:!o.documents}))}),(0,$r.jsx)("span",{children:"Documents"})]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:o.calendrier,onChange:()=>l(u(u({},o),{},{calendrier:!o.calendrier}))}),(0,$r.jsx)("span",{children:"Calendrier"})]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:o.finances,onChange:()=>l(u(u({},o),{},{finances:!o.finances}))}),(0,$r.jsx)("span",{children:"Finances"})]})]}),(0,$r.jsxs)("div",{className:"option-group",children:[(0,$r.jsx)("h4",{children:"Niveau de d\xe9tail"}),(0,$r.jsxs)("div",{className:"radio-group",children:[(0,$r.jsxs)("label",{className:"simplifie"===a.niveauDetail?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"niveauDetail",value:"simplifie",checked:"simplifie"===a.niveauDetail,onChange:()=>i(u(u({},a),{},{niveauDetail:"simplifie"}))}),(0,$r.jsx)("span",{children:"Simplifi\xe9"})]}),(0,$r.jsxs)("label",{className:"standard"===a.niveauDetail?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"niveauDetail",value:"standard",checked:"standard"===a.niveauDetail,onChange:()=>i(u(u({},a),{},{niveauDetail:"standard"}))}),(0,$r.jsx)("span",{children:"Standard"})]}),(0,$r.jsxs)("label",{className:"detaille"===a.niveauDetail?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"niveauDetail",value:"detaille",checked:"detaille"===a.niveauDetail,onChange:()=>i(u(u({},a),{},{niveauDetail:"detaille"}))}),(0,$r.jsx)("span",{children:"D\xe9taill\xe9"})]})]})]}),(0,$r.jsxs)("div",{className:"option-group",children:[(0,$r.jsx)("h4",{children:"Options"}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:a.inclureCommentairesInternes,onChange:()=>i(u(u({},a),{},{inclureCommentairesInternes:!a.inclureCommentairesInternes}))}),(0,$r.jsx)("span",{children:"Inclure commentaires internes"})]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:a.inclureLogo,onChange:()=>i(u(u({},a),{},{inclureLogo:!a.inclureLogo}))}),(0,$r.jsx)("span",{children:"Inclure logo"})]}),(0,$r.jsxs)("label",{children:[(0,$r.jsx)("input",{type:"checkbox",checked:a.inclureCoordonnees,onChange:()=>i(u(u({},a),{},{inclureCoordonnees:!a.inclureCoordonnees}))}),(0,$r.jsx)("span",{children:"Inclure coordonn\xe9es du bureau"})]})]})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h3",{children:"Mode de diffusion"})}),(0,$r.jsxs)("div",{className:"diffusion-options",children:[(0,$r.jsxs)("div",{className:"radio-group",children:[(0,$r.jsxs)("label",{className:"pdf"===c?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"modeDiffusion",value:"pdf",checked:"pdf"===c,onChange:()=>d("pdf")}),(0,$r.jsx)("span",{children:"PDF s\xe9curis\xe9"})]}),(0,$r.jsxs)("label",{className:"email"===c?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"modeDiffusion",value:"email",checked:"email"===c,onChange:()=>d("email")}),(0,$r.jsx)("span",{children:"Email"})]}),(0,$r.jsxs)("label",{className:"imprimer"===c?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"modeDiffusion",value:"imprimer",checked:"imprimer"===c,onChange:()=>d("imprimer")}),(0,$r.jsx)("span",{children:"Version imprimable"})]})]}),"email"===c&&(0,$r.jsxs)("div",{className:"option-group",children:[(0,$r.jsx)("h4",{children:"Fr\xe9quence d'envoi"}),(0,$r.jsxs)("div",{className:"radio-group",children:[(0,$r.jsxs)("label",{className:"sur_demande"===h?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"frequenceEnvoi",value:"sur_demande",checked:"sur_demande"===h,onChange:()=>f("sur_demande")}),(0,$r.jsx)("span",{children:"Sur demande"})]}),(0,$r.jsxs)("label",{className:"hebdomadaire"===h?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"frequenceEnvoi",value:"hebdomadaire",checked:"hebdomadaire"===h,onChange:()=>f("hebdomadaire")}),(0,$r.jsx)("span",{children:"Hebdomadaire"})]}),(0,$r.jsxs)("label",{className:"mensuel"===h?"selected":"",children:[(0,$r.jsx)("input",{type:"radio",name:"frequenceEnvoi",value:"mensuel",checked:"mensuel"===h,onChange:()=>f("mensuel")}),(0,$r.jsx)("span",{children:"Mensuel"})]})]})]})]}),(0,$r.jsxs)("div",{className:"rapport-actions",children:[(0,$r.jsx)("button",{className:"btn-primary",onClick:()=>{e?(v(!0),setTimeout((()=>{v(!1),x(!0),m(!0)}),1500)):alert("Veuillez s\xe9lectionner un client")},disabled:g,children:g?"G\xe9n\xe9ration en cours...":"G\xe9n\xe9rer le rapport"}),b&&(0,$r.jsxs)($r.Fragment,{children:["pdf"===c&&(0,$r.jsxs)("button",{className:"btn-secondary",onClick:()=>{b?(v(!0),setTimeout((()=>{v(!1),alert("Rapport t\xe9l\xe9charg\xe9")}),1500)):alert("Veuillez d'abord g\xe9n\xe9rer le rapport")},disabled:g,children:[(0,$r.jsx)("i",{className:"fas fa-download"})," T\xe9l\xe9charger PDF"]}),"email"===c&&(0,$r.jsxs)("button",{className:"btn-secondary",onClick:()=>{b?(v(!0),setTimeout((()=>{v(!1),alert("Rapport envoy\xe9 \xe0 ".concat(e.email))}),1500)):alert("Veuillez d'abord g\xe9n\xe9rer le rapport")},disabled:g,children:[(0,$r.jsx)("i",{className:"fas fa-envelope"})," Envoyer par email"]}),"imprimer"===c&&(0,$r.jsxs)("button",{className:"btn-secondary",onClick:()=>{b?window.print():alert("Veuillez d'abord g\xe9n\xe9rer le rapport")},disabled:g,children:[(0,$r.jsx)("i",{className:"fas fa-print"})," Imprimer"]})]})]})]})]}),(0,$r.jsx)("div",{className:"rapports-preview",children:e?p?e?(0,$r.jsxs)("div",{className:"rapport-apercu",children:[(0,$r.jsxs)("div",{className:"rapport-header",children:[a.inclureLogo&&(0,$r.jsx)("div",{className:"rapport-logo",children:(0,$r.jsx)("img",{src:"/assets/logo.png",alt:"Logo ImmigExpert"})}),(0,$r.jsxs)("div",{className:"rapport-titre",children:[(0,$r.jsx)("h2",{children:_()}),(0,$r.jsxs)("p",{children:["G\xe9n\xe9r\xe9 le ",(new Date).toLocaleDateString("fr-CA")]})]}),a.inclureCoordonnees&&(0,$r.jsxs)("div",{className:"rapport-coordonnees",children:[(0,$r.jsx)("p",{children:"ImmigExpert Inc."}),(0,$r.jsx)("p",{children:"123 Rue de l'Immigration"}),(0,$r.jsx)("p",{children:"Montr\xe9al, QC H2X 3Y7"}),(0,$r.jsx)("p",{children:"T\xe9l: +1 514-555-0000"})]})]}),(0,$r.jsxs)("div",{className:"rapport-client-info",children:[(0,$r.jsx)("h3",{children:"Informations du client"}),(0,$r.jsxs)("div",{className:"rapport-info-grid",children:[(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Nom:"})," ",e.nom]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Pr\xe9nom:"})," ",e.prenom]})]}),(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"T\xe9l\xe9phone:"})," ",e.telephone]})]}),(0,$r.jsxs)("div",{children:[(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Num\xe9ro de dossier:"})," ",e.dossier]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"})," ",(0,$r.jsx)("span",{style:{color:L(e.statut)},children:e.statut})]})]})]})]}),o.statutDossier&&(0,$r.jsxs)("div",{className:"rapport-section",children:[(0,$r.jsx)("h3",{children:"Statut du dossier"}),(0,$r.jsxs)("div",{className:"rapport-progression",children:[(0,$r.jsx)("div",{className:"progression-bar-container",children:(0,$r.jsx)("div",{className:"progression-bar",style:{width:"".concat(e.progression,"%"),backgroundColor:L(e.statut)}})}),(0,$r.jsxs)("div",{className:"progression-label",children:[e.progression,"% compl\xe9t\xe9"]})]}),"simplifie"!==a.niveauDetail&&(0,$r.jsxs)("div",{className:"rapport-etapes",children:[(0,$r.jsxs)("div",{className:"etape ".concat(e.progression>=20?"complete":""),children:[(0,$r.jsx)("div",{className:"etape-point"}),(0,$r.jsx)("div",{className:"etape-label",children:"Ouverture du dossier"}),(0,$r.jsx)("div",{className:"etape-date",children:"2025-01-15"})]}),(0,$r.jsxs)("div",{className:"etape ".concat(e.progression>=40?"complete":""),children:[(0,$r.jsx)("div",{className:"etape-point"}),(0,$r.jsx)("div",{className:"etape-label",children:"Documents re\xe7us"}),(0,$r.jsx)("div",{className:"etape-date",children:"2025-02-10"})]}),(0,$r.jsxs)("div",{className:"etape ".concat(e.progression>=60?"complete":""),children:[(0,$r.jsx)("div",{className:"etape-point"}),(0,$r.jsx)("div",{className:"etape-label",children:"Demande soumise"}),(0,$r.jsx)("div",{className:"etape-date",children:"2025-03-05"})]}),(0,$r.jsxs)("div",{className:"etape ".concat(e.progression>=80?"complete":""),children:[(0,$r.jsx)("div",{className:"etape-point"}),(0,$r.jsx)("div",{className:"etape-label",children:"Traitement en cours"}),(0,$r.jsx)("div",{className:"etape-date",children:"2025-04-20"})]}),(0,$r.jsxs)("div",{className:"etape ".concat(e.progression>=100?"complete":""),children:[(0,$r.jsx)("div",{className:"etape-point"}),(0,$r.jsx)("div",{className:"etape-label",children:"D\xe9cision finale"}),(0,$r.jsx)("div",{className:"etape-date",children:"En attente"})]})]}),"detaille"===a.niveauDetail&&a.inclureCommentairesInternes&&(0,$r.jsxs)("div",{className:"rapport-commentaires",children:[(0,$r.jsx)("h4",{children:"Commentaires internes"}),(0,$r.jsxs)("div",{className:"commentaire",children:[(0,$r.jsx)("p",{className:"commentaire-date",children:"2025-03-10"}),(0,$r.jsx)("p",{className:"commentaire-auteur",children:"Marie Tremblay"}),(0,$r.jsx)("p",{className:"commentaire-texte",children:"Le client a fourni tous les documents n\xe9cessaires. La demande a \xe9t\xe9 soumise avec succ\xe8s."})]}),(0,$r.jsxs)("div",{className:"commentaire",children:[(0,$r.jsx)("p",{className:"commentaire-date",children:"2025-04-15"}),(0,$r.jsx)("p",{className:"commentaire-auteur",children:"Sophie Martin"}),(0,$r.jsx)("p",{className:"commentaire-texte",children:"Demande de documents suppl\xe9mentaires re\xe7ue. Le client a \xe9t\xe9 contact\xe9."})]})]})]}),o.documents&&(0,$r.jsxs)("div",{className:"rapport-section",children:[(0,$r.jsx)("h3",{children:"Documents"}),(0,$r.jsxs)("table",{className:"rapport-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Document"}),(0,$r.jsx)("th",{children:"Statut"}),(0,$r.jsx)("th",{children:"Date"})]})}),(0,$r.jsxs)("tbody",{children:[(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Passeport"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Re\xe7u"})}),(0,$r.jsx)("td",{children:"2025-01-20"})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Acte de naissance"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Re\xe7u"})}),(0,$r.jsx)("td",{children:"2025-01-25"})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Relev\xe9s bancaires"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Re\xe7u"})}),(0,$r.jsx)("td",{children:"2025-02-05"})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Certificat m\xe9dical"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-warning",children:"En attente"})}),(0,$r.jsx)("td",{children:"-"})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Casier judiciaire"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-warning",children:"En attente"})}),(0,$r.jsx)("td",{children:"-"})]})]})]})]}),o.calendrier&&(0,$r.jsxs)("div",{className:"rapport-section",children:[(0,$r.jsx)("h3",{children:"Calendrier"}),(0,$r.jsxs)("table",{className:"rapport-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"\xc9v\xe9nement"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Statut"})]})}),(0,$r.jsxs)("tbody",{children:[(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Consultation initiale"}),(0,$r.jsx)("td",{children:"2025-01-10"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Compl\xe9t\xe9"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Soumission du dossier"}),(0,$r.jsx)("td",{children:"2025-03-05"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Compl\xe9t\xe9"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Entrevue biom\xe9trique"}),(0,$r.jsx)("td",{children:"2025-05-15"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-info",children:"\xc0 venir"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Entrevue d'immigration"}),(0,$r.jsx)("td",{children:"2025-07-20"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-info",children:"\xc0 venir"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Date estim\xe9e de d\xe9cision"}),(0,$r.jsx)("td",{children:"2025-09-30"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-info",children:"\xc0 venir"})})]})]})]})]}),o.finances&&(0,$r.jsxs)("div",{className:"rapport-section",children:[(0,$r.jsx)("h3",{children:"Finances"}),(0,$r.jsxs)("table",{className:"rapport-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Description"}),(0,$r.jsx)("th",{children:"Montant"}),(0,$r.jsx)("th",{children:"Date"}),(0,$r.jsx)("th",{children:"Statut"})]})}),(0,$r.jsxs)("tbody",{children:[(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Frais de consultation"}),(0,$r.jsx)("td",{children:"500,00 $"}),(0,$r.jsx)("td",{children:"2025-01-10"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Pay\xe9"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Frais de dossier - Phase 1"}),(0,$r.jsx)("td",{children:"2 500,00 $"}),(0,$r.jsx)("td",{children:"2025-02-15"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Pay\xe9"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Frais de dossier - Phase 2"}),(0,$r.jsx)("td",{children:"2 500,00 $"}),(0,$r.jsx)("td",{children:"2025-04-01"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-warning",children:"En attente"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{children:"Frais gouvernementaux"}),(0,$r.jsx)("td",{children:"1 325,00 $"}),(0,$r.jsx)("td",{children:"2025-03-01"}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"statut-badge statut-success",children:"Pay\xe9"})})]})]}),(0,$r.jsxs)("tfoot",{children:[(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{colSpan:"3",children:(0,$r.jsx)("strong",{children:"Total pay\xe9"})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("strong",{children:"4 325,00 $"})})]}),(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("td",{colSpan:"3",children:(0,$r.jsx)("strong",{children:"Solde \xe0 payer"})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("strong",{children:"2 500,00 $"})})]})]})]})]}),(0,$r.jsxs)("div",{className:"rapport-actions-requises",children:[(0,$r.jsx)("h3",{children:"Actions requises"}),(0,$r.jsxs)("div",{className:"action-item",children:[(0,$r.jsx)("div",{className:"action-icon",children:(0,$r.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,$r.jsxs)("div",{className:"action-content",children:[(0,$r.jsx)("p",{className:"action-titre",children:"Fournir le certificat m\xe9dical"}),(0,$r.jsx)("p",{className:"action-description",children:"Veuillez prendre rendez-vous avec un m\xe9decin d\xe9sign\xe9 et nous faire parvenir le certificat m\xe9dical d\xe8s que possible."}),(0,$r.jsx)("p",{className:"action-echeance",children:"\xc9ch\xe9ance: 2025-06-15"})]})]}),(0,$r.jsxs)("div",{className:"action-item",children:[(0,$r.jsx)("div",{className:"action-icon",children:(0,$r.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,$r.jsxs)("div",{className:"action-content",children:[(0,$r.jsx)("p",{className:"action-titre",children:"Paiement des frais - Phase 2"}),(0,$r.jsx)("p",{className:"action-description",children:"Le paiement de la deuxi\xe8me phase des frais de dossier est maintenant d\xfb."}),(0,$r.jsx)("p",{className:"action-echeance",children:"\xc9ch\xe9ance: 2025-05-01"})]})]})]}),(0,$r.jsxs)("div",{className:"rapport-footer",children:[(0,$r.jsx)("p",{children:"Ce rapport est g\xe9n\xe9r\xe9 automatiquement et ne constitue pas un document officiel."}),(0,$r.jsx)("p",{children:"Pour toute question, veuillez contacter votre conseiller(\xe8re) en immigration."})]})]}):null:(0,$r.jsxs)("div",{className:"no-preview",children:[(0,$r.jsx)("div",{className:"no-preview-icon",children:(0,$r.jsx)("i",{className:"fas fa-eye"})}),(0,$r.jsx)("h3",{children:"Aper\xe7u non disponible"}),(0,$r.jsx)("p",{children:'Cliquez sur "G\xe9n\xe9rer le rapport" pour voir l\'aper\xe7u.'})]}):(0,$r.jsxs)("div",{className:"no-selection",children:[(0,$r.jsx)("div",{className:"no-selection-icon",children:(0,$r.jsx)("i",{className:"fas fa-file-alt"})}),(0,$r.jsx)("h3",{children:"Aucun client s\xe9lectionn\xe9"}),(0,$r.jsx)("p",{children:"Veuillez s\xe9lectionner un client dans la liste pour g\xe9n\xe9rer un rapport."})]})})]})]})},_y="http://localhost:5000/api",Ly=()=>{const e=localStorage.getItem("token");return u({"Content-Type":"application/json"},e&&{Authorization:"Bearer ".concat(e)})},Ry=async e=>{if(!e.ok){const t=await e.json().catch((()=>({})));throw new Error(t.message||"Erreur HTTP ".concat(e.status))}return e.json()},Dy=async e=>{try{if(!e||e.trim().length<2)return{success:!0,data:{leads:[],clients:[],dossiers:[],factures:[],conseillers:[]},total:0};const t=await fetch("".concat(_y,"/search/global?query=").concat(encodeURIComponent(e.trim())),{method:"GET",headers:Ly()});return await Ry(t)}catch(uw){throw console.error("Erreur lors de la recherche globale:",uw),uw}},Iy=async e=>{try{if(!e||e.trim().length<2)return{success:!0,suggestions:[]};const t=await fetch("".concat(_y,"/search/autocomplete?query=").concat(encodeURIComponent(e.trim())),{method:"GET",headers:Ly()});return await Ry(t)}catch(uw){throw console.error("Erreur lors de l'autocomplete:",uw),uw}};const Oy=function(e){let{onNavigate:t}=e;const[n,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),[d,h]=(0,s.useState)([]),[f,p]=(0,s.useState)(!1),[m,g]=(0,s.useState)(-1),v=(0,s.useRef)(null),b=(0,s.useRef)(null),x=(0,s.useRef)(null),y=(0,s.useRef)(null),w=async e=>{if(!e.trim()||e.trim().length<2)return i(null),void l(!1);u(!0);try{const t=await Dy(e.trim());t.success?(i(t.data),l(!0),console.log("\ud83d\udd0d R\xe9sultats de recherche:",t.data)):(console.error("\u274c Erreur recherche:",t.message),i(null),l(!1))}catch(uw){console.error("\u274c Erreur lors de la recherche:",uw),i(null),l(!1)}finally{u(!1)}},j=e=>{e.preventDefault(),p(!1),x.current&&clearTimeout(x.current),w(n)};(0,s.useEffect)((()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&(p(!1),g(-1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,s.useEffect)((()=>()=>{x.current&&clearTimeout(x.current),y.current&&clearTimeout(y.current)}),[]);const N=e=>{switch(e){case"lead":return"\ud83c\udfaf";case"client":return"\ud83d\udc64";case"dossier":return"\ud83d\udcc1";case"facture":return"\ud83d\udcb0";case"conseiller":return"\ud83d\udc69\u200d\ud83d\udcbc";default:return"\ud83d\udcc4"}},S=e=>{switch(e){case"lead":return"#2196F3";case"client":return"#4CAF50";case"dossier":return"#FF9800";case"facture":return"#9C27B0";case"conseiller":return"#607D8B";default:return"#666"}},C=e=>{if(l(!1),t)switch(e.type){case"lead":t("leads",{highlightId:e.id});break;case"client":t("clients",{highlightId:e.id});break;case"dossier":t("dossiers",{highlightId:e.id});break;case"facture":t("facturation",{highlightId:e.id});break;case"conseiller":t("administration",{highlightId:e.id})}},k=()=>{var e,t,n,r,s;return a?((null===(e=a.leads)||void 0===e?void 0:e.length)||0)+((null===(t=a.clients)||void 0===t?void 0:t.length)||0)+((null===(n=a.dossiers)||void 0===n?void 0:n.length)||0)+((null===(r=a.factures)||void 0===r?void 0:r.length)||0)+((null===(s=a.conseillers)||void 0===s?void 0:s.length)||0):0};return(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"global-search-container",ref:v,children:[(0,$r.jsxs)("form",{onSubmit:j,className:"global-search-form",children:[(0,$r.jsx)("i",{className:"fas fa-search global-search-icon"}),(0,$r.jsx)("input",{type:"text",placeholder:"Recherche globale...",value:n,onChange:e=>{const t=e.target.value;r(t),g(-1),y.current&&clearTimeout(y.current),y.current=setTimeout((()=>{(async e=>{if(!e.trim()||e.trim().length<2)return h([]),void p(!1);try{const t=await Iy(e.trim());t.success&&t.suggestions.length>0?(h(t.suggestions),p(!0)):(h([]),p(!1))}catch(uw){console.error("\u274c Erreur autocomplete:",uw),h([]),p(!1)}})(t)}),300),t.trim()||(l(!1),p(!1),h([]),i(null))},onKeyDown:e=>{if(f&&0!==d.length)switch(e.key){case"ArrowDown":e.preventDefault(),g((e=>e<d.length-1?e+1:0));break;case"ArrowUp":e.preventDefault(),g((e=>e>0?e-1:d.length-1));break;case"Enter":if(e.preventDefault(),m>=0&&m<d.length){const e=d[m].text;r(e),p(!1),w(e)}else j(e);break;case"Escape":p(!1),g(-1)}else"Enter"===e.key&&j(e)},className:"global-search-input",autoComplete:"off"}),c&&(0,$r.jsx)("div",{className:"global-search-loading",children:(0,$r.jsx)("i",{className:"fas fa-spinner fa-spin"})})]}),f&&d.length>0&&(0,$r.jsx)("div",{className:"global-search-suggestions",children:d.map(((e,t)=>(0,$r.jsxs)("div",{className:"suggestion-item ".concat(t===m?"selected":""),onClick:()=>(e=>{r(e.text),p(!1),g(-1),w(e.text)})(e),children:[(0,$r.jsx)("span",{className:"suggestion-icon",children:N(e.type)}),(0,$r.jsx)("span",{className:"suggestion-text",children:e.text}),(0,$r.jsx)("span",{className:"suggestion-type",style:{color:S(e.type)},children:e.type})]},t)))})]}),o&&a&&(0,$r.jsx)("div",{className:"global-search-modal-overlay",onClick:()=>l(!1),children:(0,$r.jsxs)("div",{className:"global-search-modal",onClick:e=>e.stopPropagation(),ref:b,children:[(0,$r.jsxs)("div",{className:"global-search-modal-header",children:[(0,$r.jsxs)("div",{className:"modal-title",children:[(0,$r.jsx)("i",{className:"fas fa-search"}),(0,$r.jsxs)("span",{children:['R\xe9sultats de recherche pour "',n,'"']}),(0,$r.jsxs)("span",{className:"results-count",children:["(",k()," r\xe9sultat",k()>1?"s":"",")"]})]}),(0,$r.jsx)("button",{className:"modal-close-btn",onClick:()=>l(!1),children:(0,$r.jsx)("i",{className:"fas fa-times"})})]}),(0,$r.jsx)("div",{className:"global-search-modal-content",children:0===k()?(0,$r.jsxs)("div",{className:"no-results",children:[(0,$r.jsx)("i",{className:"fas fa-search"}),(0,$r.jsx)("h3",{children:"Aucun r\xe9sultat trouv\xe9"}),(0,$r.jsx)("p",{children:"Essayez avec d'autres mots-cl\xe9s ou v\xe9rifiez l'orthographe."})]}):(0,$r.jsxs)("div",{className:"search-results-grid",children:[a.leads&&a.leads.length>0&&(0,$r.jsxs)("div",{className:"result-section",children:[(0,$r.jsxs)("h3",{className:"section-title",children:[(0,$r.jsx)("span",{className:"section-icon",children:"\ud83c\udfaf"}),"Leads (",a.leads.length,")"]}),(0,$r.jsx)("div",{className:"result-items",children:a.leads.map((e=>(0,$r.jsxs)("div",{className:"result-item",onClick:()=>C(e),children:[(0,$r.jsxs)("div",{className:"item-header",children:[(0,$r.jsx)("span",{className:"item-icon",children:N(e.type)}),(0,$r.jsx)("span",{className:"item-title",children:e.title})]}),(0,$r.jsx)("div",{className:"item-subtitle",children:e.subtitle}),(0,$r.jsx)("div",{className:"item-description",children:e.description})]},"lead-".concat(e.id))))})]}),a.clients&&a.clients.length>0&&(0,$r.jsxs)("div",{className:"result-section",children:[(0,$r.jsxs)("h3",{className:"section-title",children:[(0,$r.jsx)("span",{className:"section-icon",children:"\ud83d\udc64"}),"Clients (",a.clients.length,")"]}),(0,$r.jsx)("div",{className:"result-items",children:a.clients.map((e=>(0,$r.jsxs)("div",{className:"result-item",onClick:()=>C(e),children:[(0,$r.jsxs)("div",{className:"item-header",children:[(0,$r.jsx)("span",{className:"item-icon",children:N(e.type)}),(0,$r.jsx)("span",{className:"item-title",children:e.title})]}),(0,$r.jsx)("div",{className:"item-subtitle",children:e.subtitle}),(0,$r.jsx)("div",{className:"item-description",children:e.description}),e.metadata.numero_dossier&&(0,$r.jsxs)("div",{className:"item-metadata",children:["\ud83d\udcc1 Dossier: ",e.metadata.numero_dossier]})]},"client-".concat(e.id))))})]}),a.dossiers&&a.dossiers.length>0&&(0,$r.jsxs)("div",{className:"result-section",children:[(0,$r.jsxs)("h3",{className:"section-title",children:[(0,$r.jsx)("span",{className:"section-icon",children:"\ud83d\udcc1"}),"Dossiers (",a.dossiers.length,")"]}),(0,$r.jsx)("div",{className:"result-items",children:a.dossiers.map((e=>(0,$r.jsxs)("div",{className:"result-item",onClick:()=>C(e),children:[(0,$r.jsxs)("div",{className:"item-header",children:[(0,$r.jsx)("span",{className:"item-icon",children:N(e.type)}),(0,$r.jsx)("span",{className:"item-title",children:e.title})]}),(0,$r.jsx)("div",{className:"item-subtitle",children:e.subtitle}),(0,$r.jsx)("div",{className:"item-description",children:e.description})]},"dossier-".concat(e.id))))})]}),a.factures&&a.factures.length>0&&(0,$r.jsxs)("div",{className:"result-section",children:[(0,$r.jsxs)("h3",{className:"section-title",children:[(0,$r.jsx)("span",{className:"section-icon",children:"\ud83d\udcb0"}),"Factures (",a.factures.length,")"]}),(0,$r.jsx)("div",{className:"result-items",children:a.factures.map((e=>(0,$r.jsxs)("div",{className:"result-item",onClick:()=>C(e),children:[(0,$r.jsxs)("div",{className:"item-header",children:[(0,$r.jsx)("span",{className:"item-icon",children:N(e.type)}),(0,$r.jsx)("span",{className:"item-title",children:e.title})]}),(0,$r.jsx)("div",{className:"item-subtitle",children:e.subtitle}),(0,$r.jsx)("div",{className:"item-description",children:e.description})]},"facture-".concat(e.id))))})]}),a.conseillers&&a.conseillers.length>0&&(0,$r.jsxs)("div",{className:"result-section",children:[(0,$r.jsxs)("h3",{className:"section-title",children:[(0,$r.jsx)("span",{className:"section-icon",children:"\ud83d\udc69\u200d\ud83d\udcbc"}),"Conseill\xe8res (",a.conseillers.length,")"]}),(0,$r.jsx)("div",{className:"result-items",children:a.conseillers.map((e=>(0,$r.jsxs)("div",{className:"result-item",onClick:()=>C(e),children:[(0,$r.jsxs)("div",{className:"item-header",children:[(0,$r.jsx)("span",{className:"item-icon",children:N(e.type)}),(0,$r.jsx)("span",{className:"item-title",children:e.title})]}),(0,$r.jsx)("div",{className:"item-subtitle",children:e.subtitle}),(0,$r.jsx)("div",{className:"item-description",children:e.description})]},"conseiller-".concat(e.id))))})]})]})})]})})]})},Fy=(0,s.createContext)(void 0),My=()=>{const e=(0,s.useContext)(Fy);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},By=e=>{let{children:t}=e;const[n,r]=(0,s.useState)((()=>{try{const e=localStorage.getItem("notifications");if(e){const t=JSON.parse(e),n=new Date;n.setDate(n.getDate()-7);const r=t.filter((e=>new Date(e.date)>n));return console.log("\ud83e\uddf9 ".concat(t.length-r.length," notifications anciennes supprim\xe9es")),r}return[]}catch(uw){return console.error("Erreur lors du chargement des notifications depuis localStorage:",uw),[]}})),[a,i]=(0,s.useState)(0);(0,s.useEffect)((()=>{try{localStorage.setItem("notifications",JSON.stringify(n))}catch(uw){console.error("Erreur lors de la sauvegarde des notifications dans localStorage:",uw)}}),[n]),(0,s.useEffect)((()=>{const e=mm();return e&&(e.on("nouvelle_notification",(e=>{console.log("Notification re\xe7ue:",e),o(e)})),e.on("disconnect",(()=>{console.log("D\xe9connect\xe9 du serveur WebSocket")})),e.on("connect_error",(e=>{console.error("Erreur de connexion WebSocket:",e)}))),()=>{e&&(e.off("nouvelle_notification"),e.off("disconnect"),e.off("connect_error")),pm&&(pm.disconnect(),pm=null,console.log("Socket d\xe9connect\xe9 manuellement"))}}),[]);const o=e=>{const t=u(u({},e),{},{id:(new Date).toISOString()+Math.random().toString(36).substring(2,15),isRead:!1});r((e=>[t,...e]))};return(0,s.useEffect)((()=>{const e=n.filter((e=>!e.isRead)).length;i(e)}),[n]),(0,$r.jsx)(Fy.Provider,{value:{notifications:n,addNotification:o,removeNotification:e=>{r((t=>t.filter((t=>t.id!==e))))},markAsRead:e=>{r((t=>t.map((t=>t.id===e?u(u({},t),{},{isRead:!0}):t))))},markAllAsRead:()=>{r((e=>e.map((e=>u(u({},e),{},{isRead:!0})))))},unreadCount:a},children:t})},zy=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,s.useEffect)((()=>{if(!e)return;const t=async e=>{e.ctrlKey&&e.shiftKey&&"N"===e.key&&(console.log("\ud83d\udd04 V\xe9rification forc\xe9e via raccourci clavier"),gy.resetChecked("factures"),await gy.forceCheck()),e.ctrlKey&&e.shiftKey&&"T"===e.key&&(console.log("\ud83e\uddea Notification de test via raccourci clavier"),gy.notify({type:"paiement_recu",message:"\ud83d\udcb0 Test Raccourci : Paiement re\xe7u de 999\u20ac de Client Test",date:(new Date).toISOString(),nomClient:"Client Test Raccourci",lienRedirection:"/facturation"})),e.ctrlKey&&e.shiftKey&&"R"===e.key&&(console.log("\u267b\ufe0f Reset cache via raccourci clavier"),gy.resetChecked("all"),alert("Cache des notifications r\xe9initialis\xe9"))};return window.addEventListener("keydown",t),console.log("\n\ud83c\udfae Raccourcis de debug des notifications activ\xe9s :\n- Ctrl + Shift + N : Forcer v\xe9rification\n- Ctrl + Shift + T : Notification de test\n- Ctrl + Shift + R : Reset cache\n    "),()=>{window.removeEventListener("keydown",t)}}),[e])};const Uy=new class{constructor(){this.navigationCallback=null}setNavigationCallback(e){this.navigationCallback=e}navigateToModule(e){if(!this.navigationCallback)return void console.warn("Fonction de navigation non enregistr\xe9e");const t={"/leads":"leads","/clients":"clients","/facturation":"facturation","/rendez-vous":"rendez-vous","/dossiers":"dossiers","/procedures":"procedures","/charges":"charges","/administration":"administration","/rapports":"rapports","/":"tableau-bord"}[e]||"tableau-bord";console.log("\ud83e\udded Navigation vers le module: ".concat(t)),this.navigationCallback(t)}clearNavigationCallback(){this.navigationCallback=null}},qy=e=>{let{isOpen:t,onClose:n,bellRef:r}=e;const{notifications:a,markAsRead:i,markAllAsRead:o,unreadCount:l}=My(),c=(0,s.useRef)(null);if((0,s.useEffect)((()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&r.current&&!r.current.contains(e.target)&&n()};return t&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[t,n,r]),(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&t&&n()};return t&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t,n]),!t)return null;const u=a.slice(0,5),d=e=>{switch(e){case"nouveau_lead":return"\ud83d\udc65";case"rappel_rendez_vous":return"\ud83d\udcc5";case"paiement_recu":return"\ud83d\udcb0";case"facture_retard":return"\u26a0\ufe0f";case"resume_leads":return"\ud83d\udcca";default:return"\ud83d\udd14"}},h=e=>{switch(e){case"nouveau_lead":return"NOUVEAU LEAD";case"rappel_rendez_vous":return"RAPPEL RENDEZ VOUS";case"paiement_recu":return"PAIEMENT RECU";case"facture_retard":return"FACTURE RETARD";case"resume_leads":return"RESUME LEADS";default:return"NOTIFICATION"}},f=e=>{const t=new Date(e),n=new Date;return t.toDateString()===n.toDateString()?t.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})+" "+t.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})};return(0,$r.jsxs)("div",{className:"notification-dropdown",ref:c,children:[(0,$r.jsxs)("div",{className:"notification-dropdown-header",children:[(0,$r.jsxs)("h4",{children:[(0,$r.jsx)("i",{className:"fas fa-bell"})," Notifications",l>0&&(0,$r.jsx)("span",{className:"unread-badge",children:l})]}),a.length>0&&(0,$r.jsxs)("button",{className:"btn-mark-all-read",onClick:()=>{o()},title:"Tout marquer comme lu",children:[(0,$r.jsx)("i",{className:"fas fa-check-double"}),"Tout marquer comme lu"]})]}),(0,$r.jsx)("div",{className:"notification-dropdown-body",children:0===u.length?(0,$r.jsxs)("div",{className:"no-notifications",children:[(0,$r.jsx)("i",{className:"fas fa-bell-slash"}),(0,$r.jsx)("p",{children:"Aucune notification"})]}):(0,$r.jsx)("ul",{className:"notification-list",children:u.map((e=>(0,$r.jsxs)("li",{className:"notification-item ".concat(e.isRead?"":"unread"),onClick:()=>(e=>{e.isRead||i(e.id),e.lienRedirection&&Uy.navigateToModule(e.lienRedirection),n()})(e),children:[(0,$r.jsx)("div",{className:"notification-icon",children:d(e.type)}),(0,$r.jsxs)("div",{className:"notification-content",children:[(0,$r.jsxs)("div",{className:"notification-header",children:[(0,$r.jsx)("span",{className:"notification-type",children:h(e.type)}),(0,$r.jsx)("span",{className:"notification-date",children:f(e.date)})]}),(0,$r.jsx)("div",{className:"notification-message",children:e.message}),e.nomClient&&(0,$r.jsxs)("div",{className:"notification-client",children:["Client: ",e.nomClient]})]}),!e.isRead&&(0,$r.jsx)("div",{className:"unread-indicator"})]},e.id)))})}),a.length>5&&(0,$r.jsx)("div",{className:"notification-dropdown-footer",children:(0,$r.jsxs)("button",{className:"btn-view-all",onClick:()=>{n()},children:[(0,$r.jsx)("i",{className:"fas fa-list"}),"Voir toutes les notifications"]})})]})},Vy=e=>e&&"/default-avatar.png"!==e&&"/default-avatar.svg"!==e?e.startsWith("/uploads")?"http://localhost:5000".concat(e):e:"/default-avatar.svg";const Wy=function(e){let{userRole:t="directeur",userName:n="Utilisateur Test",onLogout:r}=e;const[a,i]=(0,s.useState)("tableau-bord"),[o,l]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),[d,h]=(0,s.useState)("/default-avatar.svg"),f=(0,s.useRef)(null),{notifications:p,unreadCount:m,markAsRead:g,markAllAsRead:v,removeNotification:b}=My();zy("administrateur"===t),(0,s.useEffect)((()=>{(async()=>{try{const e=await(0,Ix.qx)();e.success&&e.data&&e.data.photo&&h(e.data.photo)}catch(uw){console.log("Info: Impossible de charger la photo de profil, utilisation de l'avatar par d\xe9faut")}})()}),[]),(0,s.useEffect)((()=>(Uy.setNavigationCallback(i),()=>{Uy.clearNavigationCallback()})),[]);const x={administrateur:["tableau-bord","leads","clients","dossiers","procedures","facturation","rendez-vous","charges","administration","rapports"],directeur:["tableau-bord","leads","clients","dossiers","procedures","facturation","rendez-vous","charges","administration","rapports"],conseillere:["tableau-bord","leads","clients","dossiers","procedures","facturation","rendez-vous"],comptable:["tableau-bord","facturation","charges"],secretaire:["tableau-bord","leads","clients","rendez-vous"]}[t]||["tableau-bord"],[y,w]=(0,s.useState)(null),j=e=>({administrateur:"Administrateur",directeur:"Directeur",conseillere:"Conseill\xe8re",comptable:"Comptable",secretaire:"Secr\xe9taire"}[e]||e),N=e=>{i(e),"client-edit"!==e&&w(null)},S=()=>{l(!o),u(!1)},C=()=>{i("profile"),l(!1)};return(0,s.useEffect)((()=>{const e=e=>{if(e.altKey)switch(e.key){case"d":x.includes("tableau-bord")&&i("tableau-bord");break;case"l":x.includes("leads")&&i("leads");break;case"c":x.includes("clients")&&i("clients");break;case"f":x.includes("facturation")&&i("facturation");break;case"r":x.includes("rendez-vous")&&i("rendez-vous");break;case"p":C()}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[x]),(0,$r.jsxs)("div",{className:"dashboard-container",children:[(0,$r.jsxs)("div",{className:"sidebar",children:[(0,$r.jsxs)("div",{className:"logo",children:[(0,$r.jsx)("img",{src:"/assets/logo.png",alt:"Logo ImmigExpert"}),(0,$r.jsx)("h1",{children:"ImmigExpert"})]}),(0,$r.jsx)("nav",{className:"sidebar-nav",children:(0,$r.jsxs)("ul",{children:[x.includes("tableau-bord")&&(0,$r.jsxs)("li",{className:"tableau-bord"===a?"active":"",onClick:()=>N("tableau-bord"),children:[(0,$r.jsx)("i",{className:"fas fa-chart-line"}),(0,$r.jsx)("span",{children:"Tableau de bord"})]}),x.includes("leads")&&(0,$r.jsxs)("li",{className:"leads"===a?"active":"",onClick:()=>N("leads"),children:[(0,$r.jsx)("i",{className:"fas fa-funnel-dollar"}),(0,$r.jsx)("span",{children:"Leads"})]}),x.includes("clients")&&(0,$r.jsxs)("li",{className:"clients"===a?"active":"",onClick:()=>N("clients"),children:[(0,$r.jsx)("i",{className:"fas fa-users"}),(0,$r.jsx)("span",{children:"Clients"})]}),x.includes("dossiers")&&(0,$r.jsxs)("li",{className:"dossiers"===a?"active":"",onClick:()=>N("dossiers"),children:[(0,$r.jsx)("i",{className:"fas fa-folder-open"}),(0,$r.jsx)("span",{children:"Dossiers"})]}),x.includes("procedures")&&(0,$r.jsxs)("li",{className:"procedures"===a?"active":"",onClick:()=>N("procedures"),children:[(0,$r.jsx)("i",{className:"fas fa-tasks"}),(0,$r.jsx)("span",{children:"Proc\xe9dures"})]}),x.includes("facturation")&&(0,$r.jsxs)("li",{className:"facturation"===a?"active":"",onClick:()=>N("facturation"),children:[(0,$r.jsx)("i",{className:"fas fa-file-invoice-dollar"}),(0,$r.jsx)("span",{children:"Facturation"})]}),x.includes("rendez-vous")&&(0,$r.jsxs)("li",{className:"rendez-vous"===a?"active":"",onClick:()=>N("rendez-vous"),children:[(0,$r.jsx)("i",{className:"fas fa-calendar-alt"}),(0,$r.jsx)("span",{children:"Rendez-vous"})]}),x.includes("charges")&&(0,$r.jsxs)("li",{className:"charges"===a?"active":"",onClick:()=>N("charges"),children:[(0,$r.jsx)("i",{className:"fas fa-money-bill-wave"}),(0,$r.jsx)("span",{children:"Charges"})]}),x.includes("rapports")&&(0,$r.jsxs)("li",{className:"rapports"===a?"active":"",onClick:()=>N("rapports"),children:[(0,$r.jsx)("i",{className:"fas fa-file-alt"}),(0,$r.jsx)("span",{children:"Rapports"})]}),x.includes("administration")&&(0,$r.jsxs)("li",{className:"administration"===a?"active":"",onClick:()=>N("administration"),children:[(0,$r.jsx)("i",{className:"fas fa-cogs"}),(0,$r.jsx)("span",{children:"Administration"})]})]})}),(0,$r.jsxs)("div",{className:"user-profile",onClick:S,children:[(0,$r.jsx)("div",{className:"user-avatar",children:(0,$r.jsx)("img",{src:Vy(d),alt:"Avatar"})}),(0,$r.jsxs)("div",{className:"user-info",children:[(0,$r.jsx)("h3",{children:n}),(0,$r.jsx)("p",{children:j(t)})]}),(0,$r.jsx)("i",{className:"fas fa-chevron-".concat(o?"up":"down")}),o&&(0,$r.jsx)("div",{className:"profile-dropdown",children:(0,$r.jsxs)("ul",{children:[(0,$r.jsxs)("li",{onClick:C,children:[(0,$r.jsx)("i",{className:"fas fa-user"}),(0,$r.jsx)("span",{children:"Mon Profil"})]}),(0,$r.jsxs)("li",{onClick:r,children:[(0,$r.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,$r.jsx)("span",{children:"D\xe9connexion"})]})]})})]})]}),(0,$r.jsxs)("div",{className:"main-content",children:[(0,$r.jsxs)("header",{className:"dashboard-header",children:[(0,$r.jsx)("div",{className:"header-title",children:(0,$r.jsxs)("h2",{children:["tableau-bord"===a&&"Tableau de bord","leads"===a&&"Gestion des leads","clients"===a&&"Gestion des clients","dossiers"===a&&"Gestion des dossiers","procedures"===a&&"Proc\xe9dures","facturation"===a&&"Facturation","rendez-vous"===a&&"Rendez-vous","charges"===a&&"Gestion des charges","rapports"===a&&"Rapports d'avancement","administration"===a&&"Administration","profile"===a&&"Mon Profil"]})}),(0,$r.jsxs)("div",{className:"header-actions",children:[(0,$r.jsx)("button",{onClick:()=>gy.generateTestNotifications(),style:{padding:"8px 12px",marginRight:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",fontSize:"12px",cursor:"pointer"},title:"Tester les notifications automatiques",children:"\ud83e\uddea Test Notifications"}),(0,$r.jsxs)("div",{className:"notifications",ref:f,style:{position:"relative"},children:[(0,$r.jsxs)("span",{className:"icon icon-md icon-interactive",onClick:()=>{u(!c),l(!1)},children:[(0,$r.jsx)("i",{className:"fas fa-bell"}),m>0&&(0,$r.jsx)("span",{className:"icon-badge",children:m})]}),(0,$r.jsx)(qy,{isOpen:c,onClose:()=>u(!1),bellRef:f})]}),(0,$r.jsx)("div",{className:"messages",children:(0,$r.jsxs)("span",{className:"icon icon-md icon-interactive",children:[(0,$r.jsx)("i",{className:"fas fa-envelope"}),(0,$r.jsx)("span",{className:"icon-badge",children:"5"})]})}),(0,$r.jsx)("div",{className:"search-global",children:(0,$r.jsx)(Oy,{onNavigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(e),t.highlightId&&sessionStorage.setItem("highlightId",t.highlightId)}})}),(0,$r.jsxs)("div",{className:"user-header-info",children:[(0,$r.jsx)("span",{className:"user-name",children:n}),(0,$r.jsx)("span",{className:"user-role",children:j(t)}),(0,$r.jsxs)("div",{className:"user-avatar-small",onClick:S,children:[(0,$r.jsx)("img",{src:Vy(d),alt:"Avatar"}),(0,$r.jsx)("i",{className:"fas fa-chevron-".concat(o?"up":"down")}),o&&(0,$r.jsx)("div",{className:"header-profile-dropdown",children:(0,$r.jsxs)("ul",{children:[(0,$r.jsxs)("li",{onClick:C,children:[(0,$r.jsx)("i",{className:"fas fa-user"}),(0,$r.jsx)("span",{children:"Mon Profil"})]}),(0,$r.jsxs)("li",{onClick:r,children:[(0,$r.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,$r.jsx)("span",{children:"D\xe9connexion"})]})]})})]})]})]})]}),(0,$r.jsxs)("div",{className:"module-content",children:[(0,$r.jsx)("div",{className:"breadcrumb-container",children:(0,$r.jsx)(Xr,{items:(()=>{const e=[{label:"Accueil",onClick:()=>i("tableau-bord")}];switch(a){case"leads":e.push({label:"Gestion des leads"});break;case"clients":e.push({label:"Gestion des clients"});break;case"dossiers":e.push({label:"Gestion des dossiers"});break;case"procedures":e.push({label:"Proc\xe9dures"});break;case"facturation":e.push({label:"Facturation"});break;case"rendez-vous":e.push({label:"Rendez-vous"});break;case"charges":e.push({label:"Gestion des charges"});break;case"administration":e.push({label:"Administration"});break;case"rapports":e.push({label:"Rapports d'avancement"});break;case"profile":e.push({label:"Mon Profil"})}return e})()})}),"tableau-bord"===a&&(0,$r.jsx)(ky,{userRole:t,userName:n,onNavigate:N}),"leads"===a&&(0,$r.jsx)(vm,{userRole:t}),"clients"===a&&(0,$r.jsx)(Ox,{onEditClient:e=>{w(e),i("client-edit")},userRole:t}),"client-edit"===a&&(0,$r.jsx)(Ty,{id:y,onBack:()=>i("clients")}),"dossiers"===a&&(0,$r.jsx)(Fx,{userRole:t}),"procedures"===a&&(0,$r.jsx)(Ay,{userRole:t}),"facturation"===a&&(0,$r.jsx)(ty,{userRole:t}),"rendez-vous"===a&&(0,$r.jsx)(sy,{userRole:t}),"charges"===a&&(0,$r.jsx)(iy,{userRole:t}),"rapports"===a&&(0,$r.jsx)(Py,{userRole:t}),"administration"===a&&(0,$r.jsx)(yy,{userRole:t}),"profile"===a&&(0,$r.jsx)(Ey,{userRole:t,userName:n,onPhotoUpdate:e=>{h(e)}})]})]})]})},Hy=()=>{const[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)(!0),[a,i]=(0,s.useState)(""),o=async()=>{try{r(!0);const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{const t=await fetch("".concat(na,"/leads/conversion-history?limit=").concat(e),{headers:ra()});if(!t.ok)throw new Error("Erreur lors de la r\xe9cup\xe9ration de l'historique");return await t.json()}catch(a){throw console.error("Erreur API getConversionHistory:",a),a}}(100);e.success?(t(e.data.conversions),i("")):i("Erreur lors du chargement de l'historique")}catch(a){console.error("Erreur:",a),i("Impossible de charger l'historique des conversions")}finally{r(!1)}};return(0,s.useEffect)((()=>{o()}),[]),n?(0,$r.jsx)("div",{className:"conversion-history-container",children:(0,$r.jsxs)("div",{className:"loading",children:[(0,$r.jsx)("div",{className:"loading-spinner"}),(0,$r.jsx)("p",{children:"Chargement de l'historique..."})]})}):a?(0,$r.jsx)("div",{className:"conversion-history-container",children:(0,$r.jsxs)("div",{className:"error",children:[(0,$r.jsx)("h3",{children:"\u274c Erreur"}),(0,$r.jsx)("p",{children:a}),(0,$r.jsx)("button",{onClick:o,className:"retry-button",children:"R\xe9essayer"})]})}):(0,$r.jsxs)("div",{className:"conversion-history-container",children:[(0,$r.jsxs)("div",{className:"header",children:[(0,$r.jsx)("h2",{children:"\ud83d\udccb Historique des conversions"}),(0,$r.jsx)("p",{children:"Historique des leads convertis en clients"}),(0,$r.jsx)("button",{onClick:o,className:"refresh-button",children:"\ud83d\udd04 Actualiser"})]}),0===e.length?(0,$r.jsxs)("div",{className:"empty-state",children:[(0,$r.jsx)("div",{className:"empty-icon",children:"\ud83d\udd04"}),(0,$r.jsx)("h3",{children:"Aucune conversion trouv\xe9e"}),(0,$r.jsx)("p",{children:"Les conversions de leads en clients appara\xeetront ici."})]}):(0,$r.jsx)("div",{className:"conversions-grid",children:e.map((e=>(0,$r.jsxs)("div",{className:"conversion-card",children:[(0,$r.jsxs)("div",{className:"conversion-header",children:[(0,$r.jsxs)("div",{className:"conversion-info",children:[(0,$r.jsxs)("h4",{children:[e.lead.prenom," ",e.lead.nom]}),(0,$r.jsx)("span",{className:"conversion-date",children:new Date(e.date_conversion).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,$r.jsx)("div",{className:"dossier-number",children:e.numero_dossier})]}),(0,$r.jsxs)("div",{className:"conversion-details",children:[(0,$r.jsxs)("div",{className:"detail-item",children:[(0,$r.jsx)("strong",{children:"\ud83d\udc64 Utilisateur:"}),(0,$r.jsx)("span",{children:e.utilisateur})]}),(0,$r.jsxs)("div",{className:"detail-item",children:[(0,$r.jsx)("strong",{children:"\ud83d\udce7 Email du lead:"}),(0,$r.jsx)("span",{children:e.lead.email})]}),(0,$r.jsxs)("div",{className:"detail-item",children:[(0,$r.jsx)("strong",{children:"\ud83c\udfaf Client cr\xe9\xe9:"}),(0,$r.jsxs)("span",{children:[e.client.nom," ",e.client.prenom]})]}),e.notes&&(0,$r.jsxs)("div",{className:"conversion-notes",children:[(0,$r.jsx)("strong",{children:"\ud83d\udcdd Notes:"}),(0,$r.jsx)("p",{children:e.notes})]})]}),(0,$r.jsx)("div",{className:"conversion-footer",children:(0,$r.jsx)("div",{className:"status-badge",children:"\u2705 Converti"})})]},e.id)))}),(0,$r.jsxs)("div",{className:"stats",children:[(0,$r.jsxs)("div",{className:"stat-item",children:[(0,$r.jsx)("span",{className:"stat-number",children:e.length}),(0,$r.jsx)("span",{className:"stat-label",children:"Conversions totales"})]}),(0,$r.jsxs)("div",{className:"stat-item",children:[(0,$r.jsx)("span",{className:"stat-number",children:e.filter((e=>new Date(e.date_conversion).getMonth()===(new Date).getMonth())).length}),(0,$r.jsx)("span",{className:"stat-label",children:"Ce mois"})]})]})]})},Gy=()=>{const[e,t]=(0,s.useState)(0),[n,r]=(0,s.useState)("leads");return(0,$r.jsx)("div",{style:{backgroundColor:"#f8f9fa",minHeight:"100vh",padding:"20px 0"},children:(0,$r.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"0 20px"},children:[(0,$r.jsxs)("div",{style:{textAlign:"center",marginBottom:"30px"},children:[(0,$r.jsx)("h1",{style:{color:"#2c3e50",fontSize:"2.5rem",marginBottom:"10px",fontWeight:"bold"},children:"\ud83c\udfaf Gestion des Leads"}),(0,$r.jsx)("p",{style:{color:"#6c757d",fontSize:"1.1rem",maxWidth:"600px",margin:"0 auto"},children:"Cr\xe9ez et g\xe9rez vos prospects d'immigration. Convertissez vos leads en clients et suivez l'historique des conversions."})]}),(0,$r.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"30px",borderBottom:"2px solid #dee2e6"},children:[(0,$r.jsx)("button",{onClick:()=>r("leads"),style:{padding:"12px 24px",border:"none",background:"none",fontSize:"1rem",fontWeight:"500",cursor:"pointer",color:"leads"===n?"#007bff":"#6c757d",borderBottom:"leads"===n?"2px solid #007bff":"2px solid transparent",transition:"all 0.2s",marginBottom:"-2px"},children:"\ud83d\udccb Gestion des Leads"}),(0,$r.jsx)("button",{onClick:()=>r("history"),style:{padding:"12px 24px",border:"none",background:"none",fontSize:"1rem",fontWeight:"500",cursor:"pointer",color:"history"===n?"#007bff":"#6c757d",borderBottom:"history"===n?"2px solid #007bff":"2px solid transparent",transition:"all 0.2s",marginBottom:"-2px"},children:"\ud83d\udd04 Historique des Conversions"})]}),"leads"===n?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("div",{style:{marginBottom:"40px"},children:(0,$r.jsx)(ia,{onLeadCreated:()=>{t((e=>e+1))}})}),(0,$r.jsx)("div",{style:{borderTop:"2px solid #dee2e6",margin:"40px 0",position:"relative"},children:(0,$r.jsx)("div",{style:{position:"absolute",top:"-12px",left:"50%",transform:"translateX(-50%)",backgroundColor:"#f8f9fa",padding:"0 20px",color:"#6c757d",fontSize:"14px",fontWeight:"bold"},children:"LEADS EXISTANTS"})}),(0,$r.jsx)("div",{children:(0,$r.jsx)(la,{refreshTrigger:e})})]}):(0,$r.jsx)(Hy,{})]})})},Yy=()=>(0,$r.jsx)(Gy,{});console.log("AFFICHAGE : ClientDetail.js");const $y=function(){const{id:e}=ge(),t=me(),[n,r]=(0,s.useState)(!0),[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)("informations"),[h,f]=(0,s.useState)("conseillere"),[p,m]=(0,s.useState)(null),[g,v]=(0,s.useState)(!1);(0,s.useEffect)((()=>{e&&(async()=>{try{r(!0),i(null),console.log("\ud83d\udd04 Chargement des d\xe9tails du client ".concat(e,"..."));const t=await Dx.getClientById(e);console.log("\u2705 D\xe9tails du client r\xe9cup\xe9r\xe9s:",t),t.success&&t.data?(l(t.data),console.log("\ud83d\udcca Client ".concat(t.data.nom," ").concat(t.data.prenom," charg\xe9 avec succ\xe8s"))):(console.log("\u26a0\ufe0f Client non trouv\xe9 ou format de r\xe9ponse inattendu"),i("Client non trouv\xe9"))}catch(a){console.error("\u274c Erreur lors du chargement du client:",a),i("Erreur lors du chargement des d\xe9tails du client. V\xe9rifiez que le serveur backend est d\xe9marr\xe9.")}finally{r(!1)}})()}),[e]);const b=e=>e?new Date(e).toLocaleDateString("fr-FR"):"N/A",x=e=>{const t=e.createElement("a");t.href=e.url||e.path,t.download=e.nom||"document.pdf",t.target="_blank",e.body.appendChild(t),t.click(),e.body.removeChild(t)};return n?(0,$r.jsx)("div",{className:"client-detail-container",children:(0,$r.jsxs)("div",{className:"loading-container",children:[(0,$r.jsx)("div",{className:"loading-spinner"}),(0,$r.jsx)("p",{children:"Chargement des d\xe9tails du client..."})]})}):a?(0,$r.jsx)("div",{className:"client-detail-container",children:(0,$r.jsxs)("div",{className:"error-container",children:[(0,$r.jsx)("p",{className:"error-message",children:a}),(0,$r.jsx)("button",{onClick:()=>t("/clients"),className:"btn btn-secondary",children:"Retour aux clients"})]})}):o?(0,$r.jsxs)("div",{className:"client-detail-container",children:[(0,$r.jsxs)("div",{className:"client-header",children:[(0,$r.jsxs)("div",{className:"client-info",children:[(0,$r.jsxs)("h1",{children:[o.prenom," ",o.nom]}),(0,$r.jsxs)("div",{className:"client-meta",children:[(0,$r.jsx)("span",{className:"badge badge-procedure",children:o.type_procedure}),(0,$r.jsx)("span",{className:"badge badge-statut statut-".concat(o.statut.toLowerCase().replace(/\s+/g,"-")),children:o.statut}),o.urgence&&(0,$r.jsx)("span",{className:"badge badge-urgent",children:"Urgent"})]})]}),(0,$r.jsxs)("div",{className:"client-actions",children:[(0,$r.jsxs)("button",{onClick:()=>t("/clients"),className:"btn btn-secondary",children:[(0,$r.jsx)("i",{className:"fas fa-arrow-left"})," Retour"]}),(0,$r.jsxs)("button",{className:"btn btn-primary",children:[(0,$r.jsx)("i",{className:"fas fa-edit"})," Modifier"]})]})]}),(0,$r.jsxs)("div",{className:"tabs-navigation",children:[(0,$r.jsxs)("button",{className:"tab-button ".concat("informations"===c?"active":""),onClick:()=>d("informations"),children:[(0,$r.jsx)("i",{className:"fas fa-user"})," Informations personnelles"]}),(0,$r.jsxs)("button",{className:"tab-button ".concat("contact"===c?"active":""),onClick:()=>d("contact"),children:[(0,$r.jsx)("i",{className:"fas fa-phone"})," Contact"]}),(0,$r.jsxs)("button",{className:"tab-button ".concat("procedure"===c?"active":""),onClick:()=>d("procedure"),children:[(0,$r.jsx)("i",{className:"fas fa-file-alt"})," Proc\xe9dure"]}),(0,$r.jsxs)("button",{className:"tab-button ".concat("documents"===c?"active":""),onClick:()=>d("documents"),children:[(0,$r.jsx)("i",{className:"fas fa-folder"})," Documents"]}),(0,$r.jsxs)("button",{className:"tab-button ".concat("notes"===c?"active":""),onClick:()=>d("notes"),children:[(0,$r.jsx)("i",{className:"fas fa-sticky-note"})," Notes"]})]}),(0,$r.jsxs)("div",{className:"tab-content",children:["        ","informations"===c&&(0,$r.jsxs)("div",{className:"tab-pane",children:[(0,$r.jsx)("h3",{children:"Informations personnelles"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Nom complet:"}),(0,$r.jsxs)("span",{children:[o.prenom," ",o.nom]})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Date de naissance:"}),(0,$r.jsx)("span",{children:b(o.date_naissance)})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("span",{children:o.email})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{children:o.telephone})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Adresse compl\xe8te:"}),(0,$r.jsx)("span",{className:"address-text",children:o.adresse||"Non renseign\xe9e"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Nationalit\xe9:"}),(0,$r.jsx)("span",{children:o.nationalite||"Non renseign\xe9e"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Num\xe9ro de dossier:"}),(0,$r.jsx)("span",{className:"dossier-number",children:o.numero_dossier})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Type de proc\xe9dure:"}),(0,$r.jsx)("span",{className:"procedure-type",children:o.type_procedure})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Statut actuel:"}),(0,$r.jsx)("span",{className:"statut-badge statut-".concat(o.statut.toLowerCase().replace(/\s+/g,"-")),children:o.statut})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re assign\xe9e:"}),(0,$r.jsx)("span",{children:o.conseillere||"Non assign\xe9e"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Priorit\xe9:"}),(0,$r.jsx)("span",{className:o.urgence?"urgent":"normal",children:o.urgence?"\ud83d\udd34 Urgent":"\ud83d\udfe2 Normal"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Login client:"}),(0,$r.jsx)("span",{children:o.login_client||"Non cr\xe9\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Date de cr\xe9ation:"}),(0,$r.jsx)("span",{children:b(o.date_creation)})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Derni\xe8re modification:"}),(0,$r.jsx)("span",{children:b(o.date_modification)})]})]})]}),"contact"===c&&(0,$r.jsxs)("div",{className:"tab-pane",children:[(0,$r.jsx)("h3",{children:"Informations de contact"}),(0,$r.jsxs)("div",{className:"contact-sections",children:[(0,$r.jsxs)("div",{className:"contact-section",children:[(0,$r.jsx)("h4",{children:"Contact principal"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("span",{children:o.email})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{children:o.telephone})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Adresse:"}),(0,$r.jsx)("span",{children:o.adresse||"Non renseign\xe9e"})]})]})]}),(0,$r.jsxs)("div",{className:"contact-section",children:[(0,$r.jsx)("h4",{children:"Contact alternatif"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Nom:"}),(0,$r.jsx)("span",{children:o.contact_nom||"Non renseign\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Pr\xe9nom:"}),(0,$r.jsx)("span",{children:o.contact_prenom||"Non renseign\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Relation:"}),(0,$r.jsx)("span",{children:o.contact_relation||"Non renseign\xe9e"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone:"}),(0,$r.jsx)("span",{children:o.contact_telephone||"Non renseign\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Email:"}),(0,$r.jsx)("span",{children:o.contact_email||"Non renseign\xe9"})]})]})]})]})]}),"procedure"===c&&(0,$r.jsxs)("div",{className:"tab-pane",children:[(0,$r.jsx)("h3",{children:"Informations sur la proc\xe9dure"}),(0,$r.jsxs)("div",{className:"info-grid",children:[(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Type de proc\xe9dure:"}),(0,$r.jsx)("span",{children:o.type_procedure})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Statut:"}),(0,$r.jsx)("span",{className:"statut-badge statut-".concat(o.statut.toLowerCase().replace(/\s+/g,"-")),children:o.statut})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Conseill\xe8re assign\xe9e:"}),(0,$r.jsx)("span",{children:o.conseillere})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Urgence:"}),(0,$r.jsx)("span",{className:o.urgence?"urgent":"normal",children:o.urgence?"Urgent":"Normal"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Login client:"}),(0,$r.jsx)("span",{children:o.login_client||"Non cr\xe9\xe9"})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Date de cr\xe9ation:"}),(0,$r.jsx)("span",{children:b(o.date_creation)})]}),(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsx)("label",{children:"Derni\xe8re modification:"}),(0,$r.jsx)("span",{children:b(o.date_modification)})]})]}),o.informations_specifiques&&(0,$r.jsxs)("div",{className:"specific-info",children:[(0,$r.jsx)("h4",{children:"Informations sp\xe9cifiques"}),(()=>{try{const e="string"===typeof o.informations_specifiques?JSON.parse(o.informations_specifiques):o.informations_specifiques;return(0,$r.jsx)("div",{className:"info-grid",children:Object.entries(e).map((e=>{let[t,n]=e;return(0,$r.jsxs)("div",{className:"info-item",children:[(0,$r.jsxs)("label",{children:[(e=>({fondsDisponibles:"Fonds disponibles",situationFamiliale:"Situation familiale",dateVoyage:"Date de voyage pr\xe9vue",emploi:"Situation d'emploi",invitation:"Lettre d'invitation",lienParenteInvitant:"Lien de parent\xe9 avec l'invitant",niveauEtudes:"Niveau d'\xe9tudes",institutionProposee:"Institution propos\xe9e",programmeEtudes:"Programme d'\xe9tudes",dureeEtudes:"Dur\xe9e des \xe9tudes",coutEtudes:"Co\xfbt des \xe9tudes",preuvesFinancieres:"Preuves financi\xe8res",offreEmploi:"Offre d'emploi",employeur:"Employeur",posteOffert:"Poste offert",salaireOffert:"Salaire offert",lieuTravail:"Lieu de travail",experienceProfessionnelle:"Exp\xe9rience professionnelle",competencesLinguistiques:"Comp\xe9tences linguistiques",familleCanada:"Famille au Canada",parentsCanada:"Parents au Canada",relationFamiliale:"Relation familiale",documentsSoutien:"Documents de soutien",categorieRP:"Cat\xe9gorie de r\xe9sidence permanente",scoreEEE:"Score Entr\xe9e Express",experienceCanadienne:"Exp\xe9rience canadienne",certificationProfessionnelle:"Certification professionnelle"}[e]||e.charAt(0).toUpperCase()+e.slice(1)))(t),":"]}),(0,$r.jsx)("span",{children:(e=>"oui"===e||"yes"===e?"\u2705 Oui":"non"===e||"no"===e?"\u274c Non":"dateVoyage"===t&&e?b(e):"fondsDisponibles"===t&&e?"".concat(e," $"):e||"Non renseign\xe9")(n)})]},t)}))})}catch(a){return console.error("Erreur parsing informations sp\xe9cifiques:",a),(0,$r.jsx)("div",{className:"info-text",children:(0,$r.jsx)("pre",{children:o.informations_specifiques})})}})()]})]}),"documents"===c&&(0,$r.jsxs)("div",{className:"tab-pane",children:[(0,$r.jsx)("h3",{children:"Documents"}),(0,$r.jsx)("div",{className:"documents-section",children:(0,$r.jsx)("div",{className:"documents-table-container",children:(0,$r.jsxs)("table",{className:"documents-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Document"}),(0,$r.jsx)("th",{children:"\xc9tat"}),(0,$r.jsx)("th",{children:"Fichier"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsx)("tbody",{children:(()=>{const e=["Copie de CIN","Copie du passeport","Photo d'identit\xe9"];switch(null===o||void 0===o?void 0:o.type_procedure){case"Visa visiteur":case"Visa Visiteur":return[...e,"Invitation (si applicable)","Dossier financier","Dossier emploi"];case"Permis de travail":return[...e,"Offre d'emploi","EIMT","Dipl\xf4mes","CV"];case"Permis d'\xe9tudes":return[...e,"Lettre d'admission","Preuve financi\xe8re"];case"R\xe9sidence permanente":return[...e,"Certificat de police","Examen m\xe9dical","Preuves d'exp\xe9rience","Tests de langue"];default:return e}})().map(((e,t)=>{var n;const r=null===(n=o.documents)||void 0===n?void 0:n.find((t=>t.nom===e)),a=r&&"fourni"===r.statut;return(0,$r.jsxs)("tr",{className:a?"document-provided":"document-pending",children:[(0,$r.jsx)("td",{className:"document-name-cell",children:(0,$r.jsx)("span",{className:"document-name",children:e})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"status-badge ".concat(a?"status-fourni":"status-a-fournir"),children:a?"FOURNI":"\xc0 FOURNIR"})}),(0,$r.jsx)("td",{className:"file-upload-cell",children:a?(0,$r.jsxs)("div",{className:"file-info",children:[(0,$r.jsx)("i",{className:"fas fa-file-pdf text-success"}),(0,$r.jsx)("span",{className:"file-name",children:r.fichier||"Document.pdf"}),r.dateUpload&&(0,$r.jsxs)("small",{className:"upload-date",children:["(",b(r.dateUpload),")"]})]}):(0,$r.jsxs)("div",{className:"file-upload-wrapper",children:[(0,$r.jsx)("input",{type:"file",id:"file-".concat(t),className:"file-upload-input",onChange:t=>(async(e,t)=>{if(!t)return;if(t.size>10485760)return void alert("Le fichier est trop volumineux. Taille maximum: 10MB");if(!["application/pdf","image/jpeg","image/png","image/jpg","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type))return void alert("Type de fichier non autoris\xe9. Formats accept\xe9s: PDF, JPG, PNG, DOC, DOCX");const n={id:Date.now(),nom:e,fichier:t.name,type:t.type,statut:"fourni",dateUpload:(new Date).toISOString(),taille:t.size},r=[...o.documents||[],n];l(u(u({},o),{},{documents:r})),console.log("Document t\xe9l\xe9vers\xe9:",n),alert('Document "'.concat(e,'" t\xe9l\xe9vers\xe9 avec succ\xe8s !'))})(e,t.target.files[0]),accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"}),(0,$r.jsxs)("label",{htmlFor:"file-".concat(t),className:"file-upload-label",children:[(0,$r.jsx)("i",{className:"fas fa-upload"})," Choisir un fichier"]})]})}),(0,$r.jsx)("td",{className:"actions-cell",children:a?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{className:"btn-icon",onClick:()=>(e=>{m(e),v(!0)})(r),title:"Voir",children:(0,$r.jsx)("i",{className:"fas fa-eye"})}),(0,$r.jsx)("button",{className:"btn-icon",onClick:()=>x(r),title:"T\xe9l\xe9charger",children:(0,$r.jsx)("i",{className:"fas fa-download"})}),(0,$r.jsx)("button",{className:"btn-icon btn-danger",onClick:()=>(e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer ce document ?")){const t=o.documents.filter((t=>t.id!==e));l(u(u({},o),{},{documents:t})),console.log("Document supprim\xe9:",e)}})(r.id),title:"Supprimer",children:(0,$r.jsx)("i",{className:"fas fa-trash"})})]}):(0,$r.jsx)("span",{className:"no-actions",children:"-"})})]},t)}))})]})})})]}),"notes"===c&&(0,$r.jsxs)("div",{className:"tab-pane",children:[(0,$r.jsx)("h3",{children:"Notes"}),(0,$r.jsxs)("div",{className:"notes-section",children:[(0,$r.jsx)("div",{className:"section-header",children:(0,$r.jsxs)("button",{className:"btn btn-primary",children:[(0,$r.jsx)("i",{className:"fas fa-plus"})," Ajouter une note"]})}),(0,$r.jsxs)("div",{className:"notes-placeholder",children:[(0,$r.jsx)("i",{className:"fas fa-sticky-note"}),(0,$r.jsx)("p",{children:"Aucune note pour le moment"}),(0,$r.jsx)("p",{className:"text-muted",children:"La gestion des notes sera int\xe9gr\xe9e prochainement via l'API."})]})]})]})]}),g&&(0,$r.jsx)("div",{className:"document-modal",children:(0,$r.jsxs)("div",{className:"modal-content",children:[(0,$r.jsx)("span",{className:"close",onClick:()=>v(!1),children:"\xd7"}),p&&(0,$r.jsxs)("div",{className:"document-preview",children:[(0,$r.jsx)("h3",{children:"Pr\xe9visualisation du document"}),(0,$r.jsxs)("div",{className:"document-details",children:[(0,$r.jsx)("i",{className:(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"pdf":return"fas fa-file-pdf";case"doc":case"docx":return"fas fa-file-word";case"jpg":case"jpeg":case"png":return"fas fa-file-image";default:return"fas fa-file"}})(p.type)}),(0,$r.jsxs)("div",{className:"document-info",children:[(0,$r.jsx)("span",{className:"document-name",children:p.nom}),(0,$r.jsx)("span",{className:"document-type",children:p.type})]})]}),(0,$r.jsx)("div",{className:"document-actions",children:(0,$r.jsxs)("button",{className:"btn btn-primary",onClick:()=>x(p),children:[(0,$r.jsx)("i",{className:"fas fa-download"})," T\xe9l\xe9charger"]})}),(0,$r.jsx)("div",{className:"document-viewer",children:"pdf"===p.type.toLowerCase()?(0,$r.jsx)("iframe",{src:p.url||p.path,title:"Document PDF",className:"pdf-viewer"}):(0,$r.jsx)("p",{children:"Impossible de pr\xe9visualiser ce type de document."})})]})]})})]}):(0,$r.jsx)("div",{className:"client-detail-container",children:(0,$r.jsxs)("div",{className:"error-container",children:[(0,$r.jsx)("p",{className:"error-message",children:"Client non trouv\xe9"}),(0,$r.jsx)("button",{onClick:()=>t("/clients"),className:"btn btn-secondary",children:"Retour aux clients"})]})})};const Ky=function(){const e=me(),{id:t}=ge(),n=Boolean(t),[r,a]=(0,s.useState)(!1),[i,o]=(0,s.useState)({}),[l,c]=(0,s.useState)("informations"),[d,h]=(0,s.useState)(""),[f,p]=(0,s.useState)(!1),[m,g]=(0,s.useState)(!1),[v,b]=(0,s.useState)(null),[x,y]=(0,s.useState)({nom:"",prenom:"",dateNaissance:"",email:"",telephone:"",adresse:"",nationalite:"",contactNom:"",contactPrenom:"",contactRelation:"",contactTelephone:"",contactEmail:"",loginClient:"",motDePasseClient:"",conseillere:"",urgent:!1,statut:"En attente",typeProcedure:"",informationsSpecifiques:{},documents:[],notes:[]}),w="http://localhost:5000/api",j=async(e,t,n)=>{var r;const a=new FormData;a.append("file",n),a.append("clientId",e),a.append("typeDocument",t);return null===(r=(await Yr.post("".concat(w,"/documents/upload"),a,{headers:{"Content-Type":"multipart/form-data"}})).data)||void 0===r?void 0:r.document};(0,s.useEffect)((()=>{if(n&&t){const e=async()=>{try{const e=await Dx.getClientById(t);if(e&&e.data){const t=e.data,n={nom:t.nom||"",prenom:t.prenom||"",dateNaissance:t.date_naissance||"",email:t.email||"",telephone:t.telephone||"",adresse:t.adresse||"",nationalite:t.nationalite||"",contactNom:t.contact_nom||"",contactPrenom:t.contact_prenom||"",contactRelation:t.contact_relation||"",contactTelephone:t.contact_telephone||"",contactEmail:t.contact_email||"",loginClient:t.login_client||"",motDePasseClient:t.mot_de_passe_client||"",conseillere:t.conseillere||"",urgent:t.urgence||!1,statut:t.statut||"En attente",typeProcedure:t.type_procedure||"",informationsSpecifiques:"string"===typeof t.informations_specifiques&&t.informations_specifiques.trim().startsWith("{")?JSON.parse(t.informations_specifiques):t.informations_specifiques||{},documents:(()=>{if(!t.documents||!Array.isArray(t.documents))return[];let e=[];try{const n=t.type_procedure?L(t.type_procedure):{};e=_(n),console.log("\ud83d\udd0d D\xc9BOGAGE Documents:"),console.log("   - Type proc\xe9dure:",t.type_procedure),console.log("   - Documents requis bruts:",n),console.log("   - Documents requis liste:",e),console.log("   - Documents en base:",t.documents.map((e=>e.type_document)))}catch(uw){console.error("\u274c Erreur lors de la r\xe9cup\xe9ration des documents requis:",uw),e=[]}return t.documents.map((t=>{const n=!e.includes(t.type_document);return console.log('   \ud83d\udcc4 "'.concat(t.type_document,'" \u2192 ').concat(n?"SUPPL\xc9MENTAIRE":"REQUIS")),{id:t.id,nom:t.type_document,fichier:t.nom_fichier,statut:"fourni",dateUpload:t.date_televersement,isAdditional:n}}))})(),notes:(()=>{if(Array.isArray(t.notes))return t.notes;if("string"===typeof t.notes)try{return JSON.parse(t.notes)}catch(e){return[]}return[]})()};y(n),h("Donn\xe9es du client charg\xe9es pour modification.")}}catch(uw){console.error("Erreur lors du chargement des donn\xe9es client:",uw),h("Erreur lors du chargement des donn\xe9es.")}};e()}else{const e=localStorage.getItem("clientDraft");if(e)try{const t=JSON.parse(e);t&&"object"===typeof t&&void 0!==t.nom?window.confirm("Un brouillon non enregistr\xe9 a \xe9t\xe9 trouv\xe9. Voulez-vous le charger ?")?(y(t),t.activeTab&&c(t.activeTab),h("Brouillon charg\xe9.")):(localStorage.removeItem("clientDraft"),h("Brouillon ignor\xe9.")):localStorage.removeItem("clientDraft")}catch(uw){console.error("Erreur lors du chargement du brouillon:",uw),localStorage.removeItem("clientDraft")}}}),[n,t]);const[N,S]=(0,s.useState)({type:"",description:"",fichier:null}),[C,k]=(0,s.useState)(""),[E,A]=(0,s.useState)([]),[T,P]=(0,s.useState)(!0);(0,s.useEffect)((()=>{if(x.typeProcedure&&!localStorage.getItem("clientDraft")){const e=L(x.typeProcedure),t=_(e);y((e=>u(u({},e),{},{documents:[...e.documents.filter((e=>!t.includes(e.nom)||"fourni"===e.statut)),...t.filter((t=>!e.documents.some((e=>e.nom===t)))).map((e=>({id:Math.random().toString(36).substr(2,9),nom:e,statut:"a_fournir",dateUpload:null,description:""})))]})))}}),[x.typeProcedure]),(0,s.useEffect)((()=>{(async()=>{try{P(!0),console.log("\ud83d\udd04 Chargement des conseillers dans AddClient...");const e=await Zr();if(e.success&&e.data){const t=e.data.map((e=>({id:e.id,nom:e.nomComplet})));A(t),console.log("\u2705 Conseillers charg\xe9s dans AddClient:",t)}else{const t=e.data.map((e=>({id:e.id||Math.random(),nom:e.nomComplet})));A(t)}}catch(uw){console.error("\u274c Erreur lors du chargement des conseillers dans AddClient:",uw),A([{id:1,nom:"wafaa chaouby"},{id:2,nom:"hame amni"},{id:3,nom:"sanaa sami"}])}finally{P(!1)}})()}),[]),(0,s.useEffect)((()=>{if(x.typeProcedure&&x.documents&&x.documents.length>0){const e=x.documents.filter((e=>e.isAdditional)),t=x.documents.filter((e=>!e.isAdditional));console.log("\ud83d\udcc4 Documents charg\xe9s:",{total:x.documents.length,requis:t.length,"suppl\xe9mentaires":e.length,"d\xe9tail":{"suppl\xe9mentaires":e.map((e=>e.nom)),requis:t.map((e=>e.nom))}})}}),[x.documents]),(0,s.useEffect)((()=>{if(!T&&E.length>0&&!x.conseillere&&!n){const e=localStorage.getItem("userName");if(console.log("\ud83d\udc64 Utilisateur connect\xe9 r\xe9cup\xe9r\xe9 (AddClient):",e),console.log("\ud83d\udccb Liste des conseillers disponibles (AddClient):",E),e){const t=E.find((t=>t.nom.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.nom.toLowerCase())));t?(console.log("\u2705 Pr\xe9remplissage du champ conseill\xe8re (AddClient) avec:",t.nom),y((e=>u(u({},e),{},{conseillere:t.nom})))):console.log("\u26a0\ufe0f Utilisateur connect\xe9 non trouv\xe9 dans la liste des conseillers (AddClient):",{userName:e,conseilleres:E.map((e=>e.nom)),recherchePartielle:E.filter((t=>t.nom.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.nom.toLowerCase())))})}else console.log("\u26a0\ufe0f Aucun utilisateur connect\xe9 trouv\xe9 dans localStorage (AddClient)")}}),[T,E,x.conseillere,n]);const _=e=>Array.isArray(e)?e:Object.values(e).flat(),L=e=>{const t=["Copie de CIN","Copie du passeport","Photo d'identit\xe9"];switch(e){case"Visa visiteur":return(()=>{const e=x.informationsSpecifiques||{},t=e.situationFamiliale||"",n=parseInt(e.nombrePersonnes)||1,r=["Copie de CIN","Copie du passeport et des visas","Photo d'identit\xe9"];if("Oui"===(e.invitationCanada||"")&&(r.push("Invitation"),r.push("Statut de l'invitant")),r.push("Dossier financier"),r.push("Dossier emploi"),n>1||t&&"C\xe9libataire"!==t){let e=[...r];if(n>1)for(let t=2;t<=n;t++){const n=[...r];t<=3&&(n.push("Prise en charge"),n.push("Attestation de scolarit\xe9")),e=[...e,...n]}return[...new Set(e)]}return r})();case"Permis de travail":return(()=>{const e=x.informationsSpecifiques||{},t=e.situationFamilialePermis||"",n=parseInt(e.nombrePersonnesPermis)||1,r=e.offreEmploiCanada||"",a=(e.emploiActuelTypes,["Copie de la CIN","Copie du passeport et visas ant\xe9rieurs","Photo d'identit\xe9"]);if(a.push("Dossier financier"),a.push("Dossier emploi"),"Oui"===r&&a.push("Contrat de travail"),a.push("Certificat de police (si requis)"),a.push("R\xe9sultats d'examen m\xe9dical (si requis)"),n>1||t&&"C\xe9libataire"!==t){let e=[...a];if(n>1)for(let t=2;t<=n;t++){const t=["Preuve de lien","Passeport","CIN","Photo","Prise en charge"];e=[...e,...t]}return[...new Set(e)]}return a})();case"Permis d'\xe9tudes":return(()=>{const e=x.informationsSpecifiques||{},t=e.situationFamilialeEtudes||"",n=parseInt(e.nombrePersonnesEtudes)||1,r=e.provinceViseeEtudes||"",a={},s=["Copie de CIN","Copie du passeport et visas ant\xe9rieurs","Photo d'identit\xe9","Dossier financier","Dipl\xf4mes","Lettre d'admission de l'\xe9tablissement d'enseignement d\xe9sign\xe9 (EED)","Lettre d'acceptation de l'\xe9tablissement d'enseignement","Certificat de police"];if(r&&r.toLowerCase().includes("qu\xe9bec")?s.push("Certificat d'acceptation du Qu\xe9bec (CAQ)"):r&&s.push("Lettre d'attestation provinciale (LAP) ou lettre d'acceptation territoriale (LAT) (si applicable)"),s.push("Lettres de recommandation (si applicable)"),s.push("Plan d'\xe9tudes (si applicable)"),n>1||t&&"C\xe9libataire"!==t){if(a["Demandeur principal"]=s,n>1)for(let i=2;i<=n;i++){const e=["Preuve de lien","Passeport","CIN","Photo","Prise en charge"];a["Membre ".concat(i," de la famille")]=e}}else a["Documents requis"]=s;return a})();case"Investisseur":return(()=>{const e=x.informationsSpecifiques||{},t=e.situationFamilialeInvestisseur||"",n=parseInt(e.nombrePersonnesInvestisseur)||1,r={},a=["Copie de la CIN","Copie du passeport + visas ant\xe9rieurs","Photo d'identit\xe9","Dossier financier","Relev\xe9s bancaires","Preuves de propri\xe9t\xe9 d'actifs","D\xe9clarations fiscales","Preuves de l'origine des fonds"],s=["Registre de commerce","Statuts","Preuves de paiement des imp\xf4ts","Bilans financiers"],i=[];if("Oui"===(e.planAffairesCanada||"")&&i.push("Plan d'affaires pour le Canada"),i.push("Certificat de police (si requis)"),i.push("R\xe9sultats d'examen m\xe9dical (si requis)"),n>1||t&&"C\xe9libataire"!==t){if(r["Demandeur principal - Documents personnels"]=a,r["Demandeur principal - Documents d'entreprise"]=s,r["Demandeur principal - Documents conditionnels"]=i,n>1)for(let o=2;o<=n;o++){const e=["Preuve de lien","Passeport","CIN","Photo","Prise en charge","Document de prise en charge (pour enfants)"];r["Membre ".concat(o," de la famille")]=e}}else{const e=[...a,...s,...i];r["Documents requis"]=e}return r})();case"Regroupement familial":return(()=>{const e=x.informationsSpecifiques||{},t=e.lienParenteRepondant||"",n=parseInt(e.nombrePersonnesRegroupement)||1,r={},a=[];if("Conjoint(e)"===t?a.push("Acte de mariage"):"Enfant"===t||"Parent"===t?a.push("Acte de naissance"):t.includes("partenaire")?a.push("Preuve de relation durable"):a.push("Documents prouvant le lien familial"),r["Demandeur principal"]=["Copie de la CIN","Copie du passeport et visas ant\xe9rieurs","Photo d'identit\xe9","Certificat de police","R\xe9sultats d'examen m\xe9dical (si requis)",...a],r["R\xe9pondant au Canada"]=["Preuve de statut au Canada (carte de r\xe9sidence ou citoyennet\xe9)","Preuve de revenus","Engagement de parrainage sign\xe9"],n>1)for(let s=2;s<=n;s++){const e=["CIN","Passeport","Photo","Lien familial","Certificat m\xe9dical (si requis)","Prise en charge (si enfants \xe0 charge)"];r["Membre ".concat(s," de la famille")]=e}return r})();case"R\xe9sidence permanente":return(()=>{const e=x.informationsSpecifiques||{},t=parseInt(e.nombrePersonnesRP)||1,n=e.familleCanadaRP||"",r=e.diplomesObtenusRP||[],a=e.experiencesProfessionnellesRP||[],s=e.competencesLinguistiquesRP||[],i=e.programmesRP||[],o={"Demandeur principal":["Copie de la CIN","Formulaire d'information client interne sign\xe9","Formulaire d'informations sur la famille sign\xe9","Copie du passeport et des visas ant\xe9rieurs","Photo d'identit\xe9","Certificat de police","Dossier financier"],"Dipl\xf4mes et \xe9ducation":["\xc9valuation des dipl\xf4mes \xe9trangers (ECA)"],"Exp\xe9rience professionnelle":[],"Tests linguistiques":[],"Documents conditionnels":[],"Membres de la famille":[]};return r.forEach(((e,t)=>{e.nom&&(o["Dipl\xf4mes et \xe9ducation"].push("Dipl\xf4me: ".concat(e.nom)),o["Dipl\xf4mes et \xe9ducation"].push("Relev\xe9 de notes: ".concat(e.nom)))})),a.forEach(((e,t)=>{e.entreprise&&(o["Exp\xe9rience professionnelle"].push("Lettre d'exp\xe9rience: ".concat(e.entreprise)),o["Exp\xe9rience professionnelle"].push("Certificat de travail: ".concat(e.entreprise)))})),s.forEach(((e,t)=>{e.typeTest&&e.langue&&o["Tests linguistiques"].push("R\xe9sultat ".concat(e.typeTest," ").concat(e.langue))})),"Oui"===n&&o["Documents conditionnels"].push("Document du membre au Canada"),(i.includes("Entr\xe9e Express")||i.includes("Programme des candidats des provinces (PCP)"))&&o["Documents conditionnels"].push("R\xe9sultats d'examen m\xe9dical (si requis)"),t>1&&(o["Membres de la famille"]=["CIN des membres de la famille","Passeport des membres de la famille","Photo des membres de la famille","Relev\xe9s et dipl\xf4mes des membres de la famille","Examens m\xe9dicaux des membres de la famille"],o["Membres de la famille"].push("Document de prise en charge pour enfants \xe0 charge")),_(o)})();default:return t}},R=e=>{const{name:t,value:n,type:r,checked:a}=e.target;y((e=>u(u({},e),{},{[t]:"checkbox"===r?a:n}))),i[t]&&o((e=>u(u({},e),{},{[t]:null}))),h("")},D=e=>{const{name:t,value:n,type:r,checked:a}=e.target;y((e=>u(u({},e),{},{informationsSpecifiques:u(u({},e.informationsSpecifiques),{},{[t]:"checkbox"===r?a:n})}))),i["informationsSpecifiques.".concat(t)]&&o((e=>u(u({},e),{},{["informationsSpecifiques.".concat(t)]:null}))),h("")},I=(e,t,n,r)=>{y((a=>{const s=[...a.informationsSpecifiques[e]||[]];return s[t]=u(u({},s[t]),{},{[n]:r}),u(u({},a),{},{informationsSpecifiques:u(u({},a.informationsSpecifiques),{},{[e]:s})})})),h("")},O=(e,t)=>{y((n=>{const r=n.informationsSpecifiques[e]||[];return u(u({},n),{},{informationsSpecifiques:u(u({},n.informationsSpecifiques),{},{[e]:[...r,t]})})})),h("")},F=(e,t)=>{y((n=>{const r=(n.informationsSpecifiques[e]||[]).filter(((e,n)=>n!==t));return u(u({},n),{},{informationsSpecifiques:u(u({},n.informationsSpecifiques),{},{[e]:r})})})),h("")},M=e=>{const{name:t,value:n,files:r}=e.target;S("fichier"===t&&r?e=>u(u({},e),{},{fichier:r[0]}):e=>u(u({},e),{},{[t]:n})),h("")},B=async e=>{if(e.preventDefault(),N.type&&N.fichier)try{if(console.log("\ud83d\udcc4 D\xe9but ajout document suppl\xe9mentaire:",N.type),n&&t){console.log("\ud83d\udd04 Upload vers le backend...");const e=await j(t,N.type,N.fichier);if(!e||!e.id)throw new Error("\xc9chec de l'upload - r\xe9ponse serveur invalide");console.log("\u2705 Document upload\xe9:",e);const n={id:e.id,nom:e.type_document,statut:"fourni",dateUpload:e.date_televersement,fichier:e.nom_fichier,description:N.description||"Document suppl\xe9mentaire",isAdditional:!0};y((e=>u(u({},e),{},{documents:[...e.documents,n]}))),alert('\u2705 Document "'.concat(N.type,'" enregistr\xe9 avec succ\xe8s !'))}else{const e={id:Math.random().toString(36).substr(2,9),nom:N.type,statut:"fourni",dateUpload:(new Date).toISOString().split("T")[0],description:N.description||"Document suppl\xe9mentaire",fichier:N.fichier.name,tempFile:N.fichier,isAdditional:!0};y((t=>u(u({},t),{},{documents:[...t.documents,e]}))),alert('\ud83d\udcdd Document "'.concat(N.type,'" ajout\xe9 localement.'))}S({type:"",description:"",fichier:null});const e=document.querySelector('input[name="fichier"]');e&&(e.value="")}catch(uw){console.error("\u274c Erreur ajout document:",uw),alert("\u274c Erreur: ".concat(uw.message))}else alert("Veuillez remplir le type de document et choisir un fichier.")},z=async e=>{try{const t=x.documents.find((t=>t.id===e));n&&t&&!t.tempFile&&t.isAdditional&&await Yr.delete("".concat(w,"/documents/").concat(e)),y((t=>u(u({},t),{},{documents:t.documents.filter((t=>t.id!==e))}))),h("")}catch(uw){console.error("Erreur lors de la suppression du document:",uw),alert("Erreur lors de la suppression du document.")}},U=()=>{if(C.trim()){const e={id:Math.random().toString(36).substr(2,9),date:(new Date).toISOString().split("T")[0],contenu:C,auteur:"Utilisateur actuel"};y((t=>u(u({},t),{},{notes:[...t.notes,e]}))),n&&Dx.updateClient(t,{notes:[...x.notes,e]}).catch((e=>{console.error("Erreur sauvegarde note",e)})),k(""),h("")}},q=()=>{try{const e=u(u({},x),{},{activeTab:l});localStorage.setItem("clientDraft",JSON.stringify(e)),h("Brouillon sauvegard\xe9 avec succ\xe8s.")}catch(uw){console.error("Erreur lors de la sauvegarde du brouillon:",uw),h("Erreur lors de la sauvegarde du brouillon.")}},V=()=>{const e=x.informationsSpecifiques||{},t=x.typeProcedure;let n=[];if("Visa visiteur"===t){const t=e.emploiTypes||[];t.includes("Salari\xe9")&&n.push({title:"Salari\xe9 :",items:["Attestation de travail","Attestation de salaire","Attestation de cong\xe9","Bulletins de paie","Autres preuves de revenus (ex : contrat de bail)"]}),(t.includes("Entrepreneur")||t.includes("Investisseur"))&&n.push({title:"Entrepreneur / Investisseur :",items:["Registre de commerce","Statuts","Justificatif de paiement des imp\xf4ts","Contrat de bail ou autres preuves de revenus"]}),t.includes("Retrait\xe9")&&n.push({title:"Retrait\xe9 :",items:["Attestation de retraite","Contrat de bail ou autres preuves de revenus"]}),0===t.length&&(n=[{title:"Salari\xe9 :",items:["Attestation de travail","Attestation de salaire","Attestation de cong\xe9","Bulletins de paie","Autres preuves de revenus (ex : contrat de bail)"]},{title:"Entrepreneur / Investisseur :",items:["Registre de commerce","Statuts","Justificatif de paiement des imp\xf4ts","Contrat de bail ou autres preuves de revenus"]},{title:"Retrait\xe9 :",items:["Attestation de retraite","Contrat de bail ou autres preuves de revenus"]}])}if("Permis de travail"===t){const t=e.emploiActuelTypes||[];t.includes("Salari\xe9")&&n.push({title:"Salari\xe9 :",items:["Bulletins de paie","Attestation de travail","Relev\xe9s bancaires","Contrat de travail actuel"]}),t.includes("Entrepreneur")&&n.push({title:"Entrepreneur :",items:["Registre de commerce","Statuts","Justificatifs imp\xf4ts","Contrat de location","Relev\xe9s bancaires"]}),t.includes("Retrait\xe9")&&n.push({title:"Retrait\xe9 :",items:["Attestation de retraite","Preuves de revenus","Relev\xe9s bancaires"]}),0===t.length&&(n=[{title:"Salari\xe9 :",items:["Bulletins de paie","Attestation de travail","Relev\xe9s bancaires","Contrat de travail actuel"]},{title:"Entrepreneur :",items:["Registre de commerce","Statuts","Justificatifs imp\xf4ts","Contrat de location","Relev\xe9s bancaires"]},{title:"Retrait\xe9 :",items:["Attestation de retraite","Preuves de revenus","Relev\xe9s bancaires"]}])}if("Permis d'\xe9tudes"===t){const t=e.garants||[];t.length>0?t.forEach(((e,t)=>{const r=e.relation||"Garant";n.push({title:"".concat(r," :"),items:["Relev\xe9s bancaires (6 derniers mois)","Attestation de revenus","Certificat de travail ou d'affaires","Justificatifs de propri\xe9t\xe9s","D\xe9claration d'imp\xf4ts","Lettre de garantie financi\xe8re"]})})):n=[{title:"Documents financiers requis :",items:["Relev\xe9s bancaires du garant","Attestation de revenus du garant","Certificat de travail du garant","Justificatifs de fonds pour \xe9tudes","Lettre de garantie financi\xe8re","Preuve de fonds de subsistance"]}]}return"Investisseur"===t&&(n=[{title:"Documents financiers requis :",items:["Registre de commerce","Statuts","D\xe9clarations fiscales","Bilans financiers","Justificatifs d'origine des fonds (contrats de cession, ventes, h\xe9ritage, etc.)"]}]),0===n.length&&(n=[{title:"Documents financiers requis :",items:["Relev\xe9s bancaires","Attestations de revenus","Preuves de fonds disponibles"]}]),n},W=()=>{v&&(clearTimeout(v),b(null)),g(!0)},H=()=>{const e=setTimeout((()=>{g(!1)}),100);b(e)},G=e=>{e.preventDefault(),e.stopPropagation(),v&&(clearTimeout(v),b(null)),g(!m)};(0,s.useEffect)((()=>()=>{v&&clearTimeout(v)}),[v]),(0,s.useEffect)((()=>{const e=e=>{m&&!e.target.closest(".financial-tooltip-container")&&(g(!1),v&&(clearTimeout(v),b(null)))};return m&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[m,v]);const Y=async function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r)if(n){if(a&&a.id)try{await Yr.delete("".concat(w,"/documents/").concat(a.id))}catch(Qm){console.warn("Del doc fail",Qm)}try{const n=await j(t,e,r),a={id:n.id,nom:n.type_document,statut:"fourni",dateUpload:n.date_televersement,fichier:n.nom_fichier};y((t=>u(u({},t),{},{documents:[...t.documents.filter((t=>t.nom!==e)),a]})))}catch(Qm){console.error("Erreur upload",Qm),alert("Erreur lors du t\xe9l\xe9versement")}}else{const t={tempFile:r,nom:e,statut:"fourni",dateUpload:(new Date).toISOString(),fichier:r.name};y((n=>u(u({},n),{},{documents:[...n.documents.filter((t=>t.nom!==e)),t]})))}},$=e=>{window.open("".concat(w,"/documents/file/").concat(e.id),"_blank")};return(0,$r.jsxs)("div",{className:"client-form-container",children:[(0,$r.jsxs)("div",{className:"client-form-header",children:[(0,$r.jsx)("h2",{children:n?"Modifier le client":"Ajouter un nouveau client"}),(0,$r.jsxs)("button",{type:"button",className:"btn-secondary btn-back",onClick:()=>e("/clients"),children:[(0,$r.jsx)("i",{className:"fas fa-arrow-left"})," Retour \xe0 la liste"]})]}),(0,$r.jsxs)("div",{className:"tabs-navigation",children:[(0,$r.jsx)("button",{className:"informations"===l?"tab-active":"",onClick:()=>c("informations"),children:"Informations"}),(0,$r.jsx)("button",{className:"procedure"===l?"tab-active":"",onClick:()=>c("procedure"),disabled:!x.nom||!x.prenom,children:"Proc\xe9dure"}),(0,$r.jsx)("button",{className:"documents"===l?"tab-active":"",onClick:()=>c("documents"),disabled:!x.typeProcedure,children:"Documents"}),(0,$r.jsx)("button",{className:"notes"===l?"tab-active":"",onClick:()=>c("notes"),children:"Notes"})]}),(0,$r.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),(()=>{const e={};return x.nom||(e.nom="Le nom est requis"),x.prenom||(e.prenom="Le pr\xe9nom est requis"),x.email||(e.email="L'email est requis"),x.email&&!/\S+@\S+\.\S+/.test(x.email)&&(e.email="Format d'email invalide"),x.typeProcedure||(e.typeProcedure="Le type de proc\xe9dure est requis"),"Visa Visiteur"===x.typeProcedure&&(x.informationsSpecifiques.fondsDisponibles||(e["informationsSpecifiques.fondsDisponibles"]="Les fonds disponibles sont requis"),x.informationsSpecifiques.situationFamiliale||(e["informationsSpecifiques.situationFamiliale"]="La situation familiale est requise")),o(e),0===Object.keys(e).length})()){a(!0);try{console.log("\ud83d\udce4 ".concat(n?"Modification":"Cr\xe9ation"," d'un client via l'API..."));const r={nom:x.nom,prenom:x.prenom,email:x.email,telephone:x.telephone,date_naissance:x.dateNaissance,adresse:x.adresse,nationalite:x.nationalite,type_procedure:x.typeProcedure,statut:x.statut||"En cours",conseillere:x.conseillere,urgence:x.urgent||!1,contact_nom:x.contactNom||null,contact_prenom:x.contactPrenom||null,contact_relation:x.contactRelation||null,contact_telephone:x.contactTelephone||null,contact_email:x.contactEmail||null,informations_specifiques:"string"===typeof x.informationsSpecifiques?JSON.parse(x.informationsSpecifiques):x.informationsSpecifiques||null,notes:x.notes||[]};let a;if(console.log("\ud83d\udccb Donn\xe9es pr\xe9par\xe9es pour l'API:",r),a=n?await Dx.updateClient(t,r):await Dx.createClient(r),a.success){if(console.log("\u2705 Client ".concat(n?"modifi\xe9":"cr\xe9\xe9"," avec succ\xe8s:"),a.data),!n&&a.data&&a.data.id){var s;const e=null===(s=x.documents)||void 0===s?void 0:s.filter((e=>e.isAdditional&&e.tempFile));if(e&&e.length>0){console.log("\ud83d\udcc4 Upload de ".concat(e.length," document(s) suppl\xe9mentaire(s)..."));for(const t of e)try{await j(a.data.id,t.nom,t.tempFile),console.log('\u2705 Document "'.concat(t.nom,'" upload\xe9 avec succ\xe8s'))}catch(uw){console.error('\u274c Erreur upload document "'.concat(t.nom,'":'),uw)}}}localStorage.removeItem("clientDraft"),n?alert("Client modifi\xe9 avec succ\xe8s!"):alert("Nouveau client ajout\xe9 avec succ\xe8s! Num\xe9ro de dossier: ".concat(a.data.numero_dossier)),e("/clients")}else console.error("\u274c Erreur API:",a.message),alert("Erreur lors de ".concat(n?"la modification":"l'ajout"," du client: ")+a.message)}catch(uw){console.error("\u274c Erreur lors de ".concat(n?"la modification":"l'ajout"," du client:"),uw),alert("Une erreur est survenue lors de ".concat(n?"la modification":"l'ajout"," du client. V\xe9rifiez que le serveur backend est d\xe9marr\xe9."))}finally{a(!1)}}else alert("Veuillez corriger les erreurs dans le formulaire avant de soumettre.")},children:["informations"===l&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Informations personnelles communes"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Nom"}),(0,$r.jsx)("input",{type:"text",name:"nom",value:x.nom,onChange:R,required:!0}),i.nom&&(0,$r.jsx)("div",{className:"error-message",children:i.nom})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Pr\xe9nom"}),(0,$r.jsx)("input",{type:"text",name:"prenom",value:x.prenom,onChange:R,required:!0}),i.prenom&&(0,$r.jsx)("div",{className:"error-message",children:i.prenom})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de naissance"}),(0,$r.jsx)("input",{type:"date",name:"dateNaissance",value:x.dateNaissance,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Email"}),(0,$r.jsx)("input",{type:"email",name:"email",value:x.email,onChange:R,required:!0}),i.email&&(0,$r.jsx)("div",{className:"error-message",children:i.email})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone"}),(0,$r.jsx)("input",{type:"tel",name:"telephone",value:x.telephone,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group full-width",children:[(0,$r.jsx)("label",{children:"Adresse compl\xe8te"}),(0,$r.jsx)("textarea",{name:"adresse",value:x.adresse,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nationalit\xe9"}),(0,$r.jsx)("input",{type:"text",name:"nationalite",value:x.nationalite,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Login client"}),(0,$r.jsx)("input",{type:"text",name:"loginClient",value:x.loginClient,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group password-group",children:[(0,$r.jsx)("label",{children:"Mot de passe client"}),(0,$r.jsxs)("div",{className:"password-input-container",children:[(0,$r.jsx)("input",{type:f?"text":"password",name:"motDePasseClient",value:x.motDePasseClient,onChange:R}),(0,$r.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>{p(!f)},title:f?"Masquer le mot de passe":"Afficher le mot de passe",children:f?(0,$r.jsx)("i",{className:"fas fa-eye-slash"}):(0,$r.jsx)("i",{className:"fas fa-eye"})})]})]})]})]}),(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Contact alternatif"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom"}),(0,$r.jsx)("input",{type:"text",name:"contactNom",value:x.contactNom,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pr\xe9nom"}),(0,$r.jsx)("input",{type:"text",name:"contactPrenom",value:x.contactPrenom,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Relation"}),(0,$r.jsx)("input",{type:"text",name:"contactRelation",value:x.contactRelation,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"T\xe9l\xe9phone"}),(0,$r.jsx)("input",{type:"tel",name:"contactTelephone",value:x.contactTelephone,onChange:R})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Email"}),(0,$r.jsx)("input",{type:"email",name:"contactEmail",value:x.contactEmail,onChange:R})]})]})]}),(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Informations administratives"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{children:["Conseill\xe8re assign\xe9e",T&&(0,$r.jsx)("span",{style:{fontSize:"12px",color:"#666",marginLeft:"8px"},children:"(Chargement...)"})]}),(0,$r.jsxs)("select",{name:"conseillere",value:x.conseillere,onChange:R,disabled:T,style:T?{backgroundColor:"#f5f5f5",cursor:"wait"}:{},children:[(0,$r.jsx)("option",{value:"",children:"Non assign\xe9e"}),E.map((e=>(0,$r.jsx)("option",{value:e.nom,children:e.nom},e.id)))]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Statut initial"}),(0,$r.jsxs)("select",{name:"statut",value:x.statut,onChange:R,children:[(0,$r.jsx)("option",{value:"En attente",children:"En attente"}),(0,$r.jsx)("option",{value:"En cours",children:"En cours"}),(0,$r.jsx)("option",{value:"Termin\xe9",children:"Termin\xe9"}),(0,$r.jsx)("option",{value:"Refus\xe9",children:"Refus\xe9"})]})]}),(0,$r.jsxs)("div",{className:"form-group checkbox-group",children:[(0,$r.jsx)("label",{htmlFor:"urgent",children:"Dossier urgent?"}),(0,$r.jsx)("input",{type:"checkbox",id:"urgent",name:"urgent",checked:x.urgent,onChange:R})]})]})]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:q,children:"Sauvegarder le brouillon"}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>c("procedure"),disabled:!x.nom||!x.prenom||!x.email,children:"Suivant: Proc\xe9dure"})]})]}),"procedure"===l&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Proc\xe9dure d'immigration"}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Type de proc\xe9dure"}),(0,$r.jsxs)("select",{name:"typeProcedure",value:x.typeProcedure,onChange:e=>{const{value:t}=e.target;y((e=>u(u({},e),{},{typeProcedure:t,informationsSpecifiques:{}}))),h("")},required:!0,children:[(0,$r.jsx)("option",{value:"",disabled:!0,children:"S\xe9lectionner une proc\xe9dure..."}),["Visa visiteur","Permis de travail","Permis d'\xe9tudes","Investisseur","Regroupement familial","R\xe9sidence permanente","Citoyennet\xe9","Autre"].map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]}),i.typeProcedure&&(0,$r.jsx)("div",{className:"error-message",children:i.typeProcedure})]}),(()=>{const e=x.informationsSpecifiques||{},t=function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=e[t]||("checkbox-group"===r?[]:"");return"select"===r&&a?(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{htmlFor:t,children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsxs)("select",{id:t,name:t,value:i,onChange:D,className:"form-control",required:s,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),a.map((e=>(0,$r.jsx)("option",{value:e,children:e},e)))]})]},t):"textarea"===r?(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{htmlFor:t,children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsx)("textarea",{id:t,name:t,value:i,onChange:D,className:"form-control",rows:"3",required:s})]},t):"checkbox-group"===r&&a?(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsx)("div",{className:"checkbox-group",children:a.map((e=>(0,$r.jsxs)("label",{className:"checkbox-label",children:[(0,$r.jsx)("input",{type:"checkbox",value:e,checked:i.includes(e),onChange:n=>{const r=i;let a;a=n.target.checked?[...r,e]:r.filter((t=>t!==e)),D({target:{name:t,value:a}})}}),(0,$r.jsx)("span",{children:e})]},e)))})]},t):(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{htmlFor:t,children:[n," ",s&&(0,$r.jsx)("span",{className:"required",children:"*"})]}),(0,$r.jsx)("input",{id:t,name:t,type:r,value:i,onChange:D,className:"form-control",required:s})]},t)};switch(x.typeProcedure){case"Visa visiteur":const n=e.situationFamiliale||"",r=e.invitationCanada||"",a=e.voyageEtranger||"",s=e.visaRefus||"",o=e.emploiTypes||[],l=o.includes("Autre");return(0,$r.jsxs)("div",{className:"procedure-fields visa-visiteur",children:[(0,$r.jsx)("h4",{children:"\ud83d\udccb Informations sp\xe9cifiques - Visa Visiteur"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Fonds disponibles en compte (CAD):"}),(0,$r.jsx)("input",{type:"number",name:"fondsDisponibles",value:e.fondsDisponibles||"",onChange:D,required:!0}),i["informationsSpecifiques.fondsDisponibles"]&&(0,$r.jsx)("div",{className:"error-message",children:i["informationsSpecifiques.fondsDisponibles"]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{className:"required",children:"Situation familiale:"}),(0,$r.jsxs)("select",{name:"situationFamiliale",value:n,onChange:D,required:!0,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"C\xe9libataire",children:"C\xe9libataire"}),(0,$r.jsx)("option",{value:"Mari\xe9(e)",children:"Mari\xe9(e)"}),(0,$r.jsx)("option",{value:"Divorc\xe9(e)",children:"Divorc\xe9(e)"}),(0,$r.jsx)("option",{value:"Veuf/Veuve",children:"Veuf/Veuve"}),(0,$r.jsx)("option",{value:"Union de fait",children:"Union de fait"})]}),i["informationsSpecifiques.situationFamiliale"]&&(0,$r.jsx)("div",{className:"error-message",children:i["informationsSpecifiques.situationFamiliale"]})]})]}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nombre de personnes dans la demande:"}),(0,$r.jsx)("input",{type:"number",name:"nombrePersonnes",min:"1",value:e.nombrePersonnes||"1",onChange:D})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date pr\xe9vue du voyage:"}),(0,$r.jsx)("input",{type:"date",name:"dateVoyage",value:e.dateVoyage||"",onChange:D})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Emploi:"}),(0,$r.jsx)("div",{className:"checkbox-group",children:["Salari\xe9","Entrepreneur","Retrait\xe9","Autre"].map((e=>(0,$r.jsxs)("label",{className:"checkbox-label",children:[(0,$r.jsx)("input",{type:"checkbox",value:e,checked:o.includes(e),onChange:t=>{const n=o;let r;r=t.target.checked?[...n,e]:n.filter((t=>t!==e)),D({target:{name:"emploiTypes",value:r}})}}),(0,$r.jsx)("span",{children:e})]},e)))})]}),l&&(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pr\xe9cisez le type d'emploi:"}),(0,$r.jsx)("input",{type:"text",name:"autreEmploiPrecision",value:e.autreEmploiPrecision||"",onChange:D})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Invitation du Canada:"}),(0,$r.jsxs)("select",{name:"invitationCanada",value:r,onChange:D,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Oui",children:"Oui"}),(0,$r.jsx)("option",{value:"Non",children:"Non"})]})]}),"Oui"===r&&(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Lien de parent\xe9 avec l'invitant:"}),(0,$r.jsx)("input",{type:"text",name:"lienParenteInvitant",value:e.lienParenteInvitant||"",onChange:D})]}),n&&"C\xe9libataire"!==n&&(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Qui sera le repr\xe9sentant de la famille ?"}),(0,$r.jsx)("input",{type:"text",name:"representantFamille",value:e.representantFamille||"",onChange:D})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Avez-vous d\xe9j\xe0 voyag\xe9 \xe0 l'\xe9tranger ?"}),(0,$r.jsxs)("select",{name:"voyageEtranger",value:a,onChange:D,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Oui",children:"Oui"}),(0,$r.jsx)("option",{value:"Non",children:"Non"})]})]}),"Oui"===a&&(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pays, dates, dur\xe9es:"}),(0,$r.jsx)("textarea",{name:"detailsVoyages",value:e.detailsVoyages||"",onChange:D,placeholder:"Pays, dates, dur\xe9e...",rows:"3"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Avez-vous d\xe9j\xe0 eu un visa ou un refus (Canada ou autre pays) ?"}),(0,$r.jsxs)("select",{name:"visaRefus",value:s,onChange:D,children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Oui",children:"Oui"}),(0,$r.jsx)("option",{value:"Non",children:"Non"})]})]}),"Oui"===s&&(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Pays, type de visa, dates, accept\xe9/refus\xe9:"}),(0,$r.jsx)("textarea",{name:"detailsVisaRefus",value:e.detailsVisaRefus||"",onChange:D,placeholder:"Pays, type de visa, dates, accept\xe9/refus\xe9...",rows:"3"})]})]});case"Permis de travail":e.situationFamilialePermis;const c=e.nombrePersonnesPermis||"",d=(e.emploiActuelTypes||[]).includes("Autre"),h=e.testsLanguePassesPT||"",f=e.offreEmploiCanada||"",p=e.voyageEtrangerPT||"",m=e.visaAnterieursOui||"",g=e.refusVisaOui||"",v=(e.typePermisTypes||[]).includes("Autre");return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udcbc Informations sp\xe9cifiques - Permis de travail"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("situationFamilialePermis","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),t("nombrePersonnesPermis","Nombre de personnes dans la demande","number")]}),parseInt(c)>1&&(0,$r.jsx)("div",{className:"form-row",children:t("representantFamillePermis","Qui sera le repr\xe9sentant ?","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations professionnelles"})}),(0,$r.jsx)("div",{className:"form-row",children:t("emploiActuelTypes","Emploi actuel","checkbox-group",["Salari\xe9","Entrepreneur","Retrait\xe9","Autre"])}),d&&(0,$r.jsx)("div",{className:"form-row",children:t("autreEmploiActuelPrecision","Pr\xe9cisez le type d'emploi actuel","text")}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Postes occup\xe9s :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(e.postesOccupes||[]).map(((t,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom du poste :"}),(0,$r.jsx)("input",{type:"text",value:t.nom||"",onChange:t=>{const r=[...e.postesOccupes||[]];r[n]=u(u({},r[n]),{},{nom:t.target.value}),D({target:{name:"postesOccupes",value:r}})},className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Mois d'exp\xe9rience :"}),(0,$r.jsx)("input",{type:"number",value:t.moisExperience||"",onChange:t=>{const r=[...e.postesOccupes||[]];r[n]=u(u({},r[n]),{},{moisExperience:t.target.value}),D({target:{name:"postesOccupes",value:r}})},className:"form-control"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const t=(e.postesOccupes||[]).filter(((e,t)=>t!==n));D({target:{name:"postesOccupes",value:t}})},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const t=[...e.postesOccupes||[],{nom:"",moisExperience:""}];D({target:{name:"postesOccupes",value:t}})},children:"Ajouter un poste"})]})]}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Dipl\xf4mes obtenus :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(e.diplomesObtenus||[]).map(((t,n)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Dipl\xf4me :"}),(0,$r.jsx)("input",{type:"text",value:t.nom||"",onChange:t=>{const r=[...e.diplomesObtenus||[]];r[n]=u(u({},r[n]),{},{nom:t.target.value}),D({target:{name:"diplomesObtenus",value:r}})},className:"form-control",placeholder:"Ex: Licence en informatique"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"\xc9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:t.etablissement||"",onChange:t=>{const r=[...e.diplomesObtenus||[]];r[n]=u(u({},r[n]),{},{etablissement:t.target.value}),D({target:{name:"diplomesObtenus",value:r}})},className:"form-control",placeholder:"Ex: Universit\xe9 XYZ"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>{const t=(e.diplomesObtenus||[]).filter(((e,t)=>t!==n));D({target:{name:"diplomesObtenus",value:t}})},children:"Supprimer"})]})},n))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>{const t=[...e.diplomesObtenus||[],{nom:"",etablissement:""}];D({target:{name:"diplomesObtenus",value:t}})},children:"Ajouter un dipl\xf4me"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[t("competencesFrancais","Comp\xe9tences en fran\xe7ais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"]),t("competencesAnglais","Comp\xe9tences en anglais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"])]}),(0,$r.jsx)("div",{className:"form-row",children:t("testsLanguePassesPT","Tests de langue pass\xe9s","select",["Oui","Non"])}),"Oui"===h&&(0,$r.jsxs)("div",{className:"form-row",children:[t("typeTestLangue","Type de test","select",["IELTS","TEF","CELPIP","TCF","Autre"]),t("scoresObtenus","Scores obtenus","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Offre d'emploi au Canada"})}),(0,$r.jsx)("div",{className:"form-row",children:t("offreEmploiCanada","Avez-vous une offre d'emploi au Canada ?","select",["Oui","Non"])}),"Oui"===f&&(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)("div",{className:"form-row",children:[t("nomEmployeurCanadien","Nom de l'employeur canadien","text"),t("typePosteCanada","Type de poste","text")]}),(0,$r.jsxs)("div",{className:"form-row",children:[t("provinceEmploi","Province d'emploi","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"]),t("dureeContrat","Dur\xe9e pr\xe9vue du contrat","text")]}),(0,$r.jsx)("div",{className:"form-row",children:t("numeroOffreEIMT","Num\xe9ro d'offre d'emploi ou EIMT (si applicable)","text")})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:t("typePermisTypes","Type de permis de travail vis\xe9","checkbox-group",["Permis ferm\xe9","Permis ouvert","Permis post-dipl\xf4me","Autre"])}),v&&(0,$r.jsx)("div",{className:"form-row",children:t("autreTypePermisPrecision","Pr\xe9cisez le type de permis","text")}),(0,$r.jsxs)("div",{className:"form-row",children:[t("provinceViseePermis","Province vis\xe9e","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"]),t("datePrevueDepart","Date pr\xe9vue de d\xe9part","date")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Informations financi\xe8res"})}),(0,$r.jsx)("div",{className:"form-row",children:t("fondsDisponiblesPermis","Fonds disponibles en compte (CAD)","number")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:t("voyageEtrangerPT","Avez-vous voyag\xe9 \xe0 l'\xe9tranger ?","select",["Oui","Non"])}),"Oui"===p&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVoyagesPT","Pays, dates, dur\xe9e","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("visaAnterieursOui","Avez-vous d\xe9j\xe0 eu un visa ?","select",["Oui","Non"])}),"Oui"===m&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVisaAnterieurs","Visa obtenu, pays, date","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("refusVisaOui","Avez-vous d\xe9j\xe0 eu un refus de visa ?","select",["Oui","Non"])}),"Oui"===g&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsRefusVisa","Pays, type de visa, motif de refus (si connu)","textarea")})]});case"Permis d'\xe9tudes":e.situationFamilialeEtudes;const b=e.nombrePersonnesEtudes||"",y=(e.niveauEtudesActuel||[]).includes("Autre"),w=e.testsLanguePassesEtudes||"",j="Autre"===(e.programmeEtudesSouhaite||""),N=e.voyageEtrangerEtudes||"",S=e.visaAnterieursEtudes||"",C=e.refusVisaEtudes||"";return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udcda Informations sp\xe9cifiques - Permis d'\xe9tudes"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("situationFamilialeEtudes","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),t("nombrePersonnesEtudes","Nombre de personnes dans la demande","number")]}),parseInt(b)>1&&(0,$r.jsx)("div",{className:"form-row",children:t("representantFamilleEtudes","Qui sera le repr\xe9sentant ?","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations acad\xe9miques"})}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Dipl\xf4mes d\xe9j\xe0 obtenus :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(e.diplomesObtenusEtudes||[]).map(((e,t)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Dipl\xf4me :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>I("diplomesObtenusEtudes",t,"nom",e.target.value),className:"form-control",placeholder:"Ex: Baccalaur\xe9at scientifique"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"\xc9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.etablissement||"",onChange:e=>I("diplomesObtenusEtudes",t,"etablissement",e.target.value),className:"form-control",placeholder:"Ex: Lyc\xe9e Mohammed V"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>F("diplomesObtenusEtudes",t),children:"Supprimer"})]})},t))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>O("diplomesObtenusEtudes",{nom:"",etablissement:""}),children:"Ajouter un dipl\xf4me"})]})]}),(0,$r.jsx)("div",{className:"form-row",children:t("niveauEtudesActuel","Niveau d'\xe9tudes actuel","checkbox-group",["Niveau bac","Bac","Bac+2","Bac+3","Master","Doctorat","Autre"])}),y&&(0,$r.jsx)("div",{className:"form-row",children:t("autreNiveauEtudesPrecision","Pr\xe9cisez le niveau d'\xe9tudes","text")}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"\xc9tablissements fr\xe9quent\xe9s :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(e.etablissementsFrequentes||[]).map(((e,t)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom de l'\xe9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>I("etablissementsFrequentes",t,"nom",e.target.value),className:"form-control",placeholder:"Ex: Universit\xe9 Hassan II"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"P\xe9riode :"}),(0,$r.jsx)("input",{type:"text",value:e.periode||"",onChange:e=>I("etablissementsFrequentes",t,"periode",e.target.value),className:"form-control",placeholder:"Ex: 2020-2023"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>F("etablissementsFrequentes",t),children:"Supprimer"})]})},t))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>O("etablissementsFrequentes",{nom:"",periode:""}),children:"Ajouter un \xe9tablissement"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[t("competencesFrancaisEtudes","Comp\xe9tences en fran\xe7ais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"]),t("competencesAnglaisEtudes","Comp\xe9tences en anglais","select",["D\xe9butant","Interm\xe9diaire","Avanc\xe9","Langue maternelle"])]}),(0,$r.jsx)("div",{className:"form-row",children:t("testsLanguePassesEtudes","Tests de langue pass\xe9s","select",["Oui","Non"])}),"Oui"===w&&(0,$r.jsxs)("div",{className:"form-row",children:[t("typeTestLangueEtudes","Type de test","select",["IELTS","TEF","CELPIP","TCF","Autre"]),t("scoresObtenusEtudes","Scores obtenus","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:t("programmeEtudesSouhaite","Programme d'\xe9tudes souhait\xe9","select",["DEP","AEC","DEC","Bachelor","Ma\xeetrise","Doctorat","Autre"])}),j&&(0,$r.jsx)("div",{className:"form-row",children:t("autreProgrammeEtudesPrecision","Pr\xe9cisez le programme d'\xe9tudes","text")}),(0,$r.jsxs)("div",{className:"form-row",children:[t("etablissementViseCanada","\xc9tablissement(s) vis\xe9(s) au Canada","text"),t("provinceViseeEtudes","Province vis\xe9e","text")]}),(0,$r.jsx)("div",{className:"form-row",children:t("dateDebutEtudes","Date pr\xe9vue de d\xe9but des \xe9tudes","date")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Garant(s) :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(e.garants||[]).map(((e,t)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Relation :"}),(0,$r.jsxs)("select",{value:e.relation||"",onChange:e=>I("garants",t,"relation",e.target.value),className:"form-control",children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Lui-m\xeame",children:"Lui-m\xeame"}),(0,$r.jsx)("option",{value:"P\xe8re",children:"P\xe8re"}),(0,$r.jsx)("option",{value:"M\xe8re",children:"M\xe8re"}),(0,$r.jsx)("option",{value:"Fr\xe8re",children:"Fr\xe8re"}),(0,$r.jsx)("option",{value:"S\u0153ur",children:"S\u0153ur"}),(0,$r.jsx)("option",{value:"Oncle",children:"Oncle"}),(0,$r.jsx)("option",{value:"Tante",children:"Tante"}),(0,$r.jsx)("option",{value:"Autre",children:"Autre"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Capacit\xe9 financi\xe8re (CAD) :"}),(0,$r.jsx)("input",{type:"number",value:e.capaciteFinanciere||"",onChange:e=>I("garants",t,"capaciteFinanciere",e.target.value),className:"form-control",placeholder:"Ex: 50000"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>F("garants",t),children:"Supprimer"})]})},t))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>O("garants",{relation:"",capaciteFinanciere:""}),children:"Ajouter un garant"})]})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:t("voyageEtrangerEtudes","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===N&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVoyagesEtudes","D\xe9tails des voyages (pays, dates, dur\xe9e)","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("visaAnterieursEtudes","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===S&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVisaAnterieursEtudes","D\xe9tails des visas obtenus (pays, type, dates)","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("refusVisaEtudes","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===C&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsRefusVisaEtudes","D\xe9tails des refus (pays, motifs, dates)","textarea")})]});case"Investisseur":e.situationFamilialeInvestisseur;const k=e.nombrePersonnesInvestisseur||"",E=(e.statutProfessionnelTypes,(e.typeProgrammeInvestisseur||[]).includes("Autre")),A=e.planAffairesCanada||"",T=e.voyageEtrangerInvestisseur||"",P=e.visaAnterieursInvestisseur||"",_=e.refusVisaInvestisseur||"";return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udcb0 Informations sp\xe9cifiques - Programme investisseur"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("situationFamilialeInvestisseur","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),t("nombrePersonnesInvestisseur","Nombre de personnes dans la demande","number")]}),parseInt(k)>1&&(0,$r.jsx)("div",{className:"form-row",children:t("representantFamilleInvestisseur","Qui sera le repr\xe9sentant de la famille ?","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations professionnelles et entrepreneuriales"})}),(0,$r.jsx)("div",{className:"form-row",children:t("statutProfessionnelTypes","Statut professionnel actuel","checkbox-group",["Entrepreneur","Dirigeant d'entreprise","Investisseur","PME"])}),(0,$r.jsxs)("div",{className:"form-row",children:[t("secteurActivite","Secteur d'activit\xe9","text"),t("experienceGestionEntreprise","Exp\xe9rience en gestion d'entreprise (ann\xe9es)","number")]}),(0,$r.jsxs)("div",{className:"form-row",children:[t("entreprisesDetenues","Entreprises d\xe9tenues ou dirig\xe9es","textarea"),t("valeurNettePersonnelle","Valeur nette personnelle","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:t("typeProgrammeInvestisseur","Type de programme d'investisseur vis\xe9","checkbox-group",["Programme des entrepreneurs","Programme de d\xe9marrage d'entreprise (Start-up Visa)","Programme d'immigration des travailleurs autonomes","Programme des investisseurs du Qu\xe9bec","Autre"])}),E&&(0,$r.jsx)("div",{className:"form-row",children:t("autreProgrammeInvestisseurPrecision","Pr\xe9cisez le type de programme","text")}),(0,$r.jsxs)("div",{className:"form-row",children:[t("provinceViseeInvestisseur","Province vis\xe9e","text"),t("planAffairesCanada","Plan d'affaires pour le Canada","select",["Oui","Non"])]}),"Oui"===A&&(0,$r.jsx)("div",{className:"form-row",children:t("resumePlanAffaires","R\xe9sum\xe9 du plan d'affaires pr\xe9vu pour le Canada","textarea")}),(0,$r.jsxs)("div",{className:"form-row",children:[t("montantInvestissementPrevu","Montant d'investissement pr\xe9vu","text"),t("secteurActiviteCanada","Secteur d'activit\xe9 vis\xe9 au Canada","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("fondsDisponiblesMontant","Fonds disponibles (montant total)","text"),t("sourcesFonds","Sources des fonds","textarea")]}),(0,$r.jsxs)("div",{className:"form-row",children:[t("actifsDetenu","Actifs d\xe9tenus (immobilier, actions, etc.)","textarea"),t("revenusAnnuels","Revenus annuels","text")]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:t("voyageEtrangerInvestisseur","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===T&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVoyagesInvestisseur","Pays visit\xe9s, dates","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("visaAnterieursInvestisseur","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===P&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVisaAnterieursInvestisseur","Pays, type de visa","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("refusVisaInvestisseur","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===_&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsRefusVisaInvestisseur","Pays, type, motif (si connu)","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Remarques"})}),(0,$r.jsx)("div",{className:"form-row",children:t("remarquesInvestisseur","Remarques ou informations importantes sur le dossier","textarea")})]});case"Regroupement familial":e.situationFamilialeRegroupement,e.nombrePersonnesRegroupement;const L="Autre"===(e.lienParenteRepondant||""),R=(e.statutRepondantTypes,(e.typeParrainageTypes||[]).includes("Autre membre de la famille")),M=(e.regroupementAnterieur,e.voyageEtrangerRegroupement||""),B=e.visaAnterieursRegroupement||"",z=e.refusVisaRegroupement||"";return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 Informations sp\xe9cifiques - Regroupement familial"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("situationFamilialeRegroupement","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),t("nombrePersonnesRegroupement","Nombre de personnes dans la demande","number")]}),(0,$r.jsx)("div",{className:"form-row",children:t("lienParenteRepondant","Lien de parent\xe9 avec le r\xe9pondant au Canada","select",["Conjoint(e)","Enfant","Parent","Grand-parent","Fr\xe8re/S\u0153ur","Autre"])}),L&&(0,$r.jsx)("div",{className:"form-row",children:t("autreParentePrecision","Pr\xe9cisez le lien de parent\xe9","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations sur le r\xe9pondant au Canada"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("nomCompletRepondant","Nom complet du r\xe9pondant","text"),t("statutRepondantTypes","Statut du r\xe9pondant au Canada","checkbox-group",["Citoyen","R\xe9sident permanent"])]}),(0,$r.jsx)("div",{className:"form-row",children:t("adresseCompleteCanada","Adresse compl\xe8te au Canada","textarea")}),(0,$r.jsxs)("div",{className:"form-row",children:[t("telephoneRepondant","T\xe9l\xe9phone du r\xe9pondant","text"),t("emailRepondant","Email du r\xe9pondant","text")]}),(0,$r.jsxs)("div",{className:"form-row",children:[t("personnesChargeRepondant","Nombre de personnes \xe0 charge du r\xe9pondant","number"),t("regroupementAnterieur","Le r\xe9pondant a-t-il d\xe9j\xe0 fait un regroupement familial ?","select",["Oui","Non"])]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:t("typeParrainageTypes","Type de parrainage","checkbox-group",["Conjoint(e) / partenaire","Enfant","Parent","Grand-parent","Autre membre de la famille"])}),R&&(0,$r.jsx)("div",{className:"form-row",children:t("autreMembrePrecision","Pr\xe9cisez le type de membre de la famille","text")}),(0,$r.jsx)("div",{className:"form-row",children:t("provinceDestinationRegroupement","Province de destination","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"])}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsx)("div",{className:"form-row",children:t("capaciteFinanciereRepondant","Capacit\xe9 financi\xe8re du r\xe9pondant","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:t("voyageEtrangerRegroupement","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===M&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVoyagesRegroupement","Pays visit\xe9s, dates","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("visaAnterieursRegroupement","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===B&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVisaAnterieursRegroupement","Pays, type de visa","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("refusVisaRegroupement","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===z&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsRefusVisaRegroupement","Pays, type de visa, motif du refus (si connu)","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Remarques"})}),(0,$r.jsx)("div",{className:"form-row",children:t("remarquesRegroupement","Remarques ou informations importantes sur le dossier","textarea")})]});case"R\xe9sidence permanente":x.informationsSpecifiques.situationFamilialeRP;const U=x.informationsSpecifiques.nombrePersonnesRP||"",q=(x.informationsSpecifiques.proceduresRP||[]).includes("Autre"),V=(x.informationsSpecifiques.programmesRP||[]).includes("Autre"),W=x.informationsSpecifiques.voyageEtrangerRP||"",H=x.informationsSpecifiques.visaAnterieursRP||"",G=x.informationsSpecifiques.refusVisaRP||"",Y=x.informationsSpecifiques.familleCanadaRP||"",$=e=>{if(!e)return!1;const t=new Date,n=new Date(e)-t,r=Math.ceil(n/864e5);return r<=90&&r>=0};return(0,$r.jsxs)("div",{className:"specific-fields",children:[(0,$r.jsx)("h4",{children:"\ud83c\udfe0 Informations sp\xe9cifiques - R\xe9sidence permanente"}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 1. Informations personnelles suppl\xe9mentaires"})}),(0,$r.jsxs)("div",{className:"form-row",children:[t("situationFamilialeRP","Situation familiale","select",["C\xe9libataire","Mari\xe9(e)","Divorc\xe9(e)","Veuf/Veuve","Union de fait"]),t("nombrePersonnesRP","Nombre de personnes dans la demande","number")]}),parseInt(U)>1&&(0,$r.jsx)("div",{className:"form-row",children:t("representantFamilleRP","Qui sera le repr\xe9sentant de la famille ?","text")}),(0,$r.jsx)("div",{className:"form-row",children:t("proceduresRP","Proc\xe9dure(s)","checkbox-group",["Arrima (Qu\xe9bec)","Entr\xe9e Express","Candidat des provinces (PCP)","Autre"])}),q&&(0,$r.jsx)("div",{className:"form-row",children:t("autreProcedureRPPrecision","Pr\xe9ciser la proc\xe9dure","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 2. Informations professionnelles et acad\xe9miques"})}),(0,$r.jsx)("div",{className:"form-row",children:t("niveauEtudesEleveRP","Niveau d'\xe9tudes le plus \xe9lev\xe9","select",["Secondaire","Coll\xe9gial","Universitaire - Baccalaur\xe9at","Universitaire - Ma\xeetrise","Universitaire - Doctorat"])}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Dipl\xf4mes obtenus :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(x.informationsSpecifiques.diplomesObtenusRP||[]).map(((e,t)=>(0,$r.jsx)("div",{className:"dynamic-item",children:(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom du dipl\xf4me :"}),(0,$r.jsx)("input",{type:"text",value:e.nom||"",onChange:e=>I("diplomesObtenusRP",t,"nom",e.target.value),className:"form-control",placeholder:"Ex: Licence en informatique"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"\xc9tablissement :"}),(0,$r.jsx)("input",{type:"text",value:e.etablissement||"",onChange:e=>I("diplomesObtenusRP",t,"etablissement",e.target.value),className:"form-control",placeholder:"Ex: Universit\xe9 XYZ"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date d'obtention :"}),(0,$r.jsx)("input",{type:"date",value:e.dateObtention||"",onChange:e=>I("diplomesObtenusRP",t,"dateObtention",e.target.value),className:"form-control"})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>F("diplomesObtenusRP",t),children:"Supprimer"})]})},t))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>O("diplomesObtenusRP",{nom:"",etablissement:"",dateObtention:""}),children:"Ajouter un dipl\xf4me"})]})]}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Exp\xe9rience professionnelle d\xe9taill\xe9e :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(x.informationsSpecifiques.experiencesProfessionnellesRP||[]).map(((e,t)=>(0,$r.jsxs)("div",{className:"dynamic-item",children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Nom de l'entreprise :"}),(0,$r.jsx)("input",{type:"text",value:e.entreprise||"",onChange:e=>I("experiencesProfessionnellesRP",t,"entreprise",e.target.value),className:"form-control",placeholder:"Ex: ABC Corporation"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Poste occup\xe9 :"}),(0,$r.jsx)("input",{type:"text",value:e.poste||"",onChange:e=>I("experiencesProfessionnellesRP",t,"poste",e.target.value),className:"form-control",placeholder:"Ex: D\xe9veloppeur senior"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de d\xe9but :"}),(0,$r.jsx)("input",{type:"date",value:e.dateDebut||"",onChange:e=>I("experiencesProfessionnellesRP",t,"dateDebut",e.target.value),className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date de fin :"}),(0,$r.jsx)("input",{type:"date",value:e.dateFin||"",onChange:e=>I("experiencesProfessionnellesRP",t,"dateFin",e.target.value),className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Code CNP :"}),(0,$r.jsx)("input",{type:"text",value:e.codeCNP||"",onChange:e=>I("experiencesProfessionnellesRP",t,"codeCNP",e.target.value),className:"form-control",placeholder:"Ex: 2174"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Mois d'exp\xe9rience :"}),(0,$r.jsx)("input",{type:"number",value:e.moisExperience||"",onChange:e=>I("experiencesProfessionnellesRP",t,"moisExperience",e.target.value),className:"form-control",placeholder:"Ex: 24"})]})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>F("experiencesProfessionnellesRP",t),children:"Supprimer"})]},t))),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>O("experiencesProfessionnellesRP",{entreprise:"",poste:"",dateDebut:"",dateFin:"",codeCNP:"",moisExperience:""}),children:"Ajouter une exp\xe9rience"})]})]}),(0,$r.jsxs)("div",{className:"dynamic-section",children:[(0,$r.jsx)("label",{children:"Comp\xe9tences linguistiques :"}),(0,$r.jsxs)("div",{className:"dynamic-list",children:[(x.informationsSpecifiques.competencesLinguistiquesRP||[]).map(((e,t)=>{const n=$(e.dateExpiration);return(0,$r.jsxs)("div",{className:"dynamic-item ".concat(n?"test-expiring":""),children:[(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Langue :"}),(0,$r.jsxs)("select",{value:e.langue||"",onChange:e=>I("competencesLinguistiquesRP",t,"langue",e.target.value),className:"form-control",children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"Fran\xe7ais",children:"Fran\xe7ais"}),(0,$r.jsx)("option",{value:"Anglais",children:"Anglais"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Type de test :"}),(0,$r.jsxs)("select",{value:e.typeTest||"",onChange:e=>I("competencesLinguistiquesRP",t,"typeTest",e.target.value),className:"form-control",children:[(0,$r.jsx)("option",{value:"",children:"S\xe9lectionner..."}),(0,$r.jsx)("option",{value:"IELTS",children:"IELTS"}),(0,$r.jsx)("option",{value:"TEF",children:"TEF"}),(0,$r.jsx)("option",{value:"TCF",children:"TCF"}),(0,$r.jsx)("option",{value:"CELPIP",children:"CELPIP"})]})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Scores par \xe9preuve :"}),(0,$r.jsx)("input",{type:"text",value:e.scores||"",onChange:e=>I("competencesLinguistiquesRP",t,"scores",e.target.value),className:"form-control",placeholder:"Ex: L:8.5, R:7.0, W:7.5, S:8.0"})]})]}),(0,$r.jsxs)("div",{className:"form-row",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Date du test :"}),(0,$r.jsx)("input",{type:"date",value:e.dateTest||"",onChange:e=>I("competencesLinguistiquesRP",t,"dateTest",e.target.value),className:"form-control"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsxs)("label",{children:["Date d'expiration :",n&&(0,$r.jsx)("span",{className:"expiring-warning",children:"\u26a0\ufe0f Expire bient\xf4t!"})]}),(0,$r.jsx)("input",{type:"date",value:e.dateExpiration||"",onChange:e=>I("competencesLinguistiquesRP",t,"dateExpiration",e.target.value),className:"form-control ".concat(n?"expiring-field":"")})]}),(0,$r.jsx)("button",{type:"button",className:"btn-danger btn-small",onClick:()=>F("competencesLinguistiquesRP",t),children:"Supprimer"})]})]},t)})),(0,$r.jsx)("button",{type:"button",className:"btn-primary btn-small",onClick:()=>O("competencesLinguistiquesRP",{langue:"",typeTest:"",scores:"",dateTest:"",dateExpiration:""}),children:"Ajouter un test de langue"})]})]}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 3. Informations sp\xe9cifiques au programme"})}),(0,$r.jsx)("div",{className:"form-row",children:t("programmesRP","Programme(s) de r\xe9sidence permanente vis\xe9(s)","checkbox-group",["Entr\xe9e Express","Programme des candidats des provinces (PCP)","Arrima","Autre"])}),V&&(0,$r.jsx)("div",{className:"form-row",children:t("autreProgrammeRPPrecision","Pr\xe9cisez le programme","text")}),(0,$r.jsx)("div",{className:"form-row",children:t("provinceViseeRP","Province vis\xe9e","select",["Alberta","Colombie-Britannique","Manitoba","Nouveau-Brunswick","Terre-Neuve-et-Labrador","Territoires du Nord-Ouest","Nouvelle-\xc9cosse","Nunavut","Ontario","\xcele-du-Prince-\xc9douard","Qu\xe9bec","Saskatchewan","Yukon"])}),(0,$r.jsx)("div",{className:"form-row",children:t("scoreCalculeRP","Score calcul\xe9 pour les programmes s\xe9lectionn\xe9s","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 4. Informations financi\xe8res"})}),(0,$r.jsx)("div",{className:"form-row",children:t("fondsDisponiblesRP","Fonds disponibles en compte","text")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 5. Ant\xe9c\xe9dents de voyage"})}),(0,$r.jsx)("div",{className:"form-row",children:t("voyageEtrangerRP","Voyages ant\xe9rieurs \xe0 l'\xe9tranger","select",["Oui","Non"])}),"Oui"===W&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVoyagesRP","Pays visit\xe9s, dates","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("visaAnterieursRP","Visas pr\xe9c\xe9demment obtenus","select",["Oui","Non"])}),"Oui"===H&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsVisaAnterieursRP","Pays, type de visa","textarea")}),(0,$r.jsx)("div",{className:"form-row",children:t("refusVisaRP","Refus ant\xe9rieurs (Canada ou autre pays)","select",["Oui","Non"])}),"Oui"===G&&(0,$r.jsx)("div",{className:"form-row",children:t("detailsRefusVisaRP","Pays, type, motif du refus (si connu)","textarea")}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 6. Famille au Canada"})}),(0,$r.jsx)("div",{className:"form-row",children:t("familleCanadaRP","Vous ou votre conjoint(e) avez un membre de la famille au Canada ?","select",["Oui","Non"])}),"Oui"===Y&&(0,$r.jsx)($r.Fragment,{children:(0,$r.jsxs)("div",{className:"form-row",children:[t("membreFamilleCanada","Quel membre de la famille ?","text"),t("statutMembreFamille","Quel est son statut au Canada ?","select",["Citoyen canadien","R\xe9sident permanent","Travailleur temporaire","\xc9tudiant","Autre"])]})}),(0,$r.jsx)("div",{className:"section-title",children:(0,$r.jsx)("h5",{children:"\ud83d\udd39 7. Remarques"})}),(0,$r.jsx)("div",{className:"form-row",children:t("remarquesRP","Remarques ou informations importantes sur le dossier","textarea")})]});default:return(0,$r.jsx)("div",{className:"procedure-fields",children:(0,$r.jsx)("p",{children:"Veuillez s\xe9lectionner un type de proc\xe9dure pour afficher les champs sp\xe9cifiques."})})}})()]}),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>c("informations"),children:"Pr\xe9c\xe9dent: Informations"}),(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:q,children:"Sauvegarder le brouillon"}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>c("documents"),disabled:!x.typeProcedure,children:"Suivant: Documents"})]})]}),"documents"===l&&(0,$r.jsxs)($r.Fragment,{children:[(()=>{var e;return(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsxs)("h3",{children:["Documents requis pour ",x.typeProcedure]}),(0,$r.jsx)("div",{className:"documents-table-container",children:(0,$r.jsxs)("table",{className:"documents-table",children:[(0,$r.jsx)("thead",{children:(0,$r.jsxs)("tr",{children:[(0,$r.jsx)("th",{children:"Document"}),(0,$r.jsx)("th",{children:"\xc9tat"}),(0,$r.jsx)("th",{children:"Fichier"}),(0,$r.jsx)("th",{children:"Actions"})]})}),(0,$r.jsxs)("tbody",{children:[_(L(x.typeProcedure)).map(((e,t)=>{var n;const r=null===(n=x.documents)||void 0===n?void 0:n.find((t=>t.nom===e&&!t.isAdditional)),a=r&&"fourni"===r.statut;return(0,$r.jsxs)("tr",{className:a?"document-provided":"document-pending",children:[(0,$r.jsxs)("td",{className:"document-name-cell",children:[(0,$r.jsx)("span",{className:"document-name",children:e}),"Dossier financier"===e&&["Visa visiteur","Permis de travail","Permis d'\xe9tudes","Investisseur"].includes(x.typeProcedure)&&(0,$r.jsxs)("div",{className:"financial-tooltip-container",onMouseEnter:W,onMouseLeave:H,children:[(0,$r.jsx)("span",{className:"financial-warning-icon",onClick:G,title:"Cliquer ou survoler pour voir les d\xe9tails du dossier financier",children:"!"}),m&&(0,$r.jsx)("div",{className:"financial-tooltip",children:(0,$r.jsx)("div",{className:"tooltip-content",children:V().map(((e,t)=>(0,$r.jsxs)("div",{className:"tooltip-section",children:[(0,$r.jsx)("h4",{children:e.title}),(0,$r.jsx)("ul",{children:e.items.map(((e,t)=>(0,$r.jsx)("li",{children:e},t)))})]},t)))})})]})]}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"status-badge ".concat(a?"status-fourni":"status-a-fournir"),children:a?"FOURNI":"\xc0 FOURNIR"})}),(0,$r.jsx)("td",{className:"file-upload-cell",children:a?(0,$r.jsxs)("div",{className:"file-info",children:[(0,$r.jsx)("i",{className:"fas fa-file-pdf text-success"}),(0,$r.jsx)("span",{className:"file-name",children:r.fichier||"Document.pdf"}),r.dateUpload&&(0,$r.jsxs)("small",{className:"upload-date",children:["(",new Date(r.dateUpload).toLocaleDateString("fr-FR"),")"]})]}):(0,$r.jsxs)("div",{className:"file-upload-wrapper",children:[(0,$r.jsx)("input",{type:"file",id:"file-".concat(t),className:"file-upload-input",onChange:t=>{t.target.files[0]&&Y(e,t.target.files[0])},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"}),(0,$r.jsxs)("label",{htmlFor:"file-".concat(t),className:"file-upload-label",children:[(0,$r.jsx)("i",{className:"fas fa-upload"})," Choisir un fichier"]})]})}),(0,$r.jsx)("td",{className:"actions-cell",children:a?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>$(r),title:"Voir",children:(0,$r.jsx)("i",{className:"fas fa-eye"})}),(0,$r.jsx)("button",{type:"button",className:"btn-icon btn-danger",onClick:()=>z(r.id),title:"Supprimer",children:(0,$r.jsx)("i",{className:"fas fa-trash"})}),(0,$r.jsx)("input",{type:"file",id:"replace-".concat(t),style:{display:"none"},onChange:t=>{t.target.files&&t.target.files[0]&&Y(e,t.target.files[0],r)},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"}),(0,$r.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>document.getElementById("replace-".concat(t)).click(),title:"Modifier",children:(0,$r.jsx)("i",{className:"fas fa-pen"})})]}):(0,$r.jsx)("span",{className:"no-actions",children:"-"})})]},"required-".concat(t))})),null===(e=x.documents)||void 0===e?void 0:e.filter((e=>e.isAdditional)).map(((e,t)=>(0,$r.jsxs)("tr",{className:"document-provided",children:[(0,$r.jsx)("td",{className:"document-name-cell",children:(0,$r.jsx)("span",{className:"document-name",children:e.nom})}),(0,$r.jsx)("td",{children:(0,$r.jsx)("span",{className:"status-badge status-fourni",children:"FOURNI"})}),(0,$r.jsx)("td",{className:"file-upload-cell",children:(0,$r.jsxs)("div",{className:"file-info",children:[(0,$r.jsx)("i",{className:"fas fa-file-pdf text-success"}),(0,$r.jsx)("span",{className:"file-name",children:e.fichier}),e.dateUpload&&(0,$r.jsxs)("small",{className:"upload-date",children:["(",new Date(e.dateUpload).toLocaleDateString("fr-FR"),")"]})]})}),(0,$r.jsxs)("td",{className:"actions-cell",children:[(0,$r.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>$(e),title:"Voir",children:(0,$r.jsx)("i",{className:"fas fa-eye"})}),(0,$r.jsx)("button",{type:"button",className:"btn-icon btn-danger",onClick:()=>z(e.id),title:"Supprimer",children:(0,$r.jsx)("i",{className:"fas fa-trash"})}),(0,$r.jsx)("input",{type:"file",id:"replace-additional-".concat(e.id),style:{display:"none"},onChange:t=>{t.target.files&&t.target.files[0]&&(async(e,t)=>{try{await z(e.id),S({type:e.nom,description:e.description||"Document suppl\xe9mentaire",fichier:t}),setTimeout((async()=>{await B({preventDefault:()=>{}})}),100)}catch(uw){console.error("Erreur lors du remplacement du document:",uw),alert("Erreur lors du remplacement du document.")}})(e,t.target.files[0])},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"}),(0,$r.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>e.getElementById("replace-additional-".concat(e.id)).click(),title:"Modifier",children:(0,$r.jsx)("i",{className:"fas fa-pen"})})]})]},"additional-".concat(e.id))))]})]})}),(0,$r.jsxs)("div",{className:"document-upload-form",style:{marginTop:"30px"},children:[(0,$r.jsx)("h4",{children:"Ajouter un document suppl\xe9mentaire"}),(0,$r.jsxs)("div",{className:"form-grid",children:[(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Type de document:"}),(0,$r.jsx)("input",{type:"text",name:"type",value:N.type,onChange:M,placeholder:"Ex: Autre document pertinent"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Description:"}),(0,$r.jsx)("input",{type:"text",name:"description",value:N.description,onChange:M,placeholder:"Description optionnelle"})]}),(0,$r.jsxs)("div",{className:"form-group",children:[(0,$r.jsx)("label",{children:"Fichier:"}),(0,$r.jsx)("input",{type:"file",name:"fichier",onChange:M})]})]}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:B,disabled:!N.type||!N.fichier,children:"Ajouter le document"})]})]})})(),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>c("procedure"),children:"Pr\xe9c\xe9dent: Proc\xe9dure"}),(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:q,children:"Sauvegarder le brouillon"}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>c("notes"),children:"Suivant: Notes"})]})]}),"notes"===l&&(0,$r.jsxs)($r.Fragment,{children:[(()=>{const e=Array.isArray(x.notes)?x.notes.filter((e=>e&&e.contenu&&""!==e.contenu.trim())):[];return(0,$r.jsxs)("div",{className:"form-section",children:[(0,$r.jsx)("h3",{children:"Notes"}),(0,$r.jsx)("div",{className:"notes-list",children:e.length>0?e.map((e=>(0,$r.jsxs)("div",{className:"note-item",children:[(0,$r.jsxs)("div",{className:"note-header",children:[(0,$r.jsx)("span",{className:"note-date",children:e.date}),(0,$r.jsx)("span",{className:"note-author",children:e.auteur})]}),(0,$r.jsx)("div",{className:"note-content",children:e.contenu})]},e.id))):(0,$r.jsx)("p",{children:"Aucune note pour le moment."})}),(0,$r.jsxs)("div",{className:"note-add-form",children:[(0,$r.jsx)("h4",{children:"Ajouter une note"}),(0,$r.jsx)("div",{className:"form-group",children:(0,$r.jsx)("textarea",{value:C,onChange:e=>k(e.target.value),placeholder:"Saisir une nouvelle note...",rows:"3"})}),(0,$r.jsx)("button",{type:"button",className:"btn-primary",onClick:U,disabled:!C.trim(),children:"Ajouter la note"})]})]})})(),(0,$r.jsxs)("div",{className:"form-actions",children:[(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>c("documents"),children:"Pr\xe9c\xe9dent: Documents"}),(0,$r.jsx)("button",{type:"button",className:"btn-secondary",onClick:q,children:"Sauvegarder le brouillon"}),(0,$r.jsx)("button",{type:"submit",className:"btn-primary",disabled:r,children:r?"Enregistrement...":n?"Modifier le client":"Ajouter le client"})]})]})]}),d&&(0,$r.jsx)("div",{className:"save-status-message",children:d})]})},Jy=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e5,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60;const r=(0,s.useRef)(null),a=(0,s.useRef)(null),i=(0,s.useRef)(!1),[o,l]=(0,s.useState)(!1),c=(0,s.useCallback)((async()=>{console.log("\ud83d\udd12 D\xe9connexion automatique forc\xe9e");try{const t=localStorage.getItem("token");if(t)try{const e=localStorage.getItem("sessionStartTime"),n=e?Math.floor((Date.now()-parseInt(e))/1e3):"unknown";await fetch("/api/users/auto-logout",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({sessionDuration:"".concat(n," secondes")})}),console.log("\ud83d\udccb D\xe9connexion automatique enregistr\xe9e dans les journaux d'activit\xe9")}catch(e){console.warn("\u26a0\ufe0f Erreur lors de l'enregistrement de la d\xe9connexion automatique:",e)}}catch(uw){console.error("\u274c Erreur lors de l'enregistrement:",uw)}l(!1),t&&t()}),[t]),u=(0,s.useCallback)((()=>{if(console.log("\ud83d\udd04 R\xe9initialisation du timer de d\xe9connexion automatique"),r.current&&(clearTimeout(r.current),r.current=null),a.current&&(clearTimeout(a.current),a.current=null),l(!1),i.current&&t){const t=Math.max(e-1e3*n,0);console.log("\u23f0 Timer configur\xe9: avertissement dans ".concat(t/1e3,"s, d\xe9connexion dans ").concat(e/1e3,"s")),t>0&&(a.current=setTimeout((()=>{console.log("\u26a0\ufe0f Affichage de l'avertissement de d\xe9connexion"),i.current&&l(!0)}),t)),r.current=setTimeout((()=>{console.log("\u23f0 D\xe9connexion automatique - Inactivit\xe9 d\xe9tect\xe9e"),i.current&&c()}),e)}}),[e,n,t,c]),d=(0,s.useCallback)((()=>{console.log("\u2705 Session prolong\xe9e par l'utilisateur"),u()}),[u]),h=(0,s.useCallback)((e=>{console.log("\ud83d\udd10 Changement d'\xe9tat d'authentification: ".concat(e)),i.current=e,e?(console.log("\ud83d\udd13 D\xe9marrage des timers - utilisateur connect\xe9"),u()):(r.current&&(clearTimeout(r.current),r.current=null),a.current&&(clearTimeout(a.current),a.current=null),l(!1),console.log("\ud83d\udd12 Timers arr\xeat\xe9s - utilisateur d\xe9connect\xe9"))}),[u]),f=["mousedown","mousemove","keypress","scroll","touchstart","click","keydown","focus","blur"],p=(0,s.useCallback)((()=>{i.current&&u()}),[u]),m=(0,s.useCallback)((()=>{let e=0;return()=>{const t=Date.now();t-e>=1e3&&(e=t,p())}})(),[p]);return(0,s.useEffect)((()=>(console.log("\ud83c\udfaf Initialisation du hook useAutoLogout"),f.forEach((e=>{document.addEventListener(e,m,!0)})),()=>{console.log("\ud83e\uddf9 Nettoyage du hook useAutoLogout"),f.forEach((e=>{document.removeEventListener(e,m,!0)})),r.current&&clearTimeout(r.current),a.current&&clearTimeout(a.current)})),[m]),{resetTimer:u,setAuthenticationStatus:h,showWarning:o,continueSession:d,forceLogout:c}},Xy=()=>{const[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)((new Date).toLocaleTimeString()),{setAuthenticationStatus:a,showWarning:i,continueSession:o,forceLogout:l}=Jy(2e4,(()=>{console.log("\ud83d\udd12 D\xe9connexion automatique d\xe9clench\xe9e"),c()}),10),c=()=>{t(!1),a(!1),console.log("\ud83d\udd13 D\xe9connexion effectu\xe9e")};return(0,$r.jsxs)("div",{style:{padding:"40px",fontFamily:"Arial, sans-serif",maxWidth:"600px",margin:"0 auto",backgroundColor:"#f8f9fa",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[(0,$r.jsx)("h2",{style:{color:"#2c3e50",marginBottom:"30px"},children:"\ud83d\udd10 D\xe9mo D\xe9connexion Automatique"}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"6px",marginBottom:"20px",border:"2px solid ".concat(e?"#27ae60":"#e74c3c")},children:[(0,$r.jsx)("h3",{children:"\xc9tat de la session"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"}),(0,$r.jsx)("span",{style:{color:e?"#27ae60":"#e74c3c",fontWeight:"bold",marginLeft:"10px"},children:e?"\u2705 Connect\xe9":"\u274c D\xe9connect\xe9"})]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Derni\xe8re activit\xe9:"})," ",n]})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"6px",marginBottom:"20px"},children:[(0,$r.jsx)("h3",{children:"Configuration de la d\xe9mo"}),(0,$r.jsxs)("ul",{style:{lineHeight:"1.6"},children:[(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Timeout total:"})," 20 secondes (au lieu de 10 minutes)"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"Avertissement:"})," Apr\xe8s 10 secondes d'inactivit\xe9"]}),(0,$r.jsxs)("li",{children:[(0,$r.jsx)("strong",{children:"D\xe9lai d'avertissement:"})," 10 secondes pour r\xe9agir"]})]})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"6px",marginBottom:"20px"},children:[(0,$r.jsx)("h3",{children:"Actions de test"}),(0,$r.jsx)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:e?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{onClick:()=>{r((new Date).toLocaleTimeString()),console.log("\ud83c\udfaf Activit\xe9 simul\xe9e")},style:{background:"#3498db",color:"white",border:"none",padding:"12px 20px",borderRadius:"6px",cursor:"pointer"},children:"\ud83c\udfaf Simuler activit\xe9"}),(0,$r.jsx)("button",{onClick:c,style:{background:"#e74c3c",color:"white",border:"none",padding:"12px 20px",borderRadius:"6px",cursor:"pointer"},children:"\ud83d\udd10 Se d\xe9connecter"})]}):(0,$r.jsx)("button",{onClick:()=>{t(!0),a(!0),r((new Date).toLocaleTimeString()),console.log("\u2705 Connexion simul\xe9e")},style:{background:"#27ae60",color:"white",border:"none",padding:"12px 20px",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:"\ud83d\udd13 Se connecter"})})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"6px",border:"1px solid #ffeaa7"},children:[(0,$r.jsx)("h4",{style:{margin:"0 0 10px 0",color:"#856404"},children:"\ud83d\udca1 Instructions de test"}),(0,$r.jsxs)("ol",{style:{margin:0,paddingLeft:"20px",color:"#856404"},children:[(0,$r.jsx)("li",{children:'Cliquez sur "Se connecter"'}),(0,$r.jsx)("li",{children:"Attendez 10 secondes sans bouger la souris ni cliquer"}),(0,$r.jsx)("li",{children:"Un avertissement devrait appara\xeetre"}),(0,$r.jsx)("li",{children:'Testez les boutons "Continuer" ou "Se d\xe9connecter"'}),(0,$r.jsx)("li",{children:"Ou attendez 10 secondes de plus pour la d\xe9connexion auto"})]})]}),(0,$r.jsx)(Jr,{isVisible:i,onContinue:()=>{o(),r((new Date).toLocaleTimeString())},onLogout:l,warningTime:10})]})},Qy=()=>{const[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)([]),[a,i]=(0,s.useState)(5),o=e=>{const t=(new Date).toLocaleTimeString();r((n=>[...n,"".concat(t,": ").concat(e)])),console.log("[AUTO-LOGOUT TEST] ".concat(e))},{setAuthenticationStatus:l,showWarning:c,continueSession:u,forceLogout:d}=Jy(1e3*a,(()=>{o("\ud83d\udd12 D\xc9CONNEXION AUTOMATIQUE D\xc9CLENCH\xc9E"),t(!1)}),Math.floor(a/3));return(0,s.useEffect)((()=>{c&&o("\u26a0\ufe0f AVERTISSEMENT AFFICH\xc9")}),[c]),(0,$r.jsxs)("div",{style:{padding:"20px",fontFamily:"monospace",backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[(0,$r.jsx)("h2",{style:{color:"#2c3e50"},children:"\ud83d\udd10 Test de D\xe9connexion Automatique"}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"15px",borderRadius:"8px",marginBottom:"20px",border:"2px solid ".concat(e?"#27ae60":"#e74c3c")},children:[(0,$r.jsx)("h3",{children:"\xc9tat actuel"}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Statut:"})," ",(0,$r.jsx)("span",{style:{color:e?"#27ae60":"#e74c3c"},children:e?"\u2705 Connect\xe9":"\u274c D\xe9connect\xe9"})]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Avertissement:"})," ",(0,$r.jsx)("span",{style:{color:c?"#f39c12":"#95a5a6"},children:c?"\u26a0\ufe0f Affich\xe9":"\u2705 Masqu\xe9"})]}),(0,$r.jsxs)("p",{children:[(0,$r.jsx)("strong",{children:"Dur\xe9e de test:"})," ",a," secondes"]})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"15px",borderRadius:"8px",marginBottom:"20px"},children:[(0,$r.jsx)("h3",{children:"Configuration"}),(0,$r.jsxs)("label",{children:["Dur\xe9e de test (secondes):",(0,$r.jsx)("input",{type:"number",value:a,onChange:e=>i(parseInt(e.target.value)||10),min:"5",max:"300",style:{marginLeft:"10px",padding:"5px"}})]}),(0,$r.jsx)("p",{children:(0,$r.jsxs)("small",{children:["Avertissement apr\xe8s ",Math.floor(2*a/3),"s, d\xe9connexion apr\xe8s ",a,"s"]})})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"15px",borderRadius:"8px",marginBottom:"20px"},children:[(0,$r.jsx)("h3",{children:"Actions"}),(0,$r.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[e?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)("button",{onClick:()=>{o("\ud83c\udfaf Activit\xe9 simul\xe9e (reset timer)")},style:{background:"#3498db",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"\ud83c\udfaf Simuler activit\xe9"}),(0,$r.jsx)("button",{onClick:()=>{t(!1),l(!1),o("\ud83d\udd13 D\xe9connexion manuelle")},style:{background:"#e74c3c",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"\ud83d\udd10 Se d\xe9connecter"}),c&&(0,$r.jsx)("button",{onClick:()=>{u(),o("\u2705 Session prolong\xe9e manuellement")},style:{background:"#f39c12",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"\u2705 Prolonger session"})]}):(0,$r.jsx)("button",{onClick:()=>{t(!0),l(!0),o("\u2705 Connexion simul\xe9e - Timer configur\xe9 pour ".concat(a,"s"))},style:{background:"#27ae60",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"\ud83d\udd13 Se connecter"}),(0,$r.jsx)("button",{onClick:()=>r([]),style:{background:"#95a5a6",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"\ud83d\uddd1\ufe0f Effacer logs"})]})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"white",padding:"15px",borderRadius:"8px"},children:[(0,$r.jsx)("h3",{children:"Journal d'activit\xe9 (temps r\xe9el)"}),(0,$r.jsx)("div",{style:{height:"300px",overflow:"auto",background:"#2c3e50",color:"#ecf0f1",padding:"10px",borderRadius:"5px",fontSize:"12px",fontFamily:"monospace"},children:0===n.length?(0,$r.jsx)("p",{style:{margin:0,color:"#95a5a6"},children:"Aucun log pour le moment..."}):n.map(((e,t)=>(0,$r.jsx)("div",{style:{marginBottom:"2px"},children:e},t)))})]}),(0,$r.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:"15px",borderRadius:"8px",marginTop:"20px",border:"1px solid #ffeaa7"},children:[(0,$r.jsx)("h4",{style:{margin:"0 0 10px 0",color:"#856404"},children:"\ud83d\udca1 Instructions"}),(0,$r.jsxs)("ol",{style:{margin:0,paddingLeft:"20px",color:"#856404"},children:[(0,$r.jsx)("li",{children:'Cliquez sur "Se connecter"'}),(0,$r.jsx)("li",{children:"Observez les logs dans la console"}),(0,$r.jsx)("li",{children:"Attendez sans bouger la souris ni cliquer"}),(0,$r.jsx)("li",{children:"V\xe9rifiez que l'avertissement appara\xeet"}),(0,$r.jsx)("li",{children:'Testez "Prolonger session" ou attendez la d\xe9connexion auto'})]})]})]})},Zy=()=>{const[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)(0),{setAuthenticationStatus:a,showWarning:i,continueSession:o}=Jy(8e3,(()=>{console.log("\ud83c\udfaf D\xc9CONNEXION AUTO D\xc9CLENCH\xc9E !"),alert("\u2705 SUCC\xc8S: D\xe9connexion automatique fonctionne !"),t(!1)}),3);return(0,s.useEffect)((()=>{i&&console.log("\u26a0\ufe0f AVERTISSEMENT AFFICH\xc9 !")}),[i]),(0,$r.jsxs)("div",{style:{padding:"40px",fontFamily:"Arial, sans-serif",textAlign:"center",backgroundColor:"#f8f9fa"},children:[(0,$r.jsx)("h1",{style:{color:"#2c3e50"},children:"\ud83d\udd25 TEST ULTRA-RAPIDE D\xc9CONNEXION AUTO"}),(0,$r.jsxs)("div",{style:{backgroundColor:e?"#d4edda":"#f8d7da",border:"1px solid ".concat(e?"#c3e6cb":"#f5c6cb"),borderRadius:"8px",padding:"20px",margin:"20px 0"},children:[(0,$r.jsxs)("h2",{children:["\xc9tat: ",e?"\ud83d\udfe2 Connect\xe9":"\ud83d\udd34 D\xe9connect\xe9"]}),(0,$r.jsxs)("h2",{children:["Avertissement: ",i?"\u26a0\ufe0f AFFICH\xc9":"\u2705 Masqu\xe9"]}),n>0&&(0,$r.jsxs)("h2",{style:{color:"#e74c3c"},children:["\u23f1\ufe0f ",n," secondes restantes"]})]}),(0,$r.jsx)("div",{style:{margin:"30px 0"},children:e?(0,$r.jsxs)("div",{children:[(0,$r.jsx)("button",{onClick:()=>{console.log("\u23f9\ufe0f ARR\xcaT TEST"),t(!1),a(!1),r(0)},style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"15px 30px",fontSize:"18px",borderRadius:"8px",cursor:"pointer",marginRight:"10px"},children:"\u23f9\ufe0f ARR\xcaTER TEST"}),i&&(0,$r.jsx)("button",{onClick:()=>{o(),console.log("\u2705 Session prolong\xe9e")},style:{backgroundColor:"#ffc107",color:"black",border:"none",padding:"15px 30px",fontSize:"18px",borderRadius:"8px",cursor:"pointer"},children:"\u2705 PROLONGER SESSION"})]}):(0,$r.jsx)("button",{onClick:()=>{console.log("\ud83d\ude80 D\xc9MARRAGE TEST: 5 secondes avant avertissement, 8 secondes avant d\xe9connexion"),t(!0),a(!0),r(8);const e=setInterval((()=>{r((t=>t<=1?(clearInterval(e),0):t-1))}),1e3)},style:{backgroundColor:"#28a745",color:"white",border:"none",padding:"15px 30px",fontSize:"18px",borderRadius:"8px",cursor:"pointer"},children:"\ud83d\ude80 D\xc9MARRER TEST (8 secondes)"})}),(0,$r.jsxs)("div",{style:{backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:"8px",padding:"20px",textAlign:"left"},children:[(0,$r.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#856404"},children:"\ud83d\udccb Instructions"}),(0,$r.jsxs)("ol",{style:{color:"#856404"},children:[(0,$r.jsx)("li",{children:'Cliquez "D\xc9MARRER TEST"'}),(0,$r.jsx)("li",{children:(0,$r.jsx)("strong",{children:"NE BOUGEZ PAS la souris"})}),(0,$r.jsx)("li",{children:(0,$r.jsx)("strong",{children:"NE TAPEZ RIEN au clavier"})}),(0,$r.jsx)("li",{children:"Apr\xe8s 5 secondes \u2192 Avertissement doit s'afficher"}),(0,$r.jsx)("li",{children:"Apr\xe8s 8 secondes \u2192 D\xe9connexion automatique"})]}),(0,$r.jsxs)("p",{style:{color:"#721c24",backgroundColor:"#f8d7da",padding:"10px",borderRadius:"4px",margin:"10px 0"},children:[(0,$r.jsx)("strong",{children:"\u26a0\ufe0f IMPORTANT:"})," Si vous bougez la souris ou tapez, le timer se remet \xe0 z\xe9ro !"]})]})]})},ew=()=>{const{notifications:e}=My(),[t,n]=(0,s.useState)([]),[r,a]=(0,s.useState)((()=>{try{const e=localStorage.getItem("shownToastNotifications");return e?new Set(JSON.parse(e)):new Set}catch(e){return new Set}}));(0,s.useEffect)((()=>{try{localStorage.setItem("shownToastNotifications",JSON.stringify(Array.from(r)))}catch(uw){console.error("Erreur sauvegarde toast IDs:",uw)}}),[r]),(0,s.useEffect)((()=>{const t=()=>{const t=new Date;t.setDate(t.getDate()-1);const n=e.filter((e=>new Date(e.date)>t)).map((e=>e.id));a((e=>new Set(Array.from(e).filter((e=>n.includes(e))))))};t();const n=setInterval(t,36e5);return()=>clearInterval(n)}),[e]),(0,s.useEffect)((()=>{const t=new Date,s=e.filter((e=>{const n=new Date(e.date);return(t.getTime()-n.getTime())/6e4<=5&&!e.isRead&&!r.has(e.id)}));if(s.length>0){const e=s.slice(0,3);n((t=>{const n=new Set(t.map((e=>e.id))),r=e.filter((e=>!n.has(e.id)));return[...t,...r]})),a((t=>{const n=new Set(t);return e.forEach((e=>n.add(e.id))),n})),e.forEach((e=>{setTimeout((()=>{n((t=>t.filter((t=>t.id!==e.id))))}),8e3)}))}}),[e,r]);const i=e=>{switch(e){case"nouveau_lead":return"\ud83d\udc65";case"rappel_rendez_vous":return"\ud83d\udcc5";case"paiement_recu":return"\ud83d\udcb0";case"facture_retard":return"\u26a0\ufe0f";case"resume_leads":return"\ud83d\udcca";default:return"\ud83d\udd14"}},o=e=>{switch(e){case"nouveau_lead":case"paiement_recu":return"#28a745";case"rappel_rendez_vous":return"#007bff";case"facture_retard":return"#dc3545";case"resume_leads":return"#17a2b8";default:return"#6c757d"}};return 0===t.length?null:(0,$r.jsx)("div",{className:"notification-toast-container",children:(0,$r.jsx)("div",{className:"notification-toast-wrapper",style:{display:"flex",overflowX:"auto",overflowY:"hidden",scrollBehavior:"smooth",gap:"12px",paddingBottom:"10px",maxHeight:"100px"},children:t.map(((e,t)=>(0,$r.jsxs)("div",{className:"notification-toast",style:{"--notification-color":o(e.type),animationDelay:"".concat(200*t,"ms"),flexShrink:0},onClick:()=>(e=>{e.lienRedirection&&Uy.navigateToModule(e.lienRedirection),n((t=>t.filter((t=>t.id!==e.id))))})(e),children:[(0,$r.jsxs)("div",{className:"notification-toast-content",children:[(0,$r.jsx)("div",{className:"notification-toast-icon",children:i(e.type)}),(0,$r.jsxs)("div",{className:"notification-toast-message",children:[(0,$r.jsx)("p",{children:e.message}),e.nomClient&&(0,$r.jsxs)("small",{className:"notification-client",children:["Client: ",e.nomClient]})]}),(0,$r.jsx)("button",{className:"notification-toast-dismiss",onClick:t=>{return r=e.id,t.stopPropagation(),void n((e=>e.filter((e=>e.id!==r))));var r},"aria-label":"Fermer la notification",children:"\xd7"})]}),(0,$r.jsx)("div",{className:"notification-toast-progress"})]},e.id)))})})};class tw{static async onFactureAction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"created";console.log("\ud83c\udfaf Action facture d\xe9tect\xe9e: ".concat(e)),gy.resetChecked("factures"),setTimeout((async()=>{await gy.forceCheck()}),1e3)}static async onLeadAction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"created";console.log("\ud83c\udfaf Action lead d\xe9tect\xe9e: ".concat(e)),gy.resetChecked("leads"),setTimeout((async()=>{await gy.forceCheck()}),1e3)}static async onRendezVousAction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"created";console.log("\ud83c\udfaf Action rendez-vous d\xe9tect\xe9e: ".concat(e)),gy.resetChecked("rendezVous"),setTimeout((async()=>{await gy.forceCheck()}),1e3)}static async onPaymentReceived(e){console.log("\ud83c\udfaf Paiement d\xe9tect\xe9 pour facture: ".concat(e)),gy.resetChecked("factures"),setTimeout((async()=>{await gy.forceCheck()}),500)}static integreWithAPI(){window.originalFetch||(window.originalFetch=window.fetch,window.fetch=async function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const a=await window.originalFetch(...n),[s,i]=n,o=null===i||void 0===i||null===(e=i.method)||void 0===e?void 0:e.toLowerCase();return["post","put","patch"].includes(o)&&(s.includes("/api/factures")||s.includes("/facturation")?tw.onFactureAction("post"===o?"created":"updated"):s.includes("/api/leads")?tw.onLeadAction("post"===o?"created":"updated"):(s.includes("/api/rendez-vous")||s.includes("/rendezVous"))&&tw.onRendezVousAction("post"===o?"created":"updated")),a},console.log("\ud83d\udd17 API hooks install\xe9s pour les notifications en temps r\xe9el"))}}const nw=tw,rw=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{addNotification:t}=My();return(0,s.useEffect)((()=>{if(!e)return void gy.stopChecking();console.log("\ud83d\udd14 Initialisation du service de notifications automatiques");const n=gy.subscribe((e=>{t({type:e.type,message:e.message,date:e.date,lienRedirection:e.lienRedirection,nomClient:e.nomClient})}));return(async()=>{try{console.log("\ud83d\ude80 Initialisation compl\xe8te du service de notifications..."),gy.loadUserData(),await gy.initializeWithUserInfo(),nw.integreWithAPI(),console.log("\ud83d\udd04 V\xe9rification imm\xe9diate des notifications apr\xe8s actualisation..."),await gy.forceCheck()}catch(uw){console.error("Erreur lors de l'initialisation du service de notifications:",uw)}})(),()=>{console.log("\ud83d\udd15 Arr\xeat du service de notifications automatiques"),n(),gy.stopChecking()}}),[e,t]),{generateTestNotifications:()=>gy.generateTestNotifications(),forceCheck:()=>gy.forceCheck(),resetChecked:e=>gy.resetChecked(e),serviceStatus:gy.isRunning}},aw=e=>{let{isAuthenticated:t,userRole:n,onLogout:r}=e;const{generateTestNotifications:a,serviceStatus:s}=rw(t);return(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsxs)(De,{children:[(0,$r.jsx)(Le,{path:"/",element:(0,$r.jsx)(Wy,{userRole:n||"visiteur",userName:localStorage.getItem("userName")||"Utilisateur",onLogout:r})}),(0,$r.jsx)(Le,{path:"/leads",element:(0,$r.jsx)(Yy,{})}),(0,$r.jsx)(Le,{path:"/clients",element:(0,$r.jsx)(Ox,{userRole:n||"visiteur",onEditClient:e=>console.log("Edit client:",e)})}),(0,$r.jsx)(Le,{path:"/client/:id",element:(0,$r.jsx)($y,{})}),(0,$r.jsx)(Le,{path:"/client/nouveau",element:"secretaire"===n?(0,$r.jsx)(_e,{to:"/",replace:!0}):(0,$r.jsx)(Ky,{})}),(0,$r.jsx)(Le,{path:"/client/modifier/:id",element:"secretaire"===n?(0,$r.jsx)(_e,{to:"/",replace:!0}):(0,$r.jsx)(Ky,{})}),(0,$r.jsx)(Le,{path:"/journaux",element:"administrateur"===n?(0,$r.jsx)(py,{}):(0,$r.jsx)(_e,{to:"/",replace:!0})}),(0,$r.jsx)(Le,{path:"/demo-logout",element:(0,$r.jsx)(Xy,{})}),(0,$r.jsx)(Le,{path:"/test-logout",element:(0,$r.jsx)(Qy,{})}),(0,$r.jsx)(Le,{path:"/mini-test",element:(0,$r.jsx)(Zy,{})}),(0,$r.jsx)(Le,{path:"*",element:(0,$r.jsx)(_e,{to:"/",replace:!0})})]}),t&&(0,$r.jsx)(ew,{})]})},sw=()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("userName"),delete Yr.defaults.headers.common.Authorization,window.location.href="/"},iw=()=>{const e=localStorage.getItem("token");e?Yr.defaults.headers.common.Authorization="Bearer ".concat(e):delete Yr.defaults.headers.common.Authorization};const ow=function(){const[e,t]=(0,s.useState)((()=>!!localStorage.getItem("token"))),[r,a]=(0,s.useState)((()=>localStorage.getItem("role")||null)),[i,o]=(0,s.useState)(!0),{setAuthenticationStatus:l,showWarning:c,continueSession:u,forceLogout:d}=Jy(54e4,(()=>{console.log("\ud83d\udd12 D\xe9connexion automatique d\xe9clench\xe9e - Inactivit\xe9 de 10 minutes d\xe9tect\xe9e"),sw()}),60);(0,s.useEffect)((()=>{(async()=>{try{Yr.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&"mock-token"!==t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e))),Yr.interceptors.response.use((e=>e),(e=>{if(e.response){const{status:t,data:n}=e.response;if(401===t){const e=(null===n||void 0===n?void 0:n.message)||"";(e.includes("Token expir\xe9")||e.includes("Token expired")||e.includes("Token invalide")||e.includes("Token invalid"))&&(console.log("\ud83d\udd12 Token expir\xe9 d\xe9tect\xe9, d\xe9connexion automatique..."),window.confirm("Votre session a expir\xe9. Vous allez \xeatre redirig\xe9 vers la page de connexion."),sw())}t>=500&&console.error("\ud83d\udea8 Erreur serveur:",(null===n||void 0===n?void 0:n.message)||"Erreur interne du serveur")}return Promise.reject(e)}));if(localStorage.getItem("token")){const e=await(async()=>{const e=localStorage.getItem("token");if(!e||"mock-token"===e)return!0;try{return 200===(await Yr.get("http://localhost:5000/api/users/me")).status}catch(uw){var t;return 401!==(null===(t=uw.response)||void 0===t?void 0:t.status)||(console.log("\ud83d\udd12 Token invalide au d\xe9marrage, d\xe9connexion..."),sw(),!1)}})();if(e){const e=localStorage.getItem("role");e&&a(e),t(!0),l(!0),iw()}else t(!1),a(null),l(!1)}else t(!1),a(null),l(!1)}catch(uw){console.error("Erreur lors de l'initialisation:",uw),t(!1),a(null),l(!1)}finally{o(!1)}})()}),[]);const h=async(e,r)=>{try{const{loginUser:s}=await Promise.resolve().then(n.bind(n,945)),i=await s(e,r);if(i&&i.token){localStorage.setItem("token",i.token),localStorage.setItem("sessionStartTime",Date.now().toString());const e=i.user.role,n="admin"===e?"administrateur":e,r=i.user.nom||i.user.name||"Utilisateur";return a(n),localStorage.setItem("role",n),localStorage.setItem("userName",r),iw(),t(!0),l(!0),!0}}catch(cw){console.warn("Backend login failed, fallback to mock.",cw)}if("admin@immigration.ca"===e&&"admin123"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","administrateur"),localStorage.setItem("userName","Administrateur"),a("administrateur"),t(!0),l(!0),!0;if("marie.tremblay@immigration.ca"===e&&"conseillere123"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","conseillere"),localStorage.setItem("userName","Marie T."),a("conseillere"),t(!0),l(!0),!0;if("admin@example.com"===e&&"password"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","administrateur"),localStorage.setItem("userName","Administrateur"),a("administrateur"),t(!0),l(!0),!0;if("directeur@example.com"===e&&"password"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","directeur"),localStorage.setItem("userName","Directeur"),a("directeur"),t(!0),l(!0),!0;if("marie@example.com"===e&&"password"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","conseillere"),localStorage.setItem("userName","Marie T."),a("conseillere"),t(!0),l(!0),!0;if("sophie@example.com"===e&&"password"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","conseillere"),localStorage.setItem("userName","Sophie M."),a("conseillere"),t(!0),l(!0),!0;if("julie@example.com"===e&&"password"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","conseillere"),localStorage.setItem("userName","Julie L."),a("conseillere"),t(!0),l(!0),!0;if("conseillere@example.com"===e&&"password"===r)return localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","conseillere"),localStorage.setItem("userName","Marie T."),a("conseillere"),t(!0),l(!0),!0;const s=[{email:"marie.dupont@example.com",nom:"Marie Dupont"},{email:"sophie.martin@example.com",nom:"Sophie Martin"},{email:"julie.bernard@example.com",nom:"Julie Bernard"},{email:"kaoutar.chaouby@example.com",nom:"Kaoutar Chaouby"},{email:"kaoutar@example.com",nom:"kaoutar"}].find((t=>t.email===e));return s&&"password"===r?(localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","conseillere"),localStorage.setItem("userName",s.nom),a("conseillere"),t(!0),l(!0),!0):"comptable@example.com"===e&&"password"===r?(localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","comptable"),localStorage.setItem("userName","Comptable"),a("comptable"),t(!0),l(!0),!0):"secretaire@example.com"===e&&"password"===r&&(localStorage.setItem("token","mock-token"),localStorage.setItem("sessionStartTime",Date.now().toString()),localStorage.setItem("role","secretaire"),localStorage.setItem("userName","Secr\xe9taire"),a("secretaire"),t(!0),l(!0),!0)};return i?(0,$r.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",gap:"20px"},children:[(0,$r.jsx)("div",{style:{width:"50px",height:"50px",border:"4px solid #f3f3f3",borderTop:"4px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,$r.jsx)("p",{children:"V\xe9rification de la session..."}),(0,$r.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        "})]}):e?(0,$r.jsxs)($r.Fragment,{children:[(0,$r.jsx)(mt,{children:(0,$r.jsxs)(By,{children:[" ",(0,$r.jsx)(aw,{isAuthenticated:e,userRole:r,onLogout:()=>{console.log("\ud83d\udd13 D\xe9connexion manuelle d\xe9clench\xe9e"),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("userName"),localStorage.removeItem("sessionStartTime"),delete Yr.defaults.headers.common.Authorization,t(!1),a(null),l(!1)}})]})}),(0,$r.jsx)(Jr,{isVisible:c,onContinue:u,onLogout:d,warningTime:60})]}):(0,$r.jsx)(Kr,{onLogin:h})},lw=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then((t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:s,getTTFB:i}=t;n(e),r(e),a(e),s(e),i(e)}))};i.createRoot(document.getElementById("root")).render((0,$r.jsx)(s.StrictMode,{children:(0,$r.jsx)(ow,{})})),lw()})();
//# sourceMappingURL=main.390be96c.js.map